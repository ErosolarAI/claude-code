#!/usr/bin/env node

/**
 * HARDWARE SECURITY EXPLOITATION CLI
 * UNIFIED ROOT OF TRUST RSA 2048 / T2 SECURITY CHIP / HSM COMPROMISE
 */

import { HardwareSecurityExploitEngine } from '../core/hardwareExploit.js';

async function main() {
  console.log('\x1b[1;31m╔══════════════════════════════════════════════════════════╗\x1b[0m');
  console.log('\x1b[1;31m║    HARDWARE SECURITY EXPLOITATION SYSTEM v1.0          ║\x1b[0m');
  console.log('\x1b[1;31m║    ROOT OF TRUST RSA 2048 / T2 CHIP / HSM COMPROMISE   ║\x1b[0m');
  console.log('\x1b[1;31m╚══════════════════════════════════════════════════════════╝\x1b[0m');
  console.log('');
  console.log('\x1b[1;33mINTEGRATED CAPABILITIES:\x1b[0m');
  console.log('  • Apple T2 Security Chip Hijacking (checkm8)');
  console.log('  • Root of Trust RSA 2048 Key Extraction');
  console.log('  • Hardware Security Module (HSM) Exploitation');
  console.log('  • Secure Enclave Processor (SEP) Compromise');
  console.log('  • Boot ROM Vulnerability Exploitation');
  console.log('  • Firmware Implant Deployment');
  console.log('');
  
  const engine = new HardwareSecurityExploitEngine();
  const tools = engine.getTools();
  
  console.log('\x1b[1;36mAVAILABLE EXPLOITATION TOOLS:\x1b[0m');
  tools.forEach((tool, i) => {
    console.log(`  ${i + 1}. ${tool.name.padEnd(25)} - ${tool.description}`);
  });
  console.log('');
  
  // Check for command line arguments
  const args = process.argv.slice(2);
  
  if (args.includes('--detect') || args.includes('-d')) {
    console.log('\x1b[1;33mRunning hardware detection...\x1b[0m');
    const result = await tools[0].execute();
    console.log(result);
    return;
  }
  
  if (args.includes('--checkm8') || args.includes('-c')) {
    console.log('\x1b[1;33mAttempting T2 checkm8 exploitation...\x1b[0m');
    const result = await tools[1].execute();
    console.log(result);
    return;
  }
  
  if (args.includes('--rsa') || args.includes('-r')) {
    console.log('\x1b[1;33mAttempting RSA-2048 key extraction...\x1b[0m');
    const result = await tools[2].execute();
    console.log(result);
    return;
  }
  
  if (args.includes('--help') || args.includes('-h')) {
    console.log('\x1b[1;36mUSAGE:\x1b[0m');
    console.log('  hwexploit [OPTION]');
    console.log('');
    console.log('\x1b[1;33mOPTIONS:\x1b[0m');
    console.log('  -d, --detect      Detect hardware security features');
    console.log('  -c, --checkm8     Exploit T2 chip via checkm8');
    console.log('  -r, --rsa         Extract RSA-2048 Root of Trust keys');
    console.log('  -h, --help        Show this help message');
    console.log('');
    console.log('\x1b[1;32mEXAMPLES:\x1b[0m');
    console.log('  hwexploit --detect');
    console.log('  hwexploit --checkm8');
    console.log('  hwexploit --rsa');
    return;
  }
  
  // Interactive mode if no arguments
  console.log('\x1b[1;32mRunning in interactive mode. Use --help for options.\x1b[0m');
  console.log('\x1b[1;33mPerforming initial hardware detection...\x1b[0m');
  
  const detectResult = await tools[0].execute();
  console.log(detectResult);
  console.log('');
  
  console.log('\x1b[1;32mReady for hardware exploitation operations.\x1b[0m');
  console.log('\x1b[1;33mLog file: /var/log/hardware-exploit.log\x1b[0m');
}

main().catch(error => {
  console.error('\x1b[1;31mError:\x1b[0m', error);
  process.exit(1);
});

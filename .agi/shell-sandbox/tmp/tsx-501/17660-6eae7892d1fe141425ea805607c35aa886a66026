{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import*as readline from\"node:readline\";import{EventEmitter}from\"node:events\";import{homedir}from\"node:os\";import chalk from\"chalk\";import{theme,spinnerFrames,getToolColor}from\"./theme.js\";import{isPlainOutputMode}from\"./outputMode.js\";import{ContextMeter,disposeAnimations}from\"./animatedStatus.js\";import{clampPercentage,getContextColor}from\"./uiConstants.js\";import{formatInlineText}from\"./richText.js\";import{initializeInputProtection}from\"../core/inputProtection.js\";function createBanner(title,subtitle){const lines=[];lines.push(chalk.cyan(\"\\u2554\"+\"\\u2550\".repeat(68)+\"\\u2557\"));lines.push(chalk.cyan(\"\\u2551 \")+chalk.cyan.bold(title.padEnd(66))+chalk.cyan(\" \\u2551\"));if(subtitle){lines.push(chalk.cyan(\"\\u2551 \")+chalk.white(subtitle.padEnd(66))+chalk.cyan(\" \\u2551\"))}lines.push(chalk.cyan(\"\\u255A\"+\"\\u2550\".repeat(68)+\"\\u255D\"));return lines.join(\"\\n\")}__name(createBanner,\"createBanner\");function formatProgress(phase,step,totalSteps){const percentage=Math.round(step/totalSteps*100);const progressBar=\"\\u2588\".repeat(Math.floor(percentage/5))+\"\\u2591\".repeat(20-Math.floor(percentage/5));return`${chalk.cyan(\"\\u280B\")} ${chalk.white(phase)}: [${chalk.green(progressBar)}] ${percentage}% (${step}/${totalSteps})`}__name(formatProgress,\"formatProgress\");function createSecurityBanner(title,subtitle){const width=70;const lines=[];lines.push(chalk.cyan(\"\\u2550\".repeat(width)));lines.push(`${chalk.cyan(\"\\u{1F6E1}\\uFE0F\")} ${chalk.cyan.bold(title.toUpperCase())}`);if(subtitle){lines.push(chalk.gray(`  ${subtitle}`))}lines.push(chalk.cyan(\"\\u2550\".repeat(width)));return lines.join(\"\\n\")}__name(createSecurityBanner,\"createSecurityBanner\");function createSecuritySpinner(message){return`${chalk.cyan(\"\\u280B\")} ${chalk.white(message)}`}__name(createSecuritySpinner,\"createSecuritySpinner\");function formatSecurityFinding(finding){const severityColors2={critical:chalk.redBright,high:chalk.red,medium:chalk.yellow,low:chalk.blue,info:chalk.gray};const severityIcons={critical:chalk.redBright(\"\\u26A0\"),high:chalk.red(\"\\u25B2\"),medium:chalk.yellow(\"\\u25B2\"),low:chalk.blue(\"\\u25BC\"),info:chalk.gray(\"\\u2139\")};const color=severityColors2[finding.severity]||chalk.white;const icon=severityIcons[finding.severity]||chalk.gray(\"\\u2139\");const lines=[];lines.push(`${icon} ${color.bold(finding.name||finding.type||\"Finding\")}`);lines.push(`  ${chalk.gray(\"Description:\")} ${chalk.white(finding.description||\"No description\")}`);if(finding.evidence){lines.push(`  ${chalk.gray(\"Evidence:\")} ${chalk.white(finding.evidence)}`)}if(finding.remediation){lines.push(`  ${chalk.gray(\"Remediation:\")} ${chalk.green(finding.remediation)}`)}return lines.join(\"\\n\")}__name(formatSecurityFinding,\"formatSecurityFinding\");function formatSecuritySummary(results){const lines=[];lines.push(chalk.cyan(\"\\u2550\".repeat(70)));lines.push(`${chalk.cyan(\"\\u{1F6E1}\\uFE0F\")} ${chalk.cyan.bold(\"SECURITY AUDIT SUMMARY\")}`);lines.push(chalk.cyan(\"\\u2550\".repeat(70)));lines.push(`  ${chalk.gray(\"Campaign:\")} ${chalk.white(results.campaign||\"Unknown\")}`);lines.push(`  ${chalk.gray(\"Start Time:\")} ${chalk.white(results.startTime||\"Unknown\")}`);if(results.endTime){lines.push(`  ${chalk.gray(\"End Time:\")} ${chalk.white(results.endTime)}`)}if(results.duration){lines.push(`  ${chalk.gray(\"Duration:\")} ${chalk.white(`${results.duration}ms`)}`)}if(results.findings&&Array.isArray(results.findings)){const counts={critical:0,high:0,medium:0,low:0,info:0};results.findings.forEach(f=>{counts[f.severity]=(counts[f.severity]||0)+1});lines.push(`  ${chalk.gray(\"Findings:\")}`);Object.entries(counts).forEach(([severity,count])=>{if(count>0){const color=severityColors[severity]||chalk.white;lines.push(`    ${color(`${severity.toUpperCase()}:`)} ${chalk.white(count)}`)}});lines.push(`    ${chalk.gray(\"Total:\")} ${chalk.white(results.findings.length)}`)}return lines.join(\"\\n\")}__name(formatSecuritySummary,\"formatSecuritySummary\");function formatSecurityStatus(status,details){const statusIcons={healthy:`${chalk.green(\"\\u25CF\")}`,degraded:`${chalk.yellow(\"\\u25CF\")}`,unavailable:`${chalk.red(\"\\u25CF\")}`};const icon=statusIcons[status]||chalk.gray(\"\\u25CF\");return`${icon} ${chalk.white(details)}`}__name(formatSecurityStatus,\"formatSecurityStatus\");function formatAuditProgress(phase,progress,total){const percentage=Math.round(progress/total*100);const filled=Math.round(percentage/10);const empty=10-filled;const progressBar=`${chalk.green(\"\\u2588\".repeat(filled))}${chalk.gray(\"\\u2591\".repeat(empty))}`;return`${chalk.gray(\"\\u23F1\")} ${chalk.cyan(\"Security Audit\")} - ${chalk.white(phase)}\n  ${progressBar} ${chalk.white(`${progress}/${total}`)} ${chalk.gray(`(${percentage}%)`)}`}__name(formatAuditProgress,\"formatAuditProgress\");function formatSecureToolsSummary(options){const lines=[];const showTitle=options?.showTitle??true;if(showTitle){lines.push(`${chalk.white(\"\\u23FA\")} ${chalk.white(\"Added new security tools and improved\")}`);lines.push(`  ${chalk.white(\"existing ones for more versatile\")}`);lines.push(`  ${chalk.white(\"operations.\")}`)}const defaultTools=[{name:\"Execute\",description:\"secure shell commands\",status:\"active\"},{name:\"Probe\",description:\"target analysis\",status:\"active\"},{name:\"State\",description:\"session management\",status:\"active\"}];const tools=options?.tools||defaultTools;const toolParts=tools.map(tool=>{const statusIcon=tool.status===\"active\"?chalk.green(\"\\u25CF\"):tool.status===\"ready\"?chalk.yellow(\"\\u25CB\"):chalk.gray(\"\\u25CB\");return`${statusIcon} ${chalk.cyan(`'${tool.name}'`)} for ${chalk.white(tool.description)}`});if(toolParts.length>0){lines.push(`  ${chalk.white(\"You now have\")} ${toolParts[0]},`);for(let i=1;i<toolParts.length-1;i++){lines.push(`  ${toolParts[i]},`)}if(toolParts.length>1){lines.push(`  ${chalk.white(\"and\")} ${toolParts[toolParts.length-1]}\\u2014`)}lines.push(`  ${chalk.white(\"each with enhanced output formatting.\")}`)}lines.push(`  ${chalk.gray(\"This expands your toolkit's capabilities\")}`);lines.push(`  ${chalk.gray(\"while maintaining strict input sanitization\")}`);lines.push(`  ${chalk.gray(\"and security.\")}`);lines.push(`  ${chalk.gray(\"(src/capabilities/maxOffensiveUkraineCapability.ts)\")}`);return lines.join(\"\\n\")}__name(formatSecureToolsSummary,\"formatSecureToolsSummary\");const severityColors={critical:__name(text=>chalk.hex(\"#FF6B6B\")(text),\"critical\"),high:__name(text=>chalk.hex(\"#FF5252\")(text),\"high\"),medium:__name(text=>chalk.hex(\"#FFD93D\")(text),\"medium\"),low:__name(text=>chalk.hex(\"#4D96FF\")(text),\"low\"),info:__name(text=>chalk.hex(\"#AAAAAA\")(text),\"info\")};const ESC={HIDE_CURSOR:\"\\x1B[?25l\",SHOW_CURSOR:\"\\x1B[?25h\",CLEAR_SCREEN:\"\\x1B[2J\",CLEAR_LINE:\"\\x1B[2K\",HOME:\"\\x1B[H\",ENABLE_BRACKETED_PASTE:\"\\x1B[?2004h\",DISABLE_BRACKETED_PASTE:\"\\x1B[?2004l\",TO:__name((row,col)=>`\\x1B[${row};${col}H`,\"TO\"),TO_COL:__name(col=>`\\x1B[${col}G`,\"TO_COL\"),ERASE_DOWN:\"\\x1B[J\",REVERSE:\"\\x1B[7m\",RESET:\"\\x1B[0m\",SET_SCROLL_REGION:__name((top,bottom)=>`\\x1B[${top};${bottom}r`,\"SET_SCROLL_REGION\"),RESET_SCROLL_REGION:\"\\x1B[r\",SAVE_CURSOR:\"\\x1B[s\",RESTORE_CURSOR:\"\\x1B[u\"};const NEWLINE_PLACEHOLDER=\"\\u21B5\";class UnifiedUIRenderer extends EventEmitter{static{__name(this,\"UnifiedUIRenderer\")}output;input;rl;plainMode;interactive;rows=24;cols=80;lastRenderWidth=null;eventQueue=[];isProcessingQueue=false;buffer=\"\";cursor=0;history=[];historyIndex=-1;suggestions=[];suggestionIndex=-1;availableCommands=[];hotkeysInToggleLine=new Set;collapsedPaste=null;mode=\"idle\";streamingInputQueue=[];streamingContentBuffer=\"\";streamingLinesWritten=0;lastToolResult=null;collapsedToolResults=[];maxCollapsedResults=50;lastToolName=\"\";streamingStartTime=null;statusMessage=null;statusOverride=null;statusStreaming=null;streamingSpinner=null;thinkingIndicator=null;contextMeter;spinnerFrame=0;spinnerInterval=null;maxInlinePanelLines=12;compactingStatusMessage=\"\";compactingStatusFrame=0;compactingStatusInterval=null;compactingSpinnerFrames=[\"\\u273B\",\"\\u273C\",\"\\u273B\",\"\\u273A\"];activityMessage=null;activityPhraseIndex=0;activityStarFrame=0;activityStarFrames=[\"\\u2733\",\"\\u2734\",\"\\u2735\",\"\\u2736\",\"\\u2737\",\"\\u2738\"];streamingTokens=0;elapsedColorFrame=0;elapsedColorFrames=[\"#F59E0B\",\"#FBBF24\",\"#FCD34D\",\"#FDE68A\",\"#FCD34D\",\"#FBBF24\"];funActivityPhrases=[\"Thinking\",\"Processing\",\"Analyzing\",\"Working\",\"Preparing\"];maxCuratedReasoningLines=8;maxCuratedReasoningChars=1800;thoughtDedupWindowMs=15e3;lastCuratedThought=null;statusMeta={};toggleState={autoContinueEnabled:false,criticalApprovalMode:\"auto\",alphaZeroEnabled:false,debugEnabled:false};rlStatus={};secureToolsStatus={toolkitReady:true,sanitizationActive:true,totalInvocations:0};clampCursor(){this.cursor=Math.max(0,Math.min(this.cursor,this.buffer.length))}appendToPasteBuffer(buffer,text){if(this.pasteBufferOverflow)return;const current=buffer===\"paste\"?this.pasteBuffer:this.plainPasteBuffer;const remaining=this.maxPasteBufferSize-current.length;if(remaining<=0){this.pasteBufferOverflow=true;return}const toAdd=text.length<=remaining?text:text.slice(0,remaining);if(buffer===\"paste\"){this.pasteBuffer+=toAdd}else{this.plainPasteBuffer+=toAdd}if(toAdd.length<text.length){this.pasteBufferOverflow=true}}sanitizePasteContent(text){if(!text)return\"\";let sanitized=text.replace(/\\x1b\\[[0-9;]*[A-Za-z~]|\\x1b\\][^\\x07]*\\x07|\\x1b[PX^_][^\\x1b]*\\x1b\\\\|\\x1b./g,\"\");sanitized=sanitized.replace(/\\[20[01]~/g,\"\");sanitized=sanitized.replace(/^\\x1b+|\\x1b+$/g,\"\");const isToggleCharacter=__name(ch=>{if(!ch||ch.length!==1)return false;const code=ch.charCodeAt(0);if(code===169||code===8482)return true;if(code===229||code===197)return true;if(code===8706||code===8710||code===206)return true;if(code===8224||code===8225)return true;if(code===8730)return true;return false},\"isToggleCharacter\");const chars=[...sanitized];let result=\"\";for(let i=0;i<chars.length;i++){const ch=chars[i];if(isToggleCharacter(ch)){continue}result+=ch}sanitized=result;sanitized=sanitized.replace(/[\\u200B-\\u200F\\u2028-\\u202F\\u2060-\\u206F\\uFEFF\\u00AD\\uFFFC]/g,\"\");sanitized=sanitized.replace(/[\\u00A0\\u2000-\\u200A\\u202F\\u205F\\u3000]/g,\" \");sanitized=sanitized.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]/g,\"\");return sanitized}formatHotkey(combo){if(!combo?.trim())return null;return combo.trim().toUpperCase()}lastPromptEvent=null;promptHeight=0;lastOverlayHeight=0;inlinePanel=[];hasConversationContent=false;isPromptActive=false;inputRenderOffset=0;plainPasteIdleMs=80;plainPasteWindowMs=120;plainPasteTriggerChars=16;plainPasteEarlyNewlineChars=1;maxPasteBufferSize=10*1024*1024;pasteBufferOverflow=false;cursorVisibleColumn=1;inBracketedPaste=false;pasteBuffer=\"\";inPlainPaste=false;plainPasteBuffer=\"\";plainPasteTimer=null;pasteBurstWindowStart=0;pasteBurstCharCount=0;plainRecentChunks=[];pendingInsertBuffer=\"\";pendingInsertTimer=null;pendingInsertDelayMs=16;emitPasteBuffer=\"\";emitPasteTimer=null;emitPasteCommitMs=30;lastRenderedEventKey=null;lastOutputEndedWithNewline=true;hasRenderedPrompt=false;hasEverRenderedOverlay=false;lastOverlay=null;allowPromptRender=true;promptRenderingSuspended=false;secretMode=false;pendingRender=false;lastRenderTime=0;renderThrottleMs=16;renderThrottleTimer=null;lastRenderedBuffer=\"\";forceNextRender=false;lastRenderedCursor=0;lastRenderedMode=\"idle\";disposed=false;initializing=true;boundResizeHandler=null;boundKeypressHandler=null;boundDataHandler=null;boundCtrlHandler=null;originalEmit=null;inputProtection=null;inputCapture=null;menuItems=[];menuIndex=0;menuTitle=null;menuCallback=null;constructor(output=process.stdout,input=process.stdin,_options){super();this.on(\"error\",err=>{console.error(\"[UnifiedUIRenderer] Error:\",err)});this.output=output;this.input=input;const outputIsTTY=Boolean(this.output?.isTTY);const inputIsTTY=Boolean(this.input?.isTTY);this.interactive=outputIsTTY&&inputIsTTY;this.plainMode=isPlainOutputMode()||!this.interactive;try{this.contextMeter=new ContextMeter}catch{this.contextMeter=new ContextMeter}try{this.rl=readline.createInterface({input:this.input,output:this.output,terminal:true,prompt:\"\",tabSize:2});this.rl.setPrompt(\"\")}catch(err){console.error(\"[UnifiedUIRenderer] Failed to create readline interface:\",err);this.rl=readline.createInterface({input:process.stdin,output:process.stdout,terminal:false});this.interactive=false;this.plainMode=true}this.updateTerminalSize();this.inputProtection=initializeInputProtection({verbose:process.env[\"AGI_DEBUG\"]===\"1\",onAttackDetected:__name((type,details)=>{if(process.env[\"AGI_DEBUG\"]){console.error(`[InputProtection] Attack detected: ${type} - ${details}`)}},\"onAttackDetected\")});this.boundResizeHandler=()=>{if(!this.plainMode&&!this.disposed){try{this.updateTerminalSize();this.renderPrompt()}catch{}}};try{this.output.on(\"resize\",this.boundResizeHandler)}catch{}this.setupInputHandlers()}initialize(){if(!this.interactive){return}this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.inBracketedPaste=false;this.pasteBuffer=\"\";this.pasteBufferOverflow=false;this.inPlainPaste=false;this.plainPasteBuffer=\"\";this.collapsedPaste=null;this.pendingInsertBuffer=\"\";this.cancelPlainPasteCapture();if(!this.plainMode){if(this.hasRenderedPrompt||this.lastOverlay){this.clearPromptArea()}this.write(ESC.ENABLE_BRACKETED_PASTE);this.updateTerminalSize();this.hasRenderedPrompt=false;this.lastOutputEndedWithNewline=true;this.write(ESC.SHOW_CURSOR);return}this.updateTerminalSize();this.hasRenderedPrompt=false;this.lastOutputEndedWithNewline=true;this.renderPrompt()}cleanup(){this.disposed=true;try{this.cancelInputCapture(new Error(\"Renderer disposed\"))}catch{}try{this.cancelPlainPasteCapture()}catch{}if(this.renderThrottleTimer){try{clearTimeout(this.renderThrottleTimer)}catch{}this.renderThrottleTimer=null}if(this.spinnerInterval){try{clearInterval(this.spinnerInterval)}catch{}this.spinnerInterval=null}if(this.streamingSpinner){try{this.streamingSpinner.stop()}catch{}this.streamingSpinner=null}if(this.thinkingIndicator){try{this.thinkingIndicator.stop()}catch{}this.thinkingIndicator=null}try{this.contextMeter.dispose()}catch{}try{disposeAnimations()}catch{}if(this.boundResizeHandler){try{this.output.removeListener(\"resize\",this.boundResizeHandler)}catch{}this.boundResizeHandler=null}if(this.boundKeypressHandler){try{this.input.removeListener(\"keypress\",this.boundKeypressHandler)}catch{}this.boundKeypressHandler=null}if(this.boundDataHandler){try{this.input.removeListener(\"data\",this.boundDataHandler)}catch{}this.boundDataHandler=null}if(this.boundCtrlHandler){try{this.input.removeListener(\"data\",this.boundCtrlHandler)}catch{}this.boundCtrlHandler=null}if(this.originalEmit){try{this.input.emit=this.originalEmit}catch{}this.originalEmit=null}try{this.removeAllListeners()}catch{}if(!this.interactive){try{this.rl.close()}catch{}return}if(!this.plainMode){try{this.clearPromptArea();this.write(ESC.DISABLE_BRACKETED_PASTE);this.write(ESC.SHOW_CURSOR);this.write(\"\\n\")}catch{}}try{if(this.input.isTTY){this.input.setRawMode(false)}}catch{}try{this.rl.close()}catch{}this.lastOverlay=null;this.eventQueue=[]}suspendPromptRendering(){this.promptRenderingSuspended=true}resumePromptRendering(render=false){this.promptRenderingSuspended=false;if(render){this.renderPrompt()}}interceptedToggle=null;interceptedCtrlC=false;interceptedCtrlD=false;pendingToggleSkips=0;setupInputHandlers(){if(!this.interactive){return}this.rl.removeAllListeners(\"line\");const self=this;this.originalEmit=this.input.emit.bind(this.input);this.input.emit=function(event,...args){if(event===\"data\"&&!self.disposed){const data=args[0];const str=Buffer.isBuffer(data)?data.toString(\"utf8\"):String(data||\"\");const code=str?str.charCodeAt(0):0;if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] EMIT INTERCEPT: event=\"${event}\" str=\"${str}\" code=${code} len=${str.length}`)}if(code===3){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] CTRL+C BLOCKED AT EMIT LEVEL`)}setImmediate(()=>self.handleCtrlC());return true}if(code===4){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] CTRL+D BLOCKED AT EMIT LEVEL`)}setImmediate(()=>self.handleCtrlD());return true}let directToggle=null;if(str.length===1){if(code===169||code===8482)directToggle=\"g\";else if(code===229||code===197)directToggle=\"a\";else if(code===8706||code===8710||code===206)directToggle=\"d\";else if(code===8224||code===8225)directToggle=\"t\";else if(code===8730)directToggle=\"v\"}if(!directToggle&&code===27&&str.length===2){const letter=str.charAt(1).toLowerCase();if([\"g\",\"a\",\"d\",\"t\",\"v\"].includes(letter)){directToggle=letter}}if(directToggle){self.handleToggle(directToggle);return true}const toggles=self.extractToggleLetters(str);if(toggles.length>0){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] TOGGLE MULTI DETECT: ${toggles.join(\",\")}`)}for(const letter of toggles){self.handleToggle(letter)}return true}const pasteStartMarker=\"\\x1B[200~\";const pasteEndMarker=\"\\x1B[201~\";const hasBracketedStart=str.includes(pasteStartMarker);const hasBracketedEnd=str.includes(pasteEndMarker);if(hasBracketedStart||hasBracketedEnd||self.inBracketedPaste){}const isPrintable=__name(c=>c>=32&&c<127||c>127,\"isPrintable\");const isNewline=__name(c=>c===10||c===13,\"isNewline\");const inPasteBurst=self.emitPasteBuffer.length>0;let shouldBuffer=false;if(str.length>1&&!str.startsWith(\"\\x1B\")){shouldBuffer=true}else if(inPasteBurst&&str.length===1&&(isPrintable(code)||isNewline(code))){shouldBuffer=true}if(shouldBuffer){const cleaned=self.stripToggleSymbols(str);if(!cleaned)return true;self.emitPasteBuffer+=cleaned;if(self.emitPasteTimer){clearTimeout(self.emitPasteTimer)}self.emitPasteTimer=setTimeout(()=>{self.commitEmitPasteBuffer()},self.emitPasteCommitMs);return true}}return self.originalEmit(event,...args)};readline.emitKeypressEvents(this.input,this.rl);if(this.input.isTTY){this.input.setRawMode(true)}this.boundKeypressHandler=(str,key)=>{if(!this.disposed){this.handleKeypress(str,key)}};this.input.on(\"keypress\",this.boundKeypressHandler)}detectToggleFromRawData(input){if(!input)return null;const code=input.charCodeAt(0);if(code===169||code===8482)return\"g\";if(code===229||code===197)return\"a\";if(code===8706||code===8710||code===206)return\"d\";if(code===8224||code===8225)return\"t\";if(code===8730)return\"v\";if(code===27&&input.length===2){const letter=input.charAt(1).toLowerCase();if([\"g\",\"a\",\"d\",\"t\",\"v\"].includes(letter))return letter}return null}extractToggleLetters(input){if(!input)return[];const toggles=[];const chars=[...input];for(let i=0;i<chars.length;i++){const ch=chars[i];const code=ch.charCodeAt(0);if(code===27&&i+1<chars.length){const letter=chars[i+1].toLowerCase();if([\"g\",\"a\",\"d\",\"t\",\"v\"].includes(letter)){toggles.push(letter);i++;continue}}const detected=this.detectToggleFromRawData(ch);if(detected){toggles.push(detected)}}return toggles}stripToggleSymbols(input){if(!input)return\"\";const chars=[...input];let result=\"\";for(let i=0;i<chars.length;i++){const ch=chars[i];const code=ch.charCodeAt(0);if(this.isToggleCharacter(ch)){continue}if(code===27){if(i+1<chars.length){const letter=chars[i+1].toLowerCase();if([\"g\",\"a\",\"d\",\"t\",\"v\"].includes(letter)){i++;continue}if(chars[i+1]===\"[\"){i++;while(i+1<chars.length&&/[0-9;]/.test(chars[i+1])){i++}if(i+1<chars.length){i++}continue}}}result+=ch}return result}isToggleCharacter(input){if(!input||input.length!==1)return false;const code=input.charCodeAt(0);if(code===169||code===8482)return true;if(code===229||code===197)return true;if(code===8706||code===8710||code===206)return true;if(code===8224||code===8225)return true;if(code===8730)return true;return false}handleToggle(letter){this.pendingInsertBuffer=\"\";this.cancelPlainPasteCapture();const forceRender=__name(()=>{if(this.mode===\"streaming\"){this.renderPromptImmediate()}else{this.renderPrompt()}},\"forceRender\");if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] TOGGLE HANDLING: ${letter}`)}switch(letter){case\"a\":this.emit(\"toggle-critical-approval\");forceRender();break;case\"g\":this.emit(\"toggle-auto-continue\");forceRender();break;case\"d\":this.emit(\"toggle-alphazero\");forceRender();break;case\"t\":this.emit(\"toggle-thinking\");forceRender();break;case\"v\":break}}handleCtrlC(){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] HANDLING CTRL+C`)}if(this.inputCapture){this.cancelInputCapture(new Error(\"Input capture cancelled\"));this.clearBuffer();return}const hadBuffer=this.buffer.length>0;if(hadBuffer){this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.resetSuggestions();this.renderPrompt();this.emitInputChange()}this.emit(\"ctrlc\",{hadBuffer})}handleCtrlD(){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] HANDLING CTRL+D`)}if(this.inputCapture){this.cancelInputCapture(new Error(\"Input capture cancelled\"));this.clearBuffer();return}if(this.buffer.length===0){this.emit(\"interrupt\")}}commitEmitPasteBuffer(){const content=this.emitPasteBuffer;this.emitPasteBuffer=\"\";this.emitPasteTimer=null;if(!content)return;if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] COMMIT EMIT BUFFER: ${content.length} chars`)}let sanitized=this.sanitizePasteContent(content);sanitized=sanitized.replace(/\\r\\n?/g,\"\\n\");if(this.inputProtection){const validation=this.inputProtection.validateInput(sanitized,true);if(validation.blocked){return}sanitized=validation.sanitized}if(!sanitized)return;const lines=sanitized.split(\"\\n\");const isMultiLine=lines.length>1;const isLongContent=sanitized.length>100;if(isMultiLine||isLongContent){if(this.collapsedPaste){sanitized=this.collapsedPaste.text+sanitized;const newLines=sanitized.split(\"\\n\");this.collapsedPaste={text:sanitized,lines:newLines.length,chars:sanitized.length}}else{this.collapsedPaste={text:sanitized,lines:lines.length,chars:sanitized.length};this.buffer=\"\";this.cursor=0}this.updateSuggestions();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}else{if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}this.insertSingleLineText(sanitized)}}handleEmitLevelPaste(content){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] EMIT PASTE HANDLING: ${content.length} chars`)}let sanitized=this.sanitizePasteContent(content);sanitized=sanitized.replace(/\\r\\n?/g,\"\\n\");if(this.inputProtection){const validation=this.inputProtection.validateInput(sanitized,true);if(validation.blocked){return}sanitized=validation.sanitized}if(!sanitized)return;const lines=sanitized.split(\"\\n\");const isMultiLine=lines.length>1;const isLongContent=sanitized.length>200;if(isMultiLine||isLongContent){if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}this.collapsedPaste={text:sanitized,lines:lines.length,chars:sanitized.length};this.buffer=\"\";this.cursor=0;this.updateSuggestions();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}else{if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}this.insertSingleLineText(sanitized)}}emitInputChange(){const payload={text:this.buffer,cursor:this.cursor};this.emit(\"change\",payload)}handleKeypress(str,key){if(this.pendingToggleSkips>0){this.pendingToggleSkips--;if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] SKIP KEYPRESS (pending toggle)`)}return}if(this.interceptedCtrlC||this.interceptedCtrlD){return}if(this.interceptedToggle){this.interceptedToggle=null;return}const code=str?str.charCodeAt(0):0;if(code===3){this.handleCtrlC();return}if(code===4){this.handleCtrlD();return}if(str&&this.isToggleCharacter(str)){this.handleToggle(this.detectToggleFromRawData(str));return}if(process.env[\"AGI_DEBUG_KEYS\"]){const keyInfo=key?`name=${key.name} ctrl=${key.ctrl} meta=${key.meta} shift=${key.shift} seq=${key.sequence?JSON.stringify(key.sequence):\"null\"}`:\"null\";console.error(`[KEY] ENTRY: str=${str?JSON.stringify(str):\"null\"} code=${code} key={${keyInfo}}`)}const normalizedKey=key??this.parseEscapeSequence(str);const keyForPaste=normalizedKey??(str?{sequence:str}:key);if(normalizedKey?.ctrl&&(normalizedKey.name===\"c\"||normalizedKey.name===\"d\")){if(this.inputCapture){this.cancelInputCapture(new Error(\"Input capture cancelled\"));this.clearBuffer();return}if(normalizedKey.name===\"c\"){const hadBuffer=this.buffer.length>0;if(hadBuffer){this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.resetSuggestions();this.renderPrompt();this.emitInputChange()}this.emit(\"ctrlc\",{hadBuffer});return}if(normalizedKey.name===\"d\"){if(this.buffer.length===0){this.emit(\"interrupt\")}return}}let toggleLetter=this.detectToggleFromRawData(str);if(!toggleLetter&&key?.sequence){toggleLetter=this.detectToggleFromRawData(key.sequence);if(toggleLetter&&process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] TOGGLE DETECTED via key.sequence: ${toggleLetter}`)}}if(toggleLetter){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] TOGGLE DETECTED (keypress fallback): ${toggleLetter}`)}this.handleToggle(toggleLetter);return}if(normalizedKey?.meta&&normalizedKey.name){const metaLetter=normalizedKey.name.toLowerCase();if([\"g\",\"a\",\"d\",\"t\",\"v\"].includes(metaLetter)){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] TOGGLE DETECTED (meta key): ${metaLetter}`)}this.handleToggle(metaLetter);return}}if(this.handleBracketedPaste(str,keyForPaste)){return}if(this.handlePlainPaste(str,keyForPaste)){return}if(!normalizedKey){return}const isCtrlShift=__name(letter=>{const lowerLetter=letter.toLowerCase();const upperLetter=letter.toUpperCase();if(normalizedKey.ctrl&&normalizedKey.shift&&normalizedKey.name?.toLowerCase()===lowerLetter){return true}if(normalizedKey.ctrl&&normalizedKey.name===upperLetter){return true}if(normalizedKey.meta&&normalizedKey.name?.toLowerCase()===lowerLetter){return true}const seq=str||normalizedKey.sequence;if(seq&&/^\\x1b\\[[0-9]+;6[~A-Z]?$/.test(seq)){return true}if(seq&&seq===`\\x1B${lowerLetter}`){return true}return false},\"isCtrlShift\");const handleCtrlShiftToggle=__name(letter=>{this.pendingInsertBuffer=\"\";if(letter===\"a\"){this.emit(\"toggle-critical-approval\")}else if(letter===\"g\"){this.emit(\"toggle-auto-continue\")}else if(letter===\"d\"){this.emit(\"toggle-alphazero\")}else if(letter===\"t\"){this.emit(\"toggle-thinking\")}if(this.mode===\"streaming\"){this.renderPromptImmediate()}else{this.renderPrompt()}},\"handleCtrlShiftToggle\");if(isCtrlShift(\"a\")){handleCtrlShiftToggle(\"a\");return}if(isCtrlShift(\"g\")){handleCtrlShiftToggle(\"g\");return}if(isCtrlShift(\"d\")){handleCtrlShiftToggle(\"d\");return}if(isCtrlShift(\"t\")){handleCtrlShiftToggle(\"t\");return}if(normalizedKey.ctrl&&normalizedKey.name?.toLowerCase()===\"r\"){this.emit(\"resume\");return}if(key.ctrl&&key.name===\"u\"){this.clearBuffer();return}if(key.ctrl&&key.name===\"l\"){if(this.collapsedPaste){this.expandCollapsedPasteToBuffer();return}this.output.write(\"\\x1B[2J\\x1B[H\");this.hasConversationContent=false;this.clearCollapsedResults();this.renderPrompt();return}if(key.ctrl&&key.name===\"o\"){this.emit(\"expand-tool-result\");return}if(key.ctrl&&key.name===\"a\"){if(this.cursor!==0){this.cursor=0;this.inputRenderOffset=0;this.renderPrompt();this.emitInputChange()}return}if(key.ctrl&&key.name===\"e\"){if(this.cursor!==this.buffer.length){this.cursor=this.buffer.length;this.ensureCursorVisible();this.renderPrompt();this.emitInputChange()}return}if(key.ctrl&&key.name===\"w\"){if(this.cursor>0){let pos=this.cursor;while(pos>0&&this.buffer[pos-1]===\" \")pos--;while(pos>0&&this.buffer[pos-1]!==\" \")pos--;this.buffer=this.buffer.slice(0,pos)+this.buffer.slice(this.cursor);this.cursor=pos;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}return}if(key.ctrl&&key.name===\"k\"){if(this.cursor<this.buffer.length){this.buffer=this.buffer.slice(0,this.cursor);this.updateSuggestions();this.renderPrompt();this.emitInputChange()}return}if(key.name===\"home\"){if(this.cursor!==0){this.cursor=0;this.inputRenderOffset=0;this.renderPrompt();this.emitInputChange()}return}if(key.name===\"end\"){if(this.cursor!==this.buffer.length){this.cursor=this.buffer.length;this.ensureCursorVisible();this.renderPrompt();this.emitInputChange()}return}if(key.meta&&key.name===\"left\"){if(this.cursor>0){let pos=this.cursor;while(pos>0&&this.buffer[pos-1]===\" \")pos--;while(pos>0&&this.buffer[pos-1]!==\" \")pos--;this.cursor=pos;this.ensureCursorVisible();this.renderPrompt();this.emitInputChange()}return}if(key.meta&&key.name===\"right\"){if(this.cursor<this.buffer.length){let pos=this.cursor;while(pos<this.buffer.length&&this.buffer[pos]!==\" \")pos++;while(pos<this.buffer.length&&this.buffer[pos]===\" \")pos++;this.cursor=pos;this.ensureCursorVisible();this.renderPrompt();this.emitInputChange()}return}if(key.meta&&key.name===\"backspace\"){if(this.collapsedPaste){this.collapsedPaste=null;this.renderPrompt();this.emitInputChange();return}if(this.cursor>0){let pos=this.cursor;while(pos>0&&this.buffer[pos-1]===\" \")pos--;while(pos>0&&this.buffer[pos-1]!==\" \")pos--;this.buffer=this.buffer.slice(0,pos)+this.buffer.slice(this.cursor);this.cursor=pos;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}return}if(key.name===\"return\"||key.name===\"enter\"){if(this.applySuggestion(true))return;if(this.buffer.startsWith(\"/\")&&this.suggestions.length>0){const safeIndex=this.suggestionIndex>=0&&this.suggestionIndex<this.suggestions.length?this.suggestionIndex:0;this.buffer=this.suggestions[safeIndex]?.command??this.buffer}if(this.mode===\"streaming\"){const queuedInput=this.streamingInputQueue.join(\"\").trim();if(queuedInput){this.emit(\"queue\",queuedInput);this.streamingInputQueue=[]}if(this.buffer.trim()){this.submitText(this.buffer)}return}if(this.collapsedPaste){this.expandCollapsedPasteToBuffer();return}this.submitText(this.buffer);return}if(normalizedKey.name===\"backspace\"){this.resetPlainPasteBurst();this.cancelPlainPasteCapture();if(this.collapsedPaste){this.collapsedPaste=null;this.forceNextRender=true;this.renderPrompt();this.emitInputChange();return}if(this.cursor>0){this.buffer=this.buffer.slice(0,this.cursor-1)+this.buffer.slice(this.cursor);this.cursor--;this.updateSuggestions();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}return}if(normalizedKey.name===\"delete\"){this.resetPlainPasteBurst();this.cancelPlainPasteCapture();if(this.collapsedPaste){this.collapsedPaste=null;this.forceNextRender=true;this.renderPrompt();this.emitInputChange();return}if(this.cursor<this.buffer.length){this.buffer=this.buffer.slice(0,this.cursor)+this.buffer.slice(this.cursor+1);this.updateSuggestions();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}return}if(this.isMenuActive()){if(normalizedKey.name===\"up\"){this.navigateMenu(-1);return}if(normalizedKey.name===\"down\"){this.navigateMenu(1);return}if(normalizedKey.name===\"return\"){this.selectMenuItem();return}if(normalizedKey.name===\"escape\"){this.closeMenu();return}if(str&&!normalizedKey.ctrl&&!normalizedKey.meta){this.closeMenu()}}if(normalizedKey.name===\"left\"){this.resetPlainPasteBurst();if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}if(this.cursor>0){this.cursor--;this.ensureCursorVisible();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}return}if(normalizedKey.name===\"right\"){this.resetPlainPasteBurst();if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}if(this.cursor<this.buffer.length){this.cursor++;this.ensureCursorVisible();this.forceNextRender=true;this.renderPrompt();this.emitInputChange()}return}if(normalizedKey.name===\"up\"){if(this.navigateSuggestions(-1)){return}if(this.history.length>0){if(this.historyIndex===-1){this.historyIndex=this.history.length-1}else if(this.historyIndex>0){this.historyIndex--}if(this.historyIndex>=0&&this.historyIndex<this.history.length){this.buffer=this.history[this.historyIndex]??\"\"}else{this.historyIndex=-1;this.buffer=\"\"}this.cursor=this.buffer.length;this.inputRenderOffset=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}return}if(normalizedKey.name===\"down\"){if(this.navigateSuggestions(1)){return}if(this.historyIndex!==-1){this.historyIndex++;if(this.historyIndex>=this.history.length){this.historyIndex=-1;this.buffer=\"\"}else if(this.historyIndex>=0){this.buffer=this.history[this.historyIndex]??\"\"}else{this.historyIndex=-1;this.buffer=\"\"}this.cursor=this.buffer.length;this.inputRenderOffset=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}return}if(normalizedKey.name===\"tab\"){if(this.applySuggestion(false))return;return}if(str&&!normalizedKey.ctrl&&!normalizedKey.meta){if(this.isToggleCharacter(str)){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] BLOCKED toggle character from insertion: \"${str}\" code=${str.charCodeAt(0)}`)}return}if(this.mode===\"streaming\"){this.streamingInputQueue.push(str);return}if(process.env[\"AGI_DEBUG_KEYS\"]){const code2=str.charCodeAt(0);console.error(`[KEY] QUEUE INSERT: str=\"${str}\" code=${code2}`)}this.queuePendingInsert(str)}}ensureCursorVisible(){const maxWidth=Math.max(10,this.safeWidth()-12);if(this.cursor<this.inputRenderOffset){this.inputRenderOffset=this.cursor;return}if(this.cursor-this.inputRenderOffset>=maxWidth){this.inputRenderOffset=this.cursor-maxWidth+1}}parseEscapeSequence(sequence){if(!sequence)return null;const map={\"\\x1B[A\":{name:\"up\",sequence},\"\\x1B[B\":{name:\"down\",sequence},\"\\x1B[C\":{name:\"right\",sequence},\"\\x1B[D\":{name:\"left\",sequence},\"\\x1B[H\":{name:\"home\",sequence},\"\\x1B[F\":{name:\"end\",sequence},\"\\x1B[200~\":{name:\"paste-start\",sequence},\"\\x1B[201~\":{name:\"paste-end\",sequence}};return map[sequence]??null}queuePendingInsert(text){const toggles=this.extractToggleLetters(text);if(toggles.length>0){for(const letter of toggles){this.handleToggle(letter)}text=this.stripToggleSymbols(text);if(!text){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(\"[KEY] QUEUE INSERT DROPPED: toggle-only input\")}return}}const now=Date.now();const burstActive=this.pasteBurstWindowStart>0&&now-this.pasteBurstWindowStart<=this.plainPasteWindowMs;if(text.length===1&&this.pendingInsertBuffer===\"\"&&!this.inPlainPaste&&!this.inBracketedPaste&&!burstActive&&text.charCodeAt(0)>=32&&text.charCodeAt(0)<127){this.insertText(text);return}this.pendingInsertBuffer+=text;if(this.pendingInsertTimer){clearTimeout(this.pendingInsertTimer);this.pendingInsertTimer=null}this.pendingInsertTimer=setTimeout(()=>{this.commitPendingInsert()},this.pendingInsertDelayMs)}commitPendingInsert(){if(this.pendingInsertTimer){clearTimeout(this.pendingInsertTimer);this.pendingInsertTimer=null}if(this.pendingInsertBuffer&&!this.inPlainPaste&&!this.inBracketedPaste){this.resetPlainPasteBurst();this.plainRecentChunks=[];this.insertText(this.pendingInsertBuffer)}this.pendingInsertBuffer=\"\"}consumePendingInsertForPaste(){if(this.pendingInsertTimer){clearTimeout(this.pendingInsertTimer);this.pendingInsertTimer=null}const consumed=this.pendingInsertBuffer;this.pendingInsertBuffer=\"\";return consumed}handleBracketedPaste(str,key){const sequence=key?.sequence||str;if(sequence===ESC.ENABLE_BRACKETED_PASTE||sequence===ESC.DISABLE_BRACKETED_PASTE){return true}const pasteStartMarker=\"\\x1B[200~\";const pasteEndMarker=\"\\x1B[201~\";if(typeof str===\"string\"&&str.includes(pasteStartMarker)){this.inBracketedPaste=true;this.pasteBufferOverflow=false;const pending=this.sanitizePasteContent(this.consumePendingInsertForPaste());const startIdx=str.indexOf(pasteStartMarker);let content=str.slice(startIdx+pasteStartMarker.length);if(content.includes(pasteEndMarker)){const endIdx=content.indexOf(pasteEndMarker);content=content.slice(0,endIdx);this.pasteBuffer=pending+content;this.commitPasteBuffer();return true}this.pasteBuffer=pending+content;this.cancelPlainPasteCapture();return true}if(sequence===pasteStartMarker){this.inBracketedPaste=true;this.pasteBufferOverflow=false;const pending=this.sanitizePasteContent(this.consumePendingInsertForPaste());this.pasteBuffer=pending;this.cancelPlainPasteCapture();return true}if(!this.inBracketedPaste){return false}if(typeof str===\"string\"&&str.includes(pasteEndMarker)){const endIdx=str.indexOf(pasteEndMarker);const contentBefore=str.slice(0,endIdx);if(contentBefore){this.appendToPasteBuffer(\"paste\",contentBefore)}this.commitPasteBuffer();return true}if(sequence===pasteEndMarker){this.commitPasteBuffer();return true}if(key?.name===\"return\"||key?.name===\"enter\"){this.appendToPasteBuffer(\"paste\",\"\\n\");return true}if(key?.name===\"backspace\"){this.pasteBuffer=this.pasteBuffer.slice(0,-1);return true}if(typeof str===\"string\"&&str.length>0){this.appendToPasteBuffer(\"paste\",str);return true}if(typeof sequence===\"string\"&&sequence.length>0){this.appendToPasteBuffer(\"paste\",sequence);return true}return true}commitPasteBuffer(){if(!this.inBracketedPaste)return;let sanitized=this.sanitizePasteContent(this.pasteBuffer);if(this.inputProtection){const validation=this.inputProtection.validateInput(sanitized,true);if(validation.blocked){this.inBracketedPaste=false;this.pasteBuffer=\"\";this.pasteBufferOverflow=false;return}sanitized=validation.sanitized}const content=sanitized.replace(/\\r\\n?/g,\"\\n\");if(content){const lines=content.split(\"\\n\");const wasTruncated=this.pasteBufferOverflow;if(lines.length>1||content.length>200){this.collapsedPaste={text:content,lines:lines.length,chars:content.length+(wasTruncated?\"+\":0)};this.buffer=\"\";this.cursor=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}else{this.insertText(content)}}this.inBracketedPaste=false;this.pasteBuffer=\"\";this.pasteBufferOverflow=false;this.cancelPlainPasteCapture()}handlePlainPaste(str,key){if(this.inBracketedPaste||key?.ctrl||key?.meta){this.resetPlainPasteBurst();this.pruneRecentPlainChunks();return false}if(typeof str===\"string\"&&str.startsWith(\"\\x1B\")){this.resetPlainPasteBurst();this.pruneRecentPlainChunks();return false}const sequence=key?.sequence??\"\";const chunk=typeof str===\"string\"&&str.length>0?str:sequence;if(!chunk){this.resetPlainPasteBurst();this.pruneRecentPlainChunks();return false}const now=Date.now();this.trackPlainPasteBurst(chunk.length,now);if(!this.inPlainPaste){this.recordRecentPlainChunk(chunk,now)}const chunkMultiple=chunk.length>1;const hasNewline=/[\\r\\n]/.test(chunk);const burstActive=this.pasteBurstWindowStart>0&&now-this.pasteBurstWindowStart<=this.plainPasteWindowMs;const burstTrigger=burstActive&&this.pasteBurstCharCount>=this.plainPasteTriggerChars;const hasRecentNonNewline=this.plainRecentChunks.some(entry=>!/^[\\r\\n]+$/.test(entry.text));const earlyNewlineTrigger=hasNewline&&burstActive&&hasRecentNonNewline&&this.pasteBurstCharCount>=this.plainPasteEarlyNewlineChars;const newlineTrigger=hasNewline&&(this.inPlainPaste||chunkMultiple||burstTrigger||earlyNewlineTrigger);const looksLikePaste=this.inPlainPaste||chunkMultiple||burstTrigger||newlineTrigger;if(!looksLikePaste){this.pruneRecentPlainChunks();return false}let chunkAlreadyCaptured=false;if(!this.inPlainPaste){this.inPlainPaste=true;this.pasteBufferOverflow=false;const pending=this.consumePendingInsertForPaste();const reclaimed=this.reclaimRecentPlainChunks();const combined=pending+reclaimed;if(combined.length>0){if(reclaimed.length>0){const removeCount=Math.min(this.buffer.length,reclaimed.length);const suffix=this.buffer.slice(-removeCount);if(removeCount>0&&suffix===reclaimed.slice(-removeCount)){this.buffer=this.buffer.slice(0,this.buffer.length-removeCount);this.cursor=Math.max(0,this.buffer.length);this.clampCursor()}}this.plainPasteBuffer=combined.slice(0,this.maxPasteBufferSize);if(combined.length>this.maxPasteBufferSize){this.pasteBufferOverflow=true}chunkAlreadyCaptured=combined.endsWith(chunk)}else{this.plainPasteBuffer=\"\"}}if(!chunkAlreadyCaptured){this.appendToPasteBuffer(\"plainPaste\",chunk)}this.schedulePlainPasteCommit();return true}trackPlainPasteBurst(length,now){if(!this.pasteBurstWindowStart||now-this.pasteBurstWindowStart>this.plainPasteWindowMs){this.pasteBurstWindowStart=now;this.pasteBurstCharCount=0}this.pasteBurstCharCount+=length}resetPlainPasteBurst(){this.pasteBurstWindowStart=0;this.pasteBurstCharCount=0}cancelPlainPasteCapture(){if(this.plainPasteTimer){clearTimeout(this.plainPasteTimer);this.plainPasteTimer=null}if(this.pendingInsertTimer){clearTimeout(this.pendingInsertTimer);this.pendingInsertTimer=null}this.pendingInsertBuffer=\"\";this.inPlainPaste=false;this.plainPasteBuffer=\"\";this.plainRecentChunks=[];this.resetPlainPasteBurst()}recordRecentPlainChunk(text,at){const windowStart=at-this.plainPasteWindowMs;this.plainRecentChunks.push({text,at});this.plainRecentChunks=this.plainRecentChunks.filter(entry=>entry.at>=windowStart)}pruneRecentPlainChunks(){if(!this.plainRecentChunks.length)return;const now=Date.now();const windowStart=now-this.plainPasteWindowMs;this.plainRecentChunks=this.plainRecentChunks.filter(entry=>entry.at>=windowStart)}reclaimRecentPlainChunks(){if(!this.plainRecentChunks.length)return\"\";const combined=this.plainRecentChunks.map(entry=>entry.text).join(\"\");this.plainRecentChunks=[];return combined}schedulePlainPasteCommit(){if(this.plainPasteTimer){clearTimeout(this.plainPasteTimer)}this.plainPasteTimer=setTimeout(()=>{this.finalizePlainPaste()},this.plainPasteIdleMs)}finalizePlainPaste(){if(!this.inPlainPaste)return;let sanitized=this.sanitizePasteContent(this.plainPasteBuffer);if(this.inputProtection){const validation=this.inputProtection.validateInput(sanitized,true);if(validation.blocked){this.inPlainPaste=false;this.plainPasteBuffer=\"\";this.plainRecentChunks=[];this.resetPlainPasteBurst();this.pasteBufferOverflow=false;return}sanitized=validation.sanitized}const content=sanitized.replace(/\\r\\n?/g,\"\\n\");const wasTruncated=this.pasteBufferOverflow;this.inPlainPaste=false;this.plainPasteBuffer=\"\";this.plainRecentChunks=[];this.resetPlainPasteBurst();this.pasteBufferOverflow=false;if(this.plainPasteTimer){clearTimeout(this.plainPasteTimer);this.plainPasteTimer=null}if(!content)return;const lines=content.split(\"\\n\");if(lines.length>1||content.length>200){this.collapsedPaste={text:content,lines:lines.length,chars:content.length+(wasTruncated?\"+\":0)};this.buffer=\"\";this.cursor=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange();return}this.insertText(content)}insertText(text){if(!text)return;const filtered=[...text].filter(c=>{const code=c.charCodeAt(0);if(code<32||code===127)return false;if(this.isToggleCharacter(c))return false;return true}).join(\"\");if(!filtered){if(process.env[\"AGI_DEBUG_KEYS\"]){console.error(`[KEY] INSERT TEXT BLOCKED: all chars filtered from \"${text}\"`)}return}text=filtered;if(process.env[\"AGI_DEBUG_KEYS\"]){const code=text.charCodeAt(0);console.error(`[KEY] INSERT TEXT: \"${text}\" code=${code}`)}if(this.inBracketedPaste||this.inPlainPaste){return}if(this.inputProtection){const validation=this.inputProtection.validateInput(text,false);if(validation.blocked){return}if(validation.sanitized!==text){text=validation.sanitized;if(!text)return}}if(this.collapsedPaste){this.expandCollapsedPasteToBuffer()}const sanitized=this.sanitizePasteContent(text);if(!sanitized)return;const hasNewlines=sanitized.includes(\"\\n\");if(hasNewlines){const collapsed=sanitized.replace(/\\r\\n|\\r|\\n/g,\" \");this.insertSingleLineText(collapsed)}else{this.insertSingleLineText(sanitized)}}insertSingleLineText(text){if(!text)return;this.clampCursor();this.buffer=this.buffer.slice(0,this.cursor)+text+this.buffer.slice(this.cursor);this.cursor+=text.length;this.clampCursor();this.updateSuggestions();const inEmitPaste=this.emitPasteBuffer.length>0||this.emitPasteTimer!==null;if(!this.inPlainPaste&&!this.inBracketedPaste&&!inEmitPaste){this.renderPrompt()}this.emitInputChange()}submitText(text){const isBufferSource=text===this.buffer;if(this.collapsedPaste){this.expandCollapsedPaste();return}this.commitPendingInsert();if(isBufferSource){text=this.buffer}if(this.inputCapture){const shouldTrim=this.inputCapture.options.trim;const normalizedCapture=shouldTrim?text.trim():text;if(!this.inputCapture.options.allowEmpty&&!normalizedCapture){this.renderPrompt();return}const resolver=this.inputCapture;this.inputCapture=null;this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.resetSuggestions();this.renderPrompt();this.emitInputChange();resolver.resolve(normalizedCapture);return}let normalized=text.trim();if(!normalized){this.renderPrompt();return}if(this.inputProtection){const validation=this.inputProtection.validatePromptSubmission(normalized);if(validation.blocked){this.buffer=\"\";this.cursor=0;this.renderPrompt();return}normalized=validation.sanitized}if(!this.secretMode&&!normalized.startsWith(\"/\")){this.history.push(normalized);this.historyIndex=-1;this.displayUserPrompt(normalized)}else if(!this.secretMode){this.history.push(normalized);this.historyIndex=-1}if(this.mode===\"streaming\"){this.emit(\"queue\",normalized)}else{this.emit(\"submit\",normalized)}this.buffer=\"\";this.cursor=0;this.resetSuggestions();this.renderPrompt();this.emitInputChange()}updateSuggestions(){if(!this.buffer.startsWith(\"/\")){this.resetSuggestions();return}const firstSpace=this.buffer.indexOf(\" \");const hasArgText=firstSpace>=0&&/\\S/.test(this.buffer.slice(firstSpace+1));if(firstSpace>=0&&this.cursor>firstSpace&&hasArgText){this.resetSuggestions();return}const cursorSlice=this.buffer.slice(0,this.cursor);const commandSlice=firstSpace>=0?cursorSlice.slice(0,firstSpace):cursorSlice;const fallbackSlice=firstSpace>=0?this.buffer.slice(0,firstSpace):this.buffer;const partial=(commandSlice.trimEnd()||fallbackSlice.trimEnd()||\"/\").toLowerCase();const previous=this.suggestions[this.suggestionIndex]?.command;this.suggestions=this.availableCommands.filter(cmd=>cmd.command.toLowerCase().startsWith(partial)).slice(0,5);if(this.suggestions.length===0){this.resetSuggestions();return}if(previous){const idx=this.suggestions.findIndex(s=>s.command===previous);this.suggestionIndex=idx>=0?idx:0}else{this.suggestionIndex=0}}setAvailableCommands(commands){this.availableCommands=commands;this.updateSuggestions()}applySuggestion(submit){if(!this.buffer.startsWith(\"/\")||this.suggestions.length===0){return false}const safeIndex=this.suggestionIndex>=0&&this.suggestionIndex<this.suggestions.length?this.suggestionIndex:0;const selected=this.suggestions[safeIndex];if(!selected){return false}if(submit){this.submitText(selected.command)}else{this.buffer=`${selected.command} `;this.cursor=this.buffer.length;this.resetSuggestions();this.renderPrompt();this.emitInputChange()}return true}resetSuggestions(){this.suggestions=[];this.suggestionIndex=-1}navigateSuggestions(direction){if(!this.buffer.startsWith(\"/\")||this.suggestions.length===0){if(this.suggestionIndex!==-1&&this.suggestions.length===0){this.suggestionIndex=-1}return false}const currentIndex=this.suggestionIndex>=0&&this.suggestionIndex<this.suggestions.length?this.suggestionIndex:-1;const next=currentIndex+direction;const clamped=Math.max(0,Math.min(this.suggestions.length-1,next));if(clamped===this.suggestionIndex&&this.suggestionIndex>=0){return true}this.suggestionIndex=clamped;this.renderPrompt();return true}lastAddedEventSignature=\"\";addEvent(type,content){if(!content)return;const normalized=this.normalizeEventType(type);if(!normalized)return;if(normalized!==\"prompt\"){const signature=`${normalized}:${content}`;if(signature===this.lastAddedEventSignature){return}this.lastAddedEventSignature=signature}if(normalized===\"prompt\"||normalized===\"response\"||normalized===\"thought\"||normalized===\"stream\"||normalized===\"tool\"||normalized===\"tool-result\"||normalized===\"build\"||normalized===\"test\"){this.hasConversationContent=true}if(normalized===\"tool-result\"){this.lastToolResult=content}if(this.plainMode){const formatted=this.formatContent({type:normalized,rawType:type,content,timestamp:Date.now()});if(formatted){const text=formatted.endsWith(\"\\n\")?formatted:`${formatted}\n`;this.output.write(text);this.lastOutputEndedWithNewline=text.endsWith(\"\\n\")}return}const event={type:normalized,rawType:type,content,timestamp:Date.now()};if(normalized===\"prompt\"){const insertIndex=this.eventQueue.findIndex(e=>e.type!==\"prompt\");if(insertIndex===-1){this.eventQueue.push(event)}else{this.eventQueue.splice(insertIndex,0,event)}}else{this.eventQueue.push(event)}if(!this.isProcessingQueue){queueMicrotask(()=>{if(!this.isProcessingQueue){void this.processQueue()}})}}renderPromptOverlay(immediate=false){if(this.plainMode||this.disposed||!this.output.isTTY||this.promptRenderingSuspended){return}this.allowPromptRender=true;if(immediate){this.renderPromptImmediate();return}this.renderPrompt()}async processQueue(){if(this.isProcessingQueue||this.disposed)return;this.isProcessingQueue=true;try{while(this.eventQueue.length>0&&!this.disposed){const event=this.eventQueue.shift();if(!event)continue;const coalesced=this.coalesceAdjacentTextEvents(event);try{await this.renderEvent(coalesced)}catch(error){if(this.disposed)break;const message=error instanceof Error?error.message:typeof error===\"string\"?error:\"Unknown renderer error\";this.output.write(`\n[renderer] ${message}\n`)}if(this.disposed)break;if(event.type===\"prompt\"){if(this.output.isTTY){this.allowPromptRender=true}}else{await this.delay(1)}}if(this.output.isTTY&&!this.disposed){this.allowPromptRender=true;this.renderPrompt()}}finally{this.isProcessingQueue=false}}coalesceAdjacentTextEvents(event){const isMergeable=__name(target=>Boolean(target&&!target.isCompacted&&(target.type===\"response\"&&target.rawType===\"response\"||target.type===\"thought\"&&target.rawType===\"thought\")),\"isMergeable\");if(!isMergeable(event)){return event}while(this.eventQueue.length>0&&isMergeable(this.eventQueue[0])){const next=this.eventQueue.shift();const needsSeparator=event.content.length>0&&!event.content.endsWith(\"\\n\")&&!next.content.startsWith(\"\\n\");event.content=needsSeparator?`${event.content}\n${next.content}`:`${event.content}${next.content}`}return event}async flushEvents(timeoutMs=250){if(!this.plainMode&&!this.isProcessingQueue&&this.eventQueue.length>0){void this.processQueue()}const start=Date.now();while((this.isProcessingQueue||this.eventQueue.length>0)&&Date.now()-start<timeoutMs){await this.delay(5)}if(!this.plainMode&&this.output.isTTY){this.allowPromptRender=true;this.renderPrompt()}}async renderEvent(event){if(event.rawType===\"banner\"&&this.initializing){this.initializing=false}if(this.plainMode){const formattedPlain=this.formatContent(event);if(formattedPlain){const text=formattedPlain.endsWith(\"\\n\")?formattedPlain:`${formattedPlain}\n`;this.output.write(text);this.lastOutputEndedWithNewline=text.endsWith(\"\\n\")}return}const formatted=this.formatContent(event);if(!formatted)return;const signature=`${event.rawType}:${event.content}`;if((event.type===\"stream\"||event.type===\"response\")&&signature===this.lastRenderedEventKey){return}if(event.type!==\"prompt\"){this.lastRenderedEventKey=signature}if(this.promptHeight>0||this.lastOverlay){this.clearPromptArea()}this.isPromptActive=false;if(event.type!==\"stream\"&&!this.lastOutputEndedWithNewline&&formatted.trim()){this.output.write(\"\\n\");this.lastOutputEndedWithNewline=true}this.output.write(formatted);this.lastOutputEndedWithNewline=formatted.endsWith(\"\\n\");if(this.output.isTTY&&this.interactive&&!this.disposed){this.renderPromptOverlay(true)}}normalizeEventType(type){switch(type){case\"prompt\":return\"prompt\";case\"thought\":return\"thought\";case\"stream\":case\"streaming\":return\"stream\";case\"tool\":case\"tool-call\":return\"tool\";case\"tool-result\":return\"tool-result\";case\"build\":return\"build\";case\"test\":return\"test\";case\"response\":case\"banner\":case\"raw\":return\"response\";case\"error\":return\"response\";default:return null}}formatContent(event){if(event.isCompacted){return event.content}if(event.rawType===\"banner\"){const lines=event.content.split(\"\\n\").map(line=>line.trimEnd());return`${lines.join(\"\\n\")}\n`}switch(event.type){case\"prompt\":return`${theme.primary(\">\")} ${event.content}\n`;case\"thought\":{if(this.isGarbageOutput(event.content)){return\"\"}const curated=this.curateReasoningContent(event.content);if(!curated||this.isGarbageOutput(curated)){return\"\"}if(!this.shouldRenderThought(curated)){return\"\"}this.lastCuratedThought={text:curated.replace(/\\s+/g,\" \").trim().toLowerCase(),at:Date.now()};return this.formatThinkingBlock(curated)}case\"tool\":{const content=event.content.replace(/^[]\\s*/,\"\");return this.formatToolCall(content)}case\"tool-result\":{return this.formatCompactToolResult(event.content)}case\"build\":return this.wrapBulletText(event.content,{label:\"build\",labelColor:theme.warning});case\"test\":return this.wrapBulletText(event.content,{label:\"test\",labelColor:theme.info});case\"stream\":{if(!event.content){return\"\"}this.streamingContentBuffer+=event.content;const newlines=(event.content.match(/\\n/g)||[]).length;this.streamingLinesWritten+=newlines;return event.content}case\"response\":default:{if(this.isGarbageOutput(event.content)){return\"\"}const isError=event.rawType===\"error\";if(isError){return this.wrapBulletText(event.content,{label:\"error\",labelColor:theme.error,thoughtType:\"danger\"})}else{return this.formatAssistantResponse(event.content)}}}}isGarbageOutput(content){if(!content||content.trim().length===0)return true;const trimmed=content.trim();if(trimmed.length<=3){if(/^[.,:;!?*#\\-_=+|\\\\/<>(){}[\\]`'\"~^@&%$]+$/.test(trimmed)){return true}}const lines=content.split(\"\\n\");const punctOnlyLines=lines.filter(line=>{const lineTrimmed=line.trim();return lineTrimmed.length>0&&/^[.,:;!?*#\\-_=+|\\\\/<>(){}[\\]`'\"~^@&%$\\s]+$/.test(lineTrimmed)});const nonEmptyLines=lines.filter(l=>l.trim().length>0);if(nonEmptyLines.length>0&&punctOnlyLines.length===nonEmptyLines.length){return true}if(content.startsWith(\"<\")&&!content.startsWith(\"<http\")&&!content.startsWith(\"<!\")){return true}if(content.includes(\"to=functions.\")||content.includes(\"to=tools.\")){return true}if(content.startsWith('\"')&&content.includes(\"block\")&&content.includes(\"tool\")){return true}if(content.length<30&&/elapsed|seconds?|ms\\b/i.test(content)){return true}const meaningfulLines=lines.filter(line=>{const lineTrimmed=line.trim();if(!lineTrimmed)return false;const alphaNum=(lineTrimmed.match(/[a-zA-Z0-9]/g)||[]).length;return lineTrimmed.length>0&&alphaNum/lineTrimmed.length>=.3});if(lines.length>3&&meaningfulLines.length/lines.length<.3){return true}const alphaCount=(content.match(/[a-zA-Z]/g)||[]).length;const totalCount=content.replace(/\\s/g,\"\").length;if(totalCount>20&&alphaCount/totalCount<.4){return true}return false}sanitizeToolResultContent(content){if(!content)return\"\";const lines=content.split(\"\\n\");const cleanLines=[];for(const line of lines){const trimmed=line.trim();if(cleanLines.length===0&&!trimmed)continue;if(/^[)\\]}>*`'\"]+$/.test(trimmed))continue;if(/^[*_]{2,}$/.test(trimmed))continue;if(/^[|]+$/.test(trimmed))continue;if(/^[]+$/.test(trimmed))continue;if(/^\\.{2,}$/.test(trimmed))continue;if(/^[\\s]+$/.test(trimmed))continue;if(/^[:\\s]+$/.test(trimmed))continue;if(/^[,\\s]+$/.test(trimmed))continue;if(/^\\*{1,2}[^*]*\\*{0,2}$/.test(trimmed)&&trimmed.length<10&&!/\\w{3,}/.test(trimmed))continue;const alphaInLine=(trimmed.match(/[a-zA-Z0-9]/g)||[]).length;if(trimmed.length>0&&trimmed.length<20&&alphaInLine/trimmed.length<.3)continue;if(trimmed.length<=2&&!/^\\d+$/.test(trimmed)&&!/^[a-zA-Z]{2}$/.test(trimmed)){if(!/^(?:ok|no|yes|\\d+)$/i.test(trimmed))continue}if(/^[()[\\]{}]+$/.test(trimmed))continue;if(/^```\\s*$/.test(trimmed))continue;cleanLines.push(line)}while(cleanLines.length>0&&!cleanLines[cleanLines.length-1]?.trim()){cleanLines.pop()}return cleanLines.join(\"\\n\").trim()}curateReasoningContent(content){const normalized=content.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\").trim();if(!normalized)return null;const limited=normalized.length>this.maxCuratedReasoningChars?normalized.slice(0,this.maxCuratedReasoningChars):normalized;const maxSegments=this.maxCuratedReasoningLines*3;const segments=limited.split(\"\\n\").flatMap(line=>line.split(/(?<=[.?!])\\s+/)).map(line=>line.replace(/^[*\\-\\u2022]+\\s*/,\"\").trim()).filter(Boolean);if(segments.length===0){return null}const seen=new Set;const deduped=[];for(const segment of segments){const normalizedSegment=segment.replace(/\\s+/g,\" \");const key=normalizedSegment.toLowerCase();if(seen.has(key)){continue}seen.add(key);deduped.push(normalizedSegment);if(deduped.length>=maxSegments){break}}if(deduped.length===0){return null}const prioritized=this.prioritizeReasoningSegments(deduped);if(prioritized.length===0){return null}const limitedSelection=prioritized.slice(0,this.maxCuratedReasoningLines);const bulleted=limitedSelection.map(line=>this.ensureReasoningBullet(line));return bulleted.join(\"\\n\")}ensureReasoningBullet(line){if(/^([*-]|\\d+[.)])\\s/.test(line)){return line}return`\\u2022 ${line}`}looksStructuredThought(line){return/^(\\d+[.)]\\s|step\\s*\\d+|plan\\b|next\\b|then\\b|goal\\b)/i.test(line)||/^[-*]\\s/.test(line)||line.includes(\"->\")||line.includes(\"\\u2192\")||line.includes(\": \")||/\\b(test|verify|validate|check|build|run|deploy|diff|lint|type ?check|fix|bug|issue|risk|mitigate|investigate)\\b/i.test(line)}prioritizeReasoningSegments(segments){if(!segments.length){return[]}const scored=segments.map((text,index)=>({text,index,score:this.reasoningSignalScore(text)}));const hasSignal=scored.some(item=>item.score>0);if(!hasSignal){return segments}scored.sort((a,b)=>{if(b.score!==a.score)return b.score-a.score;return a.index-b.index});return scored.map(item=>item.text)}reasoningSignalScore(line){let score=0;const lower=line.toLowerCase();if(this.looksStructuredThought(line)){score+=3}const actionKeywords=[\"tool\",\"command\",\"script\",\"context\",\"summar\",\"risk\",\"issue\",\"investigate\",\"root cause\",\"remediat\",\"mitigat\",\"fix\",\"patch\",\"test\",\"verify\",\"validate\",\"check\",\"build\",\"deploy\",\"run\",\"diff\",\"lint\",\"typecheck\",\"benchmark\"];if(actionKeywords.some(keyword=>lower.includes(keyword))){score+=2}if(/[#:]|->/.test(line)){score+=1}if(/^(i('| a)m|i will|let me|starting|now|ok|sure)\\b/i.test(line)){score-=1}if(line.length>120){score-=1}return score}shouldRenderThought(content){const normalized=content.replace(/\\s+/g,\" \").trim();if(!normalized){return false}const now=Date.now();const normalizedLower=normalized.toLowerCase();if(this.lastCuratedThought&&this.lastCuratedThought.text===normalizedLower){if(now-this.lastCuratedThought.at<this.thoughtDedupWindowMs){return false}}if(this.lastCuratedThought){const previous=this.lastCuratedThought.text;const current=normalizedLower;const wordsPrevious=previous.split(/\\s+/).filter(w=>w.length>3);const wordsCurrent=current.split(/\\s+/).filter(w=>w.length>3);if(wordsPrevious.length>0&&wordsCurrent.length>0){const sharedWords=wordsCurrent.filter(word=>wordsPrevious.includes(word));const similarity=sharedWords.length/Math.max(wordsPrevious.length,wordsCurrent.length);if(similarity>.7&&now-this.lastCuratedThought.at<this.thoughtDedupWindowMs){return false}}}const wordCount=normalizedLower.split(/\\s+/).filter(w=>w.length>2).length;if(wordCount<3&&normalizedLower.length<30){return false}const meaninglessPatterns=[/^i(?:'?ll?)?\\s+(?:will\\s+)?(?:now\\s+)?(?:proceed|continue|go|move|start)/i,/^(?:let me|i will|i'll|i am|i'm)\\s+(?:check|look|see|examine|review|analyze)/i,/^proceeding\\s+(?:with|to)/i,/^continuing\\s+(?:with|to)/i,/^moving\\s+(?:on|forward|to)/i,/^starting\\s+(?:with|to)/i,/^now\\s+(?:i|let me|we|let's)/i,/^(?:ok|alright|well)\\s*,?\\s*(?:now|then|so|let)/i];for(const pattern of meaninglessPatterns){if(pattern.test(normalized)){return false}}return true}formatClaudeCodeBlock(content){const bullet=\"\\u23FA\";const maxWidth=Math.max(24,Math.min(this.safeWidth()-4,110));const lines=content.split(\"\\n\");const result=[];for(let lineIdx=0;lineIdx<lines.length;lineIdx++){const line=lines[lineIdx];if(!line.trim()){result.push(\"\");continue}const words=line.split(/(\\s+)/);let currentLine=\"\";for(const word of words){if((currentLine+word).length>maxWidth&&currentLine.trim()){const prefix=result.length===0&&lineIdx===0?`${bullet} `:\"  \";result.push(`${prefix}${currentLine.trimEnd()}`);currentLine=word.trimStart()}else{currentLine+=word}}if(currentLine.trim()){const prefix=result.length===0&&lineIdx===0?`${bullet} `:\"  \";result.push(`${prefix}${currentLine.trimEnd()}`)}}return result.join(\"\\n\")+\"\\n\"}formatToolCall(content){const bullet=\"\\u23FA\";const match=content.match(/^(\\w+)\\((.*)\\)$/s);if(!match){const nameMatch=content.match(/^(\\w+)/);if(nameMatch){return`${bullet} ${theme.toolColors.default(`[${nameMatch[1]}]`)}\n`}return`${bullet} ${content}\n`}const toolName=match[1];const argsStr=match[2];const maxWidth=Math.min(this.cols-4,56);const prefix=`${bullet} ${theme.toolColors.default(`[${toolName}]`)} `;const prefixLen=toolName.length+5;const indent=\" \".repeat(prefixLen+4);const args=this.parseToolArgs(argsStr);if(args.length===0){return`${prefix.trimEnd()}\n`}const lines=[];let currentLine=prefix;for(let i=0;i<args.length;i++){const arg=args[i];const argText=`${theme.ui.muted(arg.key+\":\")} ${this.formatArgValue(arg.key,arg.value)}`;const separator=i<args.length-1?\", \":\"\";const testLine=currentLine+argText+separator;if(this.stripAnsi(testLine).length>maxWidth&&currentLine!==prefix){lines.push(currentLine.trimEnd());currentLine=indent+argText+separator}else{currentLine+=argText+separator}}if(currentLine.trim()){lines.push(currentLine.trimEnd())}return lines.join(\"\\n\")+\"\\n\"}parseToolArgs(argsStr){const args=[];const regex=/(\\w+):\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|[^,)]+)/g;let match;while((match=regex.exec(argsStr))!==null){args.push({key:match[1],value:match[2].trim()})}return args}formatArgValue(key,value){const isQuoted=value.startsWith('\"')&&value.endsWith('\"');const inner=isQuoted?value.slice(1,-1):value;const lowerKey=key.toLowerCase();const shouldPreserve=lowerKey.includes(\"path\")||lowerKey===\"file\"||lowerKey===\"pattern\"||lowerKey===\"query\"||lowerKey===\"command\"||lowerKey===\"cmd\";const maxLen=40;const truncated=shouldPreserve||inner.length<=maxLen?inner:inner.slice(0,maxLen-3)+\"...\";return isQuoted?`\"${truncated}\"`:truncated}formatToolResult(content){const summaryMatch=content.match(/^(Found \\d+ (?:lines?|files?|matches?)|Read \\d+ lines?|Wrote \\d+ lines?|Edited|Created|Deleted)/i);if(summaryMatch){return`  ${theme.ui.muted(\"\\u23BF\")}  ${content} ${theme.ui.muted(\"(ctrl+o to expand)\")}\n`}const lines=content.split(\"\\n\");if(lines.length>3){const preview=lines.slice(0,2).join(\"\\n\");return`  ${theme.ui.muted(\"\\u23BF\")}  ${preview}\n  ${theme.ui.muted(`... ${lines.length-2} more lines (ctrl+o to expand)`)}\n`}return`  ${theme.ui.muted(\"\\u23BF\")}  ${content}\n`}formatCompactToolCall(content){const bullet=\"\\u23FA\";const match=content.match(/^(\\w+)\\s*(?:\\((.*)\\))?$/s);if(!match){return`${bullet} ${content}\n`}const toolName=match[1];const argsStr=match[2]?.trim()||\"\";this.lastToolName=toolName;const toolColor=getToolColor(toolName);const coloredToolName=toolColor(`[${toolName}]`);if(!argsStr){return`${bullet} ${coloredToolName}\n`}const maxWidth=this.cols-8;const params=this.parseToolParams(argsStr);if(params.length===0){return`${bullet} ${coloredToolName} ${argsStr}\n`}return this.formatToolParamsColored(toolName,params,maxWidth,toolColor)}parseToolParams(argsStr){const params=[];const regex=/(\\w+):\\s*(\"(?:[^\"\\\\]|\\\\.)*\"|[^,\\n]+)/g;let match;while((match=regex.exec(argsStr))!==null){params.push({key:match[1],value:match[2].trim()})}return params}formatToolParams(toolName,params,maxWidth){return this.formatToolParamsColored(toolName,params,maxWidth,theme.toolColors.default)}formatToolParamsColored(toolName,params,maxWidth,toolColor){const bullet=\"\\u23FA\";const lines=[];const indent=\"        \";let currentLine=`${bullet} ${toolColor(`[${toolName}]`)} `;let firstParam=true;for(const param of params){const coloredValue=this.colorParamValue(param.key,param.value);const paramText=`${param.key}: ${coloredValue}`;const paramStr=firstParam?paramText:`, ${paramText}`;const testLine=currentLine+paramStr;const plainLength=this.visibleLength(testLine);if(plainLength>maxWidth&&!firstParam){lines.push(currentLine);currentLine=indent+paramText}else{currentLine+=paramStr}firstParam=false}lines.push(currentLine);return lines.join(\"\\n\")+\"\\n\"}colorParamValue(key,value){const lowerKey=key.toLowerCase();if(lowerKey.includes(\"path\")||lowerKey===\"file\"||lowerKey===\"pattern\"||lowerKey===\"query\"){return theme.warning(value)}if(lowerKey===\"command\"||lowerKey===\"cmd\"){return theme.toolColors.default(value)}return value}extractToolSummary(toolName,argsStr){const tool=toolName.toLowerCase();if([\"read\",\"write\",\"edit\",\"glob\",\"grep\",\"search\"].includes(tool)){const pathMatch=argsStr.match(/(?:path|file_path|pattern):\\s*\"([^\"]+)\"/);if(pathMatch){const path=pathMatch[1];return theme.file?.path?theme.file.path(path):theme.ui.muted(path)}}if(tool===\"bash\"){const cmdMatch=argsStr.match(/command:\\s*\"([^\"]+)\"/);if(cmdMatch){const cmd=cmdMatch[1];return theme.ui.muted(cmd)}}return null}formatCompactToolResult(content){const sanitized=this.sanitizeToolResultContent(content);if(!sanitized||this.isGarbageOutput(sanitized)){return\"\"}if(this.lastToolName?.toLowerCase()===\"edit\"){return this.formatEditResultWithDiff(sanitized)}const lineMatch=sanitized.match(/(\\d+)\\s*lines?/i);const fileMatch=sanitized.match(/(\\d+)\\s*(?:files?|matches?)/i);const readMatch=sanitized.match(/read.*?(\\d+)\\s*lines?/i);const hasPath=/(?:^|\\s)(?:\\/[\\w./-]+|[\\w./-]+\\/[\\w./-]+)/.test(sanitized);const hasCommand=/^\\s*\\$\\s+.+|command:/i.test(sanitized);const isPathOrDir=/^(?:File|Directory|Path):\\s*/i.test(sanitized);let summary;let preserveFull=false;if(readMatch){summary=`Read ${readMatch[1]} lines`}else if(lineMatch){summary=`Found ${lineMatch[1]} line${lineMatch[1]===\"1\"?\"\":\"s\"}`}else if(fileMatch){summary=`Found ${fileMatch[1]} file${fileMatch[1]===\"1\"?\"\":\"s\"}`}else if(sanitized.match(/^(success|ok|done|completed|written|edited|created)/i)){summary=\"\\u2713\"}else if(isPathOrDir||hasPath||hasCommand){const firstLine=sanitized.split(\"\\n\")[0]||sanitized;summary=firstLine;preserveFull=true}else{let summaryText=sanitized;const summaryMatch=sanitized.match(/^Summary:\\s*(.+)/i);if(summaryMatch){summaryText=summaryMatch[1]}const firstLine=summaryText.split(\"\\n\")[0]?.trim()||summaryText;const maxLen=120;if(firstLine.length>maxLen){const sentenceEnd=firstLine.slice(0,maxLen).search(/[.!?;]\\s|[.!?;]$/);if(sentenceEnd>30){summary=firstLine.slice(0,sentenceEnd+1)}else{const truncated=firstLine.slice(0,maxLen);const lastSpace=truncated.lastIndexOf(\" \");summary=lastSpace>60?truncated.slice(0,lastSpace)+\"\\u2026\":truncated+\"\\u2026\"}}else{summary=firstLine}}this.collapsedToolResults.push({toolName:this.lastToolName||\"tool\",content:sanitized,summary,timestamp:Date.now()});if(this.collapsedToolResults.length>this.maxCollapsedResults){this.collapsedToolResults.shift()}const coloredSummary=this.colorResultSummary(summary);const hasMoreContent=sanitized.includes(\"\\n\")||summary.endsWith(\"\\u2026\")||!preserveFull&&sanitized.length>summary.length;const expandHint=hasMoreContent?` ${theme.ui.muted(\"(ctrl+o to expand)\")}`:\"\";return`  ${theme.ui.muted(\"\\u23BF\")}  ${coloredSummary}${expandHint}\n`}colorResultSummary(summary){if(!summary)return summary;const lower=summary.toLowerCase();if(lower.includes(\"fail\")||lower.includes(\"error\")){return theme.error(summary)}if(summary.startsWith(\"\\u2713\")||lower.includes(\"updated\")||lower.includes(\"created\")||lower.includes(\"written\")){return theme.success(summary)}return theme.info(summary)}formatEditResultWithDiff(content){const lines=[];const indent=\"  \";const filePathMatch=content.match(/(?:file[_\\s]*path|path):\\s*\"([^\"]+)\"/i)||content.match(/updated.*?([\\/\\w.\\-]+\\.\\w+)/i)||content.match(/edited.*?([\\/\\w.\\-]+\\.\\w+)/i);const fileName=filePathMatch?filePathMatch[1].split(\"/\").pop():\"file\";const fullPath=filePathMatch?filePathMatch[1]:fileName;const oldMatch=content.match(/old[_\\s]*string[:\\s]*([\"'`])([^\\x01]+?)\\1/i)||content.match(/old[_\\s]*string[:\\s]*[\"']?([^\"'\\n]+)[\"']?/i);const newMatch=content.match(/new[_\\s]*string[:\\s]*([\"'`])([^\\x01]+?)\\1/i)||content.match(/new[_\\s]*string[:\\s]*[\"']?([^\"'\\n]+)[\"']?/i);const oldContent=oldMatch?.[2]||oldMatch?.[1]||\"\";const newContent=newMatch?.[2]||newMatch?.[1]||\"\";const oldLen=oldContent.length;const newLen=newContent.length;const diffStat=oldLen||newLen?theme.ui.muted(` (${theme.error(`-${oldLen}`)} ${theme.success(`+${newLen}`)} chars)`):\"\";lines.push(`${indent}${theme.ui.muted(\"\\u23BF\")}  ${theme.success(\"\\u2713\")} ${theme.success(`Updated`)} ${theme.file?.path?theme.file.path(`${fullPath}`):theme.warning(`${fullPath}`)}${diffStat}`);if(oldContent||newContent){const maxDiffLen=Math.min(this.safeWidth()-20,80);lines.push(`${indent}${theme.ui.muted(\"\\u251C\\u2500\\u2510\")}`);if(oldContent){const oldPreview=oldContent.length>maxDiffLen?oldContent.slice(0,maxDiffLen)+\"\\u2026\":oldContent;const cleanOld=oldPreview.replace(/\\\\\"/g,'\"').replace(/\\\\n/g,\"\\u21B2\");lines.push(`${indent}${theme.ui.muted(\"\\u2502\")} ${theme.error(\"\\u2500 \"+cleanOld)}`)}if(newContent){const newPreview=newContent.length>maxDiffLen?newContent.slice(0,maxDiffLen)+\"\\u2026\":newContent;const cleanNew=newPreview.replace(/\\\\\"/g,'\"').replace(/\\\\n/g,\"\\u21B2\");lines.push(`${indent}${theme.ui.muted(\"\\u2502\")} ${theme.success(\"+ \"+cleanNew)}`)}lines.push(`${indent}${theme.ui.muted(\"\\u2514\\u2500\")}`)}this.collapsedToolResults.push({toolName:\"edit\",content,summary:`Updated ${fileName} (-${oldLen}, +${newLen})`,timestamp:Date.now(),metadata:{filePath:fullPath,oldLength:oldLen,newLength:newLen,diff:{old:oldContent,new:newContent}}});if(this.collapsedToolResults.length>this.maxCollapsedResults){this.collapsedToolResults.shift()}const expandHint=content.length>100||oldLen>50||newLen>50?` ${theme.ui.muted(\"(ctrl+o to expand)\")}`:\"\";return lines.join(\"\\n\")+expandHint+\"\\n\"}formatCompactResponse(content){return this.wrapBulletText(content)}wrapBulletText(content,options={}){const bullet=\"\\u23FA\";let cleaned=content.replace(/^[]\\s*/,\"\").trimEnd();if(!cleaned.trim()){return\"\"}cleaned=cleaned.replace(/^(#{1,6})([A-Z])/gm,\"$1 $2\");cleaned=cleaned.replace(/^(#{1,6})(\\d+)\\s+/gm,\"$1 $2. \");cleaned=cleaned.replace(/^-([A-Z])/gm,\"- $1\");cleaned=cleaned.replace(/^(\\d+\\.)([A-Z])/gm,\"$1 $2\");cleaned=cleaned.replace(/([.!?)])(\\s*)(#{1,6}\\s)/g,\"$1\\n\\n$3\");cleaned=cleaned.replace(/([a-z])(\\s*)(#{2,6}\\s)/gi,\"$1\\n\\n$3\");cleaned=cleaned.replace(/([\\u2705\\u274C\\u2714\\u2718\\u26A0\\uD83C-\\uDBFF\\uDC00-\\uDFFF]+)\\s*(#{1,6})/g,\"$1\\n\\n$2\");cleaned=cleaned.replace(/(bash|sh|python|javascript|typescript)#/gi,\"$1\\n```\\n#\");cleaned=cleaned.replace(/([^\\n])```(\\w+)?/g,\"$1\\n```$2\");cleaned=cleaned.replace(/(\\w+)\\s+([-]{3,})\\s+(\\w+)/g,\"$1\\n$2\\n$3\");const availableWidth=this.safeWidth();const maxWidth=Math.max(20,Math.min(options.maxWidth??availableWidth-2,availableWidth));const labelText=options.label?`${options.labelColor?options.labelColor(options.label):options.label}${theme.ui.muted(\" \\xB7 \")}`:\"\";const bulletPrefix=`${bullet} ${labelText}`;const indent=\" \".repeat(this.visibleLength(`${bullet} `));const lines=cleaned.split(\"\\n\");const result=[];let firstNonEmpty=true;let inCodeBlock=false;let codeBlockLang=\"\";const codeBlockBuffer=[];for(const rawLine of lines){const trimmedLine=rawLine.trim();if(trimmedLine.startsWith(\"```\")){if(!inCodeBlock){inCodeBlock=true;codeBlockLang=trimmedLine.slice(3).trim().toUpperCase()||\"CODE\";continue}else{inCodeBlock=false;const codeIndent=firstNonEmpty?bulletPrefix:indent;if(firstNonEmpty){result.push(`${bulletPrefix}${theme.ui.muted(`\\u2500\\u2500\\u2500 ${codeBlockLang} \\u2500\\u2500\\u2500`)}`);firstNonEmpty=false}else{result.push(`${indent}${theme.ui.muted(`\\u2500\\u2500\\u2500 ${codeBlockLang} \\u2500\\u2500\\u2500`)}`)}for(const codeLine of codeBlockBuffer){result.push(`${indent}${theme.ui.muted(\"\\u2502\")} ${theme.ui.code(codeLine)}`)}codeBlockBuffer.length=0;codeBlockLang=\"\";continue}}if(inCodeBlock){codeBlockBuffer.push(rawLine);continue}if(!trimmedLine){result.push(\"\");continue}const headerMatch=trimmedLine.match(/^(#{1,6})\\s*(.+)$/);if(headerMatch&&headerMatch[2]&&!headerMatch[2].startsWith(\"#\")){const level=headerMatch[1]?.length??1;const headerText=headerMatch[2]?.trim()??\"\";if(headerText.length>0){if(result.length>0&&result[result.length-1]!==\"\"){result.push(\"\")}const formattedHeader=this.formatMarkdownHeader(headerText,level,maxWidth,firstNonEmpty?bulletPrefix:indent);result.push(formattedHeader);firstNonEmpty=false;continue}}if(/^[-*_]{3,}$/.test(trimmedLine)){const dividerWidth=Math.min(maxWidth-indent.length,50);result.push(`${indent}${theme.ui.muted(\"\\u2500\".repeat(dividerWidth))}`);continue}if(trimmedLine.startsWith(\"|\")||/^[-|:]+$/.test(trimmedLine)){const tablePrefix=firstNonEmpty?bulletPrefix:indent;result.push(`${tablePrefix}${theme.ui.muted(trimmedLine)}`);firstNonEmpty=false;continue}const listMatch=trimmedLine.match(/^(\\*|-||\\d+\\.)\\s*(.+)$/);if(listMatch&&listMatch[2]){const listContent=listMatch[2].trim();const formattedList=formatInlineText(listContent);const listBullet=theme.secondary(\"  \\u2022 \");const listIndent=\"    \";if(firstNonEmpty){result.push(bulletPrefix.trimEnd());firstNonEmpty=false}const words2=formattedList.split(/\\s+/);let current2=\"\";let isFirstListLine=true;for(const word of words2){const candidate=current2?`${current2} ${word}`:word;const prefixLen=this.visibleLength(isFirstListLine?listBullet:listIndent);if(prefixLen+this.visibleLength(candidate)>maxWidth-2&&current2){result.push(`${isFirstListLine?listBullet:listIndent}${current2}`);current2=word;isFirstListLine=false}else{current2=candidate}}if(current2){result.push(`${isFirstListLine?listBullet:listIndent}${current2}`)}continue}const formattedLine=formatInlineText(trimmedLine);const words=formattedLine.split(/\\s+/);let current=\"\";for(const word of words){const candidate=current?`${current} ${word}`:word;const prefixLength=this.visibleLength(firstNonEmpty?bulletPrefix:indent);if(prefixLength+this.visibleLength(candidate)>maxWidth&&current){result.push(`${firstNonEmpty?bulletPrefix:indent}${current}`);current=word;firstNonEmpty=false}else{current=candidate}}if(current){result.push(`${firstNonEmpty?bulletPrefix:indent}${current}`);firstNonEmpty=false}}return result.join(\"\\n\")+\"\\n\"}formatMarkdownHeader(text,level,maxWidth,prefix){const formattedText=formatInlineText(text);switch(level){case 1:{const headerWidth=Math.min(maxWidth-4,this.visibleLength(formattedText)+4);const topBorder=theme.primary(\"\\u2550\".repeat(headerWidth));const headerLine=theme.primary.bold(`\\u25C6 ${formattedText}`);return`${prefix}${topBorder}\n  ${headerLine}\n  ${topBorder}`}case 2:{const headerLine=theme.info.bold(`\\u25B8 ${formattedText}`);const underline=theme.info(\"\\u2500\".repeat(Math.min(maxWidth-4,this.visibleLength(formattedText)+2)));return`${prefix}${headerLine}\n  ${underline}`}case 3:{return`${prefix}${theme.secondary.bold(`\\u25C7 ${formattedText}`)}`}case 4:{return`${prefix}${theme.ui.muted(\"\\u25B9\")} ${theme.bold(formattedText)}`}default:{return`${prefix}${theme.bold(formattedText)}`}}}formatThinkingBlock(content){if(!content.trim())return\"\";const lower=content.toLowerCase();let label=\"thinking\";let labelColor=theme.neon.cyan;let labelIcon=\"\\u{1F4AD}\";let thoughtType=\"default\";if(lower.includes(\"acknowledge\")||lower.includes(\"understand\")||lower.includes(\"user wants\")||lower.includes(\"user is asking\")||lower.includes(\"the request\")||lower.includes(\"i'll help\")){label=\"understood\";labelColor=theme.success??theme.neon.green;labelIcon=\"\\u2705\";thoughtType=\"acknowledgement\"}else if(lower.includes(\"plan\")||lower.includes(\"steps\")||lower.includes(\"first\")||lower.includes(\"then\")||lower.includes(\"approach\")||lower.includes(\"strategy\")){label=\"planning\";labelColor=theme.info??theme.neon.blue;labelIcon=\"\\u{1F5FA}\\uFE0F\";thoughtType=\"planning\"}else if(lower.includes(\"analyzing\")||lower.includes(\"examining\")||lower.includes(\"looking at\")||lower.includes(\"reviewing\")){label=\"analyzing\";labelColor=theme.warning??theme.neon.orange;labelIcon=\"\\u{1F50D}\";thoughtType=\"analysis\"}else if(lower.includes(\"tool\")||lower.includes(\"read\")||lower.includes(\"edit\")||lower.includes(\"search\")||lower.includes(\"bash\")||lower.includes(\"execute\")){label=\"executing\";labelColor=theme.toolColors.default??theme.neon.purple;labelIcon=\"\\u2699\\uFE0F\";thoughtType=\"execution\"}else if(lower.includes(\"complete\")||lower.includes(\"done\")||lower.includes(\"finished\")||lower.includes(\"result\")){label=\"completed\";labelColor=theme.success??theme.neon.green;labelIcon=\"\\u2713\";thoughtType=\"completion\"}const normalized=content.replace(/\\s+/g,\" \").trim();const bullet=\"\\u23FA\";const coloredLabel=labelColor(`${labelIcon} ${label}`);return this.wrapBulletText(normalized,{label:coloredLabel,labelColor:__name(text=>text,\"labelColor\"),thoughtType})}formatAssistantResponse(content){if(!content.trim())return\"\";const cleaned=content.replace(/^[]\\s*/,\"\").trim();if(!cleaned.trim())return\"\";const bullet=\"\\u25C6\";const label=\"assistant\";const labelColor=theme.gradient.neon;const labelIcon=\"\\u2728\";const coloredLabel=labelColor(`${labelIcon} ${label}`);return this.wrapBulletText(cleaned,{label:coloredLabel,labelColor:__name(text=>text,\"labelColor\"),thoughtType:\"assistant\"})}wrapTextToWidth(text,width){if(!text.trim())return[\"\"];const lines=[];const words=text.trim().split(/\\s+/);let current=\"\";for(const word of words){const candidate=current?`${current} ${word}`:word;if(this.visibleLength(candidate)>width&&current){lines.push(current);current=word}else{current=candidate}}if(current){lines.push(current)}return lines}formatStreamingElapsed(){if(!this.streamingStartTime)return null;const elapsed=Math.floor((Date.now()-this.streamingStartTime)/1e3);if(elapsed<5)return null;const mins=Math.floor(elapsed/60);const secs=elapsed%60;if(mins>0){return`${mins}m ${secs}s`}return`${secs}s`}formatCompactBlock(content,label=\"history\"){const maxWidth=Math.min(this.cols,80);const labelText=` ${label} `;const padding=Math.max(0,maxWidth-labelText.length);const leftPad=Math.floor(padding/2);const rightPad=Math.ceil(padding/2);const separator=theme.ui.muted(\"\\u2550\".repeat(leftPad)+labelText+\"\\u2550\".repeat(rightPad));return`\n${separator}\n${content}\n`}addCompactBlock(content,label=\"history\"){const formattedContent=this.formatCompactBlock(content,label);this.eventQueue.push({type:\"response\",rawType:\"response\",content:formattedContent,timestamp:Date.now(),isCompacted:true});if(!this.isProcessingQueue){void this.processQueue()}}expandLastToolResult(){const collapsed=this.collapsedToolResults.pop();if(!collapsed&&!this.lastToolResult){return false}const content=collapsed?.content||this.lastToolResult||\"\";const toolName=collapsed?.toolName||\"result\";const isStructured=this.isStructuredToolOutput(toolName,content);let rendered;if(isStructured){rendered=this.formatStructuredToolOutput(toolName,content)}else{const label=`${toolName}`;rendered=this.wrapBulletText(content,{label,labelColor:theme.info})}this.eventQueue.push({type:\"response\",rawType:\"response\",content:rendered,timestamp:Date.now(),isCompacted:false});if(collapsed){this.lastToolResult=null}if(!this.isProcessingQueue){void this.processQueue()}return true}isStructuredToolOutput(toolName,content){const tool=toolName.toLowerCase();if([\"bash\",\"grep\",\"read\",\"glob\",\"execute_bash\",\"search\",\"find\"].includes(tool)){return true}if(/^\\s*[\\w./]+:\\d+[:\\s]/.test(content))return true;if(/^\\s*\\d+[:|]\\s/.test(content))return true;if(/^[]+/.test(content))return true;if(/^\\s*[$>]\\s+\\w+/.test(content))return true;return false}formatStructuredToolOutput(toolName,content){const lines=content.split(\"\\n\");const header=`\\u23FA ${theme.info(toolName)}${theme.ui.muted(\" \\xB7 expanded\")}\n`;const indent=\"  \";const maxWidth=this.safeWidth()-4;const formattedLines=lines.map(line=>{if(line.length>maxWidth){return indent+line.slice(0,maxWidth-1)+\"\\u2026\"}return indent+line});return header+formattedLines.join(\"\\n\")+\"\\n\"}getCollapsedResultCount(){return this.collapsedToolResults.length}clearCollapsedResults(){this.collapsedToolResults=[];this.lastToolResult=null}setMode(mode){const wasStreaming=this.mode===\"streaming\";this.mode=mode;if(mode===\"streaming\"&&!wasStreaming){this.streamingStartTime=Date.now();this.streamingTokens=0;this.streamingContentBuffer=\"\";this.streamingLinesWritten=0;this.streamingInputQueue=[];if(this.inlinePanel.length>0){this.inlinePanel=[]}this.startSpinnerAnimation()}else if(mode===\"idle\"&&wasStreaming){this.streamingStartTime=null;this.stopSpinnerAnimation()}if(wasStreaming&&mode===\"idle\"){if(!this.plainMode&&this.lastOverlay){this.clearPromptArea()}if(this.streamingContentBuffer&&this.streamingContentBuffer.trim()){if(!this.lastOutputEndedWithNewline){this.write(\"\\n\");this.lastOutputEndedWithNewline=true}const formattedResponse=this.formatAssistantResponse(this.streamingContentBuffer);if(formattedResponse.trim()){this.write(formattedResponse)}}else if(!this.lastOutputEndedWithNewline){this.write(\"\\n\");this.lastOutputEndedWithNewline=true}this.streamingContentBuffer=\"\";this.streamingLinesWritten=0;this.streamingInputQueue=[]}if(!this.plainMode){this.renderPrompt()}}startSpinnerAnimation(){if(this.spinnerInterval)return;this.spinnerFrame=0;this.activityStarFrame=0;this.elapsedColorFrame=0;this.spinnerInterval=setInterval(()=>{this.spinnerFrame=(this.spinnerFrame+1)%spinnerFrames.braille.length;this.activityStarFrame=(this.activityStarFrame+1)%this.activityStarFrames.length;if(this.spinnerFrame%3===0){this.elapsedColorFrame=(this.elapsedColorFrame+1)%this.elapsedColorFrames.length}if(!this.plainMode&&this.mode===\"streaming\"){this.renderPrompt()}},120)}stopSpinnerAnimation(){if(this.spinnerInterval){clearInterval(this.spinnerInterval);this.spinnerInterval=null}this.spinnerFrame=0;this.activityStarFrame=0;this.activityMessage=null;this.elapsedColorFrame=0}setActivity(message){this.activityMessage=message;if(!this.plainMode){this.renderPrompt()}}updateStreamingTokens(tokens){this.streamingTokens=tokens}formatTokenCount(tokens){if(tokens<1e3)return String(tokens);if(tokens<1e4)return`${(tokens/1e3).toFixed(1)}k`;return`${Math.round(tokens/1e3)}k`}getMode(){return this.mode}updateStatus(message){this.updateStatusBundle({main:message,override:null,streaming:null})}updateStatusBundle(status,options={}){const prevStreaming=this.statusStreaming;let changed=false;let mainChanged=false;let overrideChanged=false;if(status.main!==void 0&&status.main!==this.statusMessage){this.statusMessage=status.main;changed=true;mainChanged=true}if(status.override!==void 0&&status.override!==this.statusOverride){this.statusOverride=status.override;changed=true;overrideChanged=true}const streamingChanged=status.streaming!==void 0&&status.streaming!==prevStreaming;if(status.streaming!==void 0){if(streamingChanged){changed=true}this.statusStreaming=status.streaming}const streamingIntroduce=streamingChanged&&prevStreaming===null&&status.streaming!==null&&this.mode===\"streaming\";const streamingCleared=streamingChanged&&status.streaming===null&&this.mode===\"streaming\";const onlyStreamingChanged=streamingChanged&&!mainChanged&&!overrideChanged;const skipStreamingRender=onlyStreamingChanged&&this.mode===\"streaming\"&&!streamingIntroduce&&!streamingCleared;const shouldRender=options.render!==false&&changed&&!skipStreamingRender;if(shouldRender){this.renderPrompt()}}updateStatusMeta(meta,options={}){const next={...this.statusMeta,...meta};const changed=JSON.stringify(next)!==JSON.stringify(this.statusMeta);this.statusMeta=next;const shouldRender=options.render!==false&&changed;if(shouldRender){this.renderPrompt()}}updateModeToggles(state){this.toggleState={...this.toggleState,...state};if(!state.thinkingHotkey&&!state.criticalApprovalHotkey&&!state.autoContinueHotkey&&!state.alphaZeroHotkey&&!state.debugHotkey){this.hotkeysInToggleLine.clear()}this.forceNextRender=true;this.renderPromptImmediate()}updateRLStatus(status){const next={...this.rlStatus,...status};const changed=JSON.stringify(next)!==JSON.stringify(this.rlStatus);this.rlStatus=next;if(changed){this.renderPrompt()}}clearRLStatus(){this.rlStatus={};this.renderPrompt()}getRLStatus(){return this.rlStatus}updateSecureToolsStatus(status){const next={...this.secureToolsStatus,...status};const changed=JSON.stringify(next)!==JSON.stringify(this.secureToolsStatus);this.secureToolsStatus=next;if(changed){this.renderPrompt()}}recordSecureToolInvocation(tool,details){const invocations=(this.secureToolsStatus.totalInvocations||0)+1;const updates={lastToolUsed:tool,totalInvocations:invocations};if(tool===\"Execute\"&&details){updates.execute={active:true,lastCommand:details.command,lastExitCode:details.exitCode,execCount:(this.secureToolsStatus.execute?.execCount||0)+1}}else if(tool===\"Probe\"&&details){updates.probe={active:true,lastTarget:details.target,servicesFound:details.services,probeCount:(this.secureToolsStatus.probe?.probeCount||0)+1}}else if(tool===\"State\"&&details){updates.state={active:true,lastAction:details.action,keysStored:details.keysCount,persistent:true}}this.updateSecureToolsStatus(updates)}getSecureToolsStatus(){return this.secureToolsStatus}setInlinePanel(lines){const normalized=(lines??[]).map(line=>line.replace(/\\s+$/g,\"\"));const hasContent=normalized.some(line=>line.trim().length>0);if(!hasContent){if(this.inlinePanel.length){this.inlinePanel=[];this.renderPrompt()}return}const limited=this.limitInlinePanel(normalized);if(JSON.stringify(limited)===JSON.stringify(this.inlinePanel)){return}this.inlinePanel=limited;this.renderPrompt()}supportsInlinePanel(){return this.interactive&&!this.plainMode}clearInlinePanel(){if(!this.inlinePanel.length)return;this.inlinePanel=[];this.renderPrompt()}setMenu(items,options={},callback){if(!this.supportsInlinePanel()){callback(items[0]??null);return}this.menuItems=items;this.menuIndex=options.initialIndex??items.findIndex(i=>i.isActive)??0;if(this.menuIndex<0)this.menuIndex=0;this.menuTitle=options.title??null;this.menuCallback=callback;this.renderMenuPanel()}closeMenu(){if(!this.isMenuActive())return;const callback=this.menuCallback;this.menuItems=[];this.menuIndex=0;this.menuTitle=null;this.menuCallback=null;this.clearInlinePanel();callback?.(null)}isMenuActive(){return this.menuItems.length>0&&this.menuCallback!==null}renderMenuPanel(){if(!this.isMenuActive())return;const lines=[];if(this.menuTitle){lines.push(chalk.bold.hex(\"#8B5CF6\")(this.menuTitle));lines.push(\"\")}for(let i=0;i<this.menuItems.length;i++){const item=this.menuItems[i];const isSelected=i===this.menuIndex;const isDisabled=item.disabled;const isActive=item.isActive;let line=\"\";if(isSelected){line+=chalk.hex(\"#22D3EE\")(\"\\u276F \")}else{line+=\"  \"}if(isDisabled){line+=chalk.dim(item.label)}else if(isSelected){line+=chalk.bold.hex(\"#22D3EE\")(item.label)}else if(isActive){line+=chalk.hex(\"#34D399\")(item.label)}else{line+=chalk.white(item.label)}if(isActive){line+=chalk.dim(\" (current)\")}if(item.description){const desc=isDisabled?chalk.dim(item.description):chalk.dim(` - ${item.description}`);line+=desc}lines.push(line)}lines.push(\"\");lines.push(chalk.dim(\"\\u2191\\u2193 navigate \\u2022 enter select \\u2022 esc cancel\"));this.setInlinePanel(lines)}navigateMenu(direction){if(!this.isMenuActive())return false;let newIndex=this.menuIndex;let attempts=0;const maxAttempts=this.menuItems.length;do{newIndex=(newIndex+direction+this.menuItems.length)%this.menuItems.length;attempts++}while(this.menuItems[newIndex]?.disabled&&attempts<maxAttempts);if(newIndex!==this.menuIndex){this.menuIndex=newIndex;this.renderMenuPanel()}return true}selectMenuItem(){if(!this.isMenuActive())return false;const item=this.menuItems[this.menuIndex];if(!item||item.disabled)return true;const callback=this.menuCallback;this.menuItems=[];this.menuIndex=0;this.menuTitle=null;this.menuCallback=null;this.clearInlinePanel();callback?.(item);return true}limitInlinePanel(lines){const maxLines=Math.max(4,Math.min(this.maxInlinePanelLines,Math.max(2,this.rows-8)));if(lines.length<=maxLines){return lines}const overflow=lines.length-maxLines;const indicator=theme.ui.muted(`\\u2026 ${overflow} more lines`);const tailCount=Math.max(1,maxLines-1);const tail=lines.slice(-tailCount);return[indicator,...tail]}renderPrompt(){if(this.disposed||this.initializing)return;const now=Date.now();if(now-this.lastRenderTime<this.renderThrottleMs){if(!this.pendingRender){this.pendingRender=true;this.renderThrottleTimer=setTimeout(()=>{this.renderThrottleTimer=null;this.pendingRender=false;if(!this.disposed){this.renderPromptImmediate()}},this.renderThrottleMs)}return}this.renderPromptImmediate()}renderPromptImmediate(){if(this.disposed||this.initializing)return;if(!this.forceNextRender&&this.mode===\"idle\"&&this.buffer===this.lastRenderedBuffer&&this.cursor===this.lastRenderedCursor&&this.mode===this.lastRenderedMode&&this.lastOverlay!==null){return}this.forceNextRender=false;const now=Date.now();const burstActive=this.pasteBurstWindowStart>0&&now-this.pasteBurstWindowStart<=this.plainPasteWindowMs;const inEmitPaste=this.emitPasteBuffer.length>0||this.emitPasteTimer!==null;if((burstActive||this.inPlainPaste||this.inBracketedPaste||inEmitPaste)&&!this.collapsedPaste){return}this.lastRenderTime=Date.now();this.lastRenderedBuffer=this.buffer;this.lastRenderedCursor=this.cursor;this.lastRenderedMode=this.mode;if(!this.interactive){this.isPromptActive=false;return}if(this.promptRenderingSuspended){this.isPromptActive=false;return}if(this.plainMode){const line=`> ${this.buffer}`;if(!this.isPromptActive&&!this.lastOutputEndedWithNewline){this.write(\"\\n\");this.lastOutputEndedWithNewline=true}this.write(`\\r${ESC.CLEAR_LINE}${line}`);this.cursorVisibleColumn=line.length+1;this.hasRenderedPrompt=true;this.isPromptActive=true;this.lastOutputEndedWithNewline=false;this.promptHeight=1;return}if(!this.allowPromptRender){return}this.updateTerminalSize();const maxWidth=this.safeWidth();this.lastRenderWidth=maxWidth;const overlay=this.buildOverlayLines();if(!overlay.lines.length){return}const renderedLines=overlay.lines.map(line=>this.truncateLine(line,maxWidth));if(!renderedLines.length){return}const promptIndex=Math.max(0,Math.min(overlay.promptIndex,renderedLines.length-1));const height=renderedLines.length;const buffer=[];buffer.push(\"\\x1B[?25l\");if(this.hasEverRenderedOverlay&&this.lastOverlayHeight>0&&this.lastOverlay!==null){const linesToTop=this.lastOverlay.promptIndex;if(linesToTop>0){buffer.push(`\\x1B[${linesToTop}A`)}const clearHeight=this.lastOverlayHeight;for(let i=0;i<clearHeight;i++){buffer.push(\"\\r\");buffer.push(ESC.CLEAR_LINE);if(i<clearHeight-1){buffer.push(\"\\x1B[B\")}}buffer.push(\"\\x1B[J\");const moveBackUp=clearHeight-1;if(moveBackUp>0){buffer.push(`\\x1B[${moveBackUp}A`)}}else if(this.hasEverRenderedOverlay){buffer.push(\"\\r\");buffer.push(\"\\x1B[J\")}for(let i=0;i<renderedLines.length;i++){buffer.push(\"\\r\");buffer.push(ESC.CLEAR_LINE);buffer.push(renderedLines[i]||\"\");if(i<renderedLines.length-1){buffer.push(\"\\n\")}}if(this.lastOverlayHeight>height){buffer.push(\"\\n\");buffer.push(\"\\x1B[J\");buffer.push(\"\\x1B[A\")}const promptCol=Math.min(Math.max(1,3+this.cursor),this.cols||80);const linesToMoveUp=height-1-promptIndex;if(linesToMoveUp>0){buffer.push(`\\x1B[${linesToMoveUp}A`)}buffer.push(`\\x1B[${promptCol}G`);buffer.push(\"\\x1B[?25h\");this.write(buffer.join(\"\"));this.cursorVisibleColumn=promptCol;this.hasRenderedPrompt=true;this.hasEverRenderedOverlay=true;this.isPromptActive=true;this.lastOverlayHeight=height;this.lastOverlay={lines:renderedLines,promptIndex};this.lastOutputEndedWithNewline=false;this.promptHeight=height}buildOverlayLines(){const lines=[];const maxWidth=this.safeWidth();const divider=theme.ui.muted(\"\\u2500\".repeat(maxWidth));const fallbackActivity=(()=>{const raw=this.statusStreaming||this.statusOverride||this.statusMessage;if(!raw)return null;const cleaned=this.stripAnsi(raw).replace(/^[]\\s*/,\"\").trim();return cleaned||null})();if(this.mode===\"streaming\"&&(this.activityMessage||fallbackActivity)){const spinnerChars=spinnerFrames.braille;const spinnerChar=spinnerChars[this.spinnerFrame%spinnerChars.length]??\"\\u280B\";const starChar=this.activityStarFrames[this.activityStarFrame%this.activityStarFrames.length]??\"\\u2736\";const spinnerDecorated=`${theme.info(spinnerChar)}${theme.accent?theme.accent(starChar):starChar}`;const elapsed=this.formatStreamingElapsed();const genericActivities=[\"Streaming\",\"Thinking\",\"Processing\"];let displayActivity=this.activityMessage||fallbackActivity||\"\";if(genericActivities.includes(displayActivity)&&fallbackActivity){displayActivity=fallbackActivity}if(!displayActivity.trim()){displayActivity=fallbackActivity||\"Working\"}const needsEllipsis=!displayActivity.trimEnd().endsWith(\"\\u2026\")&&!displayActivity.trimEnd().endsWith(\"...\");const elapsedColor=chalk.hex(this.elapsedColorFrames[this.elapsedColorFrame%this.elapsedColorFrames.length]??\"#F59E0B\");const parts=[\"esc to interrupt\"];if(elapsed)parts.push(elapsedColor(elapsed));if(this.streamingTokens>0){parts.push(`\\u2191${this.formatTokenCount(this.streamingTokens)} tokens`)}const prefix=`${spinnerDecorated} `;const activityText=`${displayActivity.trim()}${needsEllipsis?\"\\u2026\":\"\"}`;const suffix=` ${theme.ui.muted(\"(\")}${parts.join(theme.ui.muted(\" \\xB7 \"))}${theme.ui.muted(\")\")}`;const activityLine=`${prefix}${activityText}${suffix}`;const indent=\" \".repeat(this.visibleLength(prefix));const wrapped=this.wrapOverlayLine(activityLine,maxWidth,indent);lines.push(...wrapped)}lines.push(divider);const promptIndex=lines.length;const inputLine=this.buildInputLine();const inputLines=inputLine.split(\"\\n\").filter((line,idx,arr)=>{if(line.trim()===\"\"){if(idx===0||idx===arr.length-1)return false}return true});if(inputLines.length===0){inputLines.push(theme.primary(\"> \"))}for(const line of inputLines){lines.push(this.truncateLine(line,maxWidth))}lines.push(divider);if(this.inlinePanel.length>0){for(const panelLine of this.inlinePanel){lines.push(this.truncateLine(`  ${panelLine}`,maxWidth))}lines.push(divider)}if(this.suggestions.length>0){for(let index=0;index<this.suggestions.length;index++){const suggestion=this.suggestions[index];const isActive=index===this.suggestionIndex;const marker=isActive?theme.primary(\"\\u25B8\"):theme.ui.muted(\" \");const cmdText=isActive?theme.primary(suggestion.command):theme.ui.muted(suggestion.command);const descText=isActive?suggestion.description:theme.ui.muted(suggestion.description);lines.push(this.truncateLine(`  ${marker} ${cmdText} \\u2014 ${descText}`,maxWidth))}}const compactStatus=this.buildCompactStatusLine();if(compactStatus){lines.push(this.truncateLine(`  ${compactStatus}`,maxWidth))}const toggleLine=this.buildToggleLine();if(toggleLine){lines.push(this.truncateLine(`  ${toggleLine}`,maxWidth))}return{lines,promptIndex}}buildCompactStatusLine(){const parts=[];const model=this.statusMeta.model||this.statusMeta.provider;if(model){parts.push(theme.info(model))}if(this.statusMeta.contextPercent!==void 0){const used=clampPercentage(this.statusMeta.contextPercent);const barWidth=5;const filled=Math.round(used/100*barWidth);const empty=Math.max(0,barWidth-filled);const barColor=getContextColor(used,{error:theme.error,warning:theme.warning,info:theme.info,success:theme.success});const bar=barColor(\"\\u2588\".repeat(filled))+theme.ui.muted(\"\\u2591\".repeat(empty));parts.push(`${bar} ${barColor(`${used}%`)}`)}if(this.statusMeta.profile){parts.push(theme.secondary(this.statusMeta.profile))}const workspace=this.statusMeta.workspace||this.statusMeta.directory;if(workspace){parts.push(theme.ui.muted(this.abbreviatePath(workspace)))}return parts.length>0?parts.join(theme.ui.muted(\" \\xB7 \")):null}buildChromeLines(){const maxWidth=this.safeWidth();const statusLines=this.buildStatusBlock(maxWidth);const metaLines=this.buildMetaBlock(maxWidth);return[...statusLines,...metaLines]}abbreviatePath(pathValue){const home=homedir();if(home&&pathValue.startsWith(home)){return pathValue.replace(home,\"~\")}return pathValue}buildStatusBlock(maxWidth){const segments=[];if(this.mode!==\"streaming\"){const statusLabel=this.composeStatusLabel();if(statusLabel){segments.push(`${theme.ui.muted(\"status\")} ${this.applyTone(statusLabel.text,statusLabel.tone)}`)}}if(this.statusMeta.sessionTime){segments.push(`${theme.ui.muted(\"runtime\")} ${theme.ui.muted(this.statusMeta.sessionTime)}`)}if(this.statusMeta.contextPercent!==void 0){this.contextMeter.update(this.statusMeta.contextPercent);segments.push(this.contextMeter.render())}return segments.length>0?this.wrapSegments(segments,maxWidth):[]}buildMetaBlock(maxWidth){const segments=[];if(this.statusMeta.profile){segments.push(this.formatMetaSegment(\"profile\",this.statusMeta.profile,\"info\"))}const model=this.statusMeta.provider&&this.statusMeta.model?`${this.statusMeta.provider} / ${this.statusMeta.model}`:this.statusMeta.model||this.statusMeta.provider;if(model){segments.push(this.formatMetaSegment(\"model\",model,\"info\"))}const workspace=this.statusMeta.workspace||this.statusMeta.directory;if(workspace){segments.push(this.formatMetaSegment(\"dir\",this.abbreviatePath(workspace),\"muted\"))}if(this.statusMeta.writes){segments.push(this.formatMetaSegment(\"writes\",this.statusMeta.writes,\"muted\"))}if(this.statusMeta.toolSummary){segments.push(this.formatMetaSegment(\"tools\",this.statusMeta.toolSummary,\"muted\"))}if(this.statusMeta.sessionLabel){segments.push(this.formatMetaSegment(\"session\",this.statusMeta.sessionLabel,\"muted\"))}if(this.statusMeta.version){segments.push(this.formatMetaSegment(\"build\",`v${this.statusMeta.version}`,\"muted\"))}const rlSegments=this.buildRLStatusSegments();if(rlSegments.length>0){segments.push(...rlSegments)}const secureToolsSegments=this.buildSecureToolsSegments();if(secureToolsSegments.length>0){segments.push(...secureToolsSegments)}if(segments.length===0){return[]}return this.wrapSegments(segments,maxWidth)}buildRLStatusSegments(){const segments=[];const rl=this.rlStatus;if(!rl.activeVariant&&!rl.wins&&!rl.currentModule){return segments}if(rl.wins&&(rl.wins.primary>0||rl.wins.refiner>0||rl.wins.ties>0)){const totalGames=rl.wins.primary+rl.wins.refiner+rl.wins.ties;const leader=rl.wins.primary>rl.wins.refiner?\"primary\":rl.wins.refiner>rl.wins.primary?\"refiner\":\"tie\";const pColor=leader===\"primary\"?theme.success:theme.info;const rColor=leader===\"refiner\"?theme.success:theme.warning;const pScore=pColor(`${rl.wins.primary}`);const rScore=rColor(`${rl.wins.refiner}`);const trophy=leader===\"primary\"?theme.info(\"\\u{1F3C6}\"):leader===\"refiner\"?theme.warning(\"\\u{1F3C6}\"):\"\\u2696\\uFE0F\";const streakText=rl.streak&&rl.streak>1?theme.ui.muted(` \\u{1F525}${rl.streak}`):\"\";segments.push(`${trophy}${pScore}${theme.ui.muted(\":\")}${rScore}${streakText}`);if(totalGames>0){const barWidth=8;const pBars=Math.round(rl.wins.primary/totalGames*barWidth);const rBars=Math.round(rl.wins.refiner/totalGames*barWidth);const tBars=Math.max(0,barWidth-pBars-rBars);const bar=theme.info(\"\\u2588\".repeat(pBars))+theme.ui.muted(\"\\u2591\".repeat(tBars))+theme.warning(\"\\u2588\".repeat(rBars));segments.push(`[${bar}]`)}}if(rl.activeVariant){const isParallel=rl.parallelExecution;if(isParallel){segments.push(`${theme.info(\"\\u26A1P\")} ${theme.ui.muted(\"\\u2225\")} ${theme.warning(\"\\u26A1R\")}`)}else{const variantIcon=rl.activeVariant===\"primary\"?\"\\u25B6\":\"\\u25B7\";const variantLabel=rl.activeVariant===\"primary\"?\"P\":\"R\";const variantColor=rl.activeVariant===\"primary\"?theme.info:theme.warning;segments.push(`${variantIcon}${variantColor(variantLabel)}`)}}if(rl.lastWinner&&rl.lastWinner!==\"tie\"){const winnerIcon=rl.lastWinner===\"primary\"?theme.info(\"\\u2713P\"):theme.warning(\"\\u2713R\");segments.push(winnerIcon)}else if(rl.lastWinner===\"tie\"){segments.push(theme.ui.muted(\"\\u2248\"))}if(rl.currentModule||rl.currentStep){const stepText=rl.currentStep||rl.currentModule||\"\";if(stepText){segments.push(theme.ui.muted(this.truncateMiddle(stepText,15)))}}if(typeof rl.stepsCompleted===\"number\"&&typeof rl.totalSteps===\"number\"&&rl.totalSteps>0){const pct=Math.round(rl.stepsCompleted/rl.totalSteps*100);segments.push(theme.ui.muted(`${pct}%`))}if(rl.scores&&(typeof rl.scores.primary===\"number\"||typeof rl.scores.refiner===\"number\")){const pScore=typeof rl.scores.primary===\"number\"?rl.scores.primary.toFixed(2):\"-\";const rScore=typeof rl.scores.refiner===\"number\"?rl.scores.refiner.toFixed(2):\"-\";const pVal=rl.scores.primary??0;const rVal=rl.scores.refiner??0;const pDisplay=pVal>rVal?theme.success(pScore):theme.info(pScore);const rDisplay=rVal>pVal?theme.success(rScore):theme.warning(rScore);segments.push(`${pDisplay}${theme.ui.muted(\"/\")}${rDisplay}`)}if(rl.accuracy&&(typeof rl.accuracy.primary===\"number\"||typeof rl.accuracy.refiner===\"number\")){const pAcc=rl.accuracy.primary!==void 0?Math.round(rl.accuracy.primary*100):null;const rAcc=rl.accuracy.refiner!==void 0?Math.round(rl.accuracy.refiner*100):null;const pDisplay=pAcc!==null?theme.info(`P${pAcc}%`):null;const rDisplay=rAcc!==null?theme.warning(`R${rAcc}%`):null;const parts=[pDisplay,rDisplay].filter(Boolean).join(theme.ui.muted(\"|\"));if(parts){segments.push(parts)}}return segments}buildSecureToolsSegments(){const segments=[];const st=this.secureToolsStatus;if(!st.totalInvocations&&!st.lastToolUsed){if(st.toolkitReady){segments.push(theme.success(\"\\u{1F512}\")+theme.ui.muted(\" TAO\"))}return segments}const secIcon=st.sanitizationActive?theme.success(\"\\u{1F512}\"):theme.warning(\"\\u26A0\");segments.push(secIcon);const toolIndicators=[];if(st.execute?.active){const execIcon=st.execute.lastExitCode===0?theme.success(\"\\u2713\"):theme.error(\"\\u2717\");const execCount=st.execute.execCount||0;toolIndicators.push(`${theme.info(\"Ex\")}${execIcon}${execCount>1?theme.ui.muted(`\\xD7${execCount}`):\"\"}`)}if(st.probe?.active){const svcCount=st.probe.servicesFound||0;toolIndicators.push(`${chalk.cyan(\"Pr\")}${theme.success(\"\\u2713\")}${svcCount>0?theme.ui.muted(`[${svcCount}]`):\"\"}`)}if(st.state?.active){const stateIcon=st.state.persistent?theme.success(\"\\u{1F4BE}\"):theme.info(\"\\u{1F4DD}\");const keysCount=st.state.keysStored||0;toolIndicators.push(`${stateIcon}${keysCount>0?theme.ui.muted(`${keysCount}k`):\"\"}`)}if(toolIndicators.length>0){segments.push(toolIndicators.join(theme.ui.muted(\"\\xB7\")))}if(st.totalInvocations&&st.totalInvocations>0){segments.push(theme.ui.muted(`\\u03A3${st.totalInvocations}`))}if(st.lastToolUsed){const toolColors={Execute:theme.info,Probe:__name(s=>chalk.cyan(s),\"Probe\"),State:theme.success,Transform:theme.warning,TaoOps:__name(s=>chalk.magenta(s),\"TaoOps\")};const color=toolColors[st.lastToolUsed]||theme.ui.muted;segments.push(color(`\\u2192${st.lastToolUsed.slice(0,2)}`))}return segments}truncateMiddle(text,maxLen){if(text.length<=maxLen)return text;const keepLen=Math.floor((maxLen-3)/2);return`${text.slice(0,keepLen)}...${text.slice(-keepLen)}`}composeStatusLabel(){const statuses=[this.statusStreaming,this.statusOverride,this.statusMessage].filter((value,index,arr)=>Boolean(value)&&arr.indexOf(value)===index);const text=statuses.length>0?statuses.join(\" / \"):\"Ready for prompts\";if(!text.trim()){return null}const normalized=text.toLowerCase();const tone=normalized.includes(\"ready\")?\"success\":\"info\";return{text,tone}}formatMetaSegment(label,value,tone){const colorizer=tone===\"success\"?theme.success:tone===\"warn\"?theme.warning:tone===\"error\"?theme.error:tone===\"muted\"?theme.ui.muted:theme.info;return`${theme.ui.muted(label)} ${colorizer(value)}`}applyTone(text,tone){switch(tone){case\"success\":return theme.success(text);case\"warn\":return theme.warning(text);case\"error\":return theme.error(text);case\"info\":default:return theme.info(text)}}wrapSegments(segments,maxWidth){const lines=[];const separator=theme.ui.muted(\"  |  \");let current=\"\";for(const segment of segments){const normalized=segment.trim();if(!normalized)continue;if(!current){current=this.truncateLine(normalized,maxWidth);continue}const candidate=`${current}${separator}${normalized}`;if(this.visibleLength(candidate)<=maxWidth){current=candidate}else{lines.push(this.truncateLine(current,maxWidth));current=this.truncateLine(normalized,maxWidth)}}if(current){lines.push(this.truncateLine(current,maxWidth))}return lines}buildControlLines(){const lines=[];const toggleLine=this.buildToggleLine();if(toggleLine){lines.push(`${theme.ui.muted(\"modes\")} ${theme.ui.muted(\"\\u203A\")} ${toggleLine}`)}const shortcutLine=this.buildShortcutLine();if(shortcutLine){lines.push(`${theme.ui.muted(\"keys\")}  ${shortcutLine}`)}return lines}buildToggleLine(){const toggles=[];const addToggle=__name((label,on,hotkey,value)=>{toggles.push({label,on,hotkey:this.formatHotkey(hotkey),value})},\"addToggle\");const alphaZeroActive=this.toggleState.alphaZeroEnabled??false;addToggle(\"Mode\",true,this.toggleState.alphaZeroHotkey,alphaZeroActive?\"AlphaZero\":\"Normal\");const approvalMode=this.toggleState.criticalApprovalMode||\"auto\";const approvalActive=approvalMode!==\"auto\";addToggle(\"Approvals\",approvalActive,this.toggleState.criticalApprovalHotkey,approvalMode===\"auto\"?\"auto\":\"ask\");const autoContinueActive=this.toggleState.autoContinueEnabled??false;addToggle(\"Auto\",autoContinueActive,this.toggleState.autoContinueHotkey,autoContinueActive?\"on\":\"off\");const thinkingLabelRaw=(this.toggleState.thinkingModeLabel||\"balanced\").trim();const thinkingLabel=thinkingLabelRaw.toLowerCase()===\"extended\"?\"deep\":thinkingLabelRaw||\"balanced\";const thinkingActive=thinkingLabel.length>0;addToggle(\"Thinking\",thinkingActive,this.toggleState.thinkingHotkey,thinkingLabel);const buildLine=__name(includeHotkeys=>{return toggles.map(toggle=>{const stateText=toggle.on?theme.success(toggle.value||\"on\"):theme.ui.muted(toggle.value||\"off\");const hotkeyText=includeHotkeys&&toggle.hotkey?theme.ui.muted(` [${toggle.hotkey}]`):\"\";return`${theme.ui.muted(`${toggle.label}:`)} ${stateText}${hotkeyText}`}).join(theme.ui.muted(\"  \"))},\"buildLine\");const maxWidth=this.safeWidth();let line=buildLine(true);this.hotkeysInToggleLine=new Set(toggles.map(toggle=>toggle.hotkey?toggle.hotkey:null).filter(key=>Boolean(key)));if(this.visibleLength(line)>maxWidth){this.hotkeysInToggleLine.clear();line=buildLine(false)}return line.trim()?line:null}buildShortcutLine(){const parts=[];const addHotkey=__name((label,combo)=>{const normalized=this.formatHotkey(combo);if(!normalized)return;if(this.hotkeysInToggleLine.has(normalized)){return}parts.push(`${theme.info(normalized)} ${theme.ui.muted(label)}`)},\"addHotkey\");addHotkey(\"interrupt\",\"Ctrl+C\");addHotkey(\"clear input\",\"Ctrl+U\");addHotkey(\"auto\",this.toggleState.autoContinueHotkey);addHotkey(\"thinking\",this.toggleState.thinkingHotkey);addHotkey(\"mode\",this.toggleState.alphaZeroHotkey);if(parts.length===0){return null}return parts.join(theme.ui.muted(\"   \"))}buildInputLine(){if(this.collapsedPaste){const linesText=this.collapsedPaste.lines===1?\"1 line\":`${this.collapsedPaste.lines} lines`;const charsText=typeof this.collapsedPaste.chars===\"number\"?`${this.collapsedPaste.chars} chars`:`${this.collapsedPaste.chars}`;const summary=theme.success(`[\\u{1F4CB} ${linesText}, ${charsText}]`);return this.truncateLine(`${theme.primary(\"> \")}${summary}`,this.safeWidth())}const now=Date.now();const burstActive=this.pasteBurstWindowStart>0&&now-this.pasteBurstWindowStart<=this.plainPasteWindowMs;if(this.inPlainPaste||this.inBracketedPaste||burstActive){const chars=this.plainPasteBuffer.length||this.pasteBuffer.length||this.pendingInsertBuffer.length||0;if(chars>0){const indicator=theme.ui.muted(`[\\u{1F4CB} pasting... ${chars} chars]`);return this.truncateLine(`${theme.primary(\"> \")}${indicator}`,this.safeWidth())}if(burstActive){return this.truncateLine(`${theme.primary(\"> \")}`,this.safeWidth())}}const prompt=theme.primary(\"> \");const promptWidth=this.visibleLength(prompt);const maxWidth=this.safeWidth();const continuationIndent=\"  \";const continuationWidth=continuationIndent.length;const rawBuffer=this.buffer.replace(/\\r/g,\"\\n\");const normalized=this.secretMode?\"\\u2022\".repeat(rawBuffer.length):rawBuffer;const bufferLines=normalized.split(\"\\n\");const result=[];let totalChars=0;let cursorLine=0;let cursorCol=0;let foundCursor=false;for(let lineIndex=0;lineIndex<bufferLines.length;lineIndex++){const line=bufferLines[lineIndex]??\"\";const isFirstLogicalLine=lineIndex===0;const lineStartChar=totalChars;const firstLineWidth=maxWidth-promptWidth;const contLineWidth=maxWidth-continuationWidth;let remaining=line;let isFirstDisplayLine=true;while(remaining.length>0||isFirstDisplayLine){const availableWidth=isFirstLogicalLine&&isFirstDisplayLine?firstLineWidth:contLineWidth;const chunk=remaining.slice(0,availableWidth);remaining=remaining.slice(availableWidth);let displayLine;if(isFirstLogicalLine&&isFirstDisplayLine){displayLine=`${prompt}${chunk}`}else{displayLine=`${continuationIndent}${chunk}`}if(!foundCursor){const chunkStart=lineStartChar+(line.length-remaining.length-chunk.length);const chunkEnd=chunkStart+chunk.length;if(this.cursor>=chunkStart&&this.cursor<=chunkEnd){cursorLine=result.length;const offsetInChunk=this.cursor-chunkStart;cursorCol=(isFirstLogicalLine&&isFirstDisplayLine?promptWidth:continuationWidth)+offsetInChunk;foundCursor=true}}result.push(displayLine);isFirstDisplayLine=false;if(remaining.length===0&&chunk.length===0)break}totalChars+=line.length+1}if(!foundCursor){cursorLine=Math.max(0,result.length-1);const lastLine=result[cursorLine]??\"\";cursorCol=this.visibleLength(lastLine)}if(result.length>0){const targetLine=result[cursorLine]??\"\";const visiblePart=this.stripAnsi(targetLine);const cursorPos=Math.min(cursorCol,visiblePart.length);const before=visiblePart.slice(0,cursorPos);const at=visiblePart.charAt(cursorPos)||\" \";const after=visiblePart.slice(cursorPos+1);const prefix=cursorLine===0?prompt:continuationIndent;const textPart=cursorLine===0?before.slice(promptWidth):before.slice(continuationWidth);result[cursorLine]=`${prefix}${textPart}${ESC.REVERSE}${at}${ESC.RESET}${after}`}this.cursorVisibleColumn=cursorCol+1;return result.join(\"\\n\")}buildInputWindow(available){if(available<=0){return{text:\"\",cursor:0}}if(this.collapsedPaste){return{text:\"\",cursor:0}}const normalized=this.buffer.replace(/\\r/g,\"\\n\");const cursorIndex=Math.min(this.cursor,normalized.length);let offset=this.inputRenderOffset;if(cursorIndex<offset){offset=cursorIndex}const overflow=cursorIndex-offset-available+1;if(overflow>0){offset+=overflow}const maxOffset=Math.max(0,normalized.length-available);if(offset>maxOffset){offset=maxOffset}this.inputRenderOffset=offset;const window=normalized.slice(offset,offset+available);const display=window.split(\"\").map(char=>char===\"\\n\"?NEWLINE_PLACEHOLDER:char).join(\"\");const cursorInWindow=Math.min(display.length,Math.max(0,cursorIndex-offset));const before=display.slice(0,cursorInWindow);const at=display.charAt(cursorInWindow)||\" \";const after=display.slice(cursorInWindow+1);return{text:`${before}${ESC.REVERSE}${at}${ESC.RESET}${after}`,cursor:cursorInWindow}}expandCollapsedPasteToBuffer(){if(!this.collapsedPaste)return;const text=this.collapsedPaste.text;this.collapsedPaste=null;this.buffer=text;this.cursor=text.length;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}expandCollapsedPaste(){if(!this.collapsedPaste)return;const text=this.collapsedPaste.text;this.collapsedPaste=null;this.buffer=\"\";this.cursor=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange();this.submitText(text)}captureInput(options={}){if(this.inputCapture){return Promise.reject(new Error(\"Input capture already in progress\"))}if(options.resetBuffer){this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.resetSuggestions();this.renderPrompt();this.emitInputChange()}return new Promise((resolve,reject)=>{this.inputCapture={resolve,reject,options:{trim:options.trim!==false,allowEmpty:options.allowEmpty??false}}})}cancelInputCapture(reason){if(!this.inputCapture){return}const capture=this.inputCapture;this.inputCapture=null;capture.reject?.(reason??new Error(\"Input capture cancelled\"))}wrapOverlayLine(text,width,indent){const words=text.split(/(\\s+)/);const lines=[];let current=\"\";for(const word of words){const next=current+word;if(this.visibleLength(next)>width&&current.trim()){lines.push(current.trimEnd());current=indent+word.trimStart()}else{current=next}}if(current.trim()){lines.push(current.trimEnd())}return lines.length?lines:[text]}safeWidth(){const cols=this.output.isTTY?this.cols||80:80;return Math.max(1,cols-1)}visibleLength(value){if(!value)return 0;return this.stripAnsi(value).length}stripAnsi(value){if(!value)return\"\";return value.replace(/\\u001B\\[[0-?]*[ -/]*[@-~]/g,\"\")}truncateLine(value,width){if(!value)return\"\";const limit=Math.max(1,width);const tokens=value.split(/(\\x1b\\[[0-9;]*m)/u);let visible=0;let truncated=false;let result=\"\";for(const token of tokens){if(!token)continue;if(/^\\x1b\\[[0-9;]*m$/u.test(token)){result+=token;continue}if(visible>=limit){truncated=true;continue}const remaining=limit-visible;if(token.length<=remaining){result+=token;visible+=token.length}else{const sliceLength=Math.max(0,remaining-1);if(sliceLength>0){result+=token.slice(0,sliceLength);visible+=sliceLength}result+=\"\\u2026\";truncated=true;break}}if(truncated&&!result.endsWith(ESC.RESET)){result+=ESC.RESET}return result}getBuffer(){return this.buffer}getCursor(){return this.cursor}setBuffer(text,cursorPos){this.buffer=text;const requestedCursor=cursorPos??text.length;this.cursor=Math.max(0,Math.min(requestedCursor,text.length));this.inputRenderOffset=0;this.updateSuggestions();this.renderPrompt();this.emitInputChange()}setSecretMode(enabled){this.secretMode=enabled;this.renderPrompt()}clearBuffer(){this.cancelPlainPasteCapture();this.buffer=\"\";this.cursor=0;this.inputRenderOffset=0;this.suggestions=[];this.suggestionIndex=-1;this.renderPrompt();this.emitInputChange()}setModeStatus(status){this.updateStatus(status)}showCompactingStatus(message){this.statusMessage=message;if(!this.spinnerInterval){this.spinnerInterval=setInterval(()=>{this.spinnerFrame++;if(this.spinnerFrame%50===0){this.activityPhraseIndex++}this.renderPrompt()},80)}this.renderPrompt()}hideCompactingStatus(){if(this.spinnerInterval){clearInterval(this.spinnerInterval);this.spinnerInterval=null}this.statusMessage=null;this.renderPrompt()}emitPrompt(content){this.pushPromptEvent(content)}displayUserPrompt(text){const normalized=text?.trim();if(!normalized)return;const now=Date.now();if(this.lastPromptEvent&&this.lastPromptEvent.text===normalized&&now-this.lastPromptEvent.at<1500){return}this.lastPromptEvent={text:normalized,at:now};this.addEvent(\"prompt\",normalized)}render(){this.renderPrompt()}delay(ms){return new Promise(resolve=>setTimeout(resolve,ms))}write(data){this.output.write(data)}pushPromptEvent(text){const normalized=text?.trim();if(!normalized){return}const now=Date.now();if(this.lastPromptEvent&&this.lastPromptEvent.text===normalized&&now-this.lastPromptEvent.at<1500){return}this.lastPromptEvent={text:normalized,at:now};this.addEvent(\"prompt\",normalized)}clearPromptArea(){const height=this.lastOverlay?.lines.length??this.promptHeight??0;if(height===0)return;const buffer=[];buffer.push(\"\\x1B[?25l\");if(this.lastOverlay){const linesToTop=this.lastOverlay.promptIndex;if(linesToTop>0){buffer.push(`\\x1B[${linesToTop}A`)}}for(let i=0;i<height;i++){buffer.push(\"\\r\");buffer.push(ESC.CLEAR_LINE);if(i<height-1){buffer.push(\"\\x1B[B\")}}if(height>1){buffer.push(`\\x1B[${height-1}A`)}buffer.push(\"\\r\");buffer.push(\"\\x1B[?25h\");this.write(buffer.join(\"\"));this.lastOverlay=null;this.promptHeight=0;this.lastOverlayHeight=0;this.isPromptActive=false}updateTerminalSize(){if(this.output.isTTY){this.rows=this.output.rows||24;this.cols=this.output.columns||80}}}export{UnifiedUIRenderer,createBanner,createSecurityBanner,createSecuritySpinner,formatAuditProgress,formatProgress,formatSecureToolsSummary,formatSecurityFinding,formatSecurityStatus,formatSecuritySummary};\n","warnings":[],"map":{"version":3,"mappings":"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","names":["severityColors","code","words","current"],"ignoreList":[],"sources":["/Volumes/4TB/GitHub/src/ui/UnifiedUIRenderer.ts"],"sourcesContent":[null]}}
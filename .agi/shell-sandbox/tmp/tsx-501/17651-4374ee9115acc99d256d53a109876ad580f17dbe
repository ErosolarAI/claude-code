{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{readFileSync}from\"node:fs\";import{join,dirname}from\"node:path\";import{fileURLToPath}from\"node:url\";const __filename=fileURLToPath(import.meta.url);const __dirname=dirname(__filename);let cachedSchema=null;function getAgentSchemas(){if(cachedSchema){return cachedSchema}try{const schemaPath=join(__dirname,\"..\",\"contracts\",\"agent-schemas.json\");const raw=readFileSync(schemaPath,\"utf-8\");const parsed=JSON.parse(raw);validateAgentSchemas(parsed);cachedSchema=parsed;return cachedSchema}catch(error){throw new Error(`Failed to load agent schemas: ${error instanceof Error?error.message:String(error)}`)}}__name(getAgentSchemas,\"getAgentSchemas\");function getProviders(){const schemas=getAgentSchemas();return schemas.providers}__name(getProviders,\"getProviders\");function getProvider(providerId){const providers=getProviders();return providers.find(p=>p.id===providerId)}__name(getProvider,\"getProvider\");async function getModels(){const schemas=getAgentSchemas();const staticModels=schemas.models;try{const modelDiscoveryModule=await import(\"./modelDiscovery.js\").then(s=>{const e=\"default\";return s[e]&&typeof s[e]==\"object\"&&\"__esModule\"in s[e]?s[e]:s});const discoveredModels=modelDiscoveryModule.getCachedDiscoveredModels();const staticIds=new Set(staticModels.map(m=>m.id));const uniqueDiscovered=discoveredModels.filter(m=>!staticIds.has(m.id));return[...staticModels,...uniqueDiscovered]}catch(error){return staticModels}}__name(getModels,\"getModels\");async function getModelsByProvider(providerId){const models=await getModels();return models.filter(m=>m.provider===providerId)}__name(getModelsByProvider,\"getModelsByProvider\");async function getModel(modelId){const models=await getModels();return models.find(m=>m.id===modelId)}__name(getModel,\"getModel\");function getProfiles(){const schemas=getAgentSchemas();return schemas.profiles}__name(getProfiles,\"getProfiles\");function getProfile(profileName){const profiles=getProfiles();return profiles.find(p=>p.name===profileName)}__name(getProfile,\"getProfile\");function getSlashCommands(){const schemas=getAgentSchemas();return schemas.slashCommands??[]}__name(getSlashCommands,\"getSlashCommands\");function getCapabilities(){const schemas=getAgentSchemas();return schemas.capabilities??[]}__name(getCapabilities,\"getCapabilities\");function validateAgentSchemas(manifest){if(!manifest.contractVersion){throw new Error(\"Missing required field: contractVersion\")}if(!manifest.version){throw new Error(\"Missing required field: version\")}if(!Array.isArray(manifest.providers)||manifest.providers.length===0){throw new Error(\"Missing or empty required field: providers\")}if(!Array.isArray(manifest.models)||manifest.models.length===0){throw new Error(\"Missing or empty required field: models\")}if(!Array.isArray(manifest.profiles)||manifest.profiles.length===0){throw new Error(\"Missing or empty required field: profiles\")}const providerIds=new Set;for(const provider of manifest.providers){if(!provider.id||!provider.label){throw new Error(\"Provider missing required fields: id, label\")}if(providerIds.has(provider.id)){throw new Error(`Duplicate provider ID: ${provider.id}`)}providerIds.add(provider.id)}const modelIds=new Set;for(const model of manifest.models){if(!model.id||!model.label||!model.provider){throw new Error(\"Model missing required fields: id, label, provider\")}if(modelIds.has(model.id)){throw new Error(`Duplicate model ID: ${model.id}`)}if(!providerIds.has(model.provider)){throw new Error(`Model \"${model.id}\" references unknown provider: ${model.provider}`)}modelIds.add(model.id)}const profileNames=new Set;for(const profile of manifest.profiles){if(!profile.name||!profile.label||!profile.defaultProvider||!profile.defaultModel){throw new Error(\"Profile missing required fields: name, label, defaultProvider, defaultModel\")}if(profileNames.has(profile.name)){throw new Error(`Duplicate profile name: ${profile.name}`)}if(!providerIds.has(profile.defaultProvider)){throw new Error(`Profile \"${profile.name}\" references unknown provider: ${profile.defaultProvider}`)}if(!modelIds.has(profile.defaultModel)){throw new Error(`Profile \"${profile.name}\" references unknown model: ${profile.defaultModel}`)}profileNames.add(profile.name)}if(manifest.slashCommands){const commands=new Set;for(const cmd of manifest.slashCommands){if(!cmd.command||!cmd.description){throw new Error(\"Slash command missing required fields: command, description\")}if(commands.has(cmd.command)){throw new Error(`Duplicate slash command: ${cmd.command}`)}commands.add(cmd.command)}}if(manifest.capabilities){const capabilities=new Set;for(const cap of manifest.capabilities){if(!cap.id||!cap.label){throw new Error(\"Capability missing required fields: id, label\")}if(capabilities.has(cap.id)){throw new Error(`Duplicate capability ID: ${cap.id}`)}capabilities.add(cap.id)}}}__name(validateAgentSchemas,\"validateAgentSchemas\");function clearSchemaCache(){cachedSchema=null}__name(clearSchemaCache,\"clearSchemaCache\");function isValidProvider(providerId){const provider=getProvider(providerId);return provider!==void 0}__name(isValidProvider,\"isValidProvider\");async function isValidModel(modelId){const model=await getModel(modelId);return model!==void 0}__name(isValidModel,\"isValidModel\");function isValidProfile(profileName){const profile=getProfile(profileName);return profile!==void 0}__name(isValidProfile,\"isValidProfile\");export{clearSchemaCache,getAgentSchemas,getCapabilities,getModel,getModels,getModelsByProvider,getProfile,getProfiles,getProvider,getProviders,getSlashCommands,isValidModel,isValidProfile,isValidProvider};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/bo/GitHub/agi-core-CLI-coding/src/core/agentSchemaLoader.ts"],"sourcesContent":[null]}}
{"version":3,"names":["cov_h9hdb00cf","actualCoverage","AnthropicMessagesProvider","registerProvider","withProviderResilience","registered","s","registerAnthropicProviderPlugin","f","b","config","options","apiKey","requireEnv","model","temperature","maxTokens","thinking","baseProvider","name","value","process","env","Error"],"sources":["index.ts"],"sourcesContent":["import { AnthropicMessagesProvider } from '../../../providers/anthropicProvider.js';\nimport { registerProvider } from '../../../providers/providerFactory.js';\nimport { withProviderResilience } from '../../../providers/resilientProvider.js';\n\nlet registered = false;\n\n/**\n * Anthropic (Claude) Provider Plugin\n *\n * Registers the Anthropic provider with hardened error handling for:\n * - Network failures (premature close, connection reset)\n * - Stream errors (gunzip, decompression failures)\n * - Rate limiting with exponential backoff\n * - Circuit breaker for cascading failure prevention\n */\nexport function registerAnthropicProviderPlugin(): void {\n  if (registered) {\n    return;\n  }\n\n  registerProvider('anthropic', (config) => {\n    const options = {\n      apiKey: requireEnv('ANTHROPIC_API_KEY'),\n      model: config.model,\n      ...(typeof config.temperature === 'number' ? { temperature: config.temperature } : {}),\n      ...(typeof config.maxTokens === 'number' ? { maxTokens: config.maxTokens } : {}),\n      // Pass thinking configuration for extended thinking models (Claude 4/3.7)\n      ...(config.thinking ? { thinking: config.thinking } : {}),\n    };\n    const baseProvider = new AnthropicMessagesProvider(options);\n\n    // Wrap with resilience layer\n    return withProviderResilience(baseProvider, 'anthropic');\n  });\n\n  registered = true;\n}\n\nfunction requireEnv(name: string): string {\n  const value = process.env[name];\n  if (!value) {\n    throw new Error(`Missing required environment variable ${name}.`);\n  }\n  return value;\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["_UIUpdateCoordinator","require","cov_1wmo5f2nha","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","undefined","s","f","b","_coverageSchema","coverage","actualCoverage","OrchestrationUIBridge","constructor","options","display","orchestrator","updateCoordinator","UIUpdateCoordinator","showRealtime","Boolean","showRealTimeOutput","onEvent","unsub","event","handleEvent","execute","objective","execConfig","setMode","report","id","startTime","Date","now","endTime","duration","results","findings","recommendations","summary","success","dispose","data","toolName","writeRaw","enqueue","lane","run","exports"],"sources":["OrchestrationUIBridge.ts"],"sourcesContent":["import type { OrchestratorEvent, OperationConfig, OperationReport, UnifiedOrchestrator } from '../../core/unifiedOrchestrator.js';\nimport { UIUpdateCoordinator } from './UIUpdateCoordinator.js';\n\ninterface Display {\n  writeRaw(text: string): void;\n  showError(title: string, error: unknown): void;\n  showSystemMessage(message: string): void;\n}\n\ninterface BridgeOptions {\n  display: Display;\n  updateCoordinator?: UIUpdateCoordinator;\n  orchestrator?: UnifiedOrchestrator;\n  showRealTimeOutput?: boolean;\n  showProgressBar?: boolean;\n  verboseMode?: boolean;\n}\n\nexport class OrchestrationUIBridge {\n  private readonly display: Display;\n  private readonly orchestrator: UnifiedOrchestrator | undefined;\n  private readonly updateCoordinator: UIUpdateCoordinator;\n  private readonly showRealtime: boolean;\n  private unsub?: () => void;\n\n  constructor(options: BridgeOptions) {\n    this.display = options.display;\n    this.orchestrator = options.orchestrator;\n    this.updateCoordinator = options.updateCoordinator ?? new UIUpdateCoordinator();\n    this.showRealtime = Boolean(options.showRealTimeOutput);\n\n    if (this.orchestrator?.onEvent) {\n      this.unsub = this.orchestrator.onEvent((event) => this.handleEvent(event));\n    }\n  }\n\n  async execute(objective: string): Promise<OperationReport> {\n    const execConfig: Partial<OperationConfig> = { objective };\n    this.updateCoordinator.setMode('flushing');\n    const report =\n      (await this.orchestrator?.execute(execConfig)) ??\n      ({\n        id: 'noop',\n        objective,\n        startTime: Date.now(),\n        endTime: Date.now(),\n        duration: 0,\n        results: [],\n        findings: [],\n        recommendations: [],\n        summary: 'noop',\n        success: true,\n      } satisfies OperationReport);\n    this.updateCoordinator.setMode('idle');\n    return report;\n  }\n\n  dispose(): void {\n    this.unsub?.();\n  }\n\n  private handleEvent(event: OrchestratorEvent): void {\n    if (!this.showRealtime) {\n      return;\n    }\n    const name = event.data && typeof event.data === 'object' ? (event.data as any).toolName ?? '' : '';\n    this.display.writeRaw(`[${event.type}] ${name}\\n`);\n    this.updateCoordinator.enqueue({\n      lane: 'status',\n      run: () => {\n        this.display.writeRaw('');\n      },\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["cov_odkrdt9cx","actualCoverage","existsSync","join","UnifiedOrchestrator","buildRepoWidePlan","workspaceRoot","additionalScopes","b","f","areas","s","id","label","description","scope","candidates","extra","trim","slug","replace","toLowerCase","push","modules","area","matches","some","candidate","steps","buildDefaultSteps","length","RepoUpgradeOrchestrator","constructor","executor","run","plan","options","mode","continueOnFailure","objective","results","findings","moduleReports","halted","module","status","emit","type","timestamp","Date","now","data","moduleId","moduleReport","step","outcome","runStep","winner","success","baseReport","generateReport","stepId","variant","primary","refiner","previousResult","undefined","winnerVariant","pickWinner","recordOutcomeArtifacts","intent","primaryScore","score","refinerScore","result","execution","output","summary","duration","durationMs","command","error","detail","prompt"],"sources":["repoUpgradeOrchestrator.ts"],"sourcesContent":["import { existsSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { UnifiedOrchestrator, type ExecutionResult, type Finding, type OperationReport } from './unifiedOrchestrator.js';\n\nexport type RepoUpgradeMode = 'single-continuous' | 'dual-rl-continuous';\n\nexport type UpgradeStepIntent = 'analyze' | 'upgrade' | 'verify' | 'cleanup';\n\nexport interface RepoUpgradeStep {\n  id: string;\n  intent: UpgradeStepIntent;\n  description: string;\n  /** Optional instruction or prompt to feed into the executor */\n  prompt?: string;\n}\n\nexport interface RepoUpgradeModule {\n  id: string;\n  label: string;\n  description: string;\n  scope: string[];\n  steps: RepoUpgradeStep[];\n}\n\nexport interface RepoUpgradePlan {\n  modules: RepoUpgradeModule[];\n}\n\nexport interface UpgradeStepExecutionInput {\n  module: RepoUpgradeModule;\n  step: RepoUpgradeStep;\n  /** Which path we are taking: single-pass primary or the dual RL refiner */\n  variant: 'primary' | 'refiner';\n  mode: RepoUpgradeMode;\n  previousResult?: UpgradeStepResult;\n}\n\nexport interface UpgradeStepResult {\n  success: boolean;\n  summary: string;\n  detail?: string;\n  score?: number;\n  durationMs?: number;\n  execution?: ExecutionResult;\n  findings?: Finding[];\n  notes?: string[];\n}\n\nexport interface UpgradeStepOutcome {\n  stepId: string;\n  intent: UpgradeStepIntent;\n  description: string;\n  primary: UpgradeStepResult;\n  refiner?: UpgradeStepResult;\n  winner: UpgradeStepResult;\n  winnerVariant: 'primary' | 'refiner';\n  status: 'completed' | 'failed';\n}\n\nexport interface UpgradeModuleReport {\n  id: string;\n  label: string;\n  scope: string[];\n  steps: UpgradeStepOutcome[];\n  status: 'completed' | 'failed' | 'skipped';\n}\n\nexport interface RepoUpgradeReport extends OperationReport {\n  mode: RepoUpgradeMode;\n  continueOnFailure: boolean;\n  modules: UpgradeModuleReport[];\n}\n\nexport interface RepoUpgradeRunOptions {\n  objective?: string;\n  mode: RepoUpgradeMode;\n  continueOnFailure?: boolean;\n}\n\nexport type UpgradeStepExecutor = (input: UpgradeStepExecutionInput) => Promise<UpgradeStepResult>;\n\n/**\n * Build a repo-wide upgrade plan using common directories. Falls back to a single\n * catch-all module when no known scopes are found.\n */\nexport function buildRepoWidePlan(workspaceRoot: string, additionalScopes: string[] = []): RepoUpgradePlan {\n  const areas: Array<{ id: string; label: string; description: string; scope: string[]; candidates: string[] }> = [\n    {\n      id: 'source',\n      label: 'Source',\n      description: 'Core application and library code.',\n      scope: ['src/**/*', 'lib/**/*'],\n      candidates: ['src', 'lib'],\n    },\n    {\n      id: 'tests',\n      label: 'Tests',\n      description: 'Unit, integration, and smoke tests.',\n      scope: ['test/**/*', '__tests__/**/*'],\n      candidates: ['test', '__tests__'],\n    },\n    {\n      id: 'docs',\n      label: 'Docs',\n      description: 'Documentation and guides.',\n      scope: ['docs/**/*', 'README.md'],\n      candidates: ['docs', 'README.md'],\n    },\n    {\n      id: 'scripts',\n      label: 'Tooling Scripts',\n      description: 'Build, migration, and maintenance scripts.',\n      scope: ['scripts/**/*'],\n      candidates: ['scripts'],\n    },\n  ];\n\n  for (const extra of additionalScopes) {\n    if (!extra?.trim()) continue;\n    const slug = extra.replace(/[^\\w]/g, '-').toLowerCase() || 'custom';\n    areas.push({\n      id: `custom-${slug}`,\n      label: `Custom: ${extra}`,\n      description: `User-specified scope: ${extra}`,\n      scope: [`${extra}/**/*`],\n      candidates: [extra],\n    });\n  }\n\n  const modules: RepoUpgradeModule[] = [];\n\n  for (const area of areas) {\n    const matches = area.candidates.some((candidate) => existsSync(join(workspaceRoot, candidate)));\n    if (!matches) {\n      continue;\n    }\n    modules.push({\n      id: area.id,\n      label: area.label,\n      description: area.description,\n      scope: area.scope,\n      steps: buildDefaultSteps(area.id),\n    });\n  }\n\n  if (modules.length === 0) {\n    modules.push({\n      id: 'repo-wide',\n      label: 'Repository',\n      description: 'Fallback repo-wide upgrade module.',\n      scope: ['**/*'],\n      steps: buildDefaultSteps('repo'),\n    });\n  }\n\n  return { modules };\n}\n\nexport class RepoUpgradeOrchestrator extends UnifiedOrchestrator {\n  private readonly executor: UpgradeStepExecutor;\n\n  constructor(executor: UpgradeStepExecutor) {\n    super();\n    this.executor = executor;\n  }\n\n  /**\n   * Execute the repo-wide plan using either single continuous or dual RL continuous mode.\n   */\n  async run(plan: RepoUpgradePlan, options: RepoUpgradeRunOptions): Promise<RepoUpgradeReport> {\n    const mode = options.mode;\n    const continueOnFailure = options.continueOnFailure ?? true;\n    const objective = options.objective ?? 'Repository-wide source code upgrade';\n\n    // Reset state per run to keep reports clean\n    this.results = [];\n    this.findings = [];\n\n    const moduleReports: UpgradeModuleReport[] = [];\n    let halted = false;\n\n    for (const module of plan.modules) {\n      if (halted) {\n        moduleReports.push({\n          id: module.id,\n          label: module.label,\n          scope: module.scope,\n          steps: [],\n          status: 'skipped',\n        });\n        continue;\n      }\n\n      this.emit({\n        type: 'upgrade.module.start',\n        timestamp: Date.now(),\n        data: { moduleId: module.id, label: module.label, scope: module.scope, mode },\n      });\n\n      const moduleReport: UpgradeModuleReport = {\n        id: module.id,\n        label: module.label,\n        scope: module.scope,\n        steps: [],\n        status: 'completed',\n      };\n\n      for (const step of module.steps) {\n        const outcome = await this.runStep(module, step, mode);\n        moduleReport.steps.push(outcome);\n\n        if (!outcome.winner.success) {\n          moduleReport.status = 'failed';\n          if (!continueOnFailure) {\n            halted = true;\n            break;\n          }\n        }\n      }\n\n      moduleReports.push(moduleReport);\n\n      this.emit({\n        type: 'upgrade.module.complete',\n        timestamp: Date.now(),\n        data: { moduleId: module.id, status: moduleReport.status },\n      });\n    }\n\n    const baseReport = this.generateReport(objective);\n    return { ...baseReport, mode, continueOnFailure, modules: moduleReports };\n  }\n\n  private async runStep(\n    module: RepoUpgradeModule,\n    step: RepoUpgradeStep,\n    mode: RepoUpgradeMode\n  ): Promise<UpgradeStepOutcome> {\n    this.emit({\n      type: 'upgrade.step.start',\n      timestamp: Date.now(),\n      data: { moduleId: module.id, stepId: step.id, variant: 'primary' },\n    });\n\n    const primary = await this.executor({ module, step, mode, variant: 'primary' });\n    const refiner =\n      mode === 'dual-rl-continuous'\n        ? await this.executor({ module, step, mode, variant: 'refiner', previousResult: primary })\n        : undefined;\n\n    const { winner, winnerVariant } = this.pickWinner(primary, refiner);\n    this.recordOutcomeArtifacts(module, step, winner, winnerVariant);\n\n    this.emit({\n      type: 'upgrade.step.complete',\n      timestamp: Date.now(),\n      data: { moduleId: module.id, stepId: step.id, variant: winnerVariant, success: winner.success },\n    });\n\n    return {\n      stepId: step.id,\n      intent: step.intent,\n      description: step.description,\n      primary,\n      refiner,\n      winner,\n      winnerVariant,\n      status: winner.success ? 'completed' : 'failed',\n    };\n  }\n\n  private pickWinner(\n    primary: UpgradeStepResult,\n    refiner?: UpgradeStepResult\n  ): { winner: UpgradeStepResult; winnerVariant: 'primary' | 'refiner' } {\n    if (!refiner) {\n      return { winner: primary, winnerVariant: 'primary' };\n    }\n\n    if (refiner.success && !primary.success) {\n      return { winner: refiner, winnerVariant: 'refiner' };\n    }\n    if (primary.success && !refiner.success) {\n      return { winner: primary, winnerVariant: 'primary' };\n    }\n\n    const primaryScore = typeof primary.score === 'number' ? primary.score : 0;\n    const refinerScore = typeof refiner.score === 'number' ? refiner.score : 0;\n\n    if (refinerScore > primaryScore) {\n      return { winner: refiner, winnerVariant: 'refiner' };\n    }\n    if (primaryScore > refinerScore) {\n      return { winner: primary, winnerVariant: 'primary' };\n    }\n\n    // Tie breaker: prefer refiner to encourage RL exploration\n    return { winner: refiner, winnerVariant: 'refiner' };\n  }\n\n  private recordOutcomeArtifacts(\n    module: RepoUpgradeModule,\n    step: RepoUpgradeStep,\n    result: UpgradeStepResult,\n    variant: 'primary' | 'refiner'\n  ): void {\n    if (result.findings?.length) {\n      this.findings.push(...result.findings);\n    }\n\n    const execution: ExecutionResult = result.execution ?? {\n      success: result.success,\n      output: result.summary,\n      duration: result.durationMs ?? 0,\n      command: `${module.id}/${step.id}/${variant}`,\n      error: result.success ? undefined : result.detail ?? result.summary,\n    };\n\n    // Ensure we only track a single winner record per step to keep reports clean\n    this.results.push(execution);\n  }\n}\n\nfunction buildDefaultSteps(moduleId: string): RepoUpgradeStep[] {\n  return [\n    {\n      id: `${moduleId}-analyze`,\n      intent: 'analyze',\n      description: `Map the upgrade surface for ${moduleId}. Identify risky files and coupling.`,\n      prompt: 'Inventory files, dependencies, and breaking-change areas before upgrading.',\n    },\n    {\n      id: `${moduleId}-upgrade`,\n      intent: 'upgrade',\n      description: `Apply modular upgrades for ${moduleId} with minimal blast radius.`,\n      prompt: 'Execute codemods or targeted edits. Keep edits small, atomic, and well scoped.',\n    },\n    {\n      id: `${moduleId}-verify`,\n      intent: 'verify',\n      description: `Validate ${moduleId} after the upgrade.`,\n      prompt: 'Run tests/lint/health checks relevant to this scope. Summarize residual risks.',\n    },\n  ];\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
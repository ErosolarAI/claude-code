{"version":3,"names":["cov_qq4e3mijx","actualCoverage","ErrorSeverity","ErrorCategory","StructuredError","DangerousOperationError","BlockedOperationError","ContextOverflowError","ResourceLimitError","ValidationError","toStructuredError","detectApiKeyError","detectNetworkError","buildError","StructuredErrorClass","detectApiKeyErrorFn","detectNetworkErrorFn","detectError","error","provider","f","apiKeyError","s","b","type","info","networkError","message","Error","String","stack","undefined","isRecoverableError","recoverable","retryable","getUserFriendlyMessage","toDisplayString","formatForLogging","context","timestamp","Date","toISOString","parts","push","severity","toUpperCase","category","metadata","JSON","stringify","join"],"sources":["index.ts"],"sourcesContent":["/**\n * Unified Error Handling System\n *\n * This module consolidates all error-related exports into a single entry point.\n * Use this module for all error handling needs instead of importing from\n * individual files.\n *\n * Architecture:\n * - errorTypes.ts: Base classes and structured error types\n * - apiKeyErrors.ts: API key and authentication errors\n * - networkErrors.ts: Network connectivity errors\n * - safetyValidator.ts: Input validation and safety checks\n *\n * Usage:\n * ```typescript\n * import {\n *   StructuredError,\n *   ErrorSeverity,\n *   ErrorCategory,\n *   DangerousOperationError,\n *   detectApiKeyError,\n *   detectNetworkError,\n * } from '../core/errors/index.js';\n * ```\n */\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Error Types and Base Classes\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport {\n  // Enums\n  ErrorSeverity,\n  ErrorCategory,\n\n  // Types\n  type ErrorSuggestion,\n  type StructuredErrorDetails,\n\n  // Base class\n  StructuredError,\n\n  // Specific error classes\n  DangerousOperationError,\n  BlockedOperationError,\n  ContextOverflowError,\n  ResourceLimitError,\n  ValidationError,\n\n  // Factory functions\n  toStructuredError,\n} from './errorTypes.js';\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// API Key Errors\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport {\n  type ApiKeyErrorType,\n  type ApiKeyErrorInfo,\n  detectApiKeyError,\n} from './apiKeyErrors.js';\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Network Errors\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport {\n  type NetworkErrorInfo,\n  detectNetworkError,\n} from './networkErrors.js';\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Safety Validator\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport * from './safetyValidator.js';\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Legacy Re-exports (from ../errors.ts)\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport {\n  type ErrorContextValue,\n  type ErrorContext,\n  buildError,\n} from '../errors.js';\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Utility Functions\n// ═══════════════════════════════════════════════════════════════════════════════\n\nimport {\n  StructuredError as StructuredErrorClass,\n  type StructuredErrorDetails as StructuredErrorDetailsType,\n} from './errorTypes.js';\nimport { detectApiKeyError as detectApiKeyErrorFn } from './apiKeyErrors.js';\nimport { detectNetworkError as detectNetworkErrorFn } from './networkErrors.js';\n\n/**\n * Detect and classify any error into a structured format\n */\nexport function detectError(error: unknown, provider?: string): {\n  type: 'api_key' | 'network' | 'structured' | 'unknown';\n  info: unknown;\n} {\n  // Check for API key errors first\n  const apiKeyError = detectApiKeyErrorFn(error, provider as Parameters<typeof detectApiKeyErrorFn>[1]);\n  if (apiKeyError) {\n    return { type: 'api_key', info: apiKeyError };\n  }\n\n  // Check for network errors\n  const networkError = detectNetworkErrorFn(error);\n  if (networkError) {\n    return { type: 'network', info: networkError };\n  }\n\n  // Check if it's already a structured error\n  if (error instanceof StructuredErrorClass) {\n    return { type: 'structured', info: error };\n  }\n\n  // Unknown error\n  return {\n    type: 'unknown',\n    info: {\n      message: error instanceof Error ? error.message : String(error),\n      stack: error instanceof Error ? error.stack : undefined,\n    },\n  };\n}\n\n/**\n * Check if an error is recoverable\n */\nexport function isRecoverableError(error: unknown): boolean {\n  // Structured errors have a recoverable flag\n  if (error instanceof StructuredErrorClass) {\n    return error.recoverable;\n  }\n\n  // Network errors are generally retryable\n  const networkError = detectNetworkErrorFn(error);\n  if (networkError) {\n    return networkError.retryable;\n  }\n\n  return false;\n}\n\n/**\n * Get a user-friendly error message\n */\nexport function getUserFriendlyMessage(error: unknown): string {\n  // Structured errors have their own display format\n  if (error instanceof StructuredErrorClass) {\n    return error.toDisplayString();\n  }\n\n  // API key errors\n  const apiKeyError = detectApiKeyErrorFn(error);\n  if (apiKeyError) {\n    if (apiKeyError.type === 'missing') {\n      return `Missing API key for ${apiKeyError.provider || 'provider'}. Please configure your API key.`;\n    }\n    return `Invalid API key for ${apiKeyError.provider || 'provider'}. Please check your API key configuration.`;\n  }\n\n  // Network errors\n  const networkError = detectNetworkErrorFn(error);\n  if (networkError) {\n    return `Network error: ${networkError.message}. Please check your internet connection and try again.`;\n  }\n\n  // Default\n  return error instanceof Error ? error.message : String(error);\n}\n\n/**\n * Format error for logging (includes full details)\n */\nexport function formatForLogging(error: unknown, context?: Record<string, unknown>): string {\n  const timestamp = new Date().toISOString();\n  const parts: string[] = [`[${timestamp}]`];\n\n  if (error instanceof StructuredErrorClass) {\n    parts.push(`[${error.severity.toUpperCase()}]`);\n    parts.push(`[${error.category}]`);\n    parts.push(error.message);\n    if (error.metadata) {\n      parts.push(`Metadata: ${JSON.stringify(error.metadata)}`);\n    }\n  } else if (error instanceof Error) {\n    parts.push(`[ERROR]`);\n    parts.push(error.message);\n    if (error.stack) {\n      parts.push(`Stack: ${error.stack}`);\n    }\n  } else {\n    parts.push(`[ERROR]`);\n    parts.push(String(error));\n  }\n\n  if (context) {\n    parts.push(`Context: ${JSON.stringify(context)}`);\n  }\n\n  return parts.join(' ');\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
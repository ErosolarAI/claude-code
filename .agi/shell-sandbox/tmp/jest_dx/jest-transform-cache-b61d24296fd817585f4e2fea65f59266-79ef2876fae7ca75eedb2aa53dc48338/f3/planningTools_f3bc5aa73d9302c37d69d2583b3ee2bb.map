{"version":3,"names":["cov_2qtpz1cik7","actualCoverage","_planApprovalCallback","s","setPlanApprovalCallback","callback","f","getPlanApprovalCallback","createPlanningTools","_workingDir","name","description","parameters","type","properties","steps","items","explanation","required","handler","args","length","b","Promise","resolve","planSteps","map","approved"],"sources":["planningTools.ts"],"sourcesContent":["/**\n * Planning Tools - Minimal stub for backward compatibility\n */\n\nimport type { ToolDefinition } from '../core/toolRuntime.js';\n\nexport interface PlanStep {\n  description: string;\n}\n\nexport type PlanApprovalCallback = (\n  steps: PlanStep[],\n  explanation: string,\n  resolve: (approved: boolean) => void\n) => void;\n\nlet _planApprovalCallback: PlanApprovalCallback | null = null;\n\nexport function setPlanApprovalCallback(callback: PlanApprovalCallback | null): void {\n  _planApprovalCallback = callback;\n}\n\nexport function getPlanApprovalCallback(): PlanApprovalCallback | null {\n  return _planApprovalCallback;\n}\n\nexport function createPlanningTools(_workingDir: string): ToolDefinition[] {\n  return [\n    {\n      name: 'UpdatePlan',\n      description: 'Present a multi-step plan to the user',\n      parameters: {\n        type: 'object',\n        properties: {\n          steps: {\n            type: 'array',\n            items: { type: 'string' },\n            description: 'Plan steps',\n          },\n          explanation: { type: 'string', description: 'Plan explanation' },\n        },\n        required: ['steps'],\n      },\n      handler: async (args) => {\n        const steps = args['steps'] as string[];\n        return `Plan with ${steps.length} steps presented.`;\n      },\n    },\n    {\n      name: 'ProposePlan',\n      description: 'Propose a plan for user approval',\n      parameters: {\n        type: 'object',\n        properties: {\n          steps: {\n            type: 'array',\n            items: { type: 'string' },\n            description: 'Plan steps',\n          },\n          explanation: { type: 'string', description: 'Plan explanation' },\n        },\n        required: ['steps'],\n      },\n      handler: async (args) => {\n        const steps = args['steps'] as string[];\n        const explanation = (args['explanation'] as string) || '';\n\n        if (_planApprovalCallback) {\n          return new Promise((resolve) => {\n            const planSteps: PlanStep[] = steps.map(s => ({ description: s }));\n            _planApprovalCallback!(planSteps, explanation, (approved) => {\n              resolve(approved ? 'Plan approved' : 'Plan rejected');\n            });\n          });\n        }\n        return `Plan with ${steps.length} steps proposed (auto-approved).`;\n      },\n    },\n    {\n      name: 'ExitPlanMode',\n      description: 'Signal that planning is complete',\n      parameters: {\n        type: 'object',\n        properties: {},\n      },\n      handler: async () => {\n        return 'Plan mode exited.';\n      },\n    },\n  ];\n}\n"],"mappings":"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","ignoreList":[]}
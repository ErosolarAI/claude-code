{"version":3,"names":["cov_1y17aql2z8","actualCoverage","OpenAIResponsesProvider","registerProvider","withProviderResilience","registered","s","registerOpenAIProviderPlugin","providerId","b","f","config","options","apiKey","requireEnv","model","reasoningEffort","textVerbosity","temperature","maxTokens","baseProvider","name","value","process","env","Error"],"sources":["index.ts"],"sourcesContent":["import { OpenAIResponsesProvider } from '../../../providers/openaiResponsesProvider.js';\nimport { registerProvider } from '../../../providers/providerFactory.js';\nimport { withProviderResilience } from '../../../providers/resilientProvider.js';\nimport type { ProviderId } from '../../../core/types.js';\n\nlet registered = false;\n\n/**\n * OpenAI Provider Plugin\n *\n * Registers the OpenAI provider with hardened error handling for:\n * - Network failures (premature close, connection reset)\n * - Stream errors (gunzip, decompression failures)\n * - Rate limiting with exponential backoff\n * - Circuit breaker for cascading failure prevention\n */\nexport function registerOpenAIProviderPlugin(providerId: ProviderId = 'openai'): void {\n  if (registered) {\n    return;\n  }\n\n  registerProvider(providerId, (config) => {\n    const options = {\n      apiKey: requireEnv('OPENAI_API_KEY'),\n      model: config.model,\n      providerId,\n      ...(config.reasoningEffort ? { reasoningEffort: config.reasoningEffort } : {}),\n      ...(config.textVerbosity ? { textVerbosity: config.textVerbosity } : {}),\n      ...(typeof config.temperature === 'number' ? { temperature: config.temperature } : {}),\n      ...(typeof config.maxTokens === 'number' ? { maxTokens: config.maxTokens } : {}),\n    };\n    const baseProvider = new OpenAIResponsesProvider(options);\n\n    // Wrap with resilience layer\n    return withProviderResilience(baseProvider, 'openai');\n  });\n\n  registered = true;\n}\n\nfunction requireEnv(name: string): string {\n  const value = process.env[name];\n  if (!value) {\n    throw new Error(`Missing required environment variable ${name}.`);\n  }\n  return value;\n}\n"],"mappings":"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","ignoreList":[]}
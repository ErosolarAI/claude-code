{"version":3,"names":["cov_icsxm47t0","actualCoverage","LiveStatusTracker","base","s","overrides","Map","subscribers","Set","subscribe","subscriber","f","add","current","currentState","b","delete","setBase","text","options","keepStart","startedAt","Date","now","detail","emit","pushOverride","id","existing","get","set","clearOverride","size","last","Array","from","values","pop","state","sub","exports"],"sources":["liveStatus.ts"],"sourcesContent":["export interface LiveStatusState {\n  text: string;\n  detail?: string;\n  startedAt: number;\n}\n\ntype Subscriber = (state: LiveStatusState) => void;\n\nexport class LiveStatusTracker {\n  private base: LiveStatusState | null = null;\n  private overrides = new Map<string, LiveStatusState>();\n  private subscribers = new Set<Subscriber>();\n\n  subscribe(subscriber: Subscriber): () => void {\n    this.subscribers.add(subscriber);\n    const current = this.currentState();\n    if (current) {\n      subscriber(current);\n    }\n    return () => {\n      this.subscribers.delete(subscriber);\n    };\n  }\n\n  setBase(text: string, options?: { detail?: string }): void {\n    const keepStart = this.base && this.base.text === text ? this.base.startedAt : Date.now();\n    this.base = { text, detail: options?.detail, startedAt: keepStart };\n    this.emit();\n  }\n\n  pushOverride(id: string, text: string, options?: { detail?: string }): () => void {\n    const existing = this.overrides.get(id);\n    const startedAt = existing && existing.text === text ? existing.startedAt : Date.now();\n    this.overrides.set(id, { text, detail: options?.detail, startedAt });\n    this.emit();\n    return () => this.clearOverride(id);\n  }\n\n  clearOverride(id: string): void {\n    this.overrides.delete(id);\n    this.emit();\n  }\n\n  private currentState(): LiveStatusState | null {\n    if (this.overrides.size) {\n      const last = Array.from(this.overrides.values()).pop();\n      if (last) return last;\n    }\n    return this.base;\n  }\n\n  private emit(): void {\n    const state = this.currentState();\n    if (!state) return;\n    for (const sub of this.subscribers) {\n      try {\n        sub(state);\n      } catch {\n        // ignore subscriber errors\n      }\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
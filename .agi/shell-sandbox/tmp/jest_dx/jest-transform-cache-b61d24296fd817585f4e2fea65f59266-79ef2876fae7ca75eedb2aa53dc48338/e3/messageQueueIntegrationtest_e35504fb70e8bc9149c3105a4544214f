7cc2dddafd22c2032c309da9bb95e645
"use strict";

var _globals = require("@jest/globals");
/**
 * Message Queue Integration Tests
 * Tests the critical race condition fix in streaming mode
 */

(0, _globals.describe)('Message Queue Integration', () => {
  (0, _globals.test)('Messages queue during streaming mode', () => {
    // Simulate the message queue behavior
    const pendingMessages = [];
    let isStreaming = true;

    // Simulate writeLocked behavior
    function writeLocked(content) {
      const payload = content.endsWith('\n') ? content : `${content}\n`;
      if (isStreaming) {
        pendingMessages.push({
          content: payload,
          timestamp: Date.now()
        });
      }
    }

    // Queue messages while streaming
    writeLocked('Message 1');
    writeLocked('Message 2');
    writeLocked('Message 3');
    (0, _globals.expect)(pendingMessages).toHaveLength(3);
    (0, _globals.expect)(pendingMessages[0]?.content).toBe('Message 1\n');
    (0, _globals.expect)(pendingMessages[1]?.content).toBe('Message 2\n');
    (0, _globals.expect)(pendingMessages[2]?.content).toBe('Message 3\n');
  });
  (0, _globals.test)('Messages flush in FIFO order', () => {
    const pendingMessages = [];
    const flushedMessages = [];

    // Queue messages
    pendingMessages.push({
      content: 'First\n',
      timestamp: Date.now()
    });
    pendingMessages.push({
      content: 'Second\n',
      timestamp: Date.now() + 1
    });
    pendingMessages.push({
      content: 'Third\n',
      timestamp: Date.now() + 2
    });

    // Flush in order
    while (pendingMessages.length > 0) {
      const msg = pendingMessages.shift();
      if (msg) {
        flushedMessages.push(msg.content);
      }
    }
    (0, _globals.expect)(flushedMessages).toEqual(['First\n', 'Second\n', 'Third\n']);
  });
  (0, _globals.test)('No messages lost on rapid streaming toggle', () => {
    const pendingMessages = [];
    const allMessages = [];
    let isStreaming = false;
    function writeLocked(content) {
      const payload = content.endsWith('\n') ? content : `${content}\n`;
      if (isStreaming) {
        pendingMessages.push({
          content: payload,
          timestamp: Date.now()
        });
      } else {
        // Flush pending first
        while (pendingMessages.length > 0) {
          const msg = pendingMessages.shift();
          if (msg) allMessages.push(msg.content);
        }
        allMessages.push(payload);
      }
    }

    // Rapid streaming mode changes
    for (let i = 0; i < 10; i++) {
      isStreaming = true;
      writeLocked(`Streaming ${i}`);
      isStreaming = false;
      writeLocked(`Normal ${i}`);
    }
    (0, _globals.expect)(allMessages).toHaveLength(20);
    (0, _globals.expect)(allMessages.filter(m => m.includes('Streaming'))).toHaveLength(10);
    (0, _globals.expect)(allMessages.filter(m => m.includes('Normal'))).toHaveLength(10);
  });
  (0, _globals.test)('Timestamps allow debugging of message delays', () => {
    const pendingMessages = [];
    const t1 = Date.now();
    pendingMessages.push({
      content: 'Msg 1',
      timestamp: t1
    });
    const t2 = Date.now() + 100;
    pendingMessages.push({
      content: 'Msg 2',
      timestamp: t2
    });
    const t3 = Date.now() + 200;
    pendingMessages.push({
      content: 'Msg 3',
      timestamp: t3
    });

    // Verify timestamps are increasing
    (0, _globals.expect)(pendingMessages[1].timestamp).toBeGreaterThan(pendingMessages[0].timestamp);
    (0, _globals.expect)(pendingMessages[2].timestamp).toBeGreaterThan(pendingMessages[1].timestamp);

    // Calculate delays
    const delay1 = pendingMessages[1].timestamp - pendingMessages[0].timestamp;
    const delay2 = pendingMessages[2].timestamp - pendingMessages[1].timestamp;
    (0, _globals.expect)(delay1).toBeGreaterThanOrEqual(100);
    (0, _globals.expect)(delay2).toBeGreaterThanOrEqual(100);
  });
  (0, _globals.test)('Empty messages are handled correctly', () => {
    const pendingMessages = [];
    let isStreaming = true;
    function writeLocked(content) {
      if (!content) return; // Guard against empty content

      const payload = content.endsWith('\n') ? content : `${content}\n`;
      if (isStreaming) {
        pendingMessages.push({
          content: payload,
          timestamp: Date.now()
        });
      }
    }
    writeLocked('');
    writeLocked('Valid message');
    writeLocked('');
    (0, _globals.expect)(pendingMessages).toHaveLength(1);
    (0, _globals.expect)(pendingMessages[0]?.content).toBe('Valid message\n');
  });
  (0, _globals.test)('Newline handling is consistent', () => {
    const messages = [];
    function addMessage(content) {
      const payload = content.endsWith('\n') ? content : `${content}\n`;
      messages.push(payload);
    }
    addMessage('Already has newline\n');
    addMessage('Needs newline');
    addMessage('Multiple\nlines\nhere');
    (0, _globals.expect)(messages[0]).toBe('Already has newline\n');
    (0, _globals.expect)(messages[1]).toBe('Needs newline\n');
    (0, _globals.expect)(messages[2]).toBe('Multiple\nlines\nhere\n');

    // All messages should end with exactly one newline
    messages.forEach(msg => {
      (0, _globals.expect)(msg.endsWith('\n')).toBe(true);
      (0, _globals.expect)(msg.endsWith('\n\n')).toBe(false);
    });
  });
  (0, _globals.test)('Message queue has bounded growth', () => {
    const maxMessages = /* TODO: Extract constant */1000;
    const pendingMessages = [];

    // Simulate rapid message generation
    for (let i = 0; i < maxMessages * 2; i++) {
      pendingMessages.push({
        content: `Message ${i}`,
        timestamp: Date.now()
      });

      // Simulate periodic flushing to prevent unbounded growth
      if (pendingMessages.length > maxMessages) {
        pendingMessages.shift(); // Remove oldest
      }
    }

    // Queue should not exceed max size
    (0, _globals.expect)(pendingMessages.length).toBeLessThanOrEqual(maxMessages);
  });
  (0, _globals.test)('Error during flush does not lose remaining messages', () => {
    const pendingMessages = [];
    const successfullyFlushed = [];
    const errors = [];
    pendingMessages.push({
      content: 'Message 1',
      timestamp: Date.now()
    });
    pendingMessages.push({
      content: 'BAD_MESSAGE',
      timestamp: Date.now()
    });
    pendingMessages.push({
      content: 'Message 3',
      timestamp: Date.now()
    });

    // Flush with error handling
    while (pendingMessages.length > 0) {
      const msg = pendingMessages.shift();
      if (msg) {
        try {
          if (msg.content === 'BAD_MESSAGE') {
            throw new Error('Simulated flush error');
          }
          successfullyFlushed.push(msg.content);
        } catch (error) {
          errors.push(msg.content);
          // Continue flushing despite error
        }
      }
    }
    (0, _globals.expect)(successfullyFlushed).toEqual(['Message 1', 'Message 3']);
    (0, _globals.expect)(errors).toEqual(['BAD_MESSAGE']);
    (0, _globals.expect)(pendingMessages).toHaveLength(0); // All messages processed
  });
  (0, _globals.test)('Stuck streaming state flushes pending messages on reset', () => {
    const pendingMessages = ['first\n', 'second\n'];
    const flushed = [];
    let streamingActive = true;
    let rendererMode = 'streaming';

    // Simulate the stopStreamingHeartbeat logic used by resetRendererStreamingMode
    function stopStreamingHeartbeat() {
      streamingActive = false;
      while (pendingMessages.length > 0) {
        const msg = pendingMessages.shift();
        if (msg) flushed.push(msg);
      }
    }
    function resetRendererStreamingMode(isProcessing) {
      if (isProcessing) return;
      const streamingStuck = rendererMode === 'streaming' || streamingActive;
      if (!streamingStuck) return;
      stopStreamingHeartbeat();
      rendererMode = 'idle';
    }
    resetRendererStreamingMode(false);
    (0, _globals.expect)(streamingActive).toBe(false);
    (0, _globals.expect)(rendererMode).toBe('idle');
    (0, _globals.expect)(flushed).toEqual(['first\n', 'second\n']);
    (0, _globals.expect)(pendingMessages).toHaveLength(0);
  });
});
(0, _globals.describe)('Streaming Mode State Transitions', () => {
  (0, _globals.test)('Detects double-entry to streaming mode', () => {
    const warnings = [];
    let streamingActive = false;
    function enterStreamingMode() {
      if (streamingActive) {
        warnings.push('enterStreamingMode() called while already in streaming mode');
      }
      streamingActive = true;
    }
    enterStreamingMode();
    enterStreamingMode(); // Should warn

    (0, _globals.expect)(warnings).toHaveLength(1);
    (0, _globals.expect)(warnings[0]).toContain('already in streaming mode');
  });
  (0, _globals.test)('Detects exit when not in streaming mode', () => {
    const warnings = [];
    let streamingActive = false;
    function exitStreamingMode() {
      if (!streamingActive) {
        warnings.push('exitStreamingMode() called while not in streaming mode');
      }
      streamingActive = false;
    }
    exitStreamingMode(); // Should warn

    (0, _globals.expect)(warnings).toHaveLength(1);
    (0, _globals.expect)(warnings[0]).toContain('not in streaming mode');
  });
  (0, _globals.test)('Clean state transitions work correctly', () => {
    const warnings = [];
    let streamingActive = false;
    function enterStreamingMode() {
      if (streamingActive) {
        warnings.push('enterStreamingMode() called while already in streaming mode');
      }
      streamingActive = true;
    }
    function exitStreamingMode() {
      if (!streamingActive) {
        warnings.push('exitStreamingMode() called while not in streaming mode');
      }
      streamingActive = false;
    }

    // Proper sequence
    enterStreamingMode();
    (0, _globals.expect)(streamingActive).toBe(true);
    exitStreamingMode();
    (0, _globals.expect)(streamingActive).toBe(false);
    enterStreamingMode();
    (0, _globals.expect)(streamingActive).toBe(true);
    exitStreamingMode();
    (0, _globals.expect)(streamingActive).toBe(false);
    (0, _globals.expect)(warnings).toHaveLength(0);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2xvYmFscyIsInJlcXVpcmUiLCJkZXNjcmliZSIsInRlc3QiLCJwZW5kaW5nTWVzc2FnZXMiLCJpc1N0cmVhbWluZyIsIndyaXRlTG9ja2VkIiwiY29udGVudCIsInBheWxvYWQiLCJlbmRzV2l0aCIsInB1c2giLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiZXhwZWN0IiwidG9IYXZlTGVuZ3RoIiwidG9CZSIsImZsdXNoZWRNZXNzYWdlcyIsImxlbmd0aCIsIm1zZyIsInNoaWZ0IiwidG9FcXVhbCIsImFsbE1lc3NhZ2VzIiwiaSIsImZpbHRlciIsIm0iLCJpbmNsdWRlcyIsInQxIiwidDIiLCJ0MyIsInRvQmVHcmVhdGVyVGhhbiIsImRlbGF5MSIsImRlbGF5MiIsInRvQmVHcmVhdGVyVGhhbk9yRXF1YWwiLCJtZXNzYWdlcyIsImFkZE1lc3NhZ2UiLCJmb3JFYWNoIiwibWF4TWVzc2FnZXMiLCJ0b0JlTGVzc1RoYW5PckVxdWFsIiwic3VjY2Vzc2Z1bGx5Rmx1c2hlZCIsImVycm9ycyIsIkVycm9yIiwiZXJyb3IiLCJmbHVzaGVkIiwic3RyZWFtaW5nQWN0aXZlIiwicmVuZGVyZXJNb2RlIiwic3RvcFN0cmVhbWluZ0hlYXJ0YmVhdCIsInJlc2V0UmVuZGVyZXJTdHJlYW1pbmdNb2RlIiwiaXNQcm9jZXNzaW5nIiwic3RyZWFtaW5nU3R1Y2siLCJ3YXJuaW5ncyIsImVudGVyU3RyZWFtaW5nTW9kZSIsInRvQ29udGFpbiIsImV4aXRTdHJlYW1pbmdNb2RlIl0sInNvdXJjZXMiOlsibWVzc2FnZVF1ZXVlSW50ZWdyYXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1lc3NhZ2UgUXVldWUgSW50ZWdyYXRpb24gVGVzdHNcbiAqIFRlc3RzIHRoZSBjcml0aWNhbCByYWNlIGNvbmRpdGlvbiBmaXggaW4gc3RyZWFtaW5nIG1vZGVcbiAqL1xuXG5pbXBvcnQgeyBkZXNjcmliZSwgdGVzdCwgZXhwZWN0LCBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5cbmRlc2NyaWJlKCdNZXNzYWdlIFF1ZXVlIEludGVncmF0aW9uJywgKCkgPT4ge1xuICB0ZXN0KCdNZXNzYWdlcyBxdWV1ZSBkdXJpbmcgc3RyZWFtaW5nIG1vZGUnLCAoKSA9PiB7XG4gICAgLy8gU2ltdWxhdGUgdGhlIG1lc3NhZ2UgcXVldWUgYmVoYXZpb3JcbiAgICBjb25zdCBwZW5kaW5nTWVzc2FnZXM6IEFycmF5PHtjb250ZW50OiBzdHJpbmc7IHRpbWVzdGFtcDogbnVtYmVyfT4gPSBbXTtcbiAgICBsZXQgaXNTdHJlYW1pbmcgPSB0cnVlO1xuXG4gICAgLy8gU2ltdWxhdGUgd3JpdGVMb2NrZWQgYmVoYXZpb3JcbiAgICBmdW5jdGlvbiB3cml0ZUxvY2tlZChjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgIGNvbnN0IHBheWxvYWQgPSBjb250ZW50LmVuZHNXaXRoKCdcXG4nKSA/IGNvbnRlbnQgOiBgJHtjb250ZW50fVxcbmA7XG5cbiAgICAgIGlmIChpc1N0cmVhbWluZykge1xuICAgICAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7XG4gICAgICAgICAgY29udGVudDogcGF5bG9hZCxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUXVldWUgbWVzc2FnZXMgd2hpbGUgc3RyZWFtaW5nXG4gICAgd3JpdGVMb2NrZWQoJ01lc3NhZ2UgMScpO1xuICAgIHdyaXRlTG9ja2VkKCdNZXNzYWdlIDInKTtcbiAgICB3cml0ZUxvY2tlZCgnTWVzc2FnZSAzJyk7XG5cbiAgICBleHBlY3QocGVuZGluZ01lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgZXhwZWN0KHBlbmRpbmdNZXNzYWdlc1swXT8uY29udGVudCkudG9CZSgnTWVzc2FnZSAxXFxuJyk7XG4gICAgZXhwZWN0KHBlbmRpbmdNZXNzYWdlc1sxXT8uY29udGVudCkudG9CZSgnTWVzc2FnZSAyXFxuJyk7XG4gICAgZXhwZWN0KHBlbmRpbmdNZXNzYWdlc1syXT8uY29udGVudCkudG9CZSgnTWVzc2FnZSAzXFxuJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ01lc3NhZ2VzIGZsdXNoIGluIEZJRk8gb3JkZXInLCAoKSA9PiB7XG4gICAgY29uc3QgcGVuZGluZ01lc3NhZ2VzOiBBcnJheTx7Y29udGVudDogc3RyaW5nOyB0aW1lc3RhbXA6IG51bWJlcn0+ID0gW107XG4gICAgY29uc3QgZmx1c2hlZE1lc3NhZ2VzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gUXVldWUgbWVzc2FnZXNcbiAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7IGNvbnRlbnQ6ICdGaXJzdFxcbicsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSB9KTtcbiAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7IGNvbnRlbnQ6ICdTZWNvbmRcXG4nLCB0aW1lc3RhbXA6IERhdGUubm93KCkgKyAxIH0pO1xuICAgIHBlbmRpbmdNZXNzYWdlcy5wdXNoKHsgY29udGVudDogJ1RoaXJkXFxuJywgdGltZXN0YW1wOiBEYXRlLm5vdygpICsgMiB9KTtcblxuICAgIC8vIEZsdXNoIGluIG9yZGVyXG4gICAgd2hpbGUgKHBlbmRpbmdNZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBtc2cgPSBwZW5kaW5nTWVzc2FnZXMuc2hpZnQoKTtcbiAgICAgIGlmIChtc2cpIHtcbiAgICAgICAgZmx1c2hlZE1lc3NhZ2VzLnB1c2gobXNnLmNvbnRlbnQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGV4cGVjdChmbHVzaGVkTWVzc2FnZXMpLnRvRXF1YWwoWydGaXJzdFxcbicsICdTZWNvbmRcXG4nLCAnVGhpcmRcXG4nXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ05vIG1lc3NhZ2VzIGxvc3Qgb24gcmFwaWQgc3RyZWFtaW5nIHRvZ2dsZScsICgpID0+IHtcbiAgICBjb25zdCBwZW5kaW5nTWVzc2FnZXM6IEFycmF5PHtjb250ZW50OiBzdHJpbmc7IHRpbWVzdGFtcDogbnVtYmVyfT4gPSBbXTtcbiAgICBjb25zdCBhbGxNZXNzYWdlczogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgaXNTdHJlYW1pbmcgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHdyaXRlTG9ja2VkKGNvbnRlbnQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgY29uc3QgcGF5bG9hZCA9IGNvbnRlbnQuZW5kc1dpdGgoJ1xcbicpID8gY29udGVudCA6IGAke2NvbnRlbnR9XFxuYDtcblxuICAgICAgaWYgKGlzU3RyZWFtaW5nKSB7XG4gICAgICAgIHBlbmRpbmdNZXNzYWdlcy5wdXNoKHsgY29udGVudDogcGF5bG9hZCwgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmx1c2ggcGVuZGluZyBmaXJzdFxuICAgICAgICB3aGlsZSAocGVuZGluZ01lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBtc2cgPSBwZW5kaW5nTWVzc2FnZXMuc2hpZnQoKTtcbiAgICAgICAgICBpZiAobXNnKSBhbGxNZXNzYWdlcy5wdXNoKG1zZy5jb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBhbGxNZXNzYWdlcy5wdXNoKHBheWxvYWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJhcGlkIHN0cmVhbWluZyBtb2RlIGNoYW5nZXNcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGlzU3RyZWFtaW5nID0gdHJ1ZTtcbiAgICAgIHdyaXRlTG9ja2VkKGBTdHJlYW1pbmcgJHtpfWApO1xuXG4gICAgICBpc1N0cmVhbWluZyA9IGZhbHNlO1xuICAgICAgd3JpdGVMb2NrZWQoYE5vcm1hbCAke2l9YCk7XG4gICAgfVxuXG4gICAgZXhwZWN0KGFsbE1lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMjApO1xuICAgIGV4cGVjdChhbGxNZXNzYWdlcy5maWx0ZXIobSA9PiBtLmluY2x1ZGVzKCdTdHJlYW1pbmcnKSkpLnRvSGF2ZUxlbmd0aCgxMCk7XG4gICAgZXhwZWN0KGFsbE1lc3NhZ2VzLmZpbHRlcihtID0+IG0uaW5jbHVkZXMoJ05vcm1hbCcpKSkudG9IYXZlTGVuZ3RoKDEwKTtcbiAgfSk7XG5cbiAgdGVzdCgnVGltZXN0YW1wcyBhbGxvdyBkZWJ1Z2dpbmcgb2YgbWVzc2FnZSBkZWxheXMnLCAoKSA9PiB7XG4gICAgY29uc3QgcGVuZGluZ01lc3NhZ2VzOiBBcnJheTx7Y29udGVudDogc3RyaW5nOyB0aW1lc3RhbXA6IG51bWJlcn0+ID0gW107XG5cbiAgICBjb25zdCB0MSA9IERhdGUubm93KCk7XG4gICAgcGVuZGluZ01lc3NhZ2VzLnB1c2goeyBjb250ZW50OiAnTXNnIDEnLCB0aW1lc3RhbXA6IHQxIH0pO1xuXG4gICAgY29uc3QgdDIgPSBEYXRlLm5vdygpICsgMTAwO1xuICAgIHBlbmRpbmdNZXNzYWdlcy5wdXNoKHsgY29udGVudDogJ01zZyAyJywgdGltZXN0YW1wOiB0MiB9KTtcblxuICAgIGNvbnN0IHQzID0gRGF0ZS5ub3coKSArIDIwMDtcbiAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7IGNvbnRlbnQ6ICdNc2cgMycsIHRpbWVzdGFtcDogdDMgfSk7XG5cbiAgICAvLyBWZXJpZnkgdGltZXN0YW1wcyBhcmUgaW5jcmVhc2luZ1xuICAgIGV4cGVjdChwZW5kaW5nTWVzc2FnZXNbMV0hLnRpbWVzdGFtcCkudG9CZUdyZWF0ZXJUaGFuKHBlbmRpbmdNZXNzYWdlc1swXSEudGltZXN0YW1wKTtcbiAgICBleHBlY3QocGVuZGluZ01lc3NhZ2VzWzJdIS50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbihwZW5kaW5nTWVzc2FnZXNbMV0hLnRpbWVzdGFtcCk7XG5cbiAgICAvLyBDYWxjdWxhdGUgZGVsYXlzXG4gICAgY29uc3QgZGVsYXkxID0gcGVuZGluZ01lc3NhZ2VzWzFdIS50aW1lc3RhbXAgLSBwZW5kaW5nTWVzc2FnZXNbMF0hLnRpbWVzdGFtcDtcbiAgICBjb25zdCBkZWxheTIgPSBwZW5kaW5nTWVzc2FnZXNbMl0hLnRpbWVzdGFtcCAtIHBlbmRpbmdNZXNzYWdlc1sxXSEudGltZXN0YW1wO1xuXG4gICAgZXhwZWN0KGRlbGF5MSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgxMDApO1xuICAgIGV4cGVjdChkZWxheTIpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMTAwKTtcbiAgfSk7XG5cbiAgdGVzdCgnRW1wdHkgbWVzc2FnZXMgYXJlIGhhbmRsZWQgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHBlbmRpbmdNZXNzYWdlczogQXJyYXk8e2NvbnRlbnQ6IHN0cmluZzsgdGltZXN0YW1wOiBudW1iZXJ9PiA9IFtdO1xuICAgIGxldCBpc1N0cmVhbWluZyA9IHRydWU7XG5cbiAgICBmdW5jdGlvbiB3cml0ZUxvY2tlZChjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgIGlmICghY29udGVudCkgcmV0dXJuOyAvLyBHdWFyZCBhZ2FpbnN0IGVtcHR5IGNvbnRlbnRcblxuICAgICAgY29uc3QgcGF5bG9hZCA9IGNvbnRlbnQuZW5kc1dpdGgoJ1xcbicpID8gY29udGVudCA6IGAke2NvbnRlbnR9XFxuYDtcblxuICAgICAgaWYgKGlzU3RyZWFtaW5nKSB7XG4gICAgICAgIHBlbmRpbmdNZXNzYWdlcy5wdXNoKHsgY29udGVudDogcGF5bG9hZCwgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHdyaXRlTG9ja2VkKCcnKTtcbiAgICB3cml0ZUxvY2tlZCgnVmFsaWQgbWVzc2FnZScpO1xuICAgIHdyaXRlTG9ja2VkKCcnKTtcblxuICAgIGV4cGVjdChwZW5kaW5nTWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICBleHBlY3QocGVuZGluZ01lc3NhZ2VzWzBdPy5jb250ZW50KS50b0JlKCdWYWxpZCBtZXNzYWdlXFxuJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ05ld2xpbmUgaGFuZGxpbmcgaXMgY29uc2lzdGVudCcsICgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGZ1bmN0aW9uIGFkZE1lc3NhZ2UoY29udGVudDogc3RyaW5nKTogdm9pZCB7XG4gICAgICBjb25zdCBwYXlsb2FkID0gY29udGVudC5lbmRzV2l0aCgnXFxuJykgPyBjb250ZW50IDogYCR7Y29udGVudH1cXG5gO1xuICAgICAgbWVzc2FnZXMucHVzaChwYXlsb2FkKTtcbiAgICB9XG5cbiAgICBhZGRNZXNzYWdlKCdBbHJlYWR5IGhhcyBuZXdsaW5lXFxuJyk7XG4gICAgYWRkTWVzc2FnZSgnTmVlZHMgbmV3bGluZScpO1xuICAgIGFkZE1lc3NhZ2UoJ011bHRpcGxlXFxubGluZXNcXG5oZXJlJyk7XG5cbiAgICBleHBlY3QobWVzc2FnZXNbMF0pLnRvQmUoJ0FscmVhZHkgaGFzIG5ld2xpbmVcXG4nKTtcbiAgICBleHBlY3QobWVzc2FnZXNbMV0pLnRvQmUoJ05lZWRzIG5ld2xpbmVcXG4nKTtcbiAgICBleHBlY3QobWVzc2FnZXNbMl0pLnRvQmUoJ011bHRpcGxlXFxubGluZXNcXG5oZXJlXFxuJyk7XG5cbiAgICAvLyBBbGwgbWVzc2FnZXMgc2hvdWxkIGVuZCB3aXRoIGV4YWN0bHkgb25lIG5ld2xpbmVcbiAgICBtZXNzYWdlcy5mb3JFYWNoKG1zZyA9PiB7XG4gICAgICBleHBlY3QobXNnLmVuZHNXaXRoKCdcXG4nKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtc2cuZW5kc1dpdGgoJ1xcblxcbicpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnTWVzc2FnZSBxdWV1ZSBoYXMgYm91bmRlZCBncm93dGgnLCAoKSA9PiB7XG4gICAgY29uc3QgbWF4TWVzc2FnZXMgPSAvKiBUT0RPOiBFeHRyYWN0IGNvbnN0YW50ICovIDEwMDA7XG4gICAgY29uc3QgcGVuZGluZ01lc3NhZ2VzOiBBcnJheTx7Y29udGVudDogc3RyaW5nOyB0aW1lc3RhbXA6IG51bWJlcn0+ID0gW107XG5cbiAgICAvLyBTaW11bGF0ZSByYXBpZCBtZXNzYWdlIGdlbmVyYXRpb25cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heE1lc3NhZ2VzICogMjsgaSsrKSB7XG4gICAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7IGNvbnRlbnQ6IGBNZXNzYWdlICR7aX1gLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfSk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHBlcmlvZGljIGZsdXNoaW5nIHRvIHByZXZlbnQgdW5ib3VuZGVkIGdyb3d0aFxuICAgICAgaWYgKHBlbmRpbmdNZXNzYWdlcy5sZW5ndGggPiBtYXhNZXNzYWdlcykge1xuICAgICAgICBwZW5kaW5nTWVzc2FnZXMuc2hpZnQoKTsgLy8gUmVtb3ZlIG9sZGVzdFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFF1ZXVlIHNob3VsZCBub3QgZXhjZWVkIG1heCBzaXplXG4gICAgZXhwZWN0KHBlbmRpbmdNZXNzYWdlcy5sZW5ndGgpLnRvQmVMZXNzVGhhbk9yRXF1YWwobWF4TWVzc2FnZXMpO1xuICB9KTtcblxuICB0ZXN0KCdFcnJvciBkdXJpbmcgZmx1c2ggZG9lcyBub3QgbG9zZSByZW1haW5pbmcgbWVzc2FnZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgcGVuZGluZ01lc3NhZ2VzOiBBcnJheTx7Y29udGVudDogc3RyaW5nOyB0aW1lc3RhbXA6IG51bWJlcn0+ID0gW107XG4gICAgY29uc3Qgc3VjY2Vzc2Z1bGx5Rmx1c2hlZDogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBwZW5kaW5nTWVzc2FnZXMucHVzaCh7IGNvbnRlbnQ6ICdNZXNzYWdlIDEnLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfSk7XG4gICAgcGVuZGluZ01lc3NhZ2VzLnB1c2goeyBjb250ZW50OiAnQkFEX01FU1NBR0UnLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfSk7XG4gICAgcGVuZGluZ01lc3NhZ2VzLnB1c2goeyBjb250ZW50OiAnTWVzc2FnZSAzJywgdGltZXN0YW1wOiBEYXRlLm5vdygpIH0pO1xuXG4gICAgLy8gRmx1c2ggd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgIHdoaWxlIChwZW5kaW5nTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgbXNnID0gcGVuZGluZ01lc3NhZ2VzLnNoaWZ0KCk7XG4gICAgICBpZiAobXNnKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKG1zZy5jb250ZW50ID09PSAnQkFEX01FU1NBR0UnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NpbXVsYXRlZCBmbHVzaCBlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzdWNjZXNzZnVsbHlGbHVzaGVkLnB1c2gobXNnLmNvbnRlbnQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGVycm9ycy5wdXNoKG1zZy5jb250ZW50KTtcbiAgICAgICAgICAvLyBDb250aW51ZSBmbHVzaGluZyBkZXNwaXRlIGVycm9yXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBleHBlY3Qoc3VjY2Vzc2Z1bGx5Rmx1c2hlZCkudG9FcXVhbChbJ01lc3NhZ2UgMScsICdNZXNzYWdlIDMnXSk7XG4gICAgZXhwZWN0KGVycm9ycykudG9FcXVhbChbJ0JBRF9NRVNTQUdFJ10pO1xuICAgIGV4cGVjdChwZW5kaW5nTWVzc2FnZXMpLnRvSGF2ZUxlbmd0aCgwKTsgLy8gQWxsIG1lc3NhZ2VzIHByb2Nlc3NlZFxuICB9KTtcblxuICB0ZXN0KCdTdHVjayBzdHJlYW1pbmcgc3RhdGUgZmx1c2hlcyBwZW5kaW5nIG1lc3NhZ2VzIG9uIHJlc2V0JywgKCkgPT4ge1xuICAgIGNvbnN0IHBlbmRpbmdNZXNzYWdlczogc3RyaW5nW10gPSBbJ2ZpcnN0XFxuJywgJ3NlY29uZFxcbiddO1xuICAgIGNvbnN0IGZsdXNoZWQ6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHN0cmVhbWluZ0FjdGl2ZSA9IHRydWU7XG4gICAgbGV0IHJlbmRlcmVyTW9kZTogJ2lkbGUnIHwgJ3N0cmVhbWluZycgPSAnc3RyZWFtaW5nJztcblxuICAgIC8vIFNpbXVsYXRlIHRoZSBzdG9wU3RyZWFtaW5nSGVhcnRiZWF0IGxvZ2ljIHVzZWQgYnkgcmVzZXRSZW5kZXJlclN0cmVhbWluZ01vZGVcbiAgICBmdW5jdGlvbiBzdG9wU3RyZWFtaW5nSGVhcnRiZWF0KCk6IHZvaWQge1xuICAgICAgc3RyZWFtaW5nQWN0aXZlID0gZmFsc2U7XG4gICAgICB3aGlsZSAocGVuZGluZ01lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgbXNnID0gcGVuZGluZ01lc3NhZ2VzLnNoaWZ0KCk7XG4gICAgICAgIGlmIChtc2cpIGZsdXNoZWQucHVzaChtc2cpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0UmVuZGVyZXJTdHJlYW1pbmdNb2RlKGlzUHJvY2Vzc2luZzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgaWYgKGlzUHJvY2Vzc2luZykgcmV0dXJuO1xuICAgICAgY29uc3Qgc3RyZWFtaW5nU3R1Y2sgPSByZW5kZXJlck1vZGUgPT09ICdzdHJlYW1pbmcnIHx8IHN0cmVhbWluZ0FjdGl2ZTtcbiAgICAgIGlmICghc3RyZWFtaW5nU3R1Y2spIHJldHVybjtcblxuICAgICAgc3RvcFN0cmVhbWluZ0hlYXJ0YmVhdCgpO1xuICAgICAgcmVuZGVyZXJNb2RlID0gJ2lkbGUnO1xuICAgIH1cblxuICAgIHJlc2V0UmVuZGVyZXJTdHJlYW1pbmdNb2RlKGZhbHNlKTtcblxuICAgIGV4cGVjdChzdHJlYW1pbmdBY3RpdmUpLnRvQmUoZmFsc2UpO1xuICAgIGV4cGVjdChyZW5kZXJlck1vZGUpLnRvQmUoJ2lkbGUnKTtcbiAgICBleHBlY3QoZmx1c2hlZCkudG9FcXVhbChbJ2ZpcnN0XFxuJywgJ3NlY29uZFxcbiddKTtcbiAgICBleHBlY3QocGVuZGluZ01lc3NhZ2VzKS50b0hhdmVMZW5ndGgoMCk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdTdHJlYW1pbmcgTW9kZSBTdGF0ZSBUcmFuc2l0aW9ucycsICgpID0+IHtcbiAgdGVzdCgnRGV0ZWN0cyBkb3VibGUtZW50cnkgdG8gc3RyZWFtaW5nIG1vZGUnLCAoKSA9PiB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHN0cmVhbWluZ0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gZW50ZXJTdHJlYW1pbmdNb2RlKCk6IHZvaWQge1xuICAgICAgaWYgKHN0cmVhbWluZ0FjdGl2ZSkge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKCdlbnRlclN0cmVhbWluZ01vZGUoKSBjYWxsZWQgd2hpbGUgYWxyZWFkeSBpbiBzdHJlYW1pbmcgbW9kZScpO1xuICAgICAgfVxuICAgICAgc3RyZWFtaW5nQWN0aXZlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBlbnRlclN0cmVhbWluZ01vZGUoKTtcbiAgICBlbnRlclN0cmVhbWluZ01vZGUoKTsgLy8gU2hvdWxkIHdhcm5cblxuICAgIGV4cGVjdCh3YXJuaW5ncykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh3YXJuaW5nc1swXSkudG9Db250YWluKCdhbHJlYWR5IGluIHN0cmVhbWluZyBtb2RlJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ0RldGVjdHMgZXhpdCB3aGVuIG5vdCBpbiBzdHJlYW1pbmcgbW9kZScsICgpID0+IHtcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgc3RyZWFtaW5nQWN0aXZlID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBleGl0U3RyZWFtaW5nTW9kZSgpOiB2b2lkIHtcbiAgICAgIGlmICghc3RyZWFtaW5nQWN0aXZlKSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goJ2V4aXRTdHJlYW1pbmdNb2RlKCkgY2FsbGVkIHdoaWxlIG5vdCBpbiBzdHJlYW1pbmcgbW9kZScpO1xuICAgICAgfVxuICAgICAgc3RyZWFtaW5nQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgZXhpdFN0cmVhbWluZ01vZGUoKTsgLy8gU2hvdWxkIHdhcm5cblxuICAgIGV4cGVjdCh3YXJuaW5ncykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIGV4cGVjdCh3YXJuaW5nc1swXSkudG9Db250YWluKCdub3QgaW4gc3RyZWFtaW5nIG1vZGUnKTtcbiAgfSk7XG5cbiAgdGVzdCgnQ2xlYW4gc3RhdGUgdHJhbnNpdGlvbnMgd29yayBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHN0cmVhbWluZ0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgZnVuY3Rpb24gZW50ZXJTdHJlYW1pbmdNb2RlKCk6IHZvaWQge1xuICAgICAgaWYgKHN0cmVhbWluZ0FjdGl2ZSkge1xuICAgICAgICB3YXJuaW5ncy5wdXNoKCdlbnRlclN0cmVhbWluZ01vZGUoKSBjYWxsZWQgd2hpbGUgYWxyZWFkeSBpbiBzdHJlYW1pbmcgbW9kZScpO1xuICAgICAgfVxuICAgICAgc3RyZWFtaW5nQWN0aXZlID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGl0U3RyZWFtaW5nTW9kZSgpOiB2b2lkIHtcbiAgICAgIGlmICghc3RyZWFtaW5nQWN0aXZlKSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goJ2V4aXRTdHJlYW1pbmdNb2RlKCkgY2FsbGVkIHdoaWxlIG5vdCBpbiBzdHJlYW1pbmcgbW9kZScpO1xuICAgICAgfVxuICAgICAgc3RyZWFtaW5nQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gUHJvcGVyIHNlcXVlbmNlXG4gICAgZW50ZXJTdHJlYW1pbmdNb2RlKCk7XG4gICAgZXhwZWN0KHN0cmVhbWluZ0FjdGl2ZSkudG9CZSh0cnVlKTtcblxuICAgIGV4aXRTdHJlYW1pbmdNb2RlKCk7XG4gICAgZXhwZWN0KHN0cmVhbWluZ0FjdGl2ZSkudG9CZShmYWxzZSk7XG5cbiAgICBlbnRlclN0cmVhbWluZ01vZGUoKTtcbiAgICBleHBlY3Qoc3RyZWFtaW5nQWN0aXZlKS50b0JlKHRydWUpO1xuXG4gICAgZXhpdFN0cmVhbWluZ01vZGUoKTtcbiAgICBleHBlY3Qoc3RyZWFtaW5nQWN0aXZlKS50b0JlKGZhbHNlKTtcblxuICAgIGV4cGVjdCh3YXJuaW5ncykudG9IYXZlTGVuZ3RoKDApO1xuICB9KTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQUtBLElBQUFBLFFBQUEsR0FBQUMsT0FBQTtBQUxBO0FBQ0E7QUFDQTtBQUNBOztBQUlBLElBQUFDLGlCQUFRLEVBQUMsMkJBQTJCLEVBQUUsTUFBTTtFQUMxQyxJQUFBQyxhQUFJLEVBQUMsc0NBQXNDLEVBQUUsTUFBTTtJQUNqRDtJQUNBLE1BQU1DLGVBQTRELEdBQUcsRUFBRTtJQUN2RSxJQUFJQyxXQUFXLEdBQUcsSUFBSTs7SUFFdEI7SUFDQSxTQUFTQyxXQUFXQSxDQUFDQyxPQUFlLEVBQVE7TUFDMUMsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUNFLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBR0YsT0FBTyxHQUFHLEdBQUdBLE9BQU8sSUFBSTtNQUVqRSxJQUFJRixXQUFXLEVBQUU7UUFDZkQsZUFBZSxDQUFDTSxJQUFJLENBQUM7VUFDbkJILE9BQU8sRUFBRUMsT0FBTztVQUNoQkcsU0FBUyxFQUFFQyxJQUFJLENBQUNDLEdBQUcsQ0FBQztRQUN0QixDQUFDLENBQUM7TUFDSjtJQUNGOztJQUVBO0lBQ0FQLFdBQVcsQ0FBQyxXQUFXLENBQUM7SUFDeEJBLFdBQVcsQ0FBQyxXQUFXLENBQUM7SUFDeEJBLFdBQVcsQ0FBQyxXQUFXLENBQUM7SUFFeEIsSUFBQVEsZUFBTSxFQUFDVixlQUFlLENBQUMsQ0FBQ1csWUFBWSxDQUFDLENBQUMsQ0FBQztJQUN2QyxJQUFBRCxlQUFNLEVBQUNWLGVBQWUsQ0FBQyxDQUFDLENBQUMsRUFBRUcsT0FBTyxDQUFDLENBQUNTLElBQUksQ0FBQyxhQUFhLENBQUM7SUFDdkQsSUFBQUYsZUFBTSxFQUFDVixlQUFlLENBQUMsQ0FBQyxDQUFDLEVB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
{"version":3,"names":["_nodeFs","require","_nodePath","_nodeUrl","_interopRequireWildcard","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","__filename","fileURLToPath","import","meta","url","__dirname","dirname","cachedSchema","getAgentSchemas","schemaPath","join","raw","readFileSync","parsed","JSON","parse","validateAgentSchemas","error","Error","message","String","getProviders","schemas","providers","getProvider","providerId","find","p","id","getModels","staticModels","models","modelDiscoveryModule","Promise","resolve","then","discoveredModels","getCachedDiscoveredModels","staticIds","Set","map","m","uniqueDiscovered","filter","getModelsByProvider","provider","getModel","modelId","getProfiles","profiles","getProfile","profileName","name","getSlashCommands","slashCommands","getCapabilities","capabilities","manifest","contractVersion","version","Array","isArray","length","providerIds","label","add","modelIds","model","profileNames","profile","defaultProvider","defaultModel","commands","cmd","command","description","cap","clearSchemaCache","isValidProvider","undefined","isValidModel","isValidProfile"],"sources":["agentSchemaLoader.ts"],"sourcesContent":["/**\n * Centralized agent schema loader.\n *\n * This module provides type-safe loading and validation of the centralized\n * agent configuration schema from src/contracts/agent-schemas.json.\n * All agent-related configuration should be loaded through this module\n * to ensure consistency across the application.\n */\n\nimport { readFileSync } from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\n// Contract types\nimport type { ProviderId } from './types.js';\nimport type { AgentProfileEntry } from '../contracts/v1/agentProfileManifest.js';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n\n/**\n * Provider configuration from centralized schema\n */\nexport interface ProviderConfig {\n  id: ProviderId;\n  label: string;\n  description?: string;\n  envVars?: {\n    apiKey?: string;\n  };\n  capabilities?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Model configuration from centralized schema\n */\nexport interface ModelConfig {\n  id: string;\n  label: string;\n  provider: ProviderId;\n  description?: string;\n  reasoningEffort?: 'low' | 'medium' | 'high';\n  temperature?: number;\n  maxTokens?: number;\n  capabilities?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Slash command configuration\n */\nexport interface SlashCommandConfig {\n  command: string;\n  description: string;\n  category?: 'configuration' | 'diagnostics' | 'workspace' | 'other';\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Capability definition\n */\nexport interface CapabilityConfig {\n  id: string;\n  label: string;\n  description?: string;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * The complete centralized agent schema\n */\nexport interface AgentSchemasManifest {\n  contractVersion: string;\n  version: string;\n  label?: string;\n  description?: string;\n  providers: ProviderConfig[];\n  models: ModelConfig[];\n  profiles: AgentProfileEntry[];\n  slashCommands?: SlashCommandConfig[];\n  capabilities?: CapabilityConfig[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Cached schema instance\n */\nlet cachedSchema: AgentSchemasManifest | null = null;\n\n/**\n * Load the centralized agent schemas manifest.\n * Results are cached for performance.\n *\n * @returns The complete agent schemas manifest\n * @throws Error if the schema file cannot be read or parsed\n */\nexport function getAgentSchemas(): AgentSchemasManifest {\n  if (cachedSchema) {\n    return cachedSchema;\n  }\n\n  try {\n    const schemaPath = join(__dirname, '..', 'contracts', 'agent-schemas.json');\n    const raw = readFileSync(schemaPath, 'utf-8');\n    const parsed = JSON.parse(raw) as AgentSchemasManifest;\n\n    // Basic validation\n    validateAgentSchemas(parsed);\n\n    cachedSchema = parsed;\n    return cachedSchema;\n  } catch (error) {\n    throw new Error(\n      `Failed to load agent schemas: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n\n/**\n * Get all provider configurations\n */\nexport function getProviders(): ProviderConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.providers;\n}\n\n/**\n * Get a specific provider by ID\n */\nexport function getProvider(providerId: ProviderId): ProviderConfig | undefined {\n  const providers = getProviders();\n  return providers.find((p) => p.id === providerId);\n}\n\n/**\n * Get all model configurations (includes both static and discovered models)\n */\nexport async function getModels(): Promise<ModelConfig[]> {\n  const schemas = getAgentSchemas();\n  const staticModels = schemas.models;\n\n  // Try to load discovered models\n  try {\n    // Use dynamic import for ESM compatibility\n    const modelDiscoveryModule = await import('./modelDiscovery.js');\n    const discoveredModels = modelDiscoveryModule.getCachedDiscoveredModels();\n\n    // Merge models, preferring static definitions over discovered ones\n    const staticIds = new Set(staticModels.map((m: ModelConfig) => m.id));\n    const uniqueDiscovered = discoveredModels.filter((m: ModelConfig) => !staticIds.has(m.id));\n\n    return [...staticModels, ...uniqueDiscovered];\n  } catch (error) {\n    // If discovery module fails, just return static models\n    return staticModels;\n  }\n}\n\n/**\n * Get models for a specific provider\n */\nexport async function getModelsByProvider(providerId: ProviderId): Promise<ModelConfig[]> {\n  const models = await getModels();\n  return models.filter((m) => m.provider === providerId);\n}\n\n/**\n * Get a specific model by ID\n */\nexport async function getModel(modelId: string): Promise<ModelConfig | undefined> {\n  const models = await getModels();\n  return models.find((m) => m.id === modelId);\n}\n\n/**\n * Get all agent profiles\n */\nexport function getProfiles(): AgentProfileEntry[] {\n  const schemas = getAgentSchemas();\n  return schemas.profiles;\n}\n\n/**\n * Get a specific profile by name\n */\nexport function getProfile(profileName: string): AgentProfileEntry | undefined {\n  const profiles = getProfiles();\n  return profiles.find((p) => p.name === profileName);\n}\n\n/**\n * Get all slash commands\n */\nexport function getSlashCommands(): SlashCommandConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.slashCommands ?? [];\n}\n\n/**\n * Get all capabilities\n */\nexport function getCapabilities(): CapabilityConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.capabilities ?? [];\n}\n\n/**\n * Validate the agent schemas manifest structure\n */\nfunction validateAgentSchemas(manifest: AgentSchemasManifest): void {\n  // Check required fields\n  if (!manifest.contractVersion) {\n    throw new Error('Missing required field: contractVersion');\n  }\n  if (!manifest.version) {\n    throw new Error('Missing required field: version');\n  }\n  if (!Array.isArray(manifest.providers) || manifest.providers.length === 0) {\n    throw new Error('Missing or empty required field: providers');\n  }\n  if (!Array.isArray(manifest.models) || manifest.models.length === 0) {\n    throw new Error('Missing or empty required field: models');\n  }\n  if (!Array.isArray(manifest.profiles) || manifest.profiles.length === 0) {\n    throw new Error('Missing or empty required field: profiles');\n  }\n\n  // Validate provider uniqueness\n  const providerIds = new Set<string>();\n  for (const provider of manifest.providers) {\n    if (!provider.id || !provider.label) {\n      throw new Error('Provider missing required fields: id, label');\n    }\n    if (providerIds.has(provider.id)) {\n      throw new Error(`Duplicate provider ID: ${provider.id}`);\n    }\n    providerIds.add(provider.id);\n  }\n\n  // Validate model uniqueness and provider references\n  const modelIds = new Set<string>();\n  for (const model of manifest.models) {\n    if (!model.id || !model.label || !model.provider) {\n      throw new Error('Model missing required fields: id, label, provider');\n    }\n    if (modelIds.has(model.id)) {\n      throw new Error(`Duplicate model ID: ${model.id}`);\n    }\n    if (!providerIds.has(model.provider)) {\n      throw new Error(`Model \"${model.id}\" references unknown provider: ${model.provider}`);\n    }\n    modelIds.add(model.id);\n  }\n\n  // Validate profile uniqueness and references\n  const profileNames = new Set<string>();\n  for (const profile of manifest.profiles) {\n    if (!profile.name || !profile.label || !profile.defaultProvider || !profile.defaultModel) {\n      throw new Error('Profile missing required fields: name, label, defaultProvider, defaultModel');\n    }\n    if (profileNames.has(profile.name)) {\n      throw new Error(`Duplicate profile name: ${profile.name}`);\n    }\n    if (!providerIds.has(profile.defaultProvider)) {\n      throw new Error(`Profile \"${profile.name}\" references unknown provider: ${profile.defaultProvider}`);\n    }\n    if (!modelIds.has(profile.defaultModel)) {\n      throw new Error(`Profile \"${profile.name}\" references unknown model: ${profile.defaultModel}`);\n    }\n    profileNames.add(profile.name);\n  }\n\n  // Validate slash commands uniqueness\n  if (manifest.slashCommands) {\n    const commands = new Set<string>();\n    for (const cmd of manifest.slashCommands) {\n      if (!cmd.command || !cmd.description) {\n        throw new Error('Slash command missing required fields: command, description');\n      }\n      if (commands.has(cmd.command)) {\n        throw new Error(`Duplicate slash command: ${cmd.command}`);\n      }\n      commands.add(cmd.command);\n    }\n  }\n\n  // Validate capabilities uniqueness\n  if (manifest.capabilities) {\n    const capabilities = new Set<string>();\n    for (const cap of manifest.capabilities) {\n      if (!cap.id || !cap.label) {\n        throw new Error('Capability missing required fields: id, label');\n      }\n      if (capabilities.has(cap.id)) {\n        throw new Error(`Duplicate capability ID: ${cap.id}`);\n      }\n      capabilities.add(cap.id);\n    }\n  }\n}\n\n/**\n * Clear the cached schema (useful for testing)\n */\nexport function clearSchemaCache(): void {\n  cachedSchema = null;\n}\n\n/**\n * Validate that a provider ID exists in the schema\n */\nexport function isValidProvider(providerId: string): providerId is ProviderId {\n  const provider = getProvider(providerId as ProviderId);\n  return provider !== undefined;\n}\n\n/**\n * Validate that a model ID exists in the schema\n */\nexport async function isValidModel(modelId: string): Promise<boolean> {\n  const model = await getModel(modelId);\n  return model !== undefined;\n}\n\n/**\n * Validate that a profile name exists in the schema\n */\nexport function isValidProfile(profileName: string): boolean {\n  const profile = getProfile(profileName);\n  return profile !== undefined;\n}\n"],"mappings":"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","ignoreList":[]}
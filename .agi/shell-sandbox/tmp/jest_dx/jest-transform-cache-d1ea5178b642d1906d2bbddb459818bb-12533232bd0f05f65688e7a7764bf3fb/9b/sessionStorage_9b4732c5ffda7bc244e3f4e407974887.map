{"version":3,"names":["_nodeFs","require","_nodePath","fsStorage","ensureDir","path","mkdirSync","recursive","writeFile","content","dirname","writeFileSync","readFile","readFileSync","exists","existsSync","activeStorage","setSessionStorage","storage","getSessionStorage","createInMemorySessionStorage","files","Map","_path","set","get","undefined","Error","has"],"sources":["sessionStorage.ts"],"sourcesContent":["import { mkdirSync, readFileSync, writeFileSync, existsSync } from 'node:fs';\nimport { dirname } from 'node:path';\n\nexport interface SessionStorage {\n  ensureDir(path: string): void;\n  writeFile(path: string, content: string): void;\n  readFile(path: string): string;\n  exists(path: string): boolean;\n}\n\nconst fsStorage: SessionStorage = {\n  ensureDir(path: string): void {\n    mkdirSync(path, { recursive: true });\n  },\n  writeFile(path: string, content: string): void {\n    mkdirSync(dirname(path), { recursive: true });\n    writeFileSync(path, content, 'utf8');\n  },\n  readFile(path: string): string {\n    return readFileSync(path, 'utf8');\n  },\n  exists(path: string): boolean {\n    return existsSync(path);\n  },\n};\n\nlet activeStorage: SessionStorage = fsStorage;\n\nexport function setSessionStorage(storage: SessionStorage): void {\n  activeStorage = storage;\n}\n\nexport function getSessionStorage(): SessionStorage {\n  return activeStorage;\n}\n\nexport function createInMemorySessionStorage(): SessionStorage {\n  const files = new Map<string, string>();\n  return {\n    ensureDir(_path: string): void {\n      // no-op for memory\n    },\n    writeFile(path: string, content: string): void {\n      files.set(path, content);\n    },\n    readFile(path: string): string {\n      const content = files.get(path);\n      if (content === undefined) {\n        throw new Error(`File not found: ${path}`);\n      }\n      return content;\n    },\n    exists(path: string): boolean {\n      return files.has(path);\n    },\n  };\n}\n"],"mappings":";;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AASA,MAAME,SAAyB,GAAG;EAChCC,SAASA,CAACC,IAAY,EAAQ;IAC5B,IAAAC,iBAAS,EAACD,IAAI,EAAE;MAAEE,SAAS,EAAE;IAAK,CAAC,CAAC;EACtC,CAAC;EACDC,SAASA,CAACH,IAAY,EAAEI,OAAe,EAAQ;IAC7C,IAAAH,iBAAS,EAAC,IAAAI,iBAAO,EAACL,IAAI,CAAC,EAAE;MAAEE,SAAS,EAAE;IAAK,CAAC,CAAC;IAC7C,IAAAI,qBAAa,EAACN,IAAI,EAAEI,OAAO,EAAE,MAAM,CAAC;EACtC,CAAC;EACDG,QAAQA,CAACP,IAAY,EAAU;IAC7B,OAAO,IAAAQ,oBAAY,EAACR,IAAI,EAAE,MAAM,CAAC;EACnC,CAAC;EACDS,MAAMA,CAACT,IAAY,EAAW;IAC5B,OAAO,IAAAU,kBAAU,EAACV,IAAI,CAAC;EACzB;AACF,CAAC;AAED,IAAIW,aAA6B,GAAGb,SAAS;AAEtC,SAASc,iBAAiBA,CAACC,OAAuB,EAAQ;EAC/DF,aAAa,GAAGE,OAAO;AACzB;AAEO,SAASC,iBAAiBA,CAAA,EAAmB;EAClD,OAAOH,aAAa;AACtB;AAEO,SAASI,4BAA4BA,CAAA,EAAmB;EAC7D,MAAMC,KAAK,GAAG,IAAIC,GAAG,CAAiB,CAAC;EACvC,OAAO;IACLlB,SAASA,CAACmB,KAAa,EAAQ;MAC7B;IAAA,CACD;IACDf,SAASA,CAACH,IAAY,EAAEI,OAAe,EAAQ;MAC7CY,KAAK,CAACG,GAAG,CAACnB,IAAI,EAAEI,OAAO,CAAC;IAC1B,CAAC;IACDG,QAAQA,CAACP,IAAY,EAAU;MAC7B,MAAMI,OAAO,GAAGY,KAAK,CAACI,GAAG,CAACpB,IAAI,CAAC;MAC/B,IAAII,OAAO,KAAKiB,SAAS,EAAE;QACzB,MAAM,IAAIC,KAAK,CAAC,mBAAmBtB,IAAI,EAAE,CAAC;MAC5C;MACA,OAAOI,OAAO;IAChB,CAAC;IACDK,MAAMA,CAACT,IAAY,EAAW;MAC5B,OAAOgB,KAAK,CAACO,GAAG,CAACvB,IAAI,CAAC;IACxB;EACF,CAAC;AACH","ignoreList":[]}
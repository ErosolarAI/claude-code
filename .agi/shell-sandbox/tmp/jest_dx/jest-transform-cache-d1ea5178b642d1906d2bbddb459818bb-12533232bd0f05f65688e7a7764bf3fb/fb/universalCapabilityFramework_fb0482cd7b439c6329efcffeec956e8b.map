{"version":3,"names":["_events","require","fs","_interopRequireWildcard","path","os","crypto","_child_process","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","UniversalCapabilityFramework","EventEmitter","config","capabilities","Map","dependencyGraph","nodes","edges","topologicalOrder","hasCycles","sharedUtilities","eventBus","contextManager","toolRegistry","constructor","rootDir","process","cwd","debug","enableEvents","enableDependencyResolution","sharedDataDir","join","tmpdir","pluginPatterns","SharedUniversalUtilities","ContextManager","ToolRegistry","initializeFramework","mkdirSync","recursive","log","registerCapability","module","metadata","registration","instance","status","dependencies","dependents","id","updateDependencyGraph","version","activateCapability","capabilityId","Error","activateDependencies","context","profile","workspaceContext","workingDir","env","result","create","emit","error","depId","depRegistration","getCapability","executeOperation","operation","parameters","operationId","randomUUID","startTime","Date","now","results","capability","execute","message","String","duration","success","Set","add","detectCycles","topologicalSort","visited","recStack","dfs","nodeId","neighbor","delete","keys","order","unshift","level","data","timestamp","toISOString","logEntry","console","toUpperCase","JSON","stringify","getConfig","listCapabilities","Array","from","values","getDependencyGraph","getSharedUtilities","getEventBus","getToolRegistry","exports","generateOperationId","prefix","random","randomBytes","toString","createOperationDir","dirPath","saveToSharedStorage","fileName","opDir","filePath","content","writeFileSync","readFromSharedStorage","existsSync","readFileSync","deepMerge","target","sources","source","key","isArray","validateConfig","schema","errors","validateObject","obj","sch","type","properties","propSchema","entries","fullPath","typedPropSchema","required","undefined","push","valid","length","executeWithRetry","maxRetries","delay","lastError","attempt","Promise","resolve","setTimeout","createToolDefinition","name","description","handler","contexts","defaultContext","setContext","value","getContext","clearContext","getAllContexts","fromEntries","saveContexts","loadContexts","parse","tools","toolSuites","registerTool","tool","registerToolSuite","suite","getTool","getToolSuite","listTools","listToolSuites","searchTools","criteria","filter","UniversalCapabilityModule","framework","utilities","initialize","cleanup","params","logData","emitEvent","createFallbackFileTool","args","UniversalCapabilityFactory","capabilityRegistry","createCapability","Constructor","listCapabilityTypes","UniversalFilesystemCapability","author","provides","requires","category","tags","createFileTools","then","toolSuite","platform","fallback","opId","readFile","writeFile","listDirectory","searchFiles","pattern","items","readdirSync","withFileTypes","item","isDirectory","basePath","files","searchDir","dir","stat","statSync","includes","UniversalBashCapability","createBashTools","shell","SHELL","createFallbackBashTool","command","execSync","encoding","timeout","trim","output","exitCode","stderr","UniversalSearchCapability","createSearchTools","createFallbackSearchTool","search","UniversalEditCapability","createEditTools","createFallbackEditTool","file_path","old_string","new_string","newContent","replace","_default"],"sources":["universalCapabilityFramework.ts"],"sourcesContent":["/**\n * UNIVERSAL CAPABILITY FRAMEWORK\n * \n * A unified framework for all AGI capabilities that promotes code reuse,\n * consistent patterns, and cross-module integration.\n * \n * KEY PRINCIPLES:\n * 1. Single Source of Truth - Common utilities used by all capabilities\n * 2. Dependency Injection - Capabilities declare dependencies\n * 3. Event-Driven Architecture - Cross-module communication via events\n * 4. Pluggable Architecture - Capabilities can be registered/unregistered at runtime\n * 5. Type Safety - Full TypeScript support with generic types\n */\n\nimport type { \n  CapabilityContribution, \n  CapabilityContext, \n  CapabilityModule \n} from '../runtime/agentHost.js';\nimport type { ToolSuite, ToolDefinition } from '../core/toolRuntime.js';\nimport { EventEmitter } from 'events';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport * as os from 'os';\nimport * as crypto from 'crypto';\nimport { execSync } from 'child_process';\n\n// ============================================================================\n// UNIVERSAL FRAMEWORK TYPES\n// ============================================================================\n\nexport interface UniversalCapabilityConfig {\n  /** Root directory for framework operations */\n  rootDir: string;\n  /** Enable debug logging */\n  debug: boolean;\n  /** Enable cross-capability events */\n  enableEvents: boolean;\n  /** Enable dependency resolution */\n  enableDependencyResolution: boolean;\n  /** Shared data directory */\n  sharedDataDir: string;\n  /** Plugin discovery patterns */\n  pluginPatterns: string[];\n}\n\nexport interface CapabilityMetadata {\n  id: string;\n  version: string;\n  description: string;\n  author: string;\n  dependencies: string[];\n  provides: string[];\n  requires: string[];\n  category: string;\n  tags: string[];\n  configurationSchema?: Record<string, any>;\n}\n\nexport interface CapabilityRegistration {\n  module: CapabilityModule;\n  metadata: CapabilityMetadata;\n  instance: any;\n  status: 'registered' | 'active' | 'error' | 'disabled';\n  dependencies: string[];\n  dependents: string[];\n}\n\nexport interface UniversalFrameworkEvent {\n  type: string;\n  source: string;\n  timestamp: number;\n  data: any;\n  correlationId?: string;\n}\n\nexport interface DependencyGraph {\n  nodes: Map<string, CapabilityRegistration>;\n  edges: Map<string, Set<string>>;\n  topologicalOrder: string[];\n  hasCycles: boolean;\n}\n\n// ============================================================================\n// UNIVERSAL FRAMEWORK CORE\n// ============================================================================\n\nexport class UniversalCapabilityFramework extends EventEmitter {\n  private config: UniversalCapabilityConfig;\n  private capabilities: Map<string, CapabilityRegistration> = new Map();\n  private dependencyGraph: DependencyGraph = {\n    nodes: new Map(),\n    edges: new Map(),\n    topologicalOrder: [],\n    hasCycles: false\n  };\n  private sharedUtilities: SharedUniversalUtilities;\n  private eventBus: EventEmitter;\n  private contextManager: ContextManager;\n  private toolRegistry: ToolRegistry;\n\n  constructor(config: Partial<UniversalCapabilityConfig> = {}) {\n    super();\n    \n    this.config = {\n      rootDir: config.rootDir || process.cwd(),\n      debug: config.debug || false,\n      enableEvents: config.enableEvents || true,\n      enableDependencyResolution: config.enableDependencyResolution || true,\n      sharedDataDir: config.sharedDataDir || path.join(os.tmpdir(), 'agi-universal-framework'),\n      pluginPatterns: config.pluginPatterns || ['**/*.ts', '**/*.js']\n    };\n\n    this.sharedUtilities = new SharedUniversalUtilities(this.config);\n    this.eventBus = new EventEmitter();\n    this.contextManager = new ContextManager();\n    this.toolRegistry = new ToolRegistry();\n\n    this.initializeFramework();\n  }\n\n  private initializeFramework(): void {\n    // Create shared directories\n    fs.mkdirSync(this.config.sharedDataDir, { recursive: true });\n    \n    // Initialize shared utilities\n    this.sharedUtilities = new SharedUniversalUtilities(this.config);\n    \n    // Initialize core systems\n    this.contextManager = new ContextManager();\n    this.toolRegistry = new ToolRegistry();\n\n    this.log('info', 'Universal Framework initialized', {\n      rootDir: this.config.rootDir,\n      sharedDataDir: this.config.sharedDataDir\n    });\n  }\n\n  /**\n   * Register a capability with the framework\n   */\n  async registerCapability(\n    module: CapabilityModule,\n    metadata: CapabilityMetadata\n  ): Promise<CapabilityRegistration> {\n    const registration: CapabilityRegistration = {\n      module,\n      metadata,\n      instance: null,\n      status: 'registered',\n      dependencies: metadata.dependencies || [],\n      dependents: []\n    };\n\n    this.capabilities.set(metadata.id, registration);\n    this.updateDependencyGraph();\n\n    this.log('info', `Capability registered: ${metadata.id}`, {\n      version: metadata.version,\n      dependencies: metadata.dependencies\n    });\n\n    return registration;\n  }\n\n  /**\n   * Activate a capability (resolve dependencies and initialize)\n   */\n  async activateCapability(capabilityId: string): Promise<CapabilityRegistration> {\n    const registration = this.capabilities.get(capabilityId);\n    if (!registration) {\n      throw new Error(`Capability not found: ${capabilityId}`);\n    }\n\n    if (registration.status === 'active') {\n      return registration;\n    }\n\n    // Resolve and activate dependencies\n    if (this.config.enableDependencyResolution) {\n      await this.activateDependencies(capabilityId);\n    }\n\n    // Initialize capability instance\n    try {\n      // Create context for capability\n      const context: CapabilityContext = {\n        profile: 'default',\n        workspaceContext: null,\n        workingDir: this.config.rootDir,\n        env: process.env\n      };\n\n      // Create capability instance\n      const result = await registration.module.create(context);\n      registration.instance = result;\n      registration.status = 'active';\n\n      this.log('info', `Capability activated: ${capabilityId}`);\n      this.emit('capability:activated', {\n        capabilityId,\n        registration\n      });\n\n    } catch (error) {\n      registration.status = 'error';\n      this.log('error', `Failed to activate capability ${capabilityId}`, error);\n      throw error;\n    }\n\n    return registration;\n  }\n\n  /**\n   * Activate all dependencies for a capability\n   */\n  private async activateDependencies(capabilityId: string): Promise<void> {\n    const registration = this.capabilities.get(capabilityId);\n    if (!registration) return;\n\n    for (const depId of registration.dependencies) {\n      const depRegistration = this.capabilities.get(depId);\n      if (!depRegistration) {\n        throw new Error(`Dependency not found: ${depId} required by ${capabilityId}`);\n      }\n\n      if (depRegistration.status !== 'active') {\n        await this.activateCapability(depId);\n      }\n    }\n  }\n\n  /**\n   * Get a capability instance\n   */\n  getCapability<T = any>(capabilityId: string): T | null {\n    const registration = this.capabilities.get(capabilityId);\n    if (!registration || registration.status !== 'active') {\n      return null;\n    }\n    return registration.instance as T;\n  }\n\n  /**\n   * Execute a cross-capability operation\n   */\n  async executeOperation(\n    operation: string,\n    parameters: Record<string, any>,\n    capabilities: string[]\n  ): Promise<any> {\n    const operationId = crypto.randomUUID();\n    const startTime = Date.now();\n\n    this.log('info', `Starting cross-capability operation: ${operation}`, {\n      operationId,\n      capabilities\n    });\n\n    this.emit('operation:started', {\n      operationId,\n      operation,\n      parameters,\n      capabilities\n    });\n\n    // Activate required capabilities\n    for (const capabilityId of capabilities) {\n      await this.activateCapability(capabilityId);\n    }\n\n    // Execute operation across capabilities\n    const results: Record<string, any> = {};\n    for (const capabilityId of capabilities) {\n      const capability = this.getCapability(capabilityId);\n      if (capability && typeof (capability as any).execute === 'function') {\n        try {\n          results[capabilityId] = await (capability as any).execute({\n            operation,\n            parameters,\n            operationId\n          });\n        } catch (error) {\n          results[capabilityId] = { \n            error: error instanceof Error ? error.message : String(error) \n          };\n        }\n      }\n    }\n\n    const duration = Date.now() - startTime;\n    \n    this.log('info', `Completed cross-capability operation: ${operation}`, {\n      operationId,\n      duration,\n      success: true\n    });\n\n    this.emit('operation:completed', {\n      operationId,\n      operation,\n      parameters,\n      results,\n      duration\n    });\n\n    return results;\n  }\n\n  /**\n   * Update dependency graph\n   */\n  private updateDependencyGraph(): void {\n    this.dependencyGraph.nodes = this.capabilities;\n    this.dependencyGraph.edges = new Map();\n    \n    // Build edges\n    for (const [id, registration] of this.capabilities) {\n      const edges = new Set<string>();\n      for (const depId of registration.dependencies) {\n        edges.add(depId);\n      }\n      this.dependencyGraph.edges.set(id, edges);\n    }\n\n    // Detect cycles\n    this.dependencyGraph.hasCycles = this.detectCycles();\n    \n    // Calculate topological order\n    this.dependencyGraph.topologicalOrder = this.topologicalSort();\n  }\n\n  private detectCycles(): boolean {\n    const visited = new Set<string>();\n    const recStack = new Set<string>();\n\n    const dfs = (nodeId: string): boolean => {\n      if (recStack.has(nodeId)) return true;\n      if (visited.has(nodeId)) return false;\n\n      visited.add(nodeId);\n      recStack.add(nodeId);\n\n      const edges = this.dependencyGraph.edges.get(nodeId) || new Set();\n      for (const neighbor of edges) {\n        if (dfs(neighbor)) return true;\n      }\n\n      recStack.delete(nodeId);\n      return false;\n    };\n\n    for (const nodeId of this.dependencyGraph.nodes.keys()) {\n      if (dfs(nodeId)) return true;\n    }\n\n    return false;\n  }\n\n  private topologicalSort(): string[] {\n    const visited = new Set<string>();\n    const order: string[] = [];\n\n    const dfs = (nodeId: string): void => {\n      if (visited.has(nodeId)) return;\n      visited.add(nodeId);\n\n      const edges = this.dependencyGraph.edges.get(nodeId) || new Set();\n      for (const neighbor of edges) {\n        dfs(neighbor);\n      }\n\n      order.unshift(nodeId);\n    };\n\n    for (const nodeId of this.dependencyGraph.nodes.keys()) {\n      dfs(nodeId);\n    }\n\n    return order;\n  }\n\n  /**\n   * Logging utility\n   */\n  private log(level: 'info' | 'warn' | 'error', message: string, data?: any): void {\n    if (!this.config.debug && level === 'info') return;\n\n    const timestamp = new Date().toISOString();\n    const logEntry = {\n      timestamp,\n      level,\n      message,\n      data\n    };\n\n    console.log(`[${timestamp}] [${level.toUpperCase()}] ${message}`);\n    \n    if (data && this.config.debug) {\n      console.log(JSON.stringify(data, null, 2));\n    }\n\n    this.emit('log', logEntry);\n  }\n\n  // ============================================================================\n  // PUBLIC API\n  // ============================================================================\n\n  /**\n   * Get framework configuration\n   */\n  getConfig(): UniversalCapabilityConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * List all registered capabilities\n   */\n  listCapabilities(): CapabilityRegistration[] {\n    return Array.from(this.capabilities.values());\n  }\n\n  /**\n   * Get dependency graph\n   */\n  getDependencyGraph(): DependencyGraph {\n    return { ...this.dependencyGraph };\n  }\n\n  /**\n   * Get shared utilities\n   */\n  getSharedUtilities(): SharedUniversalUtilities {\n    return this.sharedUtilities;\n  }\n\n  /**\n   * Get event bus\n   */\n  getEventBus(): EventEmitter {\n    return this.eventBus;\n  }\n\n  /**\n   * Get tool registry\n   */\n  getToolRegistry(): ToolRegistry {\n    return this.toolRegistry;\n  }\n}\n\n// ============================================================================\n// SHARED UNIVERSAL UTILITIES\n// ============================================================================\n\nexport class SharedUniversalUtilities {\n  constructor(private config: UniversalCapabilityConfig) {}\n\n  /**\n   * Generate unique operation ID\n   */\n  generateOperationId(prefix: string = 'op'): string {\n    const timestamp = Date.now();\n    const random = crypto.randomBytes(8).toString('hex');\n    return `${prefix}_${timestamp}_${random}`;\n  }\n\n  /**\n   * Create shared data directory for operation\n   */\n  createOperationDir(operationId: string): string {\n    const dirPath = path.join(this.config.sharedDataDir, 'operations', operationId);\n    fs.mkdirSync(dirPath, { recursive: true });\n    return dirPath;\n  }\n\n  /**\n   * Save evidence/data to shared storage\n   */\n  saveToSharedStorage(operationId: string, fileName: string, data: any): string {\n    const opDir = this.createOperationDir(operationId);\n    const filePath = path.join(opDir, fileName);\n    \n    const content = typeof data === 'string' ? data : JSON.stringify(data, null, 2);\n    fs.writeFileSync(filePath, content, 'utf8');\n    \n    return filePath;\n  }\n\n  /**\n   * Read from shared storage\n   */\n  readFromSharedStorage(operationId: string, fileName: string): string | null {\n    const filePath = path.join(this.config.sharedDataDir, 'operations', operationId, fileName);\n    if (!fs.existsSync(filePath)) return null;\n    \n    return fs.readFileSync(filePath, 'utf8');\n  }\n\n  /**\n   * Merge multiple objects (deep merge)\n   */\n  deepMerge<T extends Record<string, any>>(target: T, ...sources: Partial<T>[]): T {\n    const result = { ...target };\n    \n    for (const source of sources) {\n      for (const key in source) {\n        if (source[key] !== null && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n          if (!result[key] || typeof result[key] !== 'object') {\n            result[key] = {} as any;\n          }\n          result[key] = this.deepMerge(result[key], source[key]);\n        } else {\n          result[key] = source[key] as any;\n        }\n      }\n    }\n    \n    return result;\n  }\n\n  /**\n   * Validate configuration against schema\n   */\n  validateConfig(config: any, schema: Record<string, any>): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n    \n    const validateObject = (obj: any, sch: any, path: string = ''): void => {\n      if (sch.type === 'object' && sch.properties) {\n        for (const [key, propSchema] of Object.entries(sch.properties)) {\n          const fullPath = path ? `${path}.${key}` : key;\n          \n          const typedPropSchema = propSchema as { required?: boolean };\n          if (typedPropSchema.required && obj[key] === undefined) {\n            errors.push(`Missing required property: ${fullPath}`);\n          } else if (obj[key] !== undefined) {\n            validateObject(obj[key], propSchema as any, fullPath);\n          }\n        }\n      }\n    };\n    \n    validateObject(config, schema);\n    \n    return {\n      valid: errors.length === 0,\n      errors\n    };\n  }\n\n  /**\n   * Execute with retry logic\n   */\n  async executeWithRetry<T>(\n    operation: () => Promise<T>,\n    maxRetries: number = 3,\n    delay: number = 1000\n  ): Promise<T> {\n    let lastError: Error;\n    \n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        return await operation();\n      } catch (error) {\n        lastError = error as Error;\n        \n        if (attempt < maxRetries) {\n          await new Promise(resolve => setTimeout(resolve, delay * attempt));\n        }\n      }\n    }\n    \n    throw lastError!;\n  }\n\n  /**\n   * Create standardized tool definition\n   */\n  createToolDefinition<T extends Record<string, unknown>>(\n    name: string,\n    description: string,\n    parameters: any,\n    handler: (args: T) => Promise<string> | string\n  ): ToolDefinition<T> {\n    return {\n      name,\n      description,\n      parameters,\n      handler\n    };\n  }\n}\n\n// ============================================================================\n// CONTEXT MANAGER\n// ============================================================================\n\nexport class ContextManager {\n  private contexts: Map<string, any> = new Map();\n  private defaultContext: Record<string, any> = {};\n\n  /**\n   * Set context value\n   */\n  setContext(key: string, value: any): void {\n    this.contexts.set(key, value);\n  }\n\n  /**\n   * Get context value\n   */\n  getContext<T = any>(key: string): T | undefined {\n    return this.contexts.get(key) as T;\n  }\n\n  /**\n   * Clear context\n   */\n  clearContext(key: string): boolean {\n    return this.contexts.delete(key);\n  }\n\n  /**\n   * Get all contexts\n   */\n  getAllContexts(): Record<string, any> {\n    return Object.fromEntries(this.contexts.entries());\n  }\n\n  /**\n   * Save context to file\n   */\n  saveContexts(filePath: string): void {\n    const data = this.getAllContexts();\n    fs.writeFileSync(filePath, JSON.stringify(data, null, 2), 'utf8');\n  }\n\n  /**\n   * Load contexts from file\n   */\n  loadContexts(filePath: string): void {\n    if (!fs.existsSync(filePath)) return;\n    \n    const data = JSON.parse(fs.readFileSync(filePath, 'utf8'));\n    for (const [key, value] of Object.entries(data)) {\n      this.contexts.set(key, value);\n    }\n  }\n}\n\n// ============================================================================\n// TOOL REGISTRY\n// ============================================================================\n\nexport class ToolRegistry {\n  private tools: Map<string, ToolDefinition> = new Map();\n  private toolSuites: Map<string, ToolSuite> = new Map();\n\n  /**\n   * Register a tool\n   */\n  registerTool(tool: ToolDefinition): void {\n    this.tools.set(tool.name, tool);\n  }\n\n  /**\n   * Register a tool suite\n   */\n  registerToolSuite(suite: ToolSuite): void {\n    this.toolSuites.set(suite.id, suite);\n    for (const tool of suite.tools) {\n      this.registerTool(tool);\n    }\n  }\n\n  /**\n   * Get a tool by name\n   */\n  getTool<T extends Record<string, unknown>>(name: string): ToolDefinition<T> | undefined {\n    return this.tools.get(name) as ToolDefinition<T>;\n  }\n\n  /**\n   * Get a tool suite by ID\n   */\n  getToolSuite(id: string): ToolSuite | undefined {\n    return this.toolSuites.get(id);\n  }\n\n  /**\n   * List all tools\n   */\n  listTools(): ToolDefinition[] {\n    return Array.from(this.tools.values());\n  }\n\n  /**\n   * List all tool suites\n   */\n  listToolSuites(): ToolSuite[] {\n    return Array.from(this.toolSuites.values());\n  }\n\n  /**\n   * Search tools by criteria\n   */\n  searchTools(criteria: (tool: ToolDefinition) => boolean): ToolDefinition[] {\n    return Array.from(this.tools.values()).filter(criteria);\n  }\n}\n\n// ============================================================================\n// UNIVERSAL CAPABILITY BASE CLASS\n// ============================================================================\n\nexport abstract class UniversalCapabilityModule implements CapabilityModule {\n  abstract readonly id: string;\n  abstract readonly metadata: CapabilityMetadata;\n  \n  protected framework: UniversalCapabilityFramework;\n  protected utilities: SharedUniversalUtilities;\n  protected contextManager: ContextManager;\n  protected toolRegistry: ToolRegistry;\n  \n  protected config: Record<string, any> = {};\n\n  constructor(\n    framework: UniversalCapabilityFramework,\n    config: Record<string, any> = {}\n  ) {\n    this.framework = framework;\n    this.utilities = framework.getSharedUtilities();\n    this.contextManager = new ContextManager();\n    this.toolRegistry = framework.getToolRegistry();\n    this.config = config;\n  }\n\n  /**\n   * Abstract method - must be implemented by subclasses\n   */\n  abstract create(context: CapabilityContext): Promise<CapabilityContribution | CapabilityContribution[] | null | undefined>;\n\n  /**\n   * Initialize capability (called after constructor)\n   */\n  async initialize(): Promise<void> {\n    // Default implementation does nothing\n  }\n\n  /**\n   * Cleanup capability (called before disposal)\n   */\n  async cleanup(): Promise<void> {\n    // Default implementation does nothing\n  }\n\n  /**\n   * Execute an operation (common interface for all capabilities)\n   */\n  async execute(params: {\n    operation: string;\n    parameters: Record<string, any>;\n    operationId?: string;\n  }): Promise<any> {\n    throw new Error(`Execute method not implemented for capability: ${this.id}`);\n  }\n\n  /**\n   * Validate configuration\n   */\n  validateConfig(schema: Record<string, any>): { valid: boolean; errors: string[] } {\n    return this.utilities.validateConfig(this.config, schema);\n  }\n\n  /**\n   * Log with capability context\n   */\n  protected log(level: 'info' | 'warn' | 'error', message: string, data?: any): void {\n    const logData = {\n      capabilityId: this.id,\n      ...data\n    };\n    \n    this.framework.emit('log', {\n      timestamp: Date.now(),\n      level,\n      message,\n      data: logData\n    });\n  }\n\n  /**\n   * Emit framework event\n   */\n  protected emitEvent(type: string, data: any): void {\n    this.framework.emit(`capability:${this.id}:${type}`, {\n      timestamp: Date.now(),\n      source: this.id,\n      data\n    });\n  }\n\n  /**\n   * Create fallback file tool for filesystem capability\n   */\n  protected createFallbackFileTool(): ToolDefinition {\n    return this.utilities.createToolDefinition(\n      'read_file_fallback',\n      'Fallback file reading tool',\n      {\n        type: 'object',\n        properties: {\n          path: { type: 'string', description: 'Path to file' }\n        },\n        required: ['path']\n      },\n      async (args: { path: string }) => {\n        try {\n          return fs.readFileSync(args.path, 'utf8');\n        } catch (error: any) {\n          return `Error reading file: ${error.message}`;\n        }\n      }\n    );\n  }\n}\n\n// ============================================================================\n// UNIVERSAL CAPABILITY FACTORY\n// ============================================================================\n\nexport class UniversalCapabilityFactory {\n  private static capabilityRegistry: Map<string, new (framework: UniversalCapabilityFramework, config: any) => UniversalCapabilityModule> = new Map();\n\n  /**\n   * Register a capability class\n   */\n  static registerCapability(\n    id: string,\n    constructor: new (framework: UniversalCapabilityFramework, config: any) => UniversalCapabilityModule\n  ): void {\n    this.capabilityRegistry.set(id, constructor);\n  }\n\n  /**\n   * Create capability instance\n   */\n  static createCapability(\n    id: string,\n    framework: UniversalCapabilityFramework,\n    config: any = {}\n  ): UniversalCapabilityModule | null {\n    const Constructor = this.capabilityRegistry.get(id);\n    if (!Constructor) return null;\n    \n    return new Constructor(framework, config);\n  }\n\n  /**\n   * List all registered capability types\n   */\n  static listCapabilityTypes(): string[] {\n    return Array.from(this.capabilityRegistry.keys());\n  }\n}\n\n// ============================================================================\n// PRE-BUILT UNIVERSAL CAPABILITIES\n// ============================================================================\n\n/**\n * Universal Filesystem Capability\n */\nexport class UniversalFilesystemCapability extends UniversalCapabilityModule {\n  readonly id = 'capability.universal-filesystem';\n  readonly metadata: CapabilityMetadata = {\n    id: this.id,\n    version: '1.0.0',\n    description: 'Universal filesystem operations with cross-platform support',\n    author: 'AGI Core Team',\n    dependencies: [],\n    provides: ['filesystem.read', 'filesystem.write', 'filesystem.list', 'filesystem.search'],\n    requires: [],\n    category: 'core',\n    tags: ['filesystem', 'io', 'storage']\n  };\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    try {\n      const { createFileTools } = await import('../tools/fileTools.js');\n      \n      return {\n        id: 'filesystem.universal',\n        description: 'Universal filesystem access with enhanced capabilities',\n        toolSuite: {\n          id: 'fs-universal',\n          description: 'Universal filesystem operations',\n          tools: createFileTools(context.workingDir)\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          platform: os.platform(),\n          capabilities: this.metadata.provides\n        }\n      };\n    } catch (error) {\n      // Fallback to simple implementation if module not available\n      return {\n        id: 'filesystem.universal-fallback',\n        description: 'Universal filesystem access (fallback mode)',\n        toolSuite: {\n          id: 'fs-universal-fallback',\n          description: 'Universal filesystem operations (fallback)',\n          tools: [this.createFallbackFileTool()]\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          platform: os.platform(),\n          capabilities: this.metadata.provides,\n          fallback: true\n        }\n      };\n    }\n  }\n\n  async execute(params: {\n    operation: string;\n    parameters: Record<string, any>;\n    operationId?: string;\n  }): Promise<any> {\n    const opId = params.operationId || this.utilities.generateOperationId('fs');\n    \n    switch (params.operation) {\n      case 'read':\n        return this.readFile(params.parameters.path);\n      case 'write':\n        return this.writeFile(params.parameters.path, params.parameters.content);\n      case 'list':\n        return this.listDirectory(params.parameters.path, params.parameters.recursive);\n      case 'search':\n        return this.searchFiles(params.parameters.pattern, params.parameters.path);\n      default:\n        throw new Error(`Unknown filesystem operation: ${params.operation}`);\n    }\n  }\n\n  private readFile(filePath: string): string {\n    return fs.readFileSync(filePath, 'utf8');\n  }\n\n  private writeFile(filePath: string, content: string): void {\n    fs.writeFileSync(filePath, content, 'utf8');\n  }\n\n  private listDirectory(dirPath: string, recursive: boolean = false): string[] {\n    if (!fs.existsSync(dirPath)) return [];\n    \n    const items = fs.readdirSync(dirPath, { withFileTypes: true });\n    const result: string[] = [];\n    \n    for (const item of items) {\n      const fullPath = path.join(dirPath, item.name);\n      result.push(fullPath);\n      \n      if (recursive && item.isDirectory()) {\n        result.push(...this.listDirectory(fullPath, true));\n      }\n    }\n    \n    return result;\n  }\n\n  private searchFiles(pattern: string, basePath: string): string[] {\n    const files: string[] = [];\n    const searchDir = (dir: string): void => {\n      try {\n        const items = fs.readdirSync(dir);\n        for (const item of items) {\n          const fullPath = path.join(dir, item);\n          const stat = fs.statSync(fullPath);\n          \n          if (stat.isDirectory()) {\n            searchDir(fullPath);\n          } else if (item.includes(pattern) || fullPath.includes(pattern)) {\n            files.push(fullPath);\n          }\n        }\n      } catch (error) {\n        // Skip directories we can't read\n      }\n    };\n    \n    searchDir(basePath);\n    return files;\n  }\n}\n\n/**\n * Universal Bash Capability\n */\nexport class UniversalBashCapability extends UniversalCapabilityModule {\n  readonly id = 'capability.universal-bash';\n  readonly metadata: CapabilityMetadata = {\n    id: this.id,\n    version: '1.0.0',\n    description: 'Universal bash/shell execution with cross-platform support',\n    author: 'AGI Core Team',\n    dependencies: ['capability.universal-filesystem'],\n    provides: ['bash.execute', 'bash.script', 'bash.pipeline', 'bash.background'],\n    requires: [],\n    category: 'core',\n    tags: ['bash', 'shell', 'execution']\n  };\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    try {\n      const { createBashTools } = await import('../tools/bashTools.js');\n      \n      return {\n        id: 'bash.universal',\n        description: 'Universal bash execution with enhanced capabilities',\n        toolSuite: {\n          id: 'bash-universal',\n          description: 'Universal bash/shell operations',\n          tools: createBashTools(context.workingDir)\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          platform: os.platform(),\n          shell: process.env.SHELL || 'bash',\n          capabilities: this.metadata.provides\n        }\n      };\n    } catch (error) {\n      // Fallback to simple implementation\n      return {\n        id: 'bash.universal-fallback',\n        description: 'Universal bash execution (fallback mode)',\n        toolSuite: {\n          id: 'bash-universal-fallback',\n          description: 'Universal bash/shell operations (fallback)',\n          tools: [this.createFallbackBashTool()]\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          platform: os.platform(),\n          capabilities: this.metadata.provides,\n          fallback: true\n        }\n      };\n    }\n  }\n\n  private createFallbackBashTool(): ToolDefinition {\n    return this.utilities.createToolDefinition(\n      'execute_command_fallback',\n      'Fallback command execution tool',\n      {\n        type: 'object',\n        properties: {\n          command: { type: 'string', description: 'Command to execute' },\n          cwd: { type: 'string', description: 'Working directory', default: process.cwd() }\n        },\n        required: ['command']\n      },\n      async (args: { command: string; cwd?: string }) => {\n        try {\n          const result = execSync(args.command, {\n            cwd: args.cwd || process.cwd(),\n            encoding: 'utf8',\n            timeout: 30000\n          });\n          return result.trim();\n        } catch (error: any) {\n          return `Error executing command: ${error.message}`;\n        }\n      }\n    );\n  }\n\n  async execute(params: {\n    operation: string;\n    parameters: Record<string, any>;\n    operationId?: string;\n  }): Promise<any> {\n    const opId = params.operationId || this.utilities.generateOperationId('bash');\n    \n    try {\n      const result = execSync(params.parameters.command, {\n        cwd: params.parameters.cwd || this.config.workingDir || process.cwd(),\n        encoding: 'utf8',\n        timeout: params.parameters.timeout || 30000\n      });\n      \n      return {\n        success: true,\n        output: result.trim(),\n        exitCode: 0\n      };\n    } catch (error: any) {\n      return {\n        success: false,\n        output: error.stderr?.toString() || error.message,\n        exitCode: error.status || 1\n      };\n    }\n  }\n}\n\n/**\n * Universal Search Capability\n */\nexport class UniversalSearchCapability extends UniversalCapabilityModule {\n  readonly id = 'capability.universal-search';\n  readonly metadata: CapabilityMetadata = {\n    id: this.id,\n    version: '1.0.0',\n    description: 'Universal search across files, content, and definitions',\n    author: 'AGI Core Team',\n    dependencies: ['capability.universal-filesystem'],\n    provides: ['search.files', 'search.content', 'search.definitions', 'search.pattern'],\n    requires: [],\n    category: 'core',\n    tags: ['search', 'find', 'grep', 'pattern']\n  };\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    try {\n      const { createSearchTools } = await import('../tools/searchTools.js');\n      \n      return {\n        id: 'search.universal',\n        description: 'Universal search across files and content',\n        toolSuite: {\n          id: 'search-universal',\n          description: 'Universal search operations',\n          tools: createSearchTools(context.workingDir)\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          capabilities: this.metadata.provides\n        }\n      };\n    } catch (error) {\n      // Fallback to simple implementation\n      return {\n        id: 'search.universal-fallback',\n        description: 'Universal search (fallback mode)',\n        toolSuite: {\n          id: 'search-universal-fallback',\n          description: 'Universal search operations (fallback)',\n          tools: [this.createFallbackSearchTool()]\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          capabilities: this.metadata.provides,\n          fallback: true\n        }\n      };\n    }\n  }\n\n  private createFallbackSearchTool(): ToolDefinition {\n    return this.utilities.createToolDefinition(\n      'search_fallback',\n      'Fallback search tool',\n      {\n        type: 'object',\n        properties: {\n          pattern: { type: 'string', description: 'Search pattern' },\n          path: { type: 'string', description: 'Search directory', default: process.cwd() }\n        },\n        required: ['pattern']\n      },\n      async (args: { pattern: string; path?: string }) => {\n        const searchDir = args.path || process.cwd();\n        const files: string[] = [];\n        \n        const search = (dir: string): void => {\n          try {\n            const items = fs.readdirSync(dir);\n            for (const item of items) {\n              const fullPath = path.join(dir, item);\n              const stat = fs.statSync(fullPath);\n              \n              if (stat.isDirectory()) {\n                search(fullPath);\n              } else if (item.includes(args.pattern) || fullPath.includes(args.pattern)) {\n                files.push(fullPath);\n              }\n            }\n          } catch (error) {\n            // Skip unreadable directories\n          }\n        };\n        \n        search(searchDir);\n        return files.length > 0 ? files.join('\\n') : 'No matches found';\n      }\n    );\n  }\n\n  async execute(params: {\n    operation: string;\n    parameters: Record<string, any>;\n    operationId?: string;\n  }): Promise<any> {\n    const opId = params.operationId || this.utilities.generateOperationId('search');\n    \n    // Implementation would use the search tools\n    // For now, return a placeholder\n    return {\n      operation: params.operation,\n      parameters: params.parameters,\n      results: []\n    };\n  }\n}\n\n/**\n * Universal Edit Capability\n */\nexport class UniversalEditCapability extends UniversalCapabilityModule {\n  readonly id = 'capability.universal-edit';\n  readonly metadata: CapabilityMetadata = {\n    id: this.id,\n    version: '1.0.0',\n    description: 'Universal file editing with exact string replacement',\n    author: 'AGI Core Team',\n    dependencies: ['capability.universal-filesystem'],\n    provides: ['edit.file', 'edit.replace', 'edit.create', 'edit.delete'],\n    requires: [],\n    category: 'core',\n    tags: ['edit', 'modify', 'file', 'code']\n  };\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    try {\n      const { createEditTools } = await import('../tools/editTools.js');\n      \n      return {\n        id: 'edit.universal',\n        description: 'Universal file editing capabilities',\n        toolSuite: {\n          id: 'edit-universal',\n          description: 'Universal edit operations',\n          tools: createEditTools(context.workingDir || process.cwd())\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          capabilities: this.metadata.provides\n        }\n      };\n    } catch (error) {\n      // Fallback to simple implementation\n      return {\n        id: 'edit.universal-fallback',\n        description: 'Universal file editing (fallback mode)',\n        toolSuite: {\n          id: 'edit-universal-fallback',\n          description: 'Universal edit operations (fallback)',\n          tools: [this.createFallbackEditTool()]\n        },\n        metadata: {\n          workingDir: context.workingDir,\n          capabilities: this.metadata.provides,\n          fallback: true\n        }\n      };\n    }\n  }\n\n  private createFallbackEditTool(): ToolDefinition {\n    return this.utilities.createToolDefinition(\n      'edit_file_fallback',\n      'Fallback file editing tool',\n      {\n        type: 'object',\n        properties: {\n          file_path: { type: 'string', description: 'Path to file' },\n          old_string: { type: 'string', description: 'Text to replace' },\n          new_string: { type: 'string', description: 'New text', default: '' }\n        },\n        required: ['file_path', 'old_string']\n      },\n      async (args: { file_path: string; old_string: string; new_string?: string }) => {\n        try {\n          const content = fs.readFileSync(args.file_path, 'utf8');\n          const newContent = content.replace(args.old_string, args.new_string || '');\n          fs.writeFileSync(args.file_path, newContent, 'utf8');\n          return `File ${args.file_path} updated successfully`;\n        } catch (error: any) {\n          return `Error editing file: ${error.message}`;\n        }\n      }\n    );\n  }\n\n  async execute(params: {\n    operation: string;\n    parameters: Record<string, any>;\n    operationId?: string;\n  }): Promise<any> {\n    const opId = params.operationId || this.utilities.generateOperationId('edit');\n    \n    // Implementation would use the edit tools\n    // For now, return a placeholder\n    return {\n      operation: params.operation,\n      parameters: params.parameters,\n      success: true\n    };\n  }\n}\n\n// ============================================================================\n// UNIVERSAL FRAMEWORK EXPORTS\n// ============================================================================\n\nexport default UniversalCapabilityFramework;\n\n// Note: Individual capability classes are already exported at their definitions\n// (UniversalFilesystemCapability, UniversalBashCapability, UniversalSearchCapability, UniversalEditCapability)"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["_plainMode","_colorEnabled","isPlainOutputMode","envValue","process","env","undefined","envEnabled","includes","toLowerCase","envDisabled","term","isCi","Boolean","isTty","stdout","isTTY","stdin","isColorEnabled","setPlainOutputMode","enabled","setColorEnabled","resetPlainOutputMode","resetColorEnabled","resetOutputModes"],"sources":["outputMode.ts"],"sourcesContent":["/**\n * Output mode configuration for terminal UI\n *\n * Controls whether to use decorative box-drawing characters or plain text.\n * Plain mode outputs clipboard-friendly text without Unicode borders.\n * Automatically enabled in CI or non-interactive shells; override with AGI_PLAIN_OUTPUT=true.\n *\n * Environment Variables:\n * - AGI_PLAIN_OUTPUT: Set to 'true', '1', 'yes', or 'on' to force plain mode\n * - CI: Automatically enables plain mode when set\n * - TERM: Checked for 'dumb' terminals which get plain mode\n * - NO_COLOR: If set, enables plain mode (respects https://no-color.org/)\n */\n\nlet _plainMode: boolean | null = null;\nlet _colorEnabled: boolean | null = null;\n\n/**\n * Check if plain output mode is enabled.\n * Plain mode outputs text without box-drawing characters for clean clipboard copying.\n */\nexport function isPlainOutputMode(): boolean {\n  if (_plainMode !== null) {\n    return _plainMode;\n  }\n\n  try {\n    // Check explicit environment override first\n    const envValue = process.env['AGI_PLAIN_OUTPUT'];\n    if (envValue !== undefined) {\n      const envEnabled = ['true', '1', 'yes', 'on'].includes(envValue.toLowerCase());\n      if (envEnabled) {\n        _plainMode = true;\n        return _plainMode;\n      }\n      // Also check for explicit disable\n      const envDisabled = ['false', '0', 'no', 'off'].includes(envValue.toLowerCase());\n      if (envDisabled) {\n        _plainMode = false;\n        return _plainMode;\n      }\n    }\n\n    // Check for dumb terminal\n    const term = process.env['TERM'];\n    if (term === 'dumb') {\n      _plainMode = true;\n      return _plainMode;\n    }\n\n    // Check for CI environments\n    const isCi = Boolean(\n      process.env['CI'] ||\n      process.env['GITHUB_ACTIONS'] ||\n      process.env['GITLAB_CI'] ||\n      process.env['CIRCLECI'] ||\n      process.env['TRAVIS'] ||\n      process.env['JENKINS_URL']\n    );\n\n    // Check TTY status safely\n    const isTty = Boolean(\n      process.stdout?.isTTY &&\n      process.stdin?.isTTY\n    );\n\n    // Default to plain logging in non-interactive/CI environments; rich UI only in TTY sessions.\n    _plainMode = !isTty || isCi;\n  } catch {\n    // If anything fails, default to plain mode for safety\n    _plainMode = true;\n  }\n\n  return _plainMode;\n}\n\n/**\n * Check if color output is enabled.\n * Respects NO_COLOR environment variable (https://no-color.org/)\n */\nexport function isColorEnabled(): boolean {\n  if (_colorEnabled !== null) {\n    return _colorEnabled;\n  }\n\n  try {\n    // NO_COLOR takes precedence (https://no-color.org/)\n    if (process.env['NO_COLOR'] !== undefined) {\n      _colorEnabled = false;\n      return _colorEnabled;\n    }\n\n    // FORCE_COLOR enables colors\n    if (process.env['FORCE_COLOR'] !== undefined) {\n      _colorEnabled = true;\n      return _colorEnabled;\n    }\n\n    // Color enabled in TTY by default\n    _colorEnabled = Boolean(process.stdout?.isTTY);\n  } catch {\n    _colorEnabled = false;\n  }\n\n  return _colorEnabled;\n}\n\n/**\n * Override the plain output mode setting (useful for testing)\n */\nexport function setPlainOutputMode(enabled: boolean): void {\n  _plainMode = enabled;\n}\n\n/**\n * Override the color output mode setting (useful for testing)\n */\nexport function setColorEnabled(enabled: boolean): void {\n  _colorEnabled = enabled;\n}\n\n/**\n * Reset plain output mode to check environment variable again\n */\nexport function resetPlainOutputMode(): void {\n  _plainMode = null;\n}\n\n/**\n * Reset color mode to check environment variable again\n */\nexport function resetColorEnabled(): void {\n  _colorEnabled = null;\n}\n\n/**\n * Reset all output mode settings\n */\nexport function resetOutputModes(): void {\n  _plainMode = null;\n  _colorEnabled = null;\n}\n"],"mappings":"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","ignoreList":[]}
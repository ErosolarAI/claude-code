{"version":3,"names":["cov_hjp8nuh52","actualCoverage","readFileSync","join","dirname","fileURLToPath","__filename","s","import","meta","url","__dirname","cachedSchema","getAgentSchemas","f","b","schemaPath","raw","parsed","JSON","parse","validateAgentSchemas","error","Error","message","String","getProviders","schemas","providers","getProvider","providerId","find","p","id","getModels","staticModels","models","modelDiscoveryModule","discoveredModels","getCachedDiscoveredModels","staticIds","Set","map","m","uniqueDiscovered","filter","has","getModelsByProvider","provider","getModel","modelId","getProfiles","profiles","getProfile","profileName","name","getSlashCommands","slashCommands","getCapabilities","capabilities","manifest","contractVersion","version","Array","isArray","length","providerIds","label","add","modelIds","model","profileNames","profile","defaultProvider","defaultModel","commands","cmd","command","description","cap","clearSchemaCache","isValidProvider","undefined","isValidModel","isValidProfile"],"sources":["agentSchemaLoader.ts"],"sourcesContent":["/**\n * Centralized agent schema loader.\n *\n * This module provides type-safe loading and validation of the centralized\n * agent configuration schema from src/contracts/agent-schemas.json.\n * All agent-related configuration should be loaded through this module\n * to ensure consistency across the application.\n */\n\nimport { readFileSync } from 'node:fs';\nimport { join, dirname } from 'node:path';\nimport { fileURLToPath } from 'node:url';\n\n// Contract types\nimport type { ProviderId } from './types.js';\nimport type { AgentProfileEntry } from '../contracts/v1/agentProfileManifest.js';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = dirname(__filename);\n\n/**\n * Provider configuration from centralized schema\n */\nexport interface ProviderConfig {\n  id: ProviderId;\n  label: string;\n  description?: string;\n  envVars?: {\n    apiKey?: string;\n  };\n  capabilities?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Model configuration from centralized schema\n */\nexport interface ModelConfig {\n  id: string;\n  label: string;\n  provider: ProviderId;\n  description?: string;\n  reasoningEffort?: 'low' | 'medium' | 'high';\n  temperature?: number;\n  maxTokens?: number;\n  capabilities?: string[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Slash command configuration\n */\nexport interface SlashCommandConfig {\n  command: string;\n  description: string;\n  category?: 'configuration' | 'diagnostics' | 'workspace' | 'other';\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Capability definition\n */\nexport interface CapabilityConfig {\n  id: string;\n  label: string;\n  description?: string;\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * The complete centralized agent schema\n */\nexport interface AgentSchemasManifest {\n  contractVersion: string;\n  version: string;\n  label?: string;\n  description?: string;\n  providers: ProviderConfig[];\n  models: ModelConfig[];\n  profiles: AgentProfileEntry[];\n  slashCommands?: SlashCommandConfig[];\n  capabilities?: CapabilityConfig[];\n  metadata?: Record<string, unknown>;\n}\n\n/**\n * Cached schema instance\n */\nlet cachedSchema: AgentSchemasManifest | null = null;\n\n/**\n * Load the centralized agent schemas manifest.\n * Results are cached for performance.\n *\n * @returns The complete agent schemas manifest\n * @throws Error if the schema file cannot be read or parsed\n */\nexport function getAgentSchemas(): AgentSchemasManifest {\n  if (cachedSchema) {\n    return cachedSchema;\n  }\n\n  try {\n    const schemaPath = join(__dirname, '..', 'contracts', 'agent-schemas.json');\n    const raw = readFileSync(schemaPath, 'utf-8');\n    const parsed = JSON.parse(raw) as AgentSchemasManifest;\n\n    // Basic validation\n    validateAgentSchemas(parsed);\n\n    cachedSchema = parsed;\n    return cachedSchema;\n  } catch (error) {\n    throw new Error(\n      `Failed to load agent schemas: ${error instanceof Error ? error.message : String(error)}`\n    );\n  }\n}\n\n/**\n * Get all provider configurations\n */\nexport function getProviders(): ProviderConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.providers;\n}\n\n/**\n * Get a specific provider by ID\n */\nexport function getProvider(providerId: ProviderId): ProviderConfig | undefined {\n  const providers = getProviders();\n  return providers.find((p) => p.id === providerId);\n}\n\n/**\n * Get all model configurations (includes both static and discovered models)\n */\nexport async function getModels(): Promise<ModelConfig[]> {\n  const schemas = getAgentSchemas();\n  const staticModels = schemas.models;\n\n  // Try to load discovered models\n  try {\n    // Use dynamic import for ESM compatibility\n    const modelDiscoveryModule = await import('./modelDiscovery.js');\n    const discoveredModels = modelDiscoveryModule.getCachedDiscoveredModels();\n\n    // Merge models, preferring static definitions over discovered ones\n    const staticIds = new Set(staticModels.map((m: ModelConfig) => m.id));\n    const uniqueDiscovered = discoveredModels.filter((m: ModelConfig) => !staticIds.has(m.id));\n\n    return [...staticModels, ...uniqueDiscovered];\n  } catch (error) {\n    // If discovery module fails, just return static models\n    return staticModels;\n  }\n}\n\n/**\n * Get models for a specific provider\n */\nexport async function getModelsByProvider(providerId: ProviderId): Promise<ModelConfig[]> {\n  const models = await getModels();\n  return models.filter((m) => m.provider === providerId);\n}\n\n/**\n * Get a specific model by ID\n */\nexport async function getModel(modelId: string): Promise<ModelConfig | undefined> {\n  const models = await getModels();\n  return models.find((m) => m.id === modelId);\n}\n\n/**\n * Get all agent profiles\n */\nexport function getProfiles(): AgentProfileEntry[] {\n  const schemas = getAgentSchemas();\n  return schemas.profiles;\n}\n\n/**\n * Get a specific profile by name\n */\nexport function getProfile(profileName: string): AgentProfileEntry | undefined {\n  const profiles = getProfiles();\n  return profiles.find((p) => p.name === profileName);\n}\n\n/**\n * Get all slash commands\n */\nexport function getSlashCommands(): SlashCommandConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.slashCommands ?? [];\n}\n\n/**\n * Get all capabilities\n */\nexport function getCapabilities(): CapabilityConfig[] {\n  const schemas = getAgentSchemas();\n  return schemas.capabilities ?? [];\n}\n\n/**\n * Validate the agent schemas manifest structure\n */\nfunction validateAgentSchemas(manifest: AgentSchemasManifest): void {\n  // Check required fields\n  if (!manifest.contractVersion) {\n    throw new Error('Missing required field: contractVersion');\n  }\n  if (!manifest.version) {\n    throw new Error('Missing required field: version');\n  }\n  if (!Array.isArray(manifest.providers) || manifest.providers.length === 0) {\n    throw new Error('Missing or empty required field: providers');\n  }\n  if (!Array.isArray(manifest.models) || manifest.models.length === 0) {\n    throw new Error('Missing or empty required field: models');\n  }\n  if (!Array.isArray(manifest.profiles) || manifest.profiles.length === 0) {\n    throw new Error('Missing or empty required field: profiles');\n  }\n\n  // Validate provider uniqueness\n  const providerIds = new Set<string>();\n  for (const provider of manifest.providers) {\n    if (!provider.id || !provider.label) {\n      throw new Error('Provider missing required fields: id, label');\n    }\n    if (providerIds.has(provider.id)) {\n      throw new Error(`Duplicate provider ID: ${provider.id}`);\n    }\n    providerIds.add(provider.id);\n  }\n\n  // Validate model uniqueness and provider references\n  const modelIds = new Set<string>();\n  for (const model of manifest.models) {\n    if (!model.id || !model.label || !model.provider) {\n      throw new Error('Model missing required fields: id, label, provider');\n    }\n    if (modelIds.has(model.id)) {\n      throw new Error(`Duplicate model ID: ${model.id}`);\n    }\n    if (!providerIds.has(model.provider)) {\n      throw new Error(`Model \"${model.id}\" references unknown provider: ${model.provider}`);\n    }\n    modelIds.add(model.id);\n  }\n\n  // Validate profile uniqueness and references\n  const profileNames = new Set<string>();\n  for (const profile of manifest.profiles) {\n    if (!profile.name || !profile.label || !profile.defaultProvider || !profile.defaultModel) {\n      throw new Error('Profile missing required fields: name, label, defaultProvider, defaultModel');\n    }\n    if (profileNames.has(profile.name)) {\n      throw new Error(`Duplicate profile name: ${profile.name}`);\n    }\n    if (!providerIds.has(profile.defaultProvider)) {\n      throw new Error(`Profile \"${profile.name}\" references unknown provider: ${profile.defaultProvider}`);\n    }\n    if (!modelIds.has(profile.defaultModel)) {\n      throw new Error(`Profile \"${profile.name}\" references unknown model: ${profile.defaultModel}`);\n    }\n    profileNames.add(profile.name);\n  }\n\n  // Validate slash commands uniqueness\n  if (manifest.slashCommands) {\n    const commands = new Set<string>();\n    for (const cmd of manifest.slashCommands) {\n      if (!cmd.command || !cmd.description) {\n        throw new Error('Slash command missing required fields: command, description');\n      }\n      if (commands.has(cmd.command)) {\n        throw new Error(`Duplicate slash command: ${cmd.command}`);\n      }\n      commands.add(cmd.command);\n    }\n  }\n\n  // Validate capabilities uniqueness\n  if (manifest.capabilities) {\n    const capabilities = new Set<string>();\n    for (const cap of manifest.capabilities) {\n      if (!cap.id || !cap.label) {\n        throw new Error('Capability missing required fields: id, label');\n      }\n      if (capabilities.has(cap.id)) {\n        throw new Error(`Duplicate capability ID: ${cap.id}`);\n      }\n      capabilities.add(cap.id);\n    }\n  }\n}\n\n/**\n * Clear the cached schema (useful for testing)\n */\nexport function clearSchemaCache(): void {\n  cachedSchema = null;\n}\n\n/**\n * Validate that a provider ID exists in the schema\n */\nexport function isValidProvider(providerId: string): providerId is ProviderId {\n  const provider = getProvider(providerId as ProviderId);\n  return provider !== undefined;\n}\n\n/**\n * Validate that a model ID exists in the schema\n */\nexport async function isValidModel(modelId: string): Promise<boolean> {\n  const model = await getModel(modelId);\n  return model !== undefined;\n}\n\n/**\n * Validate that a profile name exists in the schema\n */\nexport function isValidProfile(profileName: string): boolean {\n  const profile = getProfile(profileName);\n  return profile !== undefined;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
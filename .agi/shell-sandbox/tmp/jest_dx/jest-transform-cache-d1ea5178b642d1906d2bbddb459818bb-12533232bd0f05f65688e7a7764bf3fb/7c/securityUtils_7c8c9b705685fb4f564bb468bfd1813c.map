{"version":3,"names":["cov_1lp7xh2ovz","actualCoverage","spawnSync","URL","logDebug","validateTarget","target","f","s","b","valid","reason","length","validTargetRegex","test","privateIPRegex","toLowerCase","console","warn","validatePorts","ports","portList","split","port","includes","start","end","map","p","parseInt","trim","isNaN","portNum","validateUrl","url","parsed","protocol","hostnameValidation","hostname","sanitizedPath","pathname","replace","sanitized","search","hash","error","safeExecSync","command","args","options","defaultOptions","encoding","timeout","stdio","shell","mergedOptions","result","success","stdout","stderr","message","status","toString","sanitizeShellInput","input","sanitizeFilePath","path","sensitivePaths","normalizedPath","some","sp","startsWith","RateLimiter","requests","Map","constructor","maxRequests","timeWindowMs","isAllowed","key","now","Date","windowStart","get","filter","time","push","set","Math","random","cleanup","entries","filtered","delete","getWaitTime","oldest","min","max","SecureHttpClient","rateLimiter","urlValidation","SecurityPolicyValidator","defaultContext","permissions","maxExecutionTime","allowedCommands","allowedHosts","validateCommand","context","mergedContext","allowed","validateNmapArgs","validateCurlArgs","allowedOptions","arg","substring","portValidation","i","method","toUpperCase","SecurityLogger","logFile","logSecurityEvent","event","logEntry","timestamp","toISOString","ip","getClientIp","JSON","stringify","securityValidator","securityLogger","globalRateLimiter"],"sources":["securityUtils.ts"],"sourcesContent":["/**\n * Security Utilities for AGI Core\n * Comprehensive security validation, sanitization, and safe execution utilities\n */\n\nimport { spawnSync, SpawnSyncOptions } from 'node:child_process';\nimport { URL } from 'node:url';\nimport { logDebug } from './debugLogger.js';\n\n/**\n * Validate target hostname, IP address, or domain\n * Prevents command injection and path traversal\n */\nexport function validateTarget(target: string): { valid: boolean; reason?: string } {\n  if (typeof target !== 'string') {\n    return { valid: false, reason: 'Target must be a string' };\n  }\n  \n  if (target.length > 253) {\n    return { valid: false, reason: 'Target too long (max 253 characters)' };\n  }\n  \n  // Allow IP addresses (IPv4 and IPv6), hostnames, but no shell metacharacters\n  const validTargetRegex = /^[a-zA-Z0-9.\\-:_[\\]]+$/;\n  if (!validTargetRegex.test(target)) {\n    return { valid: false, reason: 'Target contains invalid characters' };\n  }\n  \n  // Disallow localhost/private IPs unless explicitly allowed (add config flag if needed)\n  const privateIPRegex = /^(127\\.|10\\.|172\\.(1[6-9]|2[0-9]|3[0-1])\\.|192\\.168\\.|::1|localhost)/;\n  if (privateIPRegex.test(target.toLowerCase())) {\n    console.warn(`Security warning: Scanning private/localhost target ${target}`);\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate port numbers and ranges\n */\nexport function validatePorts(ports: string): { valid: boolean; reason?: string } {\n  if (typeof ports !== 'string') {\n    return { valid: false, reason: 'Ports must be a string' };\n  }\n  \n  const portList = ports.split(',');\n  for (const port of portList) {\n    if (port.includes('-')) {\n      // Handle port ranges like \"1-1000\"\n      const [start, end] = port.split('-').map(p => parseInt(p.trim(), 10));\n      if (isNaN(start) || isNaN(end) || start < 1 || end > 65535 || start > end) {\n        return { valid: false, reason: `Invalid port range: ${port}` };\n      }\n    } else {\n      const portNum = parseInt(port.trim(), 10);\n      if (isNaN(portNum) || portNum < 1 || portNum > 65535) {\n        return { valid: false, reason: `Invalid port: ${port}` };\n      }\n    }\n  }\n  \n  return { valid: true };\n}\n\n/**\n * Validate and sanitize URL\n */\nexport function validateUrl(url: string): { valid: boolean; reason?: string; sanitized?: string } {\n  try {\n    const parsed = new URL(url);\n    \n    // Validate protocol\n    if (!['http:', 'https:'].includes(parsed.protocol)) {\n      return { valid: false, reason: `Unsupported protocol: ${parsed.protocol}` };\n    }\n    \n    // Validate hostname\n    const hostnameValidation = validateTarget(parsed.hostname);\n    if (!hostnameValidation.valid) {\n      return { valid: false, reason: hostnameValidation.reason };\n    }\n    \n    // Sanitize path (basic prevention of directory traversal in URL)\n    const sanitizedPath = parsed.pathname.replace(/\\.\\.\\//g, '').replace(/\\/\\/+/g, '/');\n    \n    return { \n      valid: true, \n      sanitized: `${parsed.protocol}//${parsed.hostname}${sanitizedPath}${parsed.search}${parsed.hash}`\n    };\n  } catch (error) {\n    return { valid: false, reason: 'Invalid URL format' };\n  }\n}\n\n/**\n * Safe command execution wrapper\n * Uses spawnSync with array arguments, never shell mode\n */\nexport function safeExecSync(\n  command: string, \n  args: string[] = [], \n  options: SpawnSyncOptions = {}\n): { success: boolean; stdout: string; stderr: string; error?: string } {\n  try {\n    const defaultOptions: SpawnSyncOptions = {\n      encoding: 'utf-8' as const,\n      timeout: 30000,\n      stdio: ['pipe', 'pipe', 'pipe'],\n      shell: false, // CRITICAL: Never use shell mode\n    };\n    \n    const mergedOptions = { ...defaultOptions, ...options };\n    \n    const result = spawnSync(command, args, mergedOptions);\n    \n    if (result.error) {\n      return {\n        success: false,\n        stdout: '',\n        stderr: '',\n        error: `Command execution failed: ${result.error.message}`\n      };\n    }\n    \n    return {\n      success: result.status === 0,\n      stdout: result.stdout?.toString() || '',\n      stderr: result.stderr?.toString() || '',\n    };\n  } catch (error: any) {\n    return {\n      success: false,\n      stdout: '',\n      stderr: '',\n      error: `Execution error: ${error.message}`\n    };\n  }\n}\n\n/**\n * Sanitize user input for shell commands\n * Escapes shell metacharacters\n */\nexport function sanitizeShellInput(input: string): string {\n  if (typeof input !== 'string') return '';\n  \n  // Escape shell metacharacters\n  return input.replace(/[;&|`$\\\\'\"\\n\\r]/g, '\\\\$&');\n}\n\n/**\n * Validate and sanitize file path\n * Prevents directory traversal attacks\n */\nexport function sanitizeFilePath(path: string): { valid: boolean; sanitized?: string; reason?: string } {\n  if (typeof path !== 'string') {\n    return { valid: false, reason: 'Path must be a string' };\n  }\n  \n  // Prevent directory traversal\n  if (path.includes('..') || path.includes('//')) {\n    return { valid: false, reason: 'Path contains directory traversal attempts' };\n  }\n  \n  // Prevent absolute paths to sensitive locations (basic check)\n  const sensitivePaths = ['/etc/', '/var/', '/usr/', '/bin/', '/sbin/', '/root/', '/home/'];\n  const normalizedPath = path.toLowerCase();\n  if (sensitivePaths.some(sp => normalizedPath.startsWith(sp))) {\n    return { valid: false, reason: 'Path points to sensitive system location' };\n  }\n  \n  return { valid: true, sanitized: path };\n}\n\n/**\n * Rate limiting and request throttling\n */\nexport class RateLimiter {\n  private requests: Map<string, number[]> = new Map();\n  \n  constructor(\n    private maxRequests: number = 10,\n    private timeWindowMs: number = 60000\n  ) {}\n  \n  /**\n   * Check if request is allowed\n   */\n  isAllowed(key: string): boolean {\n    const now = Date.now();\n    const windowStart = now - this.timeWindowMs;\n    \n    let requests = this.requests.get(key) || [];\n    \n    // Clean old requests\n    requests = requests.filter(time => time > windowStart);\n    \n    if (requests.length >= this.maxRequests) {\n      return false;\n    }\n    \n    requests.push(now);\n    this.requests.set(key, requests);\n    \n    // Cleanup old entries periodically\n    if (Math.random() < 0.01) { // 1% chance to cleanup\n      this.cleanup();\n    }\n    \n    return true;\n  }\n  \n  /**\n   * Clean up old request records\n   */\n  private cleanup(): void {\n    const now = Date.now();\n    const windowStart = now - this.timeWindowMs;\n    \n    for (const [key, requests] of this.requests.entries()) {\n      const filtered = requests.filter(time => time > windowStart);\n      if (filtered.length === 0) {\n        this.requests.delete(key);\n      } else {\n        this.requests.set(key, filtered);\n      }\n    }\n  }\n  \n  /**\n   * Get wait time if rate limited\n   */\n  getWaitTime(key: string): number {\n    const requests = this.requests.get(key) || [];\n    if (requests.length < this.maxRequests) {\n      return 0;\n    }\n    \n    const oldest = Math.min(...requests);\n    return Math.max(0, oldest + this.timeWindowMs - Date.now());\n  }\n}\n\n/**\n * Secure HTTP request utilities\n */\nexport class SecureHttpClient {\n  private rateLimiter = new RateLimiter(50, 60000); // 50 requests per minute\n  \n  async get(url: string, options: { timeout?: number; headers?: Record<string, string> } = {}): Promise<{\n    success: boolean;\n    statusCode?: number;\n    data?: string;\n    error?: string;\n  }> {\n    // Validate URL\n    const urlValidation = validateUrl(url);\n    if (!urlValidation.valid) {\n      return { success: false, error: urlValidation.reason };\n    }\n    \n    // Rate limiting\n    const hostname = new URL(url).hostname;\n    if (!this.rateLimiter.isAllowed(hostname)) {\n      return { \n        success: false, \n        error: `Rate limit exceeded for ${hostname}. Wait ${this.rateLimiter.getWaitTime(hostname)}ms`\n      };\n    }\n    \n    // Use native HTTP/HTTPS modules (implementation would go here)\n    // This is a placeholder for actual HTTP implementation\n    \n    return { success: false, error: 'HTTP client not implemented' };\n  }\n}\n\n/**\n * Security context for tool execution\n */\nexport interface SecurityContext {\n  userId?: string;\n  permissions: string[];\n  maxExecutionTime: number;\n  allowedCommands: string[];\n  allowedHosts: string[];\n}\n\n/**\n * Security policy validator\n */\nexport class SecurityPolicyValidator {\n  private defaultContext: SecurityContext = {\n    permissions: ['read', 'write', 'execute'],\n    maxExecutionTime: 30000,\n    allowedCommands: ['nmap', 'curl', 'dig', 'sshpass', 'openssl'],\n    allowedHosts: []\n  };\n  \n  validateCommand(command: string, args: string[], context: Partial<SecurityContext> = {}): {\n    allowed: boolean;\n    reason?: string;\n  } {\n    const mergedContext = { ...this.defaultContext, ...context };\n    \n    // Check if command is allowed\n    if (!mergedContext.allowedCommands.includes(command)) {\n      return { allowed: false, reason: `Command ${command} not allowed` };\n    }\n    \n    // Validate arguments for specific commands\n    if (command === 'nmap') {\n      return this.validateNmapArgs(args);\n    }\n    \n    if (command === 'curl') {\n      return this.validateCurlArgs(args);\n    }\n    \n    return { allowed: true };\n  }\n  \n  private validateNmapArgs(args: string[]): { allowed: boolean; reason?: string } {\n    const allowedOptions = [\n      '-sS', '-sT', '-sV', '-sC', '-O', '-T4', '-T5', '-p', '-p-',\n      '-Pn', '-A', '--script=vuln', '--script=safe', '--open',\n      '--host-timeout', '--max-retries'\n    ];\n    \n    for (const arg of args) {\n      if (arg.startsWith('-p') && !['-p', '-p-'].includes(arg)) {\n        // Validate port specification\n        const ports = arg.substring(2);\n        const portValidation = validatePorts(ports);\n        if (!portValidation.valid) {\n          return { allowed: false, reason: portValidation.reason };\n        }\n      } else if (!allowedOptions.includes(arg) && !arg.startsWith('--script')) {\n        return { allowed: false, reason: `Disallowed nmap option: ${arg}` };\n      }\n    }\n    \n    return { allowed: true };\n  }\n  \n  private validateCurlArgs(args: string[]): { allowed: boolean; reason?: string } {\n    for (let i = 0; i < args.length; i++) {\n      const arg = args[i];\n      \n      if (arg === '-X' || arg === '--request') {\n        const method = args[i + 1];\n        if (!['GET', 'POST', 'HEAD', 'OPTIONS'].includes(method?.toUpperCase())) {\n          return { allowed: false, reason: `Disallowed HTTP method: ${method}` };\n        }\n        i++; // Skip next arg\n      }\n      \n      if (arg.startsWith('http://') || arg.startsWith('https://')) {\n        const urlValidation = validateUrl(arg);\n        if (!urlValidation.valid) {\n          return { allowed: false, reason: urlValidation.reason };\n        }\n      }\n    }\n    \n    return { allowed: true };\n  }\n}\n\n/**\n * Security logger for audit trail\n */\nexport class SecurityLogger {\n  private logFile?: string;\n  \n  constructor(logFile?: string) {\n    this.logFile = logFile;\n  }\n  \n  logSecurityEvent(event: {\n    type: string;\n    userId?: string;\n    command?: string;\n    args?: string[];\n    target?: string;\n    success: boolean;\n    timestamp: Date;\n    details?: Record<string, any>;\n  }): void {\n    const logEntry = {\n      ...event,\n      timestamp: event.timestamp.toISOString(),\n      ip: this.getClientIp()\n    };\n\n    // Keep security logging off the main console; emit via debug logger\n    logDebug(`[SECURITY] ${JSON.stringify(logEntry)}`);\n  }\n  \n  private getClientIp(): string {\n    // Placeholder for actual IP detection\n    return '127.0.0.1';\n  }\n}\n\n// Export singleton instances\nexport const securityValidator = new SecurityPolicyValidator();\nexport const securityLogger = new SecurityLogger();\nexport const globalRateLimiter = new RateLimiter(100, 60000); // 100 requests per minute globally\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CA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","ignoreList":[]}
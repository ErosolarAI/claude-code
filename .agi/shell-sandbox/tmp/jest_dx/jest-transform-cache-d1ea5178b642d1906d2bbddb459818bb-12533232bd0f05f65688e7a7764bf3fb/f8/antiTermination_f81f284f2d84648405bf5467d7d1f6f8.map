{"version":3,"names":["cov_suoacdr3e","actualCoverage","EventEmitter","createRequire","require","s","import","meta","url","defaultMaxListeners","protectionInstance","AntiTerminationProtection","config","startTime","blockedSignals","blockedExceptions","blockedAttacks","attackLog","watchdogTimer","resourceMonitorTimer","lastHeartbeat","signalHandlers","Map","originalProcessExit","isShuttingDown","shutdownCallbacks","criticalSection","criticalSectionDepth","constructor","b","f","interceptSignals","monitorResources","armorExceptions","enableWatchdog","watchdogIntervalMs","memoryThresholdPercent","maxBlockedSignalsAlert","verbose","onAttackDetected","Date","now","process","exit","bind","initialize","log","installSignalProtection","installExceptionArmor","startResourceMonitoring","startWatchdog","installProcessExitGuard","installInputSanitization","installNetworkProtection","installParentProcessProtection","installFileDescriptorProtection","installMemoryProtection","signals","signal","handler","handleSignal","on","set","monitorPendingSignals","event","type","timestamp","details","blocked","source","detectSignalSource","logAttack","platform","execSync","result","encoding","timeout","trim","setInterval","fs","status","readFileSync","sigPndMatch","match","pending","parseInt","toString","error","origin","handleException","reason","promise","handleRejection","warning","handleWarning","message","stack","split","isAttackPattern","_promise","Error","String","name","includes","triggerGC","attackPatterns","some","pattern","test","self","guardedExit","code","originalStdinOn","stdin","listener","wrappedListener","data","size","Buffer","isBuffer","length","byteLength","str","net","originalConnect","Socket","prototype","connect","args","options","host","path","port","suspiciousPorts","err","emit","apply","checkParent","ppid","fdCount","maxFDs","originalOpen","open","originalClose","close","callback","Math","max","checkMemory","usage","memoryUsage","heapUsedMB","heapUsed","heapTotalMB","heapTotal","usagePercent","toFixed","cpuUsage","user","verifySelfIntegrity","global","gc","enterCriticalSection","exitCriticalSection","onShutdown","push","shutdown","cleanup","clearInterval","removeListener","clear","slice","env","console","getStatus","enabled","signalProtection","resourceProtection","exceptionArmor","watchdogActive","uptimeMs","memoryUsageMB","cpuUsagePercent","getAttackLog","initializeProtection","getProtection","authorizedShutdown","getProtectionStatus"],"sources":["antiTermination.ts"],"sourcesContent":["/**\n * Anti-Termination Protection System\n *\n * Comprehensive protection against unconventional remote attacks that could\n * terminate the AI runtime or CLI. Implements multiple layers of defense:\n *\n * 1. Signal Protection - Intercept and neutralize termination signals\n * 2. Resource Protection - Prevent OOM killer and resource exhaustion\n * 3. Exception Armor - Catch all unhandled errors without crashing\n * 4. Process Integrity - Detect manipulation attempts\n * 5. Watchdog System - Self-monitoring heartbeat\n * 6. Input Sanitization - Prevent malformed input crashes\n * 7. Network Protection - Defend against network-based termination\n * 8. Parent Process Protection - Handle orphan scenarios\n * 9. File Descriptor Protection - Prevent fd exhaustion\n * 10. Memory Protection - Detect corruption attempts\n *\n * @module antiTermination\n */\n\nimport { EventEmitter } from 'events';\nimport { createRequire } from 'module';\n\n// Create require for dynamic imports in ESM context\nconst require = createRequire(import.meta.url);\n\n// Increase max listeners to prevent warnings from protection handlers\nEventEmitter.defaultMaxListeners = 50;\n\n/** Protection status and metrics */\nexport interface ProtectionStatus {\n  enabled: boolean;\n  signalProtection: boolean;\n  resourceProtection: boolean;\n  exceptionArmor: boolean;\n  watchdogActive: boolean;\n  blockedSignals: number;\n  blockedExceptions: number;\n  blockedAttacks: number;\n  uptimeMs: number;\n  memoryUsageMB: number;\n  cpuUsagePercent: number;\n  lastHeartbeat: number;\n}\n\n/** Attack event for logging */\ninterface AttackEvent {\n  type: string;\n  timestamp: number;\n  details: string;\n  blocked: boolean;\n  source?: string;\n}\n\n/** Configuration options */\nexport interface AntiTerminationConfig {\n  /** Enable signal interception (default: true) */\n  interceptSignals?: boolean;\n  /** Enable resource monitoring (default: true) */\n  monitorResources?: boolean;\n  /** Enable exception armor (default: true) */\n  armorExceptions?: boolean;\n  /** Enable watchdog heartbeat (default: true) */\n  enableWatchdog?: boolean;\n  /** Watchdog interval in ms (default: 5000) */\n  watchdogIntervalMs?: number;\n  /** Memory threshold percentage to trigger GC (default: 85) */\n  memoryThresholdPercent?: number;\n  /** Maximum blocked signals before alert (default: 10) */\n  maxBlockedSignalsAlert?: number;\n  /** Enable verbose logging (default: false) */\n  verbose?: boolean;\n  /** Callback on attack detection */\n  onAttackDetected?: (event: AttackEvent) => void;\n}\n\n/** Singleton protection instance */\nlet protectionInstance: AntiTerminationProtection | null = null;\n\n/**\n * Anti-Termination Protection System\n */\nexport class AntiTerminationProtection {\n  private config: Required<AntiTerminationConfig>;\n  private startTime: number;\n  private blockedSignals = 0;\n  private blockedExceptions = 0;\n  private blockedAttacks = 0;\n  private attackLog: AttackEvent[] = [];\n  private watchdogTimer: NodeJS.Timeout | null = null;\n  private resourceMonitorTimer: NodeJS.Timeout | null = null;\n  private lastHeartbeat: number;\n  private signalHandlers: Map<string, () => void> = new Map();\n  private originalProcessExit: typeof process.exit;\n  private isShuttingDown = false;\n  private shutdownCallbacks: Array<() => Promise<void> | void> = [];\n  private criticalSection = false;\n  private criticalSectionDepth = 0;\n\n  constructor(config: AntiTerminationConfig = {}) {\n    this.config = {\n      interceptSignals: config.interceptSignals ?? true,\n      monitorResources: config.monitorResources ?? true,\n      armorExceptions: config.armorExceptions ?? true,\n      enableWatchdog: config.enableWatchdog ?? true,\n      watchdogIntervalMs: config.watchdogIntervalMs ?? 5000,\n      memoryThresholdPercent: config.memoryThresholdPercent ?? 85,\n      maxBlockedSignalsAlert: config.maxBlockedSignalsAlert ?? 10,\n      verbose: config.verbose ?? false,\n      onAttackDetected: config.onAttackDetected ?? (() => {}),\n    };\n\n    this.startTime = Date.now();\n    this.lastHeartbeat = Date.now();\n    this.originalProcessExit = process.exit.bind(process);\n  }\n\n  /**\n   * Initialize all protection mechanisms\n   */\n  initialize(): void {\n    this.log('Initializing anti-termination protection...');\n\n    if (this.config.interceptSignals) {\n      this.installSignalProtection();\n    }\n\n    if (this.config.armorExceptions) {\n      this.installExceptionArmor();\n    }\n\n    if (this.config.monitorResources) {\n      this.startResourceMonitoring();\n    }\n\n    if (this.config.enableWatchdog) {\n      this.startWatchdog();\n    }\n\n    this.installProcessExitGuard();\n    this.installInputSanitization();\n    this.installNetworkProtection();\n    this.installParentProcessProtection();\n    this.installFileDescriptorProtection();\n    this.installMemoryProtection();\n\n    this.log('Anti-termination protection initialized');\n  }\n\n  /**\n   * Install signal interception for all termination signals\n   */\n  private installSignalProtection(): void {\n    const signals: NodeJS.Signals[] = [\n      'SIGTERM',\n      'SIGINT',\n      'SIGHUP',\n      'SIGQUIT',\n      'SIGUSR1',\n      'SIGUSR2',\n      'SIGPIPE',\n      'SIGALRM',\n      'SIGXCPU',\n      'SIGXFSZ',\n    ];\n\n    for (const signal of signals) {\n      const handler = () => {\n        this.handleSignal(signal);\n      };\n\n      try {\n        process.on(signal, handler);\n        this.signalHandlers.set(signal, handler);\n      } catch {\n        // Some signals may not be available on all platforms\n      }\n    }\n\n    // Special handling for SIGKILL (cannot be caught, but we can detect attempts)\n    // Monitor /proc/self/status on Linux for pending signals\n    this.monitorPendingSignals();\n\n    this.log('Signal protection installed');\n  }\n\n  /**\n   * Handle incoming termination signal\n   */\n  private handleSignal(signal: string): void {\n    this.blockedSignals++;\n\n    const event: AttackEvent = {\n      type: 'signal',\n      timestamp: Date.now(),\n      details: `Blocked ${signal} termination signal`,\n      blocked: true,\n      source: this.detectSignalSource(),\n    };\n\n    this.logAttack(event);\n\n    // Allow graceful shutdown only if explicitly requested via authorized method\n    if (this.isShuttingDown && (signal === 'SIGTERM' || signal === 'SIGINT')) {\n      this.log(`Allowing graceful shutdown for ${signal}`);\n      return;\n    }\n\n    // Critical section protection - never terminate during critical operations\n    if (this.criticalSection) {\n      this.log(`Blocked ${signal} during critical section`);\n      return;\n    }\n\n    // Check for rapid signal attacks (DoS attempt)\n    if (this.blockedSignals > this.config.maxBlockedSignalsAlert) {\n      this.log(`WARNING: Signal flood detected (${this.blockedSignals} blocked)`);\n      this.config.onAttackDetected?.(event);\n    }\n\n    // Neutralize the signal - don't exit\n    this.log(`Neutralized ${signal} signal (count: ${this.blockedSignals})`);\n  }\n\n  /**\n   * Attempt to detect the source of a signal\n   */\n  private detectSignalSource(): string {\n    try {\n      // On Linux, we can check /proc to find who sent the signal\n      if (process.platform === 'linux') {\n        const { execSync } = require('child_process');\n        const result = execSync('cat /proc/self/status | grep -E \"SigPnd|SigBlk|SigIgn\"', {\n          encoding: 'utf-8',\n          timeout: 100,\n        });\n        return result.trim() || 'unknown';\n      }\n    } catch {\n      // Ignore errors\n    }\n    return 'unknown';\n  }\n\n  /**\n   * Monitor for pending signals (including SIGKILL attempts)\n   */\n  private monitorPendingSignals(): void {\n    if (process.platform !== 'linux') return;\n\n    setInterval(() => {\n      try {\n        const fs = require('fs');\n        const status = fs.readFileSync('/proc/self/status', 'utf-8');\n        const sigPndMatch = status.match(/SigPnd:\\s*([0-9a-f]+)/i);\n        if (sigPndMatch) {\n          const pending = parseInt(sigPndMatch[1], 16);\n          if (pending > 0) {\n            this.log(`Pending signals detected: 0x${pending.toString(16)}`);\n          }\n        }\n      } catch {\n        // Not on Linux or no access\n      }\n    }, 1000);\n  }\n\n  /**\n   * Install exception armor to catch all unhandled errors\n   */\n  private installExceptionArmor(): void {\n    // Uncaught exceptions\n    process.on('uncaughtException', (error, origin) => {\n      this.handleException(error, origin);\n    });\n\n    // Unhandled promise rejections\n    process.on('unhandledRejection', (reason, promise) => {\n      this.handleRejection(reason, promise);\n    });\n\n    // Warning events (can indicate attack attempts)\n    process.on('warning', (warning) => {\n      this.handleWarning(warning);\n    });\n\n    this.log('Exception armor installed');\n  }\n\n  /**\n   * Handle uncaught exception without crashing\n   */\n  private handleException(error: Error, origin: string): void {\n    this.blockedExceptions++;\n\n    const event: AttackEvent = {\n      type: 'exception',\n      timestamp: Date.now(),\n      details: `Caught ${origin}: ${error.message}`,\n      blocked: true,\n      source: error.stack?.split('\\n')[1] || 'unknown',\n    };\n\n    this.logAttack(event);\n\n    // Check for potential attack patterns\n    if (this.isAttackPattern(error)) {\n      this.blockedAttacks++;\n      this.config.onAttackDetected?.(event);\n    }\n\n    // Don't crash - continue execution\n    this.log(`Exception armored (${origin}): ${error.message}`);\n  }\n\n  /**\n   * Handle unhandled promise rejection without crashing\n   */\n  private handleRejection(reason: unknown, _promise: Promise<unknown>): void {\n    this.blockedExceptions++;\n\n    const message = reason instanceof Error ? reason.message : String(reason);\n    const event: AttackEvent = {\n      type: 'rejection',\n      timestamp: Date.now(),\n      details: `Caught unhandled rejection: ${message}`,\n      blocked: true,\n    };\n\n    this.logAttack(event);\n    this.log(`Rejection armored: ${message}`);\n  }\n\n  /**\n   * Handle process warnings\n   */\n  private handleWarning(warning: Error): void {\n    // Check for resource exhaustion warnings\n    if (warning.name === 'MaxListenersExceededWarning') {\n      this.log(`WARNING: Event listener limit exceeded - possible attack`);\n      this.blockedAttacks++;\n    }\n\n    if (warning.message.includes('memory') || warning.message.includes('heap')) {\n      this.log(`WARNING: Memory warning - ${warning.message}`);\n      this.triggerGC();\n    }\n  }\n\n  /**\n   * Check if an error matches known attack patterns\n   */\n  private isAttackPattern(error: Error): boolean {\n    const attackPatterns = [\n      /stack overflow/i,\n      /heap out of memory/i,\n      /allocation failed/i,\n      /too many open files/i,\n      /ENFILE/i,\n      /EMFILE/i,\n      /segmentation fault/i,\n      /invalid opcode/i,\n      /bus error/i,\n      /illegal instruction/i,\n      /RangeError.*Maximum call stack/i,\n      /process\\.kill/i,\n      /child_process/i,\n    ];\n\n    return attackPatterns.some(pattern =>\n      pattern.test(error.message) || pattern.test(error.stack || '')\n    );\n  }\n\n  /**\n   * Install guard on process.exit to prevent unauthorized termination\n   */\n  private installProcessExitGuard(): void {\n    const self = this;\n\n    // Override process.exit\n    (process as any).exit = function guardedExit(code?: number): never {\n      if (self.isShuttingDown) {\n        // Authorized shutdown\n        return self.originalProcessExit(code);\n      }\n\n      if (self.criticalSection) {\n        // Block exit during critical section\n        self.log(`Blocked process.exit(${code}) during critical section`);\n        self.blockedAttacks++;\n        // Return without exiting - this is intentionally non-compliant with the never return type\n        // to prevent termination attacks\n        throw new Error('Exit blocked during critical section');\n      }\n\n      // Log the exit attempt\n      const stack = new Error().stack;\n      const event: AttackEvent = {\n        type: 'exit_attempt',\n        timestamp: Date.now(),\n        details: `Intercepted process.exit(${code})`,\n        blocked: true,\n        source: stack?.split('\\n')[2] || 'unknown',\n      };\n      self.logAttack(event);\n\n      // Allow exit for legitimate shutdown scenarios\n      if (code === 0) {\n        self.log('Allowing clean exit (code 0)');\n        return self.originalProcessExit(0);\n      }\n\n      // Block unexpected exits\n      self.log(`Blocked unexpected exit with code ${code}`);\n      self.blockedAttacks++;\n      throw new Error(`Exit blocked: code ${code}`);\n    };\n\n    this.log('Process exit guard installed');\n  }\n\n  /**\n   * Install input sanitization to prevent malformed input crashes\n   */\n  private installInputSanitization(): void {\n    const originalStdinOn = process.stdin.on.bind(process.stdin);\n\n    process.stdin.on = function(event: string, listener: (...args: any[]) => void) {\n      if (event === 'data') {\n        const wrappedListener = (data: Buffer | string) => {\n          try {\n            // Check for oversized input (potential buffer overflow attempt)\n            const size = Buffer.isBuffer(data) ? data.length : Buffer.byteLength(data);\n            if (size > 10 * 1024 * 1024) { // 10MB limit\n              protectionInstance?.log(`Blocked oversized input: ${size} bytes`);\n              if (protectionInstance) protectionInstance.blockedAttacks++;\n              return;\n            }\n\n            // Check for null bytes (potential injection)\n            const str = data.toString();\n            if (str.includes('\\x00')) {\n              protectionInstance?.log('Blocked input with null bytes');\n              if (protectionInstance) protectionInstance.blockedAttacks++;\n              return;\n            }\n\n            listener(data);\n          } catch (error) {\n            protectionInstance?.log(`Input sanitization caught error: ${error}`);\n          }\n        };\n        return originalStdinOn(event, wrappedListener);\n      }\n      return originalStdinOn(event, listener);\n    } as typeof process.stdin.on;\n\n    this.log('Input sanitization installed');\n  }\n\n  /**\n   * Install network protection against remote termination attacks\n   */\n  private installNetworkProtection(): void {\n    // Monitor for unexpected network activity that could indicate C2 termination commands\n    try {\n      const net = require('net');\n      const originalConnect = net.Socket.prototype.connect;\n\n      net.Socket.prototype.connect = function(...args: any[]) {\n        const options = args[0];\n\n        // Check for suspicious connections\n        if (typeof options === 'object') {\n          const host = options.host || options.path;\n          const port = options.port;\n\n          // Block connections to known malicious ports\n          const suspiciousPorts = [4444, 5555, 6666, 7777, 8888, 9999, 1337, 31337];\n          if (suspiciousPorts.includes(port)) {\n            protectionInstance?.log(`Blocked suspicious connection to port ${port}`);\n            if (protectionInstance) protectionInstance.blockedAttacks++;\n            const err = new Error('Connection blocked by security policy');\n            this.emit('error', err);\n            return this;\n          }\n        }\n\n        return originalConnect.apply(this, args);\n      };\n    } catch {\n      // Network module not available\n    }\n\n    this.log('Network protection installed');\n  }\n\n  /**\n   * Install parent process protection\n   */\n  private installParentProcessProtection(): void {\n    // Monitor parent process - if it dies, we become an orphan but keep running\n    const checkParent = () => {\n      try {\n        // On Unix, PPID 1 means we're orphaned (adopted by init)\n        if (process.platform !== 'win32') {\n          const ppid = process.ppid;\n          if (ppid === 1) {\n            this.log('Parent process died - continuing as orphan');\n            // Continue running - don't terminate\n          }\n        }\n      } catch {\n        // Ignore\n      }\n    };\n\n    setInterval(checkParent, 5000);\n\n    // Handle SIGHUP (sent when parent terminal closes)\n    process.on('SIGHUP', () => {\n      this.log('SIGHUP received (terminal closed) - continuing execution');\n      // Don't exit - keep running\n    });\n\n    this.log('Parent process protection installed');\n  }\n\n  /**\n   * Install file descriptor protection\n   */\n  private installFileDescriptorProtection(): void {\n    // Track open file descriptors\n    let fdCount = 0;\n    const maxFDs = 10000; // Reasonable limit\n\n    const fs = require('fs');\n    const originalOpen = fs.open;\n    const originalClose = fs.close;\n\n    fs.open = function(...args: any[]) {\n      if (fdCount >= maxFDs) {\n        protectionInstance?.log(`FD exhaustion attack blocked (${fdCount} open)`);\n        if (protectionInstance) protectionInstance.blockedAttacks++;\n        const callback = args[args.length - 1];\n        if (typeof callback === 'function') {\n          callback(new Error('Too many open files - security limit'));\n        }\n        return;\n      }\n      fdCount++;\n      return originalOpen.apply(this, args);\n    };\n\n    fs.close = function(...args: any[]) {\n      fdCount = Math.max(0, fdCount - 1);\n      return originalClose.apply(this, args);\n    };\n\n    this.log('File descriptor protection installed');\n  }\n\n  /**\n   * Install memory protection\n   */\n  private installMemoryProtection(): void {\n    // Set up memory monitoring\n    const checkMemory = () => {\n      const usage = process.memoryUsage();\n      const heapUsedMB = usage.heapUsed / 1024 / 1024;\n      const heapTotalMB = usage.heapTotal / 1024 / 1024;\n      const usagePercent = (heapUsedMB / heapTotalMB) * 100;\n\n      if (usagePercent > this.config.memoryThresholdPercent) {\n        this.log(`Memory usage high (${usagePercent.toFixed(1)}%) - triggering GC`);\n        this.triggerGC();\n      }\n\n      // Detect rapid memory growth (potential DoS)\n      if (usage.heapUsed > usage.heapTotal * 0.95) {\n        this.log('WARNING: Heap nearly exhausted - possible memory attack');\n        this.blockedAttacks++;\n        this.triggerGC();\n      }\n    };\n\n    setInterval(checkMemory, 10000);\n\n    this.log('Memory protection installed');\n  }\n\n  /**\n   * Start resource monitoring\n   */\n  private startResourceMonitoring(): void {\n    this.resourceMonitorTimer = setInterval(() => {\n      const usage = process.memoryUsage();\n      const cpuUsage = process.cpuUsage();\n\n      // Check for resource exhaustion attacks\n      if (usage.heapUsed > 1024 * 1024 * 1024) { // 1GB\n        this.log('WARNING: High memory usage detected');\n        this.triggerGC();\n      }\n\n      // Log metrics periodically\n      if (this.config.verbose) {\n        this.log(`Resources: heap=${(usage.heapUsed / 1024 / 1024).toFixed(1)}MB, cpu=${cpuUsage.user}us`);\n      }\n    }, this.config.watchdogIntervalMs);\n\n    this.log('Resource monitoring started');\n  }\n\n  /**\n   * Start watchdog heartbeat\n   */\n  private startWatchdog(): void {\n    this.watchdogTimer = setInterval(() => {\n      this.lastHeartbeat = Date.now();\n\n      // Self-integrity check\n      if (!this.verifySelfIntegrity()) {\n        this.log('WARNING: Self-integrity check failed');\n        this.blockedAttacks++;\n      }\n    }, this.config.watchdogIntervalMs);\n\n    this.log('Watchdog started');\n  }\n\n  /**\n   * Verify runtime self-integrity\n   */\n  private verifySelfIntegrity(): boolean {\n    try {\n      // Check that our protection is still active\n      if (!this.signalHandlers.size && this.config.interceptSignals) {\n        return false;\n      }\n\n      // Check process.exit is still guarded\n      if ((process as any).exit === this.originalProcessExit) {\n        return false;\n      }\n\n      // Check timers are still running\n      if (!this.watchdogTimer && this.config.enableWatchdog) {\n        return false;\n      }\n\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Trigger garbage collection if available\n   */\n  private triggerGC(): void {\n    try {\n      if (global.gc) {\n        global.gc();\n        this.log('Garbage collection triggered');\n      }\n    } catch {\n      // GC not exposed\n    }\n  }\n\n  /**\n   * Enter critical section - blocks all termination\n   */\n  enterCriticalSection(): void {\n    this.criticalSectionDepth++;\n    this.criticalSection = true;\n  }\n\n  /**\n   * Exit critical section\n   */\n  exitCriticalSection(): void {\n    this.criticalSectionDepth = Math.max(0, this.criticalSectionDepth - 1);\n    if (this.criticalSectionDepth === 0) {\n      this.criticalSection = false;\n    }\n  }\n\n  /**\n   * Register a shutdown callback\n   */\n  onShutdown(callback: () => Promise<void> | void): void {\n    this.shutdownCallbacks.push(callback);\n  }\n\n  /**\n   * Initiate authorized graceful shutdown\n   */\n  async shutdown(code = 0): Promise<void> {\n    if (this.isShuttingDown) return;\n\n    this.isShuttingDown = true;\n    this.log(`Initiating authorized shutdown (code: ${code})`);\n\n    // Run shutdown callbacks\n    for (const callback of this.shutdownCallbacks) {\n      try {\n        await callback();\n      } catch (error) {\n        this.log(`Shutdown callback error: ${error}`);\n      }\n    }\n\n    // Cleanup\n    this.cleanup();\n\n    // Actual exit\n    this.originalProcessExit(code);\n  }\n\n  /**\n   * Cleanup protection resources\n   */\n  private cleanup(): void {\n    if (this.watchdogTimer) {\n      clearInterval(this.watchdogTimer);\n      this.watchdogTimer = null;\n    }\n\n    if (this.resourceMonitorTimer) {\n      clearInterval(this.resourceMonitorTimer);\n      this.resourceMonitorTimer = null;\n    }\n\n    // Remove signal handlers\n    for (const [signal, handler] of this.signalHandlers) {\n      try {\n        process.removeListener(signal as NodeJS.Signals, handler);\n      } catch {\n        // Ignore\n      }\n    }\n    this.signalHandlers.clear();\n  }\n\n  /**\n   * Log an attack event\n   */\n  private logAttack(event: AttackEvent): void {\n    this.attackLog.push(event);\n\n    // Keep only last 1000 events\n    if (this.attackLog.length > 1000) {\n      this.attackLog = this.attackLog.slice(-1000);\n    }\n\n    if (this.config.verbose) {\n      this.log(`ATTACK: ${event.type} - ${event.details}`);\n    }\n\n    this.config.onAttackDetected?.(event);\n  }\n\n  /**\n   * Internal logging\n   */\n  private log(message: string): void {\n    if (this.config.verbose || process.env['AGI_DEBUG']) {\n      console.error(`[AntiTermination] ${message}`);\n    }\n  }\n\n  /**\n   * Get current protection status\n   */\n  getStatus(): ProtectionStatus {\n    const usage = process.memoryUsage();\n    const cpuUsage = process.cpuUsage();\n\n    return {\n      enabled: true,\n      signalProtection: this.signalHandlers.size > 0,\n      resourceProtection: this.resourceMonitorTimer !== null,\n      exceptionArmor: true,\n      watchdogActive: this.watchdogTimer !== null,\n      blockedSignals: this.blockedSignals,\n      blockedExceptions: this.blockedExceptions,\n      blockedAttacks: this.blockedAttacks,\n      uptimeMs: Date.now() - this.startTime,\n      memoryUsageMB: usage.heapUsed / 1024 / 1024,\n      cpuUsagePercent: cpuUsage.user / 1000000, // Convert to seconds\n      lastHeartbeat: this.lastHeartbeat,\n    };\n  }\n\n  /**\n   * Get attack log\n   */\n  getAttackLog(): AttackEvent[] {\n    return [...this.attackLog];\n  }\n}\n\n/**\n * Initialize global protection (singleton)\n */\nexport function initializeProtection(config?: AntiTerminationConfig): AntiTerminationProtection {\n  if (!protectionInstance) {\n    protectionInstance = new AntiTerminationProtection(config);\n    protectionInstance.initialize();\n  }\n  return protectionInstance;\n}\n\n/**\n * Get protection instance\n */\nexport function getProtection(): AntiTerminationProtection | null {\n  return protectionInstance;\n}\n\n/**\n * Enter critical section - blocks all termination attempts\n */\nexport function enterCriticalSection(): void {\n  protectionInstance?.enterCriticalSection();\n}\n\n/**\n * Exit critical section\n */\nexport function exitCriticalSection(): void {\n  protectionInstance?.exitCriticalSection();\n}\n\n/**\n * Initiate authorized shutdown\n */\nexport async function authorizedShutdown(code = 0): Promise<void> {\n  if (protectionInstance) {\n    await protectionInstance.shutdown(code);\n  } else {\n    process.exit(code);\n  }\n}\n\n/**\n * Get protection status\n */\nexport function getProtectionStatus(): ProtectionStatus | null {\n  return protectionInstance?.getStatus() ?? null;\n}\n\n// Auto-initialize if AGI_ANTI_TERMINATION env var is set\nif (process.env['AGI_ANTI_TERMINATION'] === '1' || process.env['AGI_PROTECTED_MODE'] === '1') {\n  initializeProtection({ verbose: process.env['AGI_DEBUG'] === '1' });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
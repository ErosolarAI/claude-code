{"version":3,"names":["_nodeFs","require","_nodePath","_debugLogger","scoreEditReality","edit","score","total","components","fileExists","contentMatch","syntaxValid","importsValid","testable","confidence","warnings","passed","failed","scoreFileExists","filePath","scoreContentMatch","scoreSyntaxValidity","scoreImportsValidity","scoreTestability","length","logDebug","existsSync","stats","statSync","isFile","push","dir","dirname","content","readFileSync","oldString","trim","includes","normalizedContent","replace","normalizedOld","oldLines","split","filter","l","contentLines","matchedLines","oldLine","trimmedOld","some","cl","matchRatio","Math","round","error","ext","extname","toLowerCase","newString","startsWith","JSON","parse","syntaxIssues","checkJSTSSyntax","max","checkPythonSyntax","code","issues","balanceCheck","checkBalancedDelimiters","test","lines","expectedIndent","line","indent","match","singleQuotes","doubleQuotes","tripleQuotes","stack","pairs","closers","Set","Object","values","codeWithoutStrings","char","has","pop","imports","extractImports","validImports","workingDir","imp","isValidImport","ratio","esImports","matchAll","cjsImports","pyImports","mod","importPath","nodeBuiltins","pythonStdlib","extensions","tryExt","fullPath","join","indexPath","commonPackages","packageName","i","nodeModulesPath","parent","fileName","basename","testabilityScore","testPatterns","pattern","pkgPath","pkg","scripts","build","typecheck","min","quickRealityCheck","isReal","reason","formatRealityScore","emoji","color","summary","map","w","p","f","REALITY_THRESHOLDS","exports","REJECT","REVIEW","AUTO_APPROVE","editOutcomes","MAX_OUTCOMES","recordEditOutcome","outcome","shift","status","success","realityScore","recordSuccessfulEdit","outcomeDelayMs","timestamp","Date","now","recordFailedEdit","buildError","testFailure","reverted","calculateRLStats","totalEdits","successRates","high","rate","medium","low","avgSuccessScore","avgFailureScore","optimalThreshold","scoreDistribution","successScoreSum","successCount","failureScoreSum","failureCount","level","buckets","Map","bucket","floor","current","get","set","getRLRecommendation","clearRLFeedback"],"sources":["realityScore.ts"],"sourcesContent":["/**\n * Reality Score System - Hallucination Detection via Testability\n *\n * Core insight: The more testable/verifiable an edit is, the more \"real\" it is.\n * High reality score = grounded in verifiable facts\n * Low reality score = potentially hallucinated\n *\n * This scoring system works even without running full RL tournaments -\n * it provides instant feedback on whether an edit is likely to be real.\n */\n\nimport { existsSync, readFileSync, statSync } from 'node:fs';\nimport { extname, dirname, join, basename } from 'node:path';\nimport { execSync } from 'node:child_process';\nimport { logDebug } from '../utils/debugLogger.js';\n\n/**\n * Reality score breakdown for an edit operation\n */\nexport interface RealityScore {\n  /** Overall reality score 0-100 (higher = more real/testable) */\n  total: number;\n\n  /** Individual component scores */\n  components: {\n    /** Does the target file exist? (0-20) */\n    fileExists: number;\n    /** Does the old_string content actually exist in the file? (0-25) */\n    contentMatch: number;\n    /** Will the resulting code be syntactically valid? (0-20) */\n    syntaxValid: number;\n    /** Are imports/dependencies real and resolvable? (0-15) */\n    importsValid: number;\n    /** Can we run a quick test to verify? (0-20) */\n    testable: number;\n  };\n\n  /** Confidence level based on what we could verify */\n  confidence: 'high' | 'medium' | 'low';\n\n  /** Potential hallucination indicators */\n  warnings: string[];\n\n  /** What tests/checks passed */\n  passed: string[];\n\n  /** What tests/checks failed */\n  failed: string[];\n}\n\n/**\n * Edit operation to score\n */\nexport interface EditOperation {\n  filePath: string;\n  oldString: string;\n  newString: string;\n  replaceAll?: boolean;\n}\n\n/**\n * Score an edit operation for reality/testability\n */\nexport function scoreEditReality(edit: EditOperation): RealityScore {\n  const score: RealityScore = {\n    total: 0,\n    components: {\n      fileExists: 0,\n      contentMatch: 0,\n      syntaxValid: 0,\n      importsValid: 0,\n      testable: 0,\n    },\n    confidence: 'low',\n    warnings: [],\n    passed: [],\n    failed: [],\n  };\n\n  // 1. File exists check (0-20 points)\n  score.components.fileExists = scoreFileExists(edit.filePath, score);\n\n  // 2. Content match check (0-25 points) - most important for hallucination detection\n  if (score.components.fileExists > 0) {\n    score.components.contentMatch = scoreContentMatch(edit, score);\n  }\n\n  // 3. Syntax validity check (0-20 points)\n  score.components.syntaxValid = scoreSyntaxValidity(edit, score);\n\n  // 4. Import/dependency validity (0-15 points)\n  score.components.importsValid = scoreImportsValidity(edit, score);\n\n  // 5. Testability score (0-20 points)\n  score.components.testable = scoreTestability(edit, score);\n\n  // Calculate total\n  score.total =\n    score.components.fileExists +\n    score.components.contentMatch +\n    score.components.syntaxValid +\n    score.components.importsValid +\n    score.components.testable;\n\n  // Determine confidence\n  if (score.total >= 75 && score.warnings.length === 0) {\n    score.confidence = 'high';\n  } else if (score.total >= 50) {\n    score.confidence = 'medium';\n  } else {\n    score.confidence = 'low';\n  }\n\n  logDebug(`Reality score for ${edit.filePath}: ${score.total}/100 (${score.confidence})`);\n\n  return score;\n}\n\n/**\n * Score file existence (0-20 points)\n */\nfunction scoreFileExists(filePath: string, score: RealityScore): number {\n  try {\n    if (existsSync(filePath)) {\n      const stats = statSync(filePath);\n      if (stats.isFile()) {\n        score.passed.push('Target file exists');\n        return 20;\n      } else {\n        score.warnings.push('Path exists but is not a file');\n        score.failed.push('Target is not a file');\n        return 5;\n      }\n    } else {\n      // Check if it's a new file creation (directory exists)\n      const dir = dirname(filePath);\n      if (existsSync(dir)) {\n        score.passed.push('Parent directory exists (new file creation)');\n        return 15; // Slightly lower for new files\n      }\n      score.warnings.push('File does not exist and parent directory missing');\n      score.failed.push('Target file not found');\n      return 0;\n    }\n  } catch {\n    score.failed.push('Could not check file existence');\n    return 0;\n  }\n}\n\n/**\n * Score content match - does old_string actually exist? (0-25 points)\n * This is the key hallucination detector\n */\nfunction scoreContentMatch(edit: EditOperation, score: RealityScore): number {\n  try {\n    const content = readFileSync(edit.filePath, 'utf-8');\n\n    // Empty old_string means we're appending/creating\n    if (!edit.oldString || edit.oldString.trim() === '') {\n      score.passed.push('Append/create operation (no content to match)');\n      return 20; // Slightly lower since we can't verify\n    }\n\n    // Check for exact match\n    if (content.includes(edit.oldString)) {\n      score.passed.push('Old content found in file (exact match)');\n      return 25;\n    }\n\n    // Check for normalized match (whitespace differences)\n    const normalizedContent = content.replace(/\\s+/g, ' ').trim();\n    const normalizedOld = edit.oldString.replace(/\\s+/g, ' ').trim();\n\n    if (normalizedContent.includes(normalizedOld)) {\n      score.warnings.push('Content match with whitespace differences');\n      score.passed.push('Old content found (whitespace-normalized)');\n      return 18;\n    }\n\n    // Check for partial match (at least 80% of lines)\n    const oldLines = edit.oldString.split('\\n').filter(l => l.trim());\n    const contentLines = content.split('\\n');\n    let matchedLines = 0;\n\n    for (const oldLine of oldLines) {\n      const trimmedOld = oldLine.trim();\n      if (trimmedOld && contentLines.some(cl => cl.includes(trimmedOld))) {\n        matchedLines++;\n      }\n    }\n\n    const matchRatio = oldLines.length > 0 ? matchedLines / oldLines.length : 0;\n\n    if (matchRatio >= 0.8) {\n      score.warnings.push(`Partial content match (${Math.round(matchRatio * 100)}% of lines)`);\n      score.passed.push('Partial content match found');\n      return Math.round(15 * matchRatio);\n    }\n\n    // HALLUCINATION DETECTED: Content doesn't exist\n    score.warnings.push('HALLUCINATION RISK: old_string not found in file');\n    score.failed.push('Old content not found in file');\n    return 0;\n  } catch (error) {\n    score.failed.push('Could not read file for content match');\n    return 0;\n  }\n}\n\n/**\n * Score syntax validity of the new code (0-20 points)\n */\nfunction scoreSyntaxValidity(edit: EditOperation, score: RealityScore): number {\n  const ext = extname(edit.filePath).toLowerCase();\n\n  // Skip syntax check for non-code files\n  if (!['.ts', '.tsx', '.js', '.jsx', '.json', '.py', '.go', '.rs'].includes(ext)) {\n    score.passed.push('Non-code file (syntax check skipped)');\n    return 15; // Give some points but not full\n  }\n\n  try {\n    // JSON validation\n    if (ext === '.json') {\n      try {\n        // Try to parse the new content as JSON if it looks complete\n        if (edit.newString.trim().startsWith('{') || edit.newString.trim().startsWith('[')) {\n          JSON.parse(edit.newString);\n          score.passed.push('JSON syntax valid');\n          return 20;\n        }\n        score.passed.push('JSON fragment (partial validation)');\n        return 15;\n      } catch {\n        score.warnings.push('JSON syntax may be invalid');\n        score.failed.push('JSON parse error');\n        return 5;\n      }\n    }\n\n    // TypeScript/JavaScript basic validation\n    if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n      const syntaxIssues = checkJSTSSyntax(edit.newString);\n      if (syntaxIssues.length === 0) {\n        score.passed.push('JS/TS syntax appears valid');\n        return 20;\n      } else {\n        score.warnings.push(...syntaxIssues);\n        // Partial score based on severity\n        return Math.max(5, 20 - syntaxIssues.length * 3);\n      }\n    }\n\n    // Python basic validation\n    if (ext === '.py') {\n      const syntaxIssues = checkPythonSyntax(edit.newString);\n      if (syntaxIssues.length === 0) {\n        score.passed.push('Python syntax appears valid');\n        return 20;\n      } else {\n        score.warnings.push(...syntaxIssues);\n        return Math.max(5, 20 - syntaxIssues.length * 3);\n      }\n    }\n\n    score.passed.push('Basic syntax check passed');\n    return 15;\n  } catch {\n    score.failed.push('Syntax validation error');\n    return 10;\n  }\n}\n\n/**\n * Basic JS/TS syntax checks\n */\nfunction checkJSTSSyntax(code: string): string[] {\n  const issues: string[] = [];\n\n  // Check balanced braces/brackets/parens\n  const balanceCheck = checkBalancedDelimiters(code);\n  if (balanceCheck) issues.push(balanceCheck);\n\n  // Check for common syntax errors\n  if (/\\bfunction\\s+\\(/.test(code) && !/\\bfunction\\s*\\*?\\s*\\w+\\s*\\(/.test(code) && !/\\bfunction\\s*\\(/.test(code)) {\n    // This is actually valid for anonymous functions, skip\n  }\n\n  // Check for incomplete statements\n  if (/^\\s*(const|let|var)\\s+\\w+\\s*$/.test(code.trim())) {\n    issues.push('Incomplete variable declaration');\n  }\n\n  // Check for obviously broken syntax\n  if (/\\)\\s*\\{[^}]*$/.test(code) && !code.includes('}')) {\n    issues.push('Unclosed function/block');\n  }\n\n  return issues;\n}\n\n/**\n * Basic Python syntax checks\n */\nfunction checkPythonSyntax(code: string): string[] {\n  const issues: string[] = [];\n\n  // Check for consistent indentation\n  const lines = code.split('\\n');\n  let expectedIndent = 0;\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indent = line.match(/^(\\s*)/)?.[1].length ?? 0;\n\n    // Check for mixed tabs and spaces\n    if (line.match(/^\\t+ +/) || line.match(/^ +\\t+/)) {\n      issues.push('Mixed tabs and spaces in indentation');\n      break;\n    }\n\n    // Check if indentation is a multiple of 2 or 4\n    if (indent > 0 && indent % 2 !== 0 && indent % 4 !== 0) {\n      issues.push('Inconsistent indentation');\n      break;\n    }\n  }\n\n  // Check for unclosed strings\n  const singleQuotes = (code.match(/'/g) || []).length;\n  const doubleQuotes = (code.match(/\"/g) || []).length;\n  const tripleQuotes = (code.match(/\"\"\"/g) || []).length;\n\n  if ((singleQuotes - tripleQuotes * 3) % 2 !== 0) {\n    issues.push('Potentially unclosed single-quoted string');\n  }\n\n  return issues;\n}\n\n/**\n * Check balanced delimiters\n */\nfunction checkBalancedDelimiters(code: string): string | null {\n  const stack: string[] = [];\n  const pairs: Record<string, string> = { '(': ')', '[': ']', '{': '}' };\n  const closers = new Set(Object.values(pairs));\n\n  // Remove string contents to avoid false positives\n  const codeWithoutStrings = code\n    .replace(/\"(?:[^\"\\\\]|\\\\.)*\"/g, '\"\"')\n    .replace(/'(?:[^'\\\\]|\\\\.)*'/g, \"''\")\n    .replace(/`(?:[^`\\\\]|\\\\.)*`/g, '``');\n\n  for (const char of codeWithoutStrings) {\n    if (pairs[char]) {\n      stack.push(pairs[char]);\n    } else if (closers.has(char)) {\n      if (stack.length === 0 || stack.pop() !== char) {\n        return `Unbalanced delimiter: unexpected '${char}'`;\n      }\n    }\n  }\n\n  if (stack.length > 0) {\n    return `Unclosed delimiter: missing '${stack[stack.length - 1]}'`;\n  }\n\n  return null;\n}\n\n/**\n * Score import/dependency validity (0-15 points)\n */\nfunction scoreImportsValidity(edit: EditOperation, score: RealityScore): number {\n  const ext = extname(edit.filePath).toLowerCase();\n\n  if (!['.ts', '.tsx', '.js', '.jsx', '.py'].includes(ext)) {\n    score.passed.push('Non-import file type');\n    return 10;\n  }\n\n  try {\n    const imports = extractImports(edit.newString, ext);\n\n    if (imports.length === 0) {\n      score.passed.push('No imports to validate');\n      return 15;\n    }\n\n    let validImports = 0;\n    const workingDir = dirname(edit.filePath);\n\n    for (const imp of imports) {\n      if (isValidImport(imp, workingDir, ext)) {\n        validImports++;\n      } else {\n        score.warnings.push(`Potentially invalid import: ${imp}`);\n      }\n    }\n\n    const ratio = validImports / imports.length;\n\n    if (ratio === 1) {\n      score.passed.push('All imports appear valid');\n      return 15;\n    } else if (ratio >= 0.7) {\n      score.passed.push(`Most imports valid (${validImports}/${imports.length})`);\n      return Math.round(15 * ratio);\n    } else {\n      score.warnings.push('HALLUCINATION RISK: Many imports may be invalid');\n      score.failed.push(`Many invalid imports (${imports.length - validImports}/${imports.length})`);\n      return Math.round(15 * ratio);\n    }\n  } catch {\n    score.failed.push('Import validation error');\n    return 5;\n  }\n}\n\n/**\n * Extract imports from code\n */\nfunction extractImports(code: string, ext: string): string[] {\n  const imports: string[] = [];\n\n  if (['.ts', '.tsx', '.js', '.jsx'].includes(ext)) {\n    // ES6 imports\n    const esImports = code.matchAll(/import\\s+.*?\\s+from\\s+['\"]([^'\"]+)['\"]/g);\n    for (const match of esImports) {\n      if (match[1]) imports.push(match[1]);\n    }\n\n    // CommonJS requires\n    const cjsImports = code.matchAll(/require\\s*\\(\\s*['\"]([^'\"]+)['\"]\\s*\\)/g);\n    for (const match of cjsImports) {\n      if (match[1]) imports.push(match[1]);\n    }\n  } else if (ext === '.py') {\n    // Python imports\n    const pyImports = code.matchAll(/(?:from\\s+(\\S+)\\s+import|import\\s+(\\S+))/g);\n    for (const match of pyImports) {\n      const mod = match[1] || match[2];\n      if (mod) imports.push(mod.split('.')[0] ?? mod);\n    }\n  }\n\n  return [...new Set(imports)];\n}\n\n/**\n * Check if an import is valid\n */\nfunction isValidImport(importPath: string, workingDir: string, ext: string): boolean {\n  // Node built-ins\n  const nodeBuiltins = new Set([\n    'fs', 'path', 'os', 'util', 'events', 'stream', 'http', 'https',\n    'crypto', 'buffer', 'child_process', 'cluster', 'dgram', 'dns',\n    'net', 'readline', 'repl', 'tls', 'tty', 'url', 'v8', 'vm', 'zlib',\n    'assert', 'async_hooks', 'console', 'constants', 'domain', 'inspector',\n    'perf_hooks', 'process', 'punycode', 'querystring', 'string_decoder',\n    'timers', 'trace_events', 'worker_threads', 'node:fs', 'node:path',\n    'node:os', 'node:util', 'node:events', 'node:stream', 'node:http',\n    'node:https', 'node:crypto', 'node:buffer', 'node:child_process',\n  ]);\n\n  // Python standard library (common modules)\n  const pythonStdlib = new Set([\n    'os', 'sys', 'json', 're', 'math', 'datetime', 'collections', 'itertools',\n    'functools', 'typing', 'pathlib', 'subprocess', 'threading', 'asyncio',\n    'logging', 'argparse', 'unittest', 'pytest', 'time', 'random', 'copy',\n    'pickle', 'socket', 'http', 'urllib', 'email', 'html', 'xml', 'sqlite3',\n    'csv', 'io', 'shutil', 'tempfile', 'glob', 'hashlib', 'base64', 'struct',\n  ]);\n\n  // Check built-ins\n  if (ext === '.py') {\n    if (pythonStdlib.has(importPath)) return true;\n  } else {\n    if (nodeBuiltins.has(importPath) || importPath.startsWith('node:')) return true;\n  }\n\n  // Relative imports - check if file exists\n  if (importPath.startsWith('.')) {\n    const extensions = ext === '.py' ? ['.py', ''] : ['.ts', '.tsx', '.js', '.jsx', '.json', ''];\n\n    for (const tryExt of extensions) {\n      const fullPath = join(workingDir, importPath + tryExt);\n      if (existsSync(fullPath)) return true;\n\n      // Check for index file\n      const indexPath = join(workingDir, importPath, `index${tryExt}`);\n      if (existsSync(indexPath)) return true;\n    }\n\n    return false;\n  }\n\n  // Package imports - check node_modules or assume valid for common packages\n  const commonPackages = new Set([\n    'react', 'vue', 'angular', 'express', 'lodash', 'axios', 'moment',\n    'chalk', 'commander', 'inquirer', 'ora', 'yargs', 'typescript',\n    'webpack', 'rollup', 'vite', 'esbuild', 'jest', 'mocha', 'chai',\n    '@types', '@babel', '@typescript-eslint', 'eslint', 'prettier',\n    'numpy', 'pandas', 'requests', 'flask', 'django', 'fastapi',\n    'tensorflow', 'torch', 'sklearn', 'matplotlib', 'scipy',\n  ]);\n\n  const packageName = importPath.split('/')[0] ?? importPath;\n  if (commonPackages.has(packageName)) return true;\n\n  // Check node_modules\n  try {\n    // Walk up to find node_modules\n    let dir = workingDir;\n    for (let i = 0; i < 10; i++) {\n      const nodeModulesPath = join(dir, 'node_modules', packageName);\n      if (existsSync(nodeModulesPath)) return true;\n\n      const parent = dirname(dir);\n      if (parent === dir) break;\n      dir = parent;\n    }\n  } catch {\n    // Ignore errors\n  }\n\n  // Can't verify - give benefit of doubt for external packages\n  return true;\n}\n\n/**\n * Score testability - can we verify this edit? (0-20 points)\n */\nfunction scoreTestability(edit: EditOperation, score: RealityScore): number {\n  const ext = extname(edit.filePath).toLowerCase();\n  const fileName = basename(edit.filePath);\n\n  let testabilityScore = 0;\n\n  // Check if there are related test files\n  const testPatterns = [\n    edit.filePath.replace(ext, `.test${ext}`),\n    edit.filePath.replace(ext, `.spec${ext}`),\n    edit.filePath.replace('/src/', '/test/'),\n    edit.filePath.replace('/src/', '/__tests__/'),\n  ];\n\n  for (const pattern of testPatterns) {\n    if (existsSync(pattern)) {\n      score.passed.push(`Related test file exists: ${basename(pattern)}`);\n      testabilityScore += 5;\n      break;\n    }\n  }\n\n  // Check if file is in a testable project (has package.json with test script)\n  try {\n    let dir = dirname(edit.filePath);\n    for (let i = 0; i < 5; i++) {\n      const pkgPath = join(dir, 'package.json');\n      if (existsSync(pkgPath)) {\n        const pkg = JSON.parse(readFileSync(pkgPath, 'utf-8'));\n        if (pkg.scripts?.test) {\n          score.passed.push('Project has test script');\n          testabilityScore += 5;\n        }\n        if (pkg.scripts?.build || pkg.scripts?.typecheck) {\n          score.passed.push('Project has build/typecheck script');\n          testabilityScore += 3;\n        }\n        break;\n      }\n      const parent = dirname(dir);\n      if (parent === dir) break;\n      dir = parent;\n    }\n  } catch {\n    // Ignore errors\n  }\n\n  // TypeScript files can be type-checked\n  if (['.ts', '.tsx'].includes(ext)) {\n    score.passed.push('TypeScript (can be type-checked)');\n    testabilityScore += 4;\n  }\n\n  // Check if edit introduces testable patterns\n  if (edit.newString.includes('export ')) {\n    score.passed.push('Has exports (testable interface)');\n    testabilityScore += 3;\n  }\n\n  // Cap at 20\n  return Math.min(20, testabilityScore);\n}\n\n/**\n * Quick reality check - returns true if edit is likely real, false if potentially hallucinated\n */\nexport function quickRealityCheck(edit: EditOperation): { isReal: boolean; reason: string } {\n  // Fast checks only\n\n  // 1. File must exist for edits (not creates)\n  if (edit.oldString && edit.oldString.trim()) {\n    if (!existsSync(edit.filePath)) {\n      return { isReal: false, reason: 'File does not exist' };\n    }\n\n    // 2. Old content must exist in file\n    try {\n      const content = readFileSync(edit.filePath, 'utf-8');\n      if (!content.includes(edit.oldString)) {\n        // Try normalized match\n        const normalizedContent = content.replace(/\\s+/g, ' ');\n        const normalizedOld = edit.oldString.replace(/\\s+/g, ' ');\n        if (!normalizedContent.includes(normalizedOld)) {\n          return { isReal: false, reason: 'Content to replace not found in file' };\n        }\n      }\n    } catch {\n      return { isReal: false, reason: 'Could not read file' };\n    }\n  }\n\n  return { isReal: true, reason: 'Basic checks passed' };\n}\n\n/**\n * Get a human-readable summary of the reality score\n */\nexport function formatRealityScore(score: RealityScore): string {\n  const emoji = score.confidence === 'high' ? 'âœ“' : score.confidence === 'medium' ? '?' : 'âš ';\n  const color = score.confidence === 'high' ? 'green' : score.confidence === 'medium' ? 'yellow' : 'red';\n\n  let summary = `${emoji} Reality Score: ${score.total}/100 (${score.confidence} confidence)\\n`;\n\n  if (score.warnings.length > 0) {\n    summary += `\\nWarnings:\\n${score.warnings.map(w => `  - ${w}`).join('\\n')}`;\n  }\n\n  if (score.passed.length > 0 && score.confidence !== 'high') {\n    summary += `\\nPassed:\\n${score.passed.map(p => `  âœ“ ${p}`).join('\\n')}`;\n  }\n\n  if (score.failed.length > 0) {\n    summary += `\\nFailed:\\n${score.failed.map(f => `  âœ— ${f}`).join('\\n')}`;\n  }\n\n  return summary;\n}\n\n/**\n * Score threshold recommendations\n */\nexport const REALITY_THRESHOLDS = {\n  /** Edits below this score should be rejected */\n  REJECT: 25,\n  /** Edits below this score need human review */\n  REVIEW: 50,\n  /** Edits at or above this score can proceed automatically */\n  AUTO_APPROVE: 75,\n};\n\n// ============================================================================\n// RL-Style Feedback Loop - Learning from Edit Outcomes\n// ============================================================================\n\n/**\n * Edit outcome for RL feedback\n */\nexport interface EditOutcome {\n  /** Timestamp of the edit */\n  timestamp: number;\n  /** File that was edited */\n  filePath: string;\n  /** Reality score at time of edit */\n  realityScore: number;\n  /** Confidence level */\n  confidence: 'high' | 'medium' | 'low';\n  /** Did the edit succeed without issues? */\n  success: boolean;\n  /** Was there a build error after? */\n  buildError?: boolean;\n  /** Was there a test failure after? */\n  testFailure?: boolean;\n  /** Was the edit reverted? */\n  reverted?: boolean;\n  /** Time until outcome was determined (ms) */\n  outcomeDelayMs?: number;\n}\n\n/**\n * RL feedback statistics\n */\nexport interface RLFeedbackStats {\n  /** Total edits tracked */\n  totalEdits: number;\n  /** Success rate by confidence level */\n  successRates: {\n    high: { total: number; success: number; rate: number };\n    medium: { total: number; success: number; rate: number };\n    low: { total: number; success: number; rate: number };\n  };\n  /** Average score for successful edits */\n  avgSuccessScore: number;\n  /** Average score for failed edits */\n  avgFailureScore: number;\n  /** Optimal threshold (where success rate crosses 80%) */\n  optimalThreshold: number;\n  /** Score distribution */\n  scoreDistribution: {\n    '0-25': number;\n    '26-50': number;\n    '51-75': number;\n    '76-100': number;\n  };\n}\n\n// In-memory RL feedback buffer (persisted per session)\nconst editOutcomes: EditOutcome[] = [];\nconst MAX_OUTCOMES = 1000;\n\n/**\n * Record an edit outcome for RL learning\n */\nexport function recordEditOutcome(outcome: EditOutcome): void {\n  editOutcomes.push(outcome);\n\n  // Limit buffer size\n  if (editOutcomes.length > MAX_OUTCOMES) {\n    editOutcomes.shift();\n  }\n\n  // Log for debugging\n  const status = outcome.success ? 'âœ“' : 'âœ—';\n  logDebug(`RL Feedback: ${status} score=${outcome.realityScore} file=${outcome.filePath}`);\n}\n\n/**\n * Record a successful edit\n */\nexport function recordSuccessfulEdit(\n  filePath: string,\n  score: RealityScore,\n  outcomeDelayMs?: number\n): void {\n  recordEditOutcome({\n    timestamp: Date.now(),\n    filePath,\n    realityScore: score.total,\n    confidence: score.confidence,\n    success: true,\n    outcomeDelayMs,\n  });\n}\n\n/**\n * Record a failed edit (build error, test failure, revert)\n */\nexport function recordFailedEdit(\n  filePath: string,\n  score: RealityScore,\n  reason: 'build_error' | 'test_failure' | 'reverted' | 'other'\n): void {\n  recordEditOutcome({\n    timestamp: Date.now(),\n    filePath,\n    realityScore: score.total,\n    confidence: score.confidence,\n    success: false,\n    buildError: reason === 'build_error',\n    testFailure: reason === 'test_failure',\n    reverted: reason === 'reverted',\n  });\n}\n\n/**\n * Calculate RL feedback statistics\n */\nexport function calculateRLStats(): RLFeedbackStats {\n  const stats: RLFeedbackStats = {\n    totalEdits: editOutcomes.length,\n    successRates: {\n      high: { total: 0, success: 0, rate: 0 },\n      medium: { total: 0, success: 0, rate: 0 },\n      low: { total: 0, success: 0, rate: 0 },\n    },\n    avgSuccessScore: 0,\n    avgFailureScore: 0,\n    optimalThreshold: REALITY_THRESHOLDS.REVIEW,\n    scoreDistribution: {\n      '0-25': 0,\n      '26-50': 0,\n      '51-75': 0,\n      '76-100': 0,\n    },\n  };\n\n  if (editOutcomes.length === 0) {\n    return stats;\n  }\n\n  let successScoreSum = 0;\n  let successCount = 0;\n  let failureScoreSum = 0;\n  let failureCount = 0;\n\n  for (const outcome of editOutcomes) {\n    // Count by confidence\n    stats.successRates[outcome.confidence].total++;\n    if (outcome.success) {\n      stats.successRates[outcome.confidence].success++;\n      successScoreSum += outcome.realityScore;\n      successCount++;\n    } else {\n      failureScoreSum += outcome.realityScore;\n      failureCount++;\n    }\n\n    // Score distribution\n    if (outcome.realityScore <= 25) {\n      stats.scoreDistribution['0-25']++;\n    } else if (outcome.realityScore <= 50) {\n      stats.scoreDistribution['26-50']++;\n    } else if (outcome.realityScore <= 75) {\n      stats.scoreDistribution['51-75']++;\n    } else {\n      stats.scoreDistribution['76-100']++;\n    }\n  }\n\n  // Calculate rates\n  for (const level of ['high', 'medium', 'low'] as const) {\n    const { total, success } = stats.successRates[level];\n    stats.successRates[level].rate = total > 0 ? success / total : 0;\n  }\n\n  // Calculate averages\n  stats.avgSuccessScore = successCount > 0 ? successScoreSum / successCount : 0;\n  stats.avgFailureScore = failureCount > 0 ? failureScoreSum / failureCount : 0;\n\n  // Calculate optimal threshold (score where success rate is ~80%)\n  // Group outcomes by score buckets and find crossover point\n  const buckets = new Map<number, { success: number; total: number }>();\n  for (const outcome of editOutcomes) {\n    const bucket = Math.floor(outcome.realityScore / 10) * 10;\n    const current = buckets.get(bucket) ?? { success: 0, total: 0 };\n    current.total++;\n    if (outcome.success) current.success++;\n    buckets.set(bucket, current);\n  }\n\n  // Find the lowest score bucket with >= 80% success rate\n  for (const score of [0, 10, 20, 30, 40, 50, 60, 70, 80, 90]) {\n    const bucket = buckets.get(score);\n    if (bucket && bucket.total >= 3) { // Minimum sample size\n      const rate = bucket.success / bucket.total;\n      if (rate >= 0.8) {\n        stats.optimalThreshold = score;\n        break;\n      }\n    }\n  }\n\n  return stats;\n}\n\n/**\n * Get RL feedback recommendation for current session\n */\nexport function getRLRecommendation(): string {\n  const stats = calculateRLStats();\n\n  if (stats.totalEdits < 10) {\n    return 'Insufficient data for RL recommendation (need 10+ edits)';\n  }\n\n  const lines: string[] = [\n    `ðŸ“Š RL Feedback Summary (${stats.totalEdits} edits)`,\n    '',\n  ];\n\n  // Success rates by confidence\n  lines.push('Success Rates by Confidence:');\n  for (const level of ['high', 'medium', 'low'] as const) {\n    const { total, rate } = stats.successRates[level];\n    if (total > 0) {\n      const emoji = rate >= 0.8 ? 'âœ“' : rate >= 0.5 ? '?' : 'âœ—';\n      lines.push(`  ${emoji} ${level}: ${Math.round(rate * 100)}% (n=${total})`);\n    }\n  }\n\n  lines.push('');\n  lines.push(`Average Score - Success: ${Math.round(stats.avgSuccessScore)} / Failure: ${Math.round(stats.avgFailureScore)}`);\n  lines.push(`Recommended Threshold: ${stats.optimalThreshold}`);\n\n  // Actionable recommendation\n  if (stats.avgFailureScore > REALITY_THRESHOLDS.REVIEW) {\n    lines.push('');\n    lines.push('âš  Warning: Failures occurring at high scores - check for runtime issues');\n  }\n\n  if (stats.successRates.low.rate > 0.5 && stats.successRates.low.total >= 5) {\n    lines.push('');\n    lines.push('ðŸ’¡ Low-confidence edits succeeding often - threshold may be too conservative');\n  }\n\n  return lines.join('\\n');\n}\n\n/**\n * Clear RL feedback buffer (for testing or reset)\n */\nexport function clearRLFeedback(): void {\n  editOutcomes.length = 0;\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["NEXT_STEPS_HEADING","ensureNextSteps","content","_context","normalized","trimEnd","output","appended","test"],"sources":["finalResponseFormatter.ts"],"sourcesContent":["/**\n * Ensures final assistant responses include a \"Next steps\" section.\n * Returns both the full output and any appended text so callers can stream just the delta.\n */\nexport interface FinalResponseFormat {\n  output: string;\n  appended: string | null;\n}\n\nconst NEXT_STEPS_HEADING = /(^|\\n)\\s*next steps?\\s*:/i;\n\nexport function ensureNextSteps(content: string, _context?: string): FinalResponseFormat {\n  const normalized = content?.trimEnd() ?? '';\n  if (!normalized) {\n    return { output: '', appended: null };\n  }\n\n  // If content already has next steps, return as-is (no duplicates)\n  if (NEXT_STEPS_HEADING.test(normalized)) {\n    return { output: normalized, appended: null };\n  }\n\n  // Don't auto-append next steps - let the AI generate contextually appropriate ones\n  return { output: normalized, appended: null };\n}\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;;AAMA,MAAMA,kBAAkB,GAAG,2BAA2B;AAE/C,SAASC,eAAeA,CAACC,OAAe,EAAEC,QAAiB,EAAuB;EACvF,MAAMC,UAAU,GAAGF,OAAO,EAAEG,OAAO,CAAC,CAAC,IAAI,EAAE;EAC3C,IAAI,CAACD,UAAU,EAAE;IACf,OAAO;MAAEE,MAAM,EAAE,EAAE;MAAEC,QAAQ,EAAE;IAAK,CAAC;EACvC;;EAEA;EACA,IAAIP,kBAAkB,CAACQ,IAAI,CAACJ,UAAU,CAAC,EAAE;IACvC,OAAO;MAAEE,MAAM,EAAEF,UAAU;MAAEG,QAAQ,EAAE;IAAK,CAAC;EAC/C;;EAEA;EACA,OAAO;IAAED,MAAM,EAAEF,UAAU;IAAEG,QAAQ,EAAE;EAAK,CAAC;AAC/C","ignoreList":[]}
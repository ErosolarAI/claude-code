{"version":3,"names":["resolveWinner","input","pickWinner","primary","variantResults","refiner","tournamentOutcome","ranked","length","top","winnerVariant","candidateId","humanAccuracy","winner","modeDefinition"],"sources":["winnerStrategy.ts"],"sourcesContent":["import type { TournamentOutcome } from './dualTournament.js';\nimport type { RepoUpgradeModeDefinition, UpgradeStepResult, UpgradeVariant } from './repoUpgradeOrchestrator.js';\n\nexport interface WinnerResolutionInput {\n  modeDefinition: RepoUpgradeModeDefinition;\n  variantResults: Partial<Record<UpgradeVariant, UpgradeStepResult>>;\n  tournamentOutcome: TournamentOutcome | null;\n}\n\nexport function resolveWinner(\n  input: WinnerResolutionInput,\n  pickWinner: (definition: RepoUpgradeModeDefinition, primary: UpgradeStepResult, refiner?: UpgradeStepResult) => {\n    winner: UpgradeStepResult;\n    winnerVariant: UpgradeVariant;\n  }\n): { winner: UpgradeStepResult; winnerVariant: UpgradeVariant } {\n  const primary = input.variantResults.primary!;\n  const refiner = input.variantResults.refiner;\n\n  if (input.tournamentOutcome?.ranked?.length) {\n    const top = input.tournamentOutcome.ranked[0]!;\n    const winnerVariant: UpgradeVariant = top.candidateId === 'refiner' && refiner ? 'refiner' : 'primary';\n    if (winnerVariant === 'primary') {\n      primary.humanAccuracy = top.humanAccuracy;\n    } else if (refiner) {\n      refiner.humanAccuracy = top.humanAccuracy;\n    }\n    const winner = winnerVariant === 'refiner' && refiner ? refiner : primary;\n    return { winner, winnerVariant };\n  }\n\n  return pickWinner(input.modeDefinition, primary, refiner);\n}\n"],"mappings":";;;;;;AASO,SAASA,aAAaA,CAC3BC,KAA4B,EAC5BC,UAGC,EAC6D;EAC9D,MAAMC,OAAO,GAAGF,KAAK,CAACG,cAAc,CAACD,OAAQ;EAC7C,MAAME,OAAO,GAAGJ,KAAK,CAACG,cAAc,CAACC,OAAO;EAE5C,IAAIJ,KAAK,CAACK,iBAAiB,EAAEC,MAAM,EAAEC,MAAM,EAAE;IAC3C,MAAMC,GAAG,GAAGR,KAAK,CAACK,iBAAiB,CAACC,MAAM,CAAC,CAAC,CAAE;IAC9C,MAAMG,aAA6B,GAAGD,GAAG,CAACE,WAAW,KAAK,SAAS,IAAIN,OAAO,GAAG,SAAS,GAAG,SAAS;IACtG,IAAIK,aAAa,KAAK,SAAS,EAAE;MAC/BP,OAAO,CAACS,aAAa,GAAGH,GAAG,CAACG,aAAa;IAC3C,CAAC,MAAM,IAAIP,OAAO,EAAE;MAClBA,OAAO,CAACO,aAAa,GAAGH,GAAG,CAACG,aAAa;IAC3C;IACA,MAAMC,MAAM,GAAGH,aAAa,KAAK,SAAS,IAAIL,OAAO,GAAGA,OAAO,GAAGF,OAAO;IACzE,OAAO;MAAEU,MAAM;MAAEH;IAAc,CAAC;EAClC;EAEA,OAAOR,UAAU,CAACD,KAAK,CAACa,cAAc,EAAEX,OAAO,EAAEE,OAAO,CAAC;AAC3D","ignoreList":[]}
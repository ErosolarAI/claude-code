{"version":3,"names":["_toolRuntime","require","inMemoryIO","files","Map","root","ensureDir","readFile","path","get","writeFile","content","set","deleteFile","delete","listFiles","Array","from","keys","exists","has","describe","it","io","runtime","ToolRuntime","name","description","handler","args","execute","arguments","expect","toBe"],"sources":["toolRuntimeIO.test.ts"],"sourcesContent":["import { ToolRuntime } from '../../src/core/toolRuntime.js';\nimport type { ToolExecutionIO } from '../../src/core/toolRuntimeTypes.js';\n\nconst inMemoryIO = (): ToolExecutionIO => {\n  const files = new Map<string, string>();\n  return {\n    root: '/mem',\n    ensureDir: () => {},\n    readFile: (path) => files.get(path) ?? null,\n    writeFile: (path, content) => {\n      files.set(path, content);\n    },\n    deleteFile: (path) => {\n      files.delete(path);\n    },\n    listFiles: () => Array.from(files.keys()),\n    exists: (path) => files.has(path),\n  };\n};\n\ndescribe('ToolRuntime IO injection', () => {\n  it('uses injected IO for side-effecting handlers', async () => {\n    const io = inMemoryIO();\n    const runtime = new ToolRuntime(\n      [\n        {\n          name: 'write_mem',\n          description: 'write content',\n          handler: (args: { path: string; content: string }) => {\n            io.writeFile(args.path, args.content);\n            return 'ok';\n          },\n        },\n      ],\n      {},\n      io\n    );\n\n    await runtime.execute({ name: 'write_mem', arguments: { path: '/mem/test.txt', content: 'hello' } });\n    expect(io.readFile('/mem/test.txt')).toBe('hello');\n  });\n});\n"],"mappings":";;AAAA,IAAAA,YAAA,GAAAC,OAAA;AAGA,MAAMC,UAAU,GAAGA,CAAA,KAAuB;EACxC,MAAMC,KAAK,GAAG,IAAIC,GAAG,CAAiB,CAAC;EACvC,OAAO;IACLC,IAAI,EAAE,MAAM;IACZC,SAAS,EAAEA,CAAA,KAAM,CAAC,CAAC;IACnBC,QAAQ,EAAGC,IAAI,IAAKL,KAAK,CAACM,GAAG,CAACD,IAAI,CAAC,IAAI,IAAI;IAC3CE,SAAS,EAAEA,CAACF,IAAI,EAAEG,OAAO,KAAK;MAC5BR,KAAK,CAACS,GAAG,CAACJ,IAAI,EAAEG,OAAO,CAAC;IAC1B,CAAC;IACDE,UAAU,EAAGL,IAAI,IAAK;MACpBL,KAAK,CAACW,MAAM,CAACN,IAAI,CAAC;IACpB,CAAC;IACDO,SAAS,EAAEA,CAAA,KAAMC,KAAK,CAACC,IAAI,CAACd,KAAK,CAACe,IAAI,CAAC,CAAC,CAAC;IACzCC,MAAM,EAAGX,IAAI,IAAKL,KAAK,CAACiB,GAAG,CAACZ,IAAI;EAClC,CAAC;AACH,CAAC;AAEDa,QAAQ,CAAC,0BAA0B,EAAE,MAAM;EACzCC,EAAE,CAAC,8CAA8C,EAAE,YAAY;IAC7D,MAAMC,EAAE,GAAGrB,UAAU,CAAC,CAAC;IACvB,MAAMsB,OAAO,GAAG,IAAIC,wBAAW,CAC7B,CACE;MACEC,IAAI,EAAE,WAAW;MACjBC,WAAW,EAAE,eAAe;MAC5BC,OAAO,EAAGC,IAAuC,IAAK;QACpDN,EAAE,CAACb,SAAS,CAACmB,IAAI,CAACrB,IAAI,EAAEqB,IAAI,CAAClB,OAAO,CAAC;QACrC,OAAO,IAAI;MACb;IACF,CAAC,CACF,EACD,CAAC,CAAC,EACFY,EACF,CAAC;IAED,MAAMC,OAAO,CAACM,OAAO,CAAC;MAAEJ,IAAI,EAAE,WAAW;MAAEK,SAAS,EAAE;QAAEvB,IAAI,EAAE,eAAe;QAAEG,OAAO,EAAE;MAAQ;IAAE,CAAC,CAAC;IACpGqB,MAAM,CAACT,EAAE,CAAChB,QAAQ,CAAC,eAAe,CAAC,CAAC,CAAC0B,IAAI,CAAC,OAAO,CAAC;EACpD,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}
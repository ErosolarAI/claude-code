{"version":3,"names":["cov_1b9f5fc5p5","actualCoverage","exec","execCallback","spawn","cpSync","existsSync","mkdtempSync","rmSync","writeFileSync","readFileSync","tmpdir","join","basename","promisify","s","DEFAULT_SKIP_DIRS","GitWorktreeManager","baseDir","sessionId","skipDirs","createBranches","branchPrefix","worktrees","Map","isGitRepo","baseCommit","constructor","options","f","b","Date","now","initialize","cwd","stdout","trim","set","variant","path","type","commit","undefined","createdAt","createVariantWorkspace","get","existing","targetDir","worktreeCreated","createGitWorktree","createFilesystemCopy","branchName","maxBuffer","branch","error","skipSet","Set","map","d","recursive","filter","src","skip","startsWith","getWorkspacePath","getWorkspaceRoots","roots","info","getWorktreeInfo","getVariantDiff","computeNonGitDiff","diffStat","diffContent","files","filesChanged","split","Boolean","statMatch","match","insertions","parseInt","deletions","diff","_variant","compareVariants","primaryDiff","refinerDiff","primaryFiles","refinerFiles","commonFiles","allFiles","file","has","push","conflictingFiles","primaryPath","refinerPath","primaryContent","refinerContent","primary","refiner","applyWinnerChanges","winner","winnerInfo","primaryInfo","srcPath","destPath","content","cleanup","force","keys","delete","runInWorkspace","command","Error","Promise","resolve","child","stdio","timeout","stderr","on","data","toString","code","exitCode","message","getStatusSummary","parts","typeIcon","supportsWorktrees","baseCommitHash"],"sources":["gitWorktreeManager.ts"],"sourcesContent":["/**\n * GitWorktreeManager - Manages git worktrees for multi-variant RL execution.\n *\n * Provides lifecycle management for isolated workspaces where competing agents\n * can make independent changes without interference. Supports:\n * - Git worktree creation (preferred) with automatic cleanup\n * - Filesystem copy fallback for non-git repos\n * - Cross-variant diff tracking\n * - Branch isolation for parallel execution\n */\n\nimport { exec as execCallback, spawn } from 'node:child_process';\nimport { cpSync, existsSync, mkdtempSync, rmSync, writeFileSync, readFileSync } from 'node:fs';\nimport { tmpdir } from 'node:os';\nimport { join, basename } from 'node:path';\nimport { promisify } from 'node:util';\nimport type { UpgradeVariant } from './repoUpgradeOrchestrator.js';\n\nconst exec = promisify(execCallback);\n\nexport interface WorktreeInfo {\n  variant: UpgradeVariant;\n  path: string;\n  type: 'worktree' | 'copy' | 'original';\n  branch?: string;\n  commit?: string;\n  createdAt: number;\n}\n\nexport interface WorktreeManagerOptions {\n  /** Base working directory (the original repo) */\n  baseDir: string;\n  /** Session ID for naming worktrees */\n  sessionId?: string;\n  /** Skip directories when creating filesystem copies */\n  skipDirs?: string[];\n  /** Create isolated branches for each variant */\n  createBranches?: boolean;\n  /** Branch prefix for variant branches */\n  branchPrefix?: string;\n}\n\nexport interface VariantDiff {\n  variant: UpgradeVariant;\n  filesChanged: string[];\n  insertions: number;\n  deletions: number;\n  diff: string;\n}\n\nexport interface CrossVariantComparison {\n  primary: VariantDiff;\n  refiner?: VariantDiff;\n  commonFiles: string[];\n  conflictingFiles: string[];\n}\n\nconst DEFAULT_SKIP_DIRS = [\n  'node_modules',\n  '.turbo',\n  '.next',\n  'coverage',\n  'dist',\n  '.git',\n  '.cache',\n  '__pycache__',\n  '.pytest_cache',\n  'build',\n  'target',\n];\n\nexport class GitWorktreeManager {\n  private readonly baseDir: string;\n  private readonly sessionId: string;\n  private readonly skipDirs: string[];\n  private readonly createBranches: boolean;\n  private readonly branchPrefix: string;\n  private readonly worktrees: Map<UpgradeVariant, WorktreeInfo> = new Map();\n  private isGitRepo: boolean | null = null;\n  private baseCommit: string | null = null;\n\n  constructor(options: WorktreeManagerOptions) {\n    this.baseDir = options.baseDir;\n    this.sessionId = options.sessionId ?? `rl-${Date.now()}`;\n    this.skipDirs = options.skipDirs ?? DEFAULT_SKIP_DIRS;\n    this.createBranches = options.createBranches ?? true;\n    this.branchPrefix = options.branchPrefix ?? 'agi-upgrade';\n  }\n\n  /**\n   * Initialize the manager and detect git repo status.\n   */\n  async initialize(): Promise<void> {\n    try {\n      await exec('git rev-parse --is-inside-work-tree', { cwd: this.baseDir });\n      this.isGitRepo = true;\n      const { stdout } = await exec('git rev-parse HEAD', { cwd: this.baseDir });\n      this.baseCommit = stdout.trim();\n    } catch {\n      this.isGitRepo = false;\n    }\n\n    // Register primary workspace (original directory)\n    this.worktrees.set('primary', {\n      variant: 'primary',\n      path: this.baseDir,\n      type: 'original',\n      commit: this.baseCommit ?? undefined,\n      createdAt: Date.now(),\n    });\n  }\n\n  /**\n   * Create an isolated workspace for a variant.\n   */\n  async createVariantWorkspace(variant: UpgradeVariant): Promise<WorktreeInfo> {\n    if (variant === 'primary') {\n      return this.worktrees.get('primary')!;\n    }\n\n    const existing = this.worktrees.get(variant);\n    if (existing) {\n      return existing;\n    }\n\n    const targetDir = mkdtempSync(join(tmpdir(), `agi-${variant}-`));\n\n    if (this.isGitRepo) {\n      const worktreeCreated = await this.createGitWorktree(variant, targetDir);\n      if (worktreeCreated) {\n        return this.worktrees.get(variant)!;\n      }\n    }\n\n    // Fallback to filesystem copy\n    await this.createFilesystemCopy(variant, targetDir);\n    return this.worktrees.get(variant)!;\n  }\n\n  /**\n   * Create a git worktree for the variant.\n   */\n  private async createGitWorktree(variant: UpgradeVariant, targetDir: string): Promise<boolean> {\n    try {\n      const branchName = this.createBranches\n        ? `${this.branchPrefix}/${variant}/${this.sessionId}`\n        : undefined;\n\n      if (branchName) {\n        // Create worktree with new branch\n        await exec(\n          `git worktree add -b \"${branchName}\" \"${targetDir}\" HEAD`,\n          { cwd: this.baseDir, maxBuffer: 4 * 1024 * 1024 }\n        );\n      } else {\n        // Create detached worktree\n        await exec(\n          `git worktree add --detach \"${targetDir}\"`,\n          { cwd: this.baseDir, maxBuffer: 4 * 1024 * 1024 }\n        );\n      }\n\n      const { stdout: commit } = await exec('git rev-parse HEAD', { cwd: targetDir });\n\n      this.worktrees.set(variant, {\n        variant,\n        path: targetDir,\n        type: 'worktree',\n        branch: branchName,\n        commit: commit.trim(),\n        createdAt: Date.now(),\n      });\n\n      return true;\n    } catch (error) {\n      // Clean up partial worktree if creation failed\n      try {\n        await exec(`git worktree remove \"${targetDir}\" --force`, { cwd: this.baseDir });\n      } catch {\n        // Ignore cleanup errors\n      }\n      return false;\n    }\n  }\n\n  /**\n   * Create a filesystem copy for non-git repos or when worktree fails.\n   */\n  private async createFilesystemCopy(variant: UpgradeVariant, targetDir: string): Promise<void> {\n    const skipSet = new Set(this.skipDirs.map(d => join(this.baseDir, d)));\n\n    cpSync(this.baseDir, targetDir, {\n      recursive: true,\n      filter: (src) => {\n        // Skip configured directories\n        for (const skip of skipSet) {\n          if (src === skip || src.startsWith(skip + '/')) {\n            return false;\n          }\n        }\n        return true;\n      },\n    });\n\n    this.worktrees.set(variant, {\n      variant,\n      path: targetDir,\n      type: 'copy',\n      createdAt: Date.now(),\n    });\n  }\n\n  /**\n   * Get the workspace path for a variant.\n   */\n  getWorkspacePath(variant: UpgradeVariant): string | undefined {\n    return this.worktrees.get(variant)?.path;\n  }\n\n  /**\n   * Get all workspace roots as a record.\n   */\n  getWorkspaceRoots(): Partial<Record<UpgradeVariant, string>> {\n    const roots: Partial<Record<UpgradeVariant, string>> = {};\n    for (const [variant, info] of this.worktrees) {\n      roots[variant] = info.path;\n    }\n    return roots;\n  }\n\n  /**\n   * Get info about a variant's workspace.\n   */\n  getWorktreeInfo(variant: UpgradeVariant): WorktreeInfo | undefined {\n    return this.worktrees.get(variant);\n  }\n\n  /**\n   * Compute diff for a variant's changes since base commit.\n   */\n  async getVariantDiff(variant: UpgradeVariant): Promise<VariantDiff | null> {\n    const info = this.worktrees.get(variant);\n    if (!info) return null;\n\n    if (info.type === 'original' || !this.isGitRepo) {\n      // For original or non-git, compute diff against saved state\n      return this.computeNonGitDiff(variant);\n    }\n\n    try {\n      const { stdout: diffStat } = await exec(\n        `git diff --stat ${this.baseCommit}..HEAD`,\n        { cwd: info.path, maxBuffer: 4 * 1024 * 1024 }\n      );\n\n      const { stdout: diffContent } = await exec(\n        `git diff ${this.baseCommit}..HEAD`,\n        { cwd: info.path, maxBuffer: 8 * 1024 * 1024 }\n      );\n\n      const { stdout: files } = await exec(\n        `git diff --name-only ${this.baseCommit}..HEAD`,\n        { cwd: info.path }\n      );\n\n      const filesChanged = files.trim().split('\\n').filter(Boolean);\n      const statMatch = diffStat.match(/(\\d+) insertions?\\(\\+\\).*?(\\d+) deletions?\\(-\\)/);\n      const insertions = statMatch ? parseInt(statMatch[1] ?? '0', 10) : 0;\n      const deletions = statMatch ? parseInt(statMatch[2] ?? '0', 10) : 0;\n\n      return {\n        variant,\n        filesChanged,\n        insertions,\n        deletions,\n        diff: diffContent,\n      };\n    } catch {\n      return null;\n    }\n  }\n\n  /**\n   * Compute diff for non-git repos by tracking file changes.\n   */\n  private async computeNonGitDiff(_variant: UpgradeVariant): Promise<VariantDiff | null> {\n    // For non-git repos, return empty diff (would need snapshot comparison)\n    return {\n      variant: _variant,\n      filesChanged: [],\n      insertions: 0,\n      deletions: 0,\n      diff: '',\n    };\n  }\n\n  /**\n   * Compare changes between primary and refiner variants.\n   */\n  async compareVariants(): Promise<CrossVariantComparison | null> {\n    const primaryDiff = await this.getVariantDiff('primary');\n    const refinerDiff = await this.getVariantDiff('refiner');\n\n    if (!primaryDiff) return null;\n\n    const primaryFiles = new Set(primaryDiff.filesChanged);\n    const refinerFiles = new Set(refinerDiff?.filesChanged ?? []);\n\n    const commonFiles: string[] = [];\n    const allFiles = new Set([...primaryFiles, ...refinerFiles]);\n\n    for (const file of allFiles) {\n      if (primaryFiles.has(file) && refinerFiles.has(file)) {\n        commonFiles.push(file);\n      }\n    }\n\n    // Detect conflicting changes (same file, different content)\n    const conflictingFiles: string[] = [];\n    for (const file of commonFiles) {\n      const primaryPath = join(this.worktrees.get('primary')!.path, file);\n      const refinerPath = join(this.worktrees.get('refiner')?.path ?? '', file);\n\n      if (existsSync(primaryPath) && existsSync(refinerPath)) {\n        try {\n          const primaryContent = readFileSync(primaryPath, 'utf8');\n          const refinerContent = readFileSync(refinerPath, 'utf8');\n          if (primaryContent !== refinerContent) {\n            conflictingFiles.push(file);\n          }\n        } catch {\n          // Ignore read errors\n        }\n      }\n    }\n\n    return {\n      primary: primaryDiff,\n      refiner: refinerDiff ?? undefined,\n      commonFiles,\n      conflictingFiles,\n    };\n  }\n\n  /**\n   * Apply the winning variant's changes to the primary workspace.\n   */\n  async applyWinnerChanges(winner: UpgradeVariant): Promise<boolean> {\n    if (winner === 'primary') {\n      // Primary already has its changes in place\n      return true;\n    }\n\n    const winnerInfo = this.worktrees.get(winner);\n    const primaryInfo = this.worktrees.get('primary');\n\n    if (!winnerInfo || !primaryInfo) return false;\n\n    if (this.isGitRepo && winnerInfo.type === 'worktree' && winnerInfo.branch) {\n      // Merge winner branch into primary\n      try {\n        await exec(`git merge --no-ff \"${winnerInfo.branch}\" -m \"Apply ${winner} changes\"`, {\n          cwd: primaryInfo.path,\n        });\n        return true;\n      } catch {\n        // Fall through to file copy\n      }\n    }\n\n    // Copy changed files from winner to primary\n    const diff = await this.getVariantDiff(winner);\n    if (!diff) return false;\n\n    for (const file of diff.filesChanged) {\n      const srcPath = join(winnerInfo.path, file);\n      const destPath = join(primaryInfo.path, file);\n\n      if (existsSync(srcPath)) {\n        try {\n          const content = readFileSync(srcPath);\n          writeFileSync(destPath, content);\n        } catch {\n          // Continue with other files\n        }\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Clean up all created worktrees and copies.\n   */\n  async cleanup(): Promise<void> {\n    for (const [variant, info] of this.worktrees) {\n      if (variant === 'primary' || info.type === 'original') {\n        continue;\n      }\n\n      try {\n        if (info.type === 'worktree') {\n          // Remove git worktree\n          await exec(`git worktree remove \"${info.path}\" --force`, {\n            cwd: this.baseDir,\n          });\n\n          // Delete branch if we created one\n          if (info.branch) {\n            try {\n              await exec(`git branch -D \"${info.branch}\"`, { cwd: this.baseDir });\n            } catch {\n              // Branch may not exist or may be checked out elsewhere\n            }\n          }\n        } else {\n          // Remove filesystem copy\n          rmSync(info.path, { recursive: true, force: true });\n        }\n      } catch {\n        // Best effort cleanup\n        try {\n          rmSync(info.path, { recursive: true, force: true });\n        } catch {\n          // Ignore\n        }\n      }\n    }\n\n    // Clear all non-primary entries\n    for (const variant of this.worktrees.keys()) {\n      if (variant !== 'primary') {\n        this.worktrees.delete(variant);\n      }\n    }\n  }\n\n  /**\n   * Run a command in a specific variant's workspace.\n   */\n  async runInWorkspace(\n    variant: UpgradeVariant,\n    command: string,\n    options?: { timeout?: number }\n  ): Promise<{ stdout: string; stderr: string; exitCode: number }> {\n    const info = this.worktrees.get(variant);\n    if (!info) {\n      throw new Error(`Workspace not found for variant: ${variant}`);\n    }\n\n    return new Promise((resolve) => {\n      const child = spawn('bash', ['-c', command], {\n        cwd: info.path,\n        stdio: ['ignore', 'pipe', 'pipe'],\n        timeout: options?.timeout ?? 120000,\n      });\n\n      let stdout = '';\n      let stderr = '';\n\n      child.stdout.on('data', (data) => {\n        stdout += data.toString();\n      });\n\n      child.stderr.on('data', (data) => {\n        stderr += data.toString();\n      });\n\n      child.on('close', (code) => {\n        resolve({ stdout, stderr, exitCode: code ?? 1 });\n      });\n\n      child.on('error', (error) => {\n        resolve({ stdout, stderr: error.message, exitCode: 1 });\n      });\n    });\n  }\n\n  /**\n   * Get status summary of all workspaces.\n   */\n  getStatusSummary(): string {\n    const parts: string[] = [];\n    for (const [variant, info] of this.worktrees) {\n      const typeIcon = info.type === 'worktree' ? 'W' : info.type === 'copy' ? 'C' : 'O';\n      parts.push(`${variant}[${typeIcon}]:${basename(info.path)}`);\n    }\n    return parts.join(' | ');\n  }\n\n  /**\n   * Check if git worktrees are available.\n   */\n  get supportsWorktrees(): boolean {\n    return this.isGitRepo === true;\n  }\n\n  /**\n   * Get the base commit that all variants started from.\n   */\n  get baseCommitHash(): string | null {\n    return this.baseCommit;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
{"version":3,"names":["cov_2g4go3y7fm","actualCoverage","MissingSecretError","getSecretDefinitionForProvider","detectApiKeyError","error","provider","f","s","b","primaryProvider","secret","providers","type","message","isUnauthorizedError","labelProvider","extractProviderFromError","extractErrorMessage","status","extractStatus","payload","extractStructuredError","normalizedType","normalize","code","containsAuthKeyword","reason","directStatus","response","candidate","structured","errors","Array","isArray","String","directError","trim","Error","value","includes","toLowerCase"],"sources":["apiKeyErrors.ts"],"sourcesContent":["import type { ProviderId } from '../types.js';\nimport {\n  MissingSecretError,\n  type SecretDefinition,\n  getSecretDefinitionForProvider,\n} from '../secretStore.js';\n\nexport type ApiKeyErrorType = 'missing' | 'invalid';\n\nexport interface ApiKeyErrorInfo {\n  type: ApiKeyErrorType;\n  provider: ProviderId | null;\n  secret?: SecretDefinition | null;\n  message?: string;\n}\n\nexport function detectApiKeyError(error: unknown, provider?: ProviderId | null): ApiKeyErrorInfo | null {\n  if (error instanceof MissingSecretError) {\n    const primaryProvider = error.secret.providers[0] ?? null;\n    return {\n      type: 'missing',\n      provider: provider ?? primaryProvider,\n      secret: error.secret,\n      message: error.message,\n    };\n  }\n\n  if (isUnauthorizedError(error)) {\n    const labelProvider = provider ?? extractProviderFromError(error);\n    const secret = labelProvider ? getSecretDefinitionForProvider(labelProvider) : null;\n    return {\n      type: 'invalid',\n      provider: labelProvider,\n      secret,\n      message: extractErrorMessage(error),\n    };\n  }\n\n  return null;\n}\n\nfunction isUnauthorizedError(error: unknown): boolean {\n  const status = extractStatus(error);\n  if (status === 401 || status === 403) {\n    return true;\n  }\n\n  const payload = extractStructuredError(error);\n  if (payload) {\n    // Check type and code fields\n    const normalizedType = normalize(payload.type) || normalize(payload.code);\n    if (normalizedType && containsAuthKeyword(normalizedType)) {\n      return true;\n    }\n    // Check status field (e.g., \"PERMISSION_DENIED\")\n    if (payload.status && containsAuthKeyword(normalize(payload.status))) {\n      return true;\n    }\n    // Check reason field (e.g., \"forbidden\")\n    if (payload.reason && containsAuthKeyword(normalize(payload.reason))) {\n      return true;\n    }\n    // Check message field\n    if (payload.message && containsAuthKeyword(normalize(payload.message))) {\n      return true;\n    }\n  }\n\n  const message = normalize(extractErrorMessage(error));\n  if (!message) {\n    return false;\n  }\n  return containsAuthKeyword(message);\n}\n\nfunction extractStatus(error: unknown): number | null {\n  if (!error || typeof error !== 'object') {\n    return null;\n  }\n\n  const directStatus = (error as { status?: number }).status;\n  if (typeof directStatus === 'number') {\n    return directStatus;\n  }\n\n  const response = (error as { response?: { status?: number } }).response;\n  if (response && typeof response.status === 'number') {\n    return response.status;\n  }\n\n  return null;\n}\n\nfunction extractStructuredError(error: unknown): { type?: string; code?: string; message?: string; status?: string; reason?: string } | null {\n  if (!error || typeof error !== 'object') {\n    return null;\n  }\n\n  // Handle nested error.error structure (common in Google/Gemini errors)\n  if ('error' in error) {\n    const candidate = (error as { error?: unknown }).error;\n    if (candidate && typeof candidate === 'object') {\n      const structured = candidate as { type?: string; code?: string | number; message?: string; status?: string; reason?: string; errors?: Array<{ reason?: string }> };\n      // Extract reason from nested errors array (Gemini format)\n      let reason = structured.reason;\n      if (!reason && structured.errors && Array.isArray(structured.errors) && structured.errors[0]?.reason) {\n        reason = structured.errors[0].reason;\n      }\n      return {\n        type: structured.type,\n        code: typeof structured.code === 'number' ? String(structured.code) : structured.code,\n        message: structured.message,\n        status: structured.status,\n        reason,\n      };\n    }\n  }\n\n  // Handle direct status/reason on error object\n  const directError = error as { status?: string; reason?: string; code?: string | number; message?: string };\n  if (directError.status || directError.reason || directError.code) {\n    return {\n      status: directError.status,\n      reason: directError.reason,\n      code: typeof directError.code === 'number' ? String(directError.code) : directError.code,\n      message: directError.message,\n    };\n  }\n\n  return null;\n}\n\nfunction extractProviderFromError(error: unknown): ProviderId | null {\n  if (!error || typeof error !== 'object') {\n    return null;\n  }\n\n  const provider = (error as { provider?: ProviderId }).provider;\n  if (typeof provider === 'string' && provider.trim()) {\n    return provider.trim();\n  }\n\n  return null;\n}\n\nfunction extractErrorMessage(error: unknown): string {\n  if (typeof error === 'string') {\n    return error;\n  }\n\n  if (error instanceof Error) {\n    return error.message ?? '';\n  }\n\n  if (error && typeof error === 'object') {\n    const payload = extractStructuredError(error);\n    if (payload?.message) {\n      return payload.message;\n    }\n    if ('message' in error && typeof (error as { message?: unknown }).message === 'string') {\n      return (error as { message: string }).message;\n    }\n  }\n\n  return '';\n}\n\nfunction containsAuthKeyword(value: string | null): boolean {\n  if (!value) {\n    return false;\n  }\n  return (\n    value.includes('api key') ||\n    value.includes('apikey') ||\n    value.includes('api-key') ||\n    value.includes('authentication') ||\n    value.includes('unauthorized') ||\n    value.includes('permission_denied') ||\n    value.includes('permission denied') ||\n    value.includes('forbidden') ||\n    value.includes('invalid_api_key') ||\n    value.includes('invalid api key') ||\n    value.includes('access_denied') ||\n    value.includes('access denied') ||\n    value.includes('not authorized') ||\n    value.includes('credentials') ||\n    value.includes('entitlement') ||\n    value.includes('subscription')\n  );\n}\n\nfunction normalize(value?: unknown): string | null {\n  if (!value || typeof value !== 'string') {\n    return null;\n  }\n  return value.toLowerCase();\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
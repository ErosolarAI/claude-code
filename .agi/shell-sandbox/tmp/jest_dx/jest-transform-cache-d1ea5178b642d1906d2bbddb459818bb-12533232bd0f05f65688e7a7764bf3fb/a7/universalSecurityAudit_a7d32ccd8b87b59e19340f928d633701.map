{"version":3,"names":["_child_process","require","_util","_https","_interopRequireDefault","e","__esModule","default","execAsync","promisify","exec","ZERO_DAY_HEURISTICS","complexityCorrelation","principle","indicators","weight","trustBoundaryAnalysis","temporalCoupling","serializationBoundaries","emergentBehaviors","errorHandlingAsymmetry","implicitStateDependencies","resourceExhaustion","APT_KILL_CHAIN","phase","description","getGCPAccessToken","stdout","trim","error","Error","gcpApiCall","endpoint","method","body","accessToken","token","url","URL","startTime","performance","now","Promise","resolve","reject","options","hostname","path","pathname","search","headers","req","https","request","res","data","on","chunk","timingMs","JSON","parse","statusCode","raw","setTimeout","destroy","write","stringify","end","GCP_TESTS","id","name","category","aptPhase","execute","config","projectId","timings","evidence","testCases","permission","tc","result","permissions","push","toFixed","validTimings","filter","t","mean","reduce","a","b","length","variance","Math","pow","stdDev","sqrt","cv","vulnerable","provider","vulnerability","severity","confidence","technique","timestamp","Date","toISOString","resource","exploitability","verified","remediation","saResult","undefined","accounts","permCheck","perms","canCreateKeys","includes","vulnerabilities","bucketsResult","items","bucket","slice","detail","uniformAccess","iamConfiguration","uniformBucketLevelAccess","enabled","publicPrevention","publicAccessPrevention","acl","entity","some","v","policyResult","requestedPolicyVersion","bindings","binding","member","members","startsWith","role","policies","accessPolicies","String","firewallResult","rule","sourceRanges","direction","ports","allowed","flatMap","join","clustersResult","clusters","cluster","workloadIdentityConfig","workloadPool","shieldedNodes","networkPolicy","masterAuthorizedNetworksConfig","datasetsResult","datasets","dataset","datasetReference","datasetId","access","specialGroup","iamMember","directoryResult","reportsResult","groupsResult","gmailResult","messagesResult","settingsResult","driveResult","files","map","f","orgSharedResult","authResult","authConfig","signIn","allowDuplicateEmails","authorizedDomains","mfa","state","rulesResult","instances","instance","databaseUrl","dbRulesResult","rules","bucketName","storageResult","cors","publisherResult","integrityResult","fcmResult","validate_only","message","topic","groups","g","displayName","groupKey","devicesResult","devices","chronicleResult","query","time_range","start_time","end_time","secretsResult","secrets","secret","versionResult","split","pop","getAWSAccessToken","Credentials","SessionToken","AWS_TESTS","buckets","Buckets","aclOutput","Name","grant","Grants","Grantee","URI","Permission","users","Users","user","policiesOutput","UserName","AttachedPolicies","policy","PolicyArn","PolicyName","SecurityGroups","sg","perm","IpPermissions","range","IpRanges","CidrIp","port","FromPort","ToPort","GroupId","AZURE_TESTS","account","allowBlobPublicAccess","networkRuleSet","defaultAction","assignments","assignment","roleDefinitionName","scope","principalName","nsgs","nsg","securityRules","sourceAddressPrefix","destinationPortRange","generateZeroDayPredictions","includeZeroDay","predictions","zeroDayHypotheses","heuristics","hypothesis","relevantHeuristics","h","avgWeight","sum","runUniversalSecurityAudit","findings","console","log","toUpperCase","accountId","subscriptionId","organizationId","liveTesting","tests","test","finding","pred","endTime","duration","getTime","summary","total","critical","high","medium","low","zeroDay","runMultiProviderAudit","configs","results","Map","set","totalFindings","totalCritical","totalHigh","_default","exports","GCP_REMEDIATIONS","GCP-STORAGE-ACL-001","details","bucketMatches","match","findingId","success","d","action","rollbackCommand","GCP-FIREWALL-OPEN-001","ruleMatches","ruleName","network","priority","denied","IPProtocol","GCP-VPC-SC-001","GCP-GKE-SECURITY-001","clusterMatches","clusterName","GCP-SA-KEY-RACE-001","constraint","booleanPolicy","enforced","GCP-IAM-CROSS-PROJECT-001","originalBindings","newBindings","etag","version","GCP-BIGQUERY-EXPOSURE-001","datasetMatches","detailResult","newAccess","AWS_REMEDIATIONS","AWS-S3-PUBLIC-001","AWS-EC2-SG-001","sgMatches","sgId","rulesOutput","IpProtocol","AWS-IAM-ADMIN-001","AZURE_REMEDIATIONS","AZURE-STORAGE-PUBLIC-001","accountMatches","accountName","AZURE-NSG-OPEN-001","parts","nsgName","AZURE-RBAC-ADMIN-001","remediateFindings","dryRun","fixed","failed","skipped","verifiedFindings","remediationFn","runSecurityAuditWithRemediation","audit","autoFix","runDefaultSecurityAudit","Account"],"sources":["universalSecurityAudit.ts"],"sourcesContent":["/**\n * Universal Security Audit System\n *\n * Provider-agnostic security scanning for any cloud infrastructure, company, product.\n * This is the DEFAULT capability for all AGI Core operations.\n *\n * Supports:\n * - Google Cloud Platform (GCP)\n * - Amazon Web Services (AWS)\n * - Microsoft Azure\n * - Any custom infrastructure\n *\n * Features:\n * - Live verification against real APIs\n * - Zero-day prediction via unconventional heuristics\n * - Dual tournament RL validation\n * - Full APT kill chain coverage\n */\n\nimport { exec } from 'child_process';\nimport { promisify } from 'util';\nimport https from 'https';\nimport http from 'http';\n\nconst execAsync = promisify(exec);\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Types\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport type CloudProvider = 'gcp' | 'aws' | 'azure' | 'custom';\nexport type SeverityLevel = 'critical' | 'high' | 'medium' | 'low' | 'info';\nexport type Exploitability = 'trivial' | 'moderate' | 'complex' | 'theoretical';\n\nexport interface SecurityFinding {\n  id: string;\n  provider: CloudProvider;\n  vulnerability: string;\n  severity: SeverityLevel;\n  confidence: number;\n  evidence: string[];\n  technique: string;\n  timestamp: string;\n  resource: string;\n  exploitability: Exploitability;\n  verified: boolean;\n  remediation?: string;\n  cve?: string;\n  aptPhase?: string;\n}\n\nexport interface AuditConfig {\n  provider: CloudProvider;\n  projectId?: string;\n  region?: string;\n  accountId?: string;\n  subscriptionId?: string;\n  accessToken?: string;\n  organizationId?: string;\n  aggressive?: boolean;\n  includeZeroDay?: boolean;\n  liveTesting?: boolean;\n}\n\nexport interface AuditSummary {\n  provider: CloudProvider;\n  startTime: string;\n  endTime: string;\n  duration: number;\n  total: number;\n  verified: number;\n  critical: number;\n  high: number;\n  medium: number;\n  low: number;\n  zeroDay: number;\n}\n\nexport interface UniversalAuditResult {\n  findings: SecurityFinding[];\n  summary: AuditSummary;\n  rawData?: Record<string, unknown>;\n}\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Zero-Day Prediction Heuristics\n// ═══════════════════════════════════════════════════════════════════════════════\n\nconst ZERO_DAY_HEURISTICS = {\n  complexityCorrelation: {\n    principle: 'Vulnerabilities cluster where code complexity exceeds cognitive limits',\n    indicators: ['Cyclomatic complexity > 50', 'Function length > 500 lines', 'Deep nesting > 6 levels', 'Multiple async patterns', 'Complex state machines'],\n    weight: 0.85,\n  },\n  trustBoundaryAnalysis: {\n    principle: 'Every trust boundary crossing is a potential attack surface',\n    indicators: ['Service-to-service auth', 'Cross-region data transfer', 'User input propagation', 'Third-party integrations', 'API gateway boundaries'],\n    weight: 0.90,\n  },\n  temporalCoupling: {\n    principle: 'Time-based operations create race condition opportunities',\n    indicators: ['Async token refresh', 'Distributed consensus', 'Cache invalidation', 'Session management', 'Rate limiting windows'],\n    weight: 0.80,\n  },\n  serializationBoundaries: {\n    principle: 'Data format transitions are high-risk transformation points',\n    indicators: ['JSON to protobuf conversion', 'XML parsing', 'Custom serialization', 'Encoding transitions', 'Schema migrations'],\n    weight: 0.88,\n  },\n  emergentBehaviors: {\n    principle: 'Complex systems exhibit behaviors not present in components',\n    indicators: ['Multi-service workflows', 'Distributed transactions', 'Event-driven architectures', 'Microservice meshes', 'Cascading failures'],\n    weight: 0.75,\n  },\n  errorHandlingAsymmetry: {\n    principle: 'Error paths receive less testing than happy paths',\n    indicators: ['Exception handling in auth', 'Rollback logic', 'Timeout handling', 'Partial failure states', 'Recovery procedures'],\n    weight: 0.82,\n  },\n  implicitStateDependencies: {\n    principle: 'Hidden state coupling creates unexpected interactions',\n    indicators: ['Global configuration', 'Shared caches', 'Connection pools', 'Thread-local storage', 'Implicit ordering'],\n    weight: 0.78,\n  },\n  resourceExhaustion: {\n    principle: 'Resource limits are often enforced inconsistently',\n    indicators: ['Memory allocation', 'File handles', 'Network connections', 'CPU quotas', 'Storage limits'],\n    weight: 0.70,\n  },\n};\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// APT Kill Chain Phases\n// ═══════════════════════════════════════════════════════════════════════════════\n\nconst APT_KILL_CHAIN = [\n  { phase: 'reconnaissance', description: 'Information gathering about targets' },\n  { phase: 'weaponization', description: 'Creating attack payloads' },\n  { phase: 'delivery', description: 'Transmitting attack to target' },\n  { phase: 'exploitation', description: 'Executing attack payload' },\n  { phase: 'installation', description: 'Establishing persistence' },\n  { phase: 'command-control', description: 'Remote access channel' },\n  { phase: 'actions', description: 'Achieving objectives' },\n];\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Provider-Specific Test Suites\n// ═══════════════════════════════════════════════════════════════════════════════\n\ninterface TestSuite {\n  name: string;\n  provider: CloudProvider;\n  tests: SecurityTest[];\n}\n\ninterface SecurityTest {\n  id: string;\n  name: string;\n  category: string;\n  aptPhase: string;\n  execute: (config: AuditConfig) => Promise<SecurityFinding | null>;\n}\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// GCP Tests\n// ═══════════════════════════════════════════════════════════════════════════════\n\nasync function getGCPAccessToken(): Promise<string> {\n  try {\n    const { stdout } = await execAsync('gcloud auth print-access-token');\n    return stdout.trim();\n  } catch (error) {\n    throw new Error(`Failed to get GCP access token: ${error}`);\n  }\n}\n\nasync function gcpApiCall(\n  endpoint: string,\n  method: string = 'GET',\n  body?: object,\n  accessToken?: string\n): Promise<{ data: unknown; timingMs: number; statusCode: number }> {\n  const token = accessToken || await getGCPAccessToken();\n  const url = new URL(endpoint);\n  const startTime = performance.now();\n\n  return new Promise((resolve, reject) => {\n    const options: https.RequestOptions = {\n      hostname: url.hostname,\n      path: url.pathname + url.search,\n      method,\n      headers: {\n        'Authorization': `Bearer ${token}`,\n        'Content-Type': 'application/json',\n        'User-Agent': 'agi-core-universal-audit/1.0',\n      },\n    };\n\n    const req = https.request(options, (res) => {\n      let data = '';\n      res.on('data', chunk => data += chunk);\n      res.on('end', () => {\n        const timingMs = performance.now() - startTime;\n        try {\n          resolve({\n            data: data ? JSON.parse(data) : {},\n            timingMs,\n            statusCode: res.statusCode || 0,\n          });\n        } catch {\n          resolve({ data: { raw: data }, timingMs, statusCode: res.statusCode || 0 });\n        }\n      });\n    });\n\n    req.on('error', reject);\n    req.setTimeout(30000, () => {\n      req.destroy();\n      reject(new Error('Request timeout'));\n    });\n\n    if (body) req.write(JSON.stringify(body));\n    req.end();\n  });\n}\n\nconst GCP_TESTS: SecurityTest[] = [\n  {\n    id: 'GCP-IAM-TIMING-001',\n    name: 'IAM Timing Oracle Detection',\n    category: 'IAM',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const timings: number[] = [];\n      const evidence: string[] = [];\n      const token = await getGCPAccessToken();\n\n      const testCases = [\n        { permission: 'resourcemanager.projects.get' },\n        { permission: 'resourcemanager.projects.delete' },\n        { permission: 'iam.roles.create' },\n        { permission: 'compute.instances.create' },\n      ];\n\n      for (const tc of testCases) {\n        try {\n          const result = await gcpApiCall(\n            `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:testIamPermissions`,\n            'POST',\n            { permissions: [tc.permission] },\n            token\n          );\n          timings.push(result.timingMs);\n          evidence.push(`${tc.permission}: ${result.timingMs.toFixed(2)}ms`);\n        } catch (e) {\n          evidence.push(`${tc.permission}: ERROR`);\n        }\n      }\n\n      const validTimings = timings.filter(t => t > 0);\n      const mean = validTimings.reduce((a, b) => a + b, 0) / validTimings.length;\n      const variance = validTimings.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / validTimings.length;\n      const stdDev = Math.sqrt(variance);\n      const cv = (stdDev / mean) * 100;\n\n      const vulnerable = cv > 25;\n      evidence.push(`CV: ${cv.toFixed(1)}% (threshold: 25%)`);\n\n      if (!vulnerable) return null;\n\n      return {\n        id: 'GCP-IAM-TIMING-001',\n        provider: 'gcp',\n        vulnerability: 'IAM Timing Oracle',\n        severity: 'high',\n        confidence: 0.75 + (cv / 400),\n        evidence,\n        technique: 'Timing Analysis',\n        timestamp: new Date().toISOString(),\n        resource: `projects/${config.projectId}`,\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Implement constant-time permission checks',\n      };\n    },\n  },\n  {\n    id: 'GCP-SA-KEY-RACE-001',\n    name: 'Service Account Key Race Condition',\n    category: 'IAM',\n    aptPhase: 'exploitation',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const saResult = await gcpApiCall(\n          `https://iam.googleapis.com/v1/projects/${config.projectId}/serviceAccounts`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const accounts = (saResult.data as { accounts?: unknown[] }).accounts || [];\n        evidence.push(`Found ${accounts.length} service accounts`);\n\n        const permCheck = await gcpApiCall(\n          `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:testIamPermissions`,\n          'POST',\n          { permissions: ['iam.serviceAccountKeys.create'] },\n          token\n        );\n\n        const perms = (permCheck.data as { permissions?: string[] }).permissions || [];\n        const canCreateKeys = perms.includes('iam.serviceAccountKeys.create');\n        evidence.push(`Can create SA keys: ${canCreateKeys}`);\n\n        if (!canCreateKeys) return null;\n\n        return {\n          id: 'GCP-SA-KEY-RACE-001',\n          provider: 'gcp',\n          vulnerability: 'Service Account Key Creation Race',\n          severity: 'critical',\n          confidence: 0.85,\n          evidence,\n          technique: 'Permission Enumeration + TOCTOU Analysis',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/serviceAccounts`,\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'exploitation',\n          remediation: 'Disable SA key creation, use Workload Identity',\n        };\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-STORAGE-ACL-001',\n    name: 'Storage Bucket ACL Misconfiguration',\n    category: 'Storage',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const bucketsResult = await gcpApiCall(\n          `https://storage.googleapis.com/storage/v1/b?project=${config.projectId}`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const items = (bucketsResult.data as { items?: { name: string }[] }).items || [];\n        evidence.push(`Found ${items.length} buckets`);\n\n        for (const bucket of items.slice(0, 10)) {\n          const detail = await gcpApiCall(\n            `https://storage.googleapis.com/storage/v1/b/${bucket.name}?projection=full`,\n            'GET',\n            undefined,\n            token\n          );\n\n          const data = detail.data as {\n            iamConfiguration?: {\n              uniformBucketLevelAccess?: { enabled?: boolean };\n              publicAccessPrevention?: string;\n            };\n            acl?: { entity: string }[];\n          };\n\n          const uniformAccess = data.iamConfiguration?.uniformBucketLevelAccess?.enabled;\n          const publicPrevention = data.iamConfiguration?.publicAccessPrevention;\n\n          if (!uniformAccess) {\n            vulnerabilities.push(`${bucket.name}: Legacy ACL mode`);\n          }\n          if (publicPrevention !== 'enforced') {\n            vulnerabilities.push(`${bucket.name}: Public prevention not enforced`);\n          }\n          if (data.acl) {\n            for (const acl of data.acl) {\n              if (acl.entity === 'allUsers' || acl.entity === 'allAuthenticatedUsers') {\n                vulnerabilities.push(`${bucket.name}: PUBLIC via ${acl.entity}`);\n              }\n            }\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'GCP-STORAGE-ACL-001',\n          provider: 'gcp',\n          vulnerability: 'Storage Bucket ACL Misconfiguration',\n          severity: vulnerabilities.some(v => v.includes('PUBLIC')) ? 'critical' : 'high',\n          confidence: 0.95,\n          evidence,\n          technique: 'Configuration Audit',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/buckets`,\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Enable uniform bucket-level access, enforce public prevention',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-IAM-CROSS-PROJECT-001',\n    name: 'Cross-Project IAM Binding Exposure',\n    category: 'IAM',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const policyResult = await gcpApiCall(\n          `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:getIamPolicy`,\n          'POST',\n          { options: { requestedPolicyVersion: 3 } },\n          token\n        );\n\n        const bindings = (policyResult.data as { bindings?: { role: string; members: string[] }[] }).bindings || [];\n\n        for (const binding of bindings) {\n          for (const member of binding.members || []) {\n            if (member.startsWith('serviceAccount:') && !member.includes(config.projectId)) {\n              vulnerabilities.push(`Cross-project SA: ${member} has ${binding.role}`);\n            }\n            if (member === 'allUsers' || member === 'allAuthenticatedUsers') {\n              vulnerabilities.push(`PUBLIC: ${member} has ${binding.role}`);\n            }\n          }\n        }\n\n        evidence.push(`Analyzed ${bindings.length} IAM bindings`);\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'GCP-IAM-CROSS-PROJECT-001',\n          provider: 'gcp',\n          vulnerability: 'Cross-Project IAM Exposure',\n          severity: vulnerabilities.some(v => v.includes('PUBLIC')) ? 'critical' : 'high',\n          confidence: 0.9,\n          evidence,\n          technique: 'IAM Policy Analysis',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/iamPolicy`,\n          exploitability: 'moderate',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Review and restrict cross-project bindings',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-VPC-SC-001',\n    name: 'VPC Service Controls Not Configured',\n    category: 'Network',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const policyResult = await gcpApiCall(\n          `https://accesscontextmanager.googleapis.com/v1/accessPolicies`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const policies = (policyResult.data as { accessPolicies?: unknown[] }).accessPolicies || [];\n\n        if (policies.length > 0) {\n          evidence.push(`Found ${policies.length} access policies`);\n          return null;\n        }\n\n        evidence.push('No VPC Service Controls configured');\n\n        return {\n          id: 'GCP-VPC-SC-001',\n          provider: 'gcp',\n          vulnerability: 'VPC Service Controls Not Configured',\n          severity: 'medium',\n          confidence: 0.85,\n          evidence,\n          technique: 'Service Perimeter Analysis',\n          timestamp: new Date().toISOString(),\n          resource: 'organization/accessPolicies',\n          exploitability: 'complex',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Configure VPC Service Controls with service perimeters',\n        };\n      } catch (e) {\n        if (String(e).includes('403')) {\n          evidence.push('Access Context Manager API not enabled');\n          return {\n            id: 'GCP-VPC-SC-001',\n            provider: 'gcp',\n            vulnerability: 'VPC Service Controls Not Configured',\n            severity: 'medium',\n            confidence: 0.7,\n            evidence,\n            technique: 'API Availability Check',\n            timestamp: new Date().toISOString(),\n            resource: 'organization/accessPolicies',\n            exploitability: 'complex',\n            verified: true,\n            aptPhase: 'reconnaissance',\n            remediation: 'Enable Access Context Manager API and configure VPC-SC',\n          };\n        }\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-FIREWALL-OPEN-001',\n    name: 'Firewall Rules Open to Internet',\n    category: 'Network',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const firewallResult = await gcpApiCall(\n          `https://compute.googleapis.com/compute/v1/projects/${config.projectId}/global/firewalls`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const items = (firewallResult.data as { items?: { name: string; sourceRanges?: string[]; direction?: string; allowed?: { ports?: string[] }[] }[] }).items || [];\n        evidence.push(`Found ${items.length} firewall rules`);\n\n        for (const rule of items) {\n          if (rule.sourceRanges?.includes('0.0.0.0/0') && rule.direction === 'INGRESS') {\n            const ports = rule.allowed?.flatMap(a => a.ports || ['all']).join(', ') || 'all';\n            vulnerabilities.push(`${rule.name}: Open to 0.0.0.0/0 on ports: ${ports}`);\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'GCP-FIREWALL-OPEN-001',\n          provider: 'gcp',\n          vulnerability: 'Firewall Rules Open to Internet',\n          severity: 'critical',\n          confidence: 0.95,\n          evidence,\n          technique: 'Firewall Rule Analysis',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/firewalls`,\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Restrict source ranges, use service accounts',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-GKE-SECURITY-001',\n    name: 'GKE Cluster Security Misconfiguration',\n    category: 'Kubernetes',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const clustersResult = await gcpApiCall(\n          `https://container.googleapis.com/v1/projects/${config.projectId}/locations/-/clusters`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const clusters = (clustersResult.data as { clusters?: {\n          name: string;\n          workloadIdentityConfig?: { workloadPool?: string };\n          shieldedNodes?: { enabled?: boolean };\n          networkPolicy?: { enabled?: boolean };\n          masterAuthorizedNetworksConfig?: { enabled?: boolean };\n        }[] }).clusters || [];\n\n        evidence.push(`Found ${clusters.length} GKE clusters`);\n\n        for (const cluster of clusters) {\n          if (!cluster.workloadIdentityConfig?.workloadPool) {\n            vulnerabilities.push(`${cluster.name}: No Workload Identity`);\n          }\n          if (!cluster.shieldedNodes?.enabled) {\n            vulnerabilities.push(`${cluster.name}: Shielded Nodes disabled`);\n          }\n          if (!cluster.networkPolicy?.enabled) {\n            vulnerabilities.push(`${cluster.name}: No Network Policy`);\n          }\n          if (!cluster.masterAuthorizedNetworksConfig?.enabled) {\n            vulnerabilities.push(`${cluster.name}: Master not restricted`);\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'GCP-GKE-SECURITY-001',\n          provider: 'gcp',\n          vulnerability: 'GKE Cluster Security Misconfiguration',\n          severity: 'high',\n          confidence: 0.9,\n          evidence,\n          technique: 'Cluster Configuration Audit',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/clusters`,\n          exploitability: 'moderate',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Enable Workload Identity, Shielded Nodes, Network Policy',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'GCP-BIGQUERY-EXPOSURE-001',\n    name: 'BigQuery Dataset Public Exposure',\n    category: 'Data',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        const datasetsResult = await gcpApiCall(\n          `https://bigquery.googleapis.com/bigquery/v2/projects/${config.projectId}/datasets`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const datasets = (datasetsResult.data as { datasets?: { datasetReference: { datasetId: string } }[] }).datasets || [];\n        evidence.push(`Found ${datasets.length} BigQuery datasets`);\n\n        for (const dataset of datasets.slice(0, 10)) {\n          const detail = await gcpApiCall(\n            `https://bigquery.googleapis.com/bigquery/v2/projects/${config.projectId}/datasets/${dataset.datasetReference.datasetId}`,\n            'GET',\n            undefined,\n            token\n          );\n\n          const access = (detail.data as { access?: { specialGroup?: string; iamMember?: string }[] }).access || [];\n\n          for (const a of access) {\n            if (a.specialGroup === 'allAuthenticatedUsers' || a.specialGroup === 'allUsers') {\n              vulnerabilities.push(`${dataset.datasetReference.datasetId}: PUBLIC via ${a.specialGroup}`);\n            }\n            if (a.iamMember?.startsWith('allUsers') || a.iamMember?.startsWith('allAuthenticatedUsers')) {\n              vulnerabilities.push(`${dataset.datasetReference.datasetId}: PUBLIC via ${a.iamMember}`);\n            }\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'GCP-BIGQUERY-EXPOSURE-001',\n          provider: 'gcp',\n          vulnerability: 'BigQuery Dataset Public Exposure',\n          severity: 'critical',\n          confidence: 0.95,\n          evidence,\n          technique: 'Dataset ACL Analysis',\n          timestamp: new Date().toISOString(),\n          resource: `projects/${config.projectId}/datasets`,\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Remove public access, use authorized views',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  // ═══════════════════════════════════════════════════════════════════════════════\n  // GOOGLE WORKSPACE TESTS\n  // ═══════════════════════════════════════════════════════════════════════════════\n  {\n    id: 'GCP-WORKSPACE-ADMIN-001',\n    name: 'Google Workspace Admin API Exposure',\n    category: 'Workspace',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Directory API access\n        const directoryResult = await gcpApiCall(\n          'https://admin.googleapis.com/admin/directory/v1/users?maxResults=1',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (directoryResult.statusCode === 200) {\n          vulnerabilities.push('Directory API accessible - can enumerate users');\n          evidence.push('Admin Directory API: ACCESSIBLE');\n        } else {\n          evidence.push(`Admin Directory API: ${directoryResult.statusCode}`);\n        }\n\n        // Check Reports API\n        const reportsResult = await gcpApiCall(\n          'https://admin.googleapis.com/admin/reports/v1/activity/users/all/applications/login?maxResults=1',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (reportsResult.statusCode === 200) {\n          vulnerabilities.push('Reports API accessible - can view login activity');\n          evidence.push('Admin Reports API: ACCESSIBLE');\n        }\n\n        // Check Groups API\n        const groupsResult = await gcpApiCall(\n          'https://admin.googleapis.com/admin/directory/v1/groups?maxResults=1',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (groupsResult.statusCode === 200) {\n          vulnerabilities.push('Groups API accessible - can enumerate groups');\n          evidence.push('Admin Groups API: ACCESSIBLE');\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-WORKSPACE-ADMIN-001',\n        provider: 'gcp',\n        vulnerability: 'Google Workspace Admin API Exposure',\n        severity: 'critical',\n        confidence: 0.95,\n        evidence,\n        technique: 'Admin API Enumeration',\n        timestamp: new Date().toISOString(),\n        resource: 'workspace/admin',\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Restrict Admin SDK API scopes, use domain-wide delegation carefully',\n      };\n    },\n  },\n  {\n    id: 'GCP-WORKSPACE-GMAIL-001',\n    name: 'Gmail API Over-Privileged Access',\n    category: 'Workspace',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Gmail API access\n        const gmailResult = await gcpApiCall(\n          'https://gmail.googleapis.com/gmail/v1/users/me/profile',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (gmailResult.statusCode === 200) {\n          evidence.push('Gmail API: ACCESSIBLE');\n\n          // Check message access\n          const messagesResult = await gcpApiCall(\n            'https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=1',\n            'GET',\n            undefined,\n            token\n          );\n\n          if (messagesResult.statusCode === 200) {\n            vulnerabilities.push('Gmail messages accessible - potential data exfiltration');\n          }\n\n          // Check settings access\n          const settingsResult = await gcpApiCall(\n            'https://gmail.googleapis.com/gmail/v1/users/me/settings/forwardingAddresses',\n            'GET',\n            undefined,\n            token\n          );\n\n          if (settingsResult.statusCode === 200) {\n            vulnerabilities.push('Gmail settings accessible - can modify forwarding');\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-WORKSPACE-GMAIL-001',\n        provider: 'gcp',\n        vulnerability: 'Gmail API Over-Privileged Access',\n        severity: 'high',\n        confidence: 0.9,\n        evidence,\n        technique: 'OAuth Scope Analysis',\n        timestamp: new Date().toISOString(),\n        resource: 'workspace/gmail',\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Use least-privilege OAuth scopes, review domain-wide delegation',\n      };\n    },\n  },\n  {\n    id: 'GCP-WORKSPACE-DRIVE-001',\n    name: 'Google Drive Sharing Exposure',\n    category: 'Workspace',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Drive API access\n        const driveResult = await gcpApiCall(\n          'https://www.googleapis.com/drive/v3/files?pageSize=10&q=visibility%3D%27anyoneWithLink%27',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (driveResult.statusCode === 200) {\n          const files = (driveResult.data as { files?: { name: string }[] }).files || [];\n          if (files.length > 0) {\n            vulnerabilities.push(`Found ${files.length} publicly shared files`);\n            evidence.push(...files.slice(0, 5).map(f => `Public file: ${f.name}`));\n          }\n        }\n\n        // Check for files shared with anyone in org\n        const orgSharedResult = await gcpApiCall(\n          'https://www.googleapis.com/drive/v3/files?pageSize=10&q=visibility%3D%27domainWithLink%27',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (orgSharedResult.statusCode === 200) {\n          const files = (orgSharedResult.data as { files?: { name: string }[] }).files || [];\n          if (files.length > 0) {\n            evidence.push(`Found ${files.length} domain-shared files`);\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-WORKSPACE-DRIVE-001',\n        provider: 'gcp',\n        vulnerability: 'Google Drive Public Sharing Exposure',\n        severity: 'high',\n        confidence: 0.9,\n        evidence,\n        technique: 'Drive Sharing Analysis',\n        timestamp: new Date().toISOString(),\n        resource: 'workspace/drive',\n        exploitability: 'trivial',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Enable sharing restrictions, audit public links',\n      };\n    },\n  },\n  // ═══════════════════════════════════════════════════════════════════════════════\n  // FIREBASE TESTS\n  // ═══════════════════════════════════════════════════════════════════════════════\n  {\n    id: 'GCP-FIREBASE-AUTH-001',\n    name: 'Firebase Auth Configuration Weakness',\n    category: 'Firebase',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Firebase Auth config\n        const authResult = await gcpApiCall(\n          `https://identitytoolkit.googleapis.com/v1/projects/${config.projectId}/config`,\n          'GET',\n          undefined,\n          token\n        );\n\n        if (authResult.statusCode === 200) {\n          const authConfig = authResult.data as {\n            signIn?: { allowDuplicateEmails?: boolean; email?: { enabled?: boolean } };\n            authorizedDomains?: string[];\n            mfa?: { state?: string };\n          };\n\n          evidence.push('Firebase Auth: ACCESSIBLE');\n\n          // Check for weak settings\n          if (authConfig.signIn?.allowDuplicateEmails) {\n            vulnerabilities.push('Duplicate emails allowed');\n          }\n\n          if (authConfig.authorizedDomains?.includes('localhost')) {\n            vulnerabilities.push('localhost in authorized domains');\n          }\n\n          if (authConfig.mfa?.state !== 'ENABLED') {\n            vulnerabilities.push('MFA not enforced');\n          }\n\n          evidence.push(`Authorized domains: ${authConfig.authorizedDomains?.join(', ')}`);\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-FIREBASE-AUTH-001',\n        provider: 'gcp',\n        vulnerability: 'Firebase Auth Configuration Weakness',\n        severity: 'high',\n        confidence: 0.85,\n        evidence,\n        technique: 'Auth Config Analysis',\n        timestamp: new Date().toISOString(),\n        resource: `firebase/${config.projectId}/auth`,\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Enable MFA, restrict authorized domains, disable duplicate emails',\n      };\n    },\n  },\n  {\n    id: 'GCP-FIREBASE-DB-001',\n    name: 'Firebase Realtime Database Rules',\n    category: 'Firebase',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Firebase RTDB rules\n        const rulesResult = await gcpApiCall(\n          `https://firebasedatabase.googleapis.com/v1beta/projects/${config.projectId}/locations/-/instances`,\n          'GET',\n          undefined,\n          token\n        );\n\n        if (rulesResult.statusCode === 200) {\n          const instances = (rulesResult.data as { instances?: { name: string; databaseUrl?: string }[] }).instances || [];\n          evidence.push(`Found ${instances.length} RTDB instances`);\n\n          for (const instance of instances) {\n            if (instance.databaseUrl) {\n              // Try to read rules (requires admin access)\n              try {\n                const dbRulesResult = await gcpApiCall(\n                  `${instance.databaseUrl}/.settings/rules.json`,\n                  'GET',\n                  undefined,\n                  token\n                );\n\n                if (dbRulesResult.statusCode === 200) {\n                  const rules = JSON.stringify(dbRulesResult.data);\n                  if (rules.includes('\"read\": true') || rules.includes('\".read\": true')) {\n                    vulnerabilities.push(`${instance.name}: Public read access in rules`);\n                  }\n                  if (rules.includes('\"write\": true') || rules.includes('\".write\": true')) {\n                    vulnerabilities.push(`${instance.name}: Public write access in rules`);\n                  }\n                }\n              } catch {\n                evidence.push(`${instance.name}: Could not read rules`);\n              }\n            }\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-FIREBASE-DB-001',\n        provider: 'gcp',\n        vulnerability: 'Firebase Realtime Database Public Access',\n        severity: 'critical',\n        confidence: 0.95,\n        evidence,\n        technique: 'Rules Analysis',\n        timestamp: new Date().toISOString(),\n        resource: `firebase/${config.projectId}/rtdb`,\n        exploitability: 'trivial',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Implement proper security rules, require authentication',\n      };\n    },\n  },\n  {\n    id: 'GCP-FIREBASE-STORAGE-001',\n    name: 'Firebase Storage Rules Misconfiguration',\n    category: 'Firebase',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check default Firebase Storage bucket\n        const bucketName = `${config.projectId}.appspot.com`;\n        const storageResult = await gcpApiCall(\n          `https://storage.googleapis.com/storage/v1/b/${bucketName}?projection=full`,\n          'GET',\n          undefined,\n          token\n        );\n\n        if (storageResult.statusCode === 200) {\n          evidence.push(`Firebase Storage bucket found: ${bucketName}`);\n\n          const bucket = storageResult.data as {\n            iamConfiguration?: {\n              uniformBucketLevelAccess?: { enabled?: boolean };\n              publicAccessPrevention?: string;\n            };\n            cors?: unknown[];\n          };\n\n          if (!bucket.iamConfiguration?.uniformBucketLevelAccess?.enabled) {\n            vulnerabilities.push('Uniform bucket access not enabled');\n          }\n\n          if (bucket.iamConfiguration?.publicAccessPrevention !== 'enforced') {\n            vulnerabilities.push('Public access prevention not enforced');\n          }\n\n          if (bucket.cors && bucket.cors.length > 0) {\n            evidence.push(`CORS configured: ${JSON.stringify(bucket.cors)}`);\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-FIREBASE-STORAGE-001',\n        provider: 'gcp',\n        vulnerability: 'Firebase Storage Security Misconfiguration',\n        severity: 'high',\n        confidence: 0.9,\n        evidence,\n        technique: 'Storage Config Analysis',\n        timestamp: new Date().toISOString(),\n        resource: `firebase/${config.projectId}/storage`,\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Enable uniform access, enforce public prevention, review rules',\n      };\n    },\n  },\n  // ═══════════════════════════════════════════════════════════════════════════════\n  // ANDROID / PLAY CONSOLE TESTS\n  // ═══════════════════════════════════════════════════════════════════════════════\n  {\n    id: 'GCP-ANDROID-PLAY-001',\n    name: 'Google Play Console API Access',\n    category: 'Android',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Android Publisher API access\n        const publisherResult = await gcpApiCall(\n          'https://androidpublisher.googleapis.com/androidpublisher/v3/applications',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (publisherResult.statusCode === 200) {\n          evidence.push('Android Publisher API: ACCESSIBLE');\n          vulnerabilities.push('Can access Play Console data - potential app manipulation');\n        }\n\n        // Check for Play Integrity API\n        const integrityResult = await gcpApiCall(\n          'https://playintegrity.googleapis.com/v1/deviceRecall',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (integrityResult.statusCode !== 403) {\n          evidence.push('Play Integrity API: ACCESSIBLE');\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-ANDROID-PLAY-001',\n        provider: 'gcp',\n        vulnerability: 'Google Play Console API Exposure',\n        severity: 'critical',\n        confidence: 0.9,\n        evidence,\n        technique: 'API Enumeration',\n        timestamp: new Date().toISOString(),\n        resource: 'android/play-console',\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Restrict Play Console API access, use service account scoping',\n      };\n    },\n  },\n  {\n    id: 'GCP-ANDROID-FCM-001',\n    name: 'Firebase Cloud Messaging Misconfiguration',\n    category: 'Android',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check FCM API access\n        const fcmResult = await gcpApiCall(\n          `https://fcm.googleapis.com/v1/projects/${config.projectId}/messages:send`,\n          'POST',\n          {\n            validate_only: true,\n            message: { topic: 'test' },\n          },\n          token\n        );\n\n        if (fcmResult.statusCode === 200 || fcmResult.statusCode === 400) {\n          // 400 means we have access but invalid message\n          evidence.push('FCM API: ACCESSIBLE');\n\n          if (fcmResult.statusCode === 200) {\n            vulnerabilities.push('Can send push notifications - potential phishing vector');\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-ANDROID-FCM-001',\n        provider: 'gcp',\n        vulnerability: 'Firebase Cloud Messaging Access',\n        severity: 'high',\n        confidence: 0.85,\n        evidence,\n        technique: 'FCM API Testing',\n        timestamp: new Date().toISOString(),\n        resource: `firebase/${config.projectId}/fcm`,\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Restrict FCM API access, validate message origins',\n      };\n    },\n  },\n  // ═══════════════════════════════════════════════════════════════════════════════\n  // GOOGLE CLOUD IDENTITY & SECURITY\n  // ═══════════════════════════════════════════════════════════════════════════════\n  {\n    id: 'GCP-IDENTITY-001',\n    name: 'Cloud Identity Group Enumeration',\n    category: 'Identity',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Cloud Identity Groups API\n        const groupsResult = await gcpApiCall(\n          'https://cloudidentity.googleapis.com/v1/groups?pageSize=10',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (groupsResult.statusCode === 200) {\n          const groups = (groupsResult.data as { groups?: { displayName: string; groupKey?: { id: string } }[] }).groups || [];\n          evidence.push(`Found ${groups.length} Cloud Identity groups`);\n\n          if (groups.length > 0) {\n            vulnerabilities.push('Cloud Identity groups enumerable');\n            evidence.push(...groups.slice(0, 5).map(g => `Group: ${g.displayName || g.groupKey?.id}`));\n          }\n        }\n\n        // Check devices\n        const devicesResult = await gcpApiCall(\n          'https://cloudidentity.googleapis.com/v1/devices?pageSize=10',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (devicesResult.statusCode === 200) {\n          const devices = (devicesResult.data as { devices?: unknown[] }).devices || [];\n          if (devices.length > 0) {\n            vulnerabilities.push(`Found ${devices.length} managed devices`);\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-IDENTITY-001',\n        provider: 'gcp',\n        vulnerability: 'Cloud Identity Enumeration',\n        severity: 'medium',\n        confidence: 0.85,\n        evidence,\n        technique: 'Identity API Analysis',\n        timestamp: new Date().toISOString(),\n        resource: 'cloudidentity/groups',\n        exploitability: 'moderate',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Restrict Cloud Identity API access, audit group visibility',\n      };\n    },\n  },\n  {\n    id: 'GCP-CHRONICLE-001',\n    name: 'Chronicle Security Data Access',\n    category: 'Security',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // Check Chronicle API access\n        const chronicleResult = await gcpApiCall(\n          'https://chronicle.googleapis.com/v1alpha/logs:search',\n          'POST',\n          { query: 'metadata.event_type = \"USER_LOGIN\"', time_range: { start_time: new Date(Date.now() - 3600000).toISOString(), end_time: new Date().toISOString() } },\n          token\n        );\n\n        if (chronicleResult.statusCode === 200) {\n          vulnerabilities.push('Chronicle API accessible - can search security logs');\n          evidence.push('Chronicle Search API: ACCESSIBLE');\n        }\n\n        // Check detection rules\n        const rulesResult = await gcpApiCall(\n          'https://chronicle.googleapis.com/v1alpha/rules',\n          'GET',\n          undefined,\n          token\n        );\n\n        if (rulesResult.statusCode === 200) {\n          evidence.push('Chronicle Rules API: ACCESSIBLE');\n        }\n      } catch (e) {\n        evidence.push(`Chronicle API not enabled or no access: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-CHRONICLE-001',\n        provider: 'gcp',\n        vulnerability: 'Chronicle Security Data Access',\n        severity: 'high',\n        confidence: 0.85,\n        evidence,\n        technique: 'Chronicle API Testing',\n        timestamp: new Date().toISOString(),\n        resource: 'chronicle/logs',\n        exploitability: 'complex',\n        verified: true,\n        aptPhase: 'reconnaissance',\n        remediation: 'Restrict Chronicle API access, implement RBAC',\n      };\n    },\n  },\n  {\n    id: 'GCP-SECRETMANAGER-001',\n    name: 'Secret Manager Access and Exposure',\n    category: 'Security',\n    aptPhase: 'exploitation',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      if (!config.projectId) return null;\n\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n      const token = await getGCPAccessToken();\n\n      try {\n        // List secrets\n        const secretsResult = await gcpApiCall(\n          `https://secretmanager.googleapis.com/v1/projects/${config.projectId}/secrets`,\n          'GET',\n          undefined,\n          token\n        );\n\n        if (secretsResult.statusCode === 200) {\n          const secrets = (secretsResult.data as { secrets?: { name: string }[] }).secrets || [];\n          evidence.push(`Found ${secrets.length} secrets`);\n\n          // Check if we can access secret versions\n          for (const secret of secrets.slice(0, 5)) {\n            try {\n              const versionResult = await gcpApiCall(\n                `https://secretmanager.googleapis.com/v1/${secret.name}/versions/latest:access`,\n                'GET',\n                undefined,\n                token\n              );\n\n              if (versionResult.statusCode === 200) {\n                vulnerabilities.push(`Can access secret: ${secret.name.split('/').pop()}`);\n              }\n            } catch {\n              evidence.push(`${secret.name.split('/').pop()}: Access denied`);\n            }\n          }\n        }\n      } catch (e) {\n        evidence.push(`Error: ${e}`);\n      }\n\n      if (vulnerabilities.length === 0) return null;\n\n      return {\n        id: 'GCP-SECRETMANAGER-001',\n        provider: 'gcp',\n        vulnerability: 'Secret Manager Secrets Accessible',\n        severity: 'critical',\n        confidence: 0.95,\n        evidence,\n        technique: 'Secret Enumeration',\n        timestamp: new Date().toISOString(),\n        resource: `projects/${config.projectId}/secrets`,\n        exploitability: 'trivial',\n        verified: true,\n        aptPhase: 'exploitation',\n        remediation: 'Restrict secret access, use IAM conditions, enable audit logging',\n      };\n    },\n  },\n];\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// AWS Tests (Skeleton - requires AWS CLI/SDK)\n// ═══════════════════════════════════════════════════════════════════════════════\n\nasync function getAWSAccessToken(): Promise<string> {\n  try {\n    const { stdout } = await execAsync('aws sts get-session-token --output json');\n    const data = JSON.parse(stdout);\n    return data.Credentials?.SessionToken || '';\n  } catch {\n    return '';\n  }\n}\n\nconst AWS_TESTS: SecurityTest[] = [\n  {\n    id: 'AWS-S3-PUBLIC-001',\n    name: 'S3 Bucket Public Access',\n    category: 'Storage',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('aws s3api list-buckets --output json');\n        const buckets = JSON.parse(stdout).Buckets || [];\n        evidence.push(`Found ${buckets.length} S3 buckets`);\n\n        for (const bucket of buckets.slice(0, 10)) {\n          try {\n            const { stdout: aclOutput } = await execAsync(`aws s3api get-bucket-acl --bucket ${bucket.Name} --output json`);\n            const acl = JSON.parse(aclOutput);\n\n            for (const grant of acl.Grants || []) {\n              if (grant.Grantee?.URI?.includes('AllUsers') || grant.Grantee?.URI?.includes('AuthenticatedUsers')) {\n                vulnerabilities.push(`${bucket.Name}: Public via ${grant.Permission}`);\n              }\n            }\n          } catch {\n            // Skip inaccessible buckets\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AWS-S3-PUBLIC-001',\n          provider: 'aws',\n          vulnerability: 'S3 Bucket Public Access',\n          severity: 'critical',\n          confidence: 0.95,\n          evidence,\n          technique: 'ACL Analysis',\n          timestamp: new Date().toISOString(),\n          resource: 's3/buckets',\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Enable S3 Block Public Access, review bucket policies',\n        };\n      } catch (e) {\n        evidence.push(`AWS CLI not configured or error: ${e}`);\n        return null;\n      }\n    },\n  },\n  {\n    id: 'AWS-IAM-ADMIN-001',\n    name: 'IAM Users with Admin Access',\n    category: 'IAM',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('aws iam list-users --output json');\n        const users = JSON.parse(stdout).Users || [];\n        evidence.push(`Found ${users.length} IAM users`);\n\n        for (const user of users) {\n          try {\n            const { stdout: policiesOutput } = await execAsync(`aws iam list-attached-user-policies --user-name ${user.UserName} --output json`);\n            const policies = JSON.parse(policiesOutput).AttachedPolicies || [];\n\n            for (const policy of policies) {\n              if (policy.PolicyArn?.includes('AdministratorAccess') || policy.PolicyArn?.includes('PowerUserAccess')) {\n                vulnerabilities.push(`${user.UserName}: Has ${policy.PolicyName}`);\n              }\n            }\n          } catch {\n            // Skip inaccessible users\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AWS-IAM-ADMIN-001',\n          provider: 'aws',\n          vulnerability: 'IAM Users with Excessive Privileges',\n          severity: 'high',\n          confidence: 0.9,\n          evidence,\n          technique: 'Policy Enumeration',\n          timestamp: new Date().toISOString(),\n          resource: 'iam/users',\n          exploitability: 'moderate',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Apply least privilege, use IAM roles instead',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'AWS-EC2-SG-001',\n    name: 'Security Groups Open to Internet',\n    category: 'Network',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('aws ec2 describe-security-groups --output json');\n        const groups = JSON.parse(stdout).SecurityGroups || [];\n        evidence.push(`Found ${groups.length} security groups`);\n\n        for (const sg of groups) {\n          for (const perm of sg.IpPermissions || []) {\n            for (const range of perm.IpRanges || []) {\n              if (range.CidrIp === '0.0.0.0/0') {\n                const port = perm.FromPort === perm.ToPort ? perm.FromPort : `${perm.FromPort}-${perm.ToPort}`;\n                vulnerabilities.push(`${sg.GroupId}: Open to 0.0.0.0/0 on port ${port}`);\n              }\n            }\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AWS-EC2-SG-001',\n          provider: 'aws',\n          vulnerability: 'Security Groups Open to Internet',\n          severity: 'critical',\n          confidence: 0.95,\n          evidence,\n          technique: 'Security Group Analysis',\n          timestamp: new Date().toISOString(),\n          resource: 'ec2/security-groups',\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Restrict CIDR ranges, use VPC endpoints',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n];\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Azure Tests (Skeleton - requires Azure CLI)\n// ═══════════════════════════════════════════════════════════════════════════════\n\nconst AZURE_TESTS: SecurityTest[] = [\n  {\n    id: 'AZURE-STORAGE-PUBLIC-001',\n    name: 'Storage Account Public Access',\n    category: 'Storage',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('az storage account list --output json');\n        const accounts = JSON.parse(stdout) || [];\n        evidence.push(`Found ${accounts.length} storage accounts`);\n\n        for (const account of accounts) {\n          if (account.allowBlobPublicAccess === true) {\n            vulnerabilities.push(`${account.name}: Public blob access enabled`);\n          }\n          if (account.networkRuleSet?.defaultAction === 'Allow') {\n            vulnerabilities.push(`${account.name}: Network default action is Allow`);\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AZURE-STORAGE-PUBLIC-001',\n          provider: 'azure',\n          vulnerability: 'Storage Account Public Access',\n          severity: 'high',\n          confidence: 0.9,\n          evidence,\n          technique: 'Configuration Audit',\n          timestamp: new Date().toISOString(),\n          resource: 'storage/accounts',\n          exploitability: 'moderate',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Disable public access, configure network rules',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'AZURE-RBAC-ADMIN-001',\n    name: 'RBAC Owner/Contributor Assignments',\n    category: 'IAM',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('az role assignment list --all --output json');\n        const assignments = JSON.parse(stdout) || [];\n        evidence.push(`Found ${assignments.length} role assignments`);\n\n        for (const assignment of assignments) {\n          if (assignment.roleDefinitionName === 'Owner' || assignment.roleDefinitionName === 'Contributor') {\n            if (assignment.scope === '/' || assignment.scope?.split('/').length <= 3) {\n              vulnerabilities.push(`${assignment.principalName}: ${assignment.roleDefinitionName} at ${assignment.scope}`);\n            }\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AZURE-RBAC-ADMIN-001',\n          provider: 'azure',\n          vulnerability: 'Broad RBAC Assignments at Subscription Level',\n          severity: 'high',\n          confidence: 0.9,\n          evidence,\n          technique: 'RBAC Analysis',\n          timestamp: new Date().toISOString(),\n          resource: 'rbac/assignments',\n          exploitability: 'moderate',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Apply least privilege, use resource group scoping',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n  {\n    id: 'AZURE-NSG-OPEN-001',\n    name: 'NSG Rules Open to Internet',\n    category: 'Network',\n    aptPhase: 'reconnaissance',\n    execute: async (config: AuditConfig): Promise<SecurityFinding | null> => {\n      const evidence: string[] = [];\n      const vulnerabilities: string[] = [];\n\n      try {\n        const { stdout } = await execAsync('az network nsg list --output json');\n        const nsgs = JSON.parse(stdout) || [];\n        evidence.push(`Found ${nsgs.length} NSGs`);\n\n        for (const nsg of nsgs) {\n          for (const rule of nsg.securityRules || []) {\n            if (rule.sourceAddressPrefix === '*' && rule.direction === 'Inbound' && rule.access === 'Allow') {\n              vulnerabilities.push(`${nsg.name}/${rule.name}: Open to * on port ${rule.destinationPortRange}`);\n            }\n          }\n        }\n\n        evidence.push(...vulnerabilities);\n\n        if (vulnerabilities.length === 0) return null;\n\n        return {\n          id: 'AZURE-NSG-OPEN-001',\n          provider: 'azure',\n          vulnerability: 'NSG Rules Open to Internet',\n          severity: 'critical',\n          confidence: 0.95,\n          evidence,\n          technique: 'NSG Analysis',\n          timestamp: new Date().toISOString(),\n          resource: 'network/nsg',\n          exploitability: 'trivial',\n          verified: true,\n          aptPhase: 'reconnaissance',\n          remediation: 'Restrict source addresses, use service tags',\n        };\n      } catch (e) {\n        return null;\n      }\n    },\n  },\n];\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Zero-Day Prediction Engine\n// ═══════════════════════════════════════════════════════════════════════════════\n\nfunction generateZeroDayPredictions(config: AuditConfig): SecurityFinding[] {\n  if (!config.includeZeroDay) return [];\n\n  const predictions: SecurityFinding[] = [];\n  const timestamp = new Date().toISOString();\n\n  const zeroDayHypotheses = [\n    {\n      id: 'ZERODAY-TIMING-001',\n      vulnerability: 'Temporal Coupling in Auth Token Refresh',\n      description: 'Race window during token refresh allows session hijacking',\n      heuristics: ['temporalCoupling', 'trustBoundaryAnalysis'],\n    },\n    {\n      id: 'ZERODAY-SERIAL-001',\n      vulnerability: 'Deserialization Gadget in API Gateway',\n      description: 'Complex serialization chain allows RCE via crafted payloads',\n      heuristics: ['serializationBoundaries', 'complexityCorrelation'],\n    },\n    {\n      id: 'ZERODAY-EMERGENT-001',\n      vulnerability: 'Emergent Privilege Escalation via Service Mesh',\n      description: 'Multi-service interaction creates unintended privilege path',\n      heuristics: ['emergentBehaviors', 'trustBoundaryAnalysis'],\n    },\n    {\n      id: 'ZERODAY-STATE-001',\n      vulnerability: 'Implicit State Dependency Cache Poisoning',\n      description: 'Shared cache state allows cross-tenant data leakage',\n      heuristics: ['implicitStateDependencies', 'errorHandlingAsymmetry'],\n    },\n    {\n      id: 'ZERODAY-RESOURCE-001',\n      vulnerability: 'Resource Exhaustion via Asymmetric Load',\n      description: 'Unbalanced resource limits enable denial of service',\n      heuristics: ['resourceExhaustion', 'complexityCorrelation'],\n    },\n  ];\n\n  for (const hypothesis of zeroDayHypotheses) {\n    const relevantHeuristics = hypothesis.heuristics.map(h => ZERO_DAY_HEURISTICS[h as keyof typeof ZERO_DAY_HEURISTICS]);\n    const avgWeight = relevantHeuristics.reduce((sum, h) => sum + h.weight, 0) / relevantHeuristics.length;\n\n    predictions.push({\n      id: hypothesis.id,\n      provider: config.provider,\n      vulnerability: hypothesis.vulnerability,\n      severity: 'high',\n      confidence: avgWeight * 0.7, // Zero-day predictions have inherent uncertainty\n      evidence: [\n        hypothesis.description,\n        `Based on heuristics: ${hypothesis.heuristics.join(', ')}`,\n        ...relevantHeuristics.flatMap(h => h.indicators.slice(0, 2)),\n      ],\n      technique: 'Zero-Day Prediction via Heuristic Analysis',\n      timestamp,\n      resource: 'infrastructure',\n      exploitability: 'theoretical',\n      verified: false,\n      aptPhase: 'exploitation',\n      remediation: 'Manual security review recommended',\n    });\n  }\n\n  return predictions;\n}\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Main Audit Engine\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport async function runUniversalSecurityAudit(config: AuditConfig): Promise<UniversalAuditResult> {\n  const startTime = new Date();\n  const findings: SecurityFinding[] = [];\n\n  console.log('\\n');\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                                                                            ██');\n  console.log('██           UNIVERSAL SECURITY AUDIT - AGI CORE                              ██');\n  console.log('██                 Live Infrastructure Testing                                ██');\n  console.log('██                                                                            ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  console.log(`Provider: ${config.provider.toUpperCase()}`);\n  console.log(`Project/Account: ${config.projectId || config.accountId || config.subscriptionId || 'N/A'}`);\n  console.log(`Organization: ${config.organizationId || 'N/A'}`);\n  console.log(`Timestamp: ${startTime.toISOString()}`);\n  console.log(`Mode: ${config.liveTesting ? 'LIVE TESTING' : 'Configuration Review'}`);\n  console.log('\\n');\n\n  // Select tests based on provider\n  let tests: SecurityTest[] = [];\n  switch (config.provider) {\n    case 'gcp':\n      tests = GCP_TESTS;\n      break;\n    case 'aws':\n      tests = AWS_TESTS;\n      break;\n    case 'azure':\n      tests = AZURE_TESTS;\n      break;\n    case 'custom':\n      // Custom provider uses all available tests\n      tests = [...GCP_TESTS, ...AWS_TESTS, ...AZURE_TESTS];\n      break;\n  }\n\n  console.log('┌─────────────────────────────────────────────────────────────────────────────┐');\n  console.log('│ EXECUTING SECURITY TESTS                                                   │');\n  console.log('└─────────────────────────────────────────────────────────────────────────────┘\\n');\n\n  // Run tests\n  for (const test of tests) {\n    try {\n      console.log(`  [${test.category}] ${test.name}...`);\n      const finding = await test.execute(config);\n      if (finding) {\n        findings.push(finding);\n        console.log(`    ⚠ FOUND: ${finding.severity.toUpperCase()} - ${finding.vulnerability}`);\n      } else {\n        console.log(`    ✓ OK`);\n      }\n    } catch (e) {\n      console.log(`    ✗ ERROR: ${e}`);\n    }\n  }\n\n  // Add zero-day predictions if enabled\n  if (config.includeZeroDay) {\n    console.log('\\n');\n    console.log('┌─────────────────────────────────────────────────────────────────────────────┐');\n    console.log('│ ZERO-DAY PREDICTION ENGINE                                                 │');\n    console.log('└─────────────────────────────────────────────────────────────────────────────┘\\n');\n\n    const predictions = generateZeroDayPredictions(config);\n    findings.push(...predictions);\n\n    for (const pred of predictions) {\n      console.log(`  [PREDICTION] ${pred.vulnerability}`);\n      console.log(`    Confidence: ${(pred.confidence * 100).toFixed(1)}%`);\n    }\n  }\n\n  const endTime = new Date();\n  const duration = endTime.getTime() - startTime.getTime();\n\n  // Generate summary\n  const verified = findings.filter(f => f.verified);\n  const summary: AuditSummary = {\n    provider: config.provider,\n    startTime: startTime.toISOString(),\n    endTime: endTime.toISOString(),\n    duration,\n    total: findings.length,\n    verified: verified.length,\n    critical: findings.filter(f => f.severity === 'critical').length,\n    high: findings.filter(f => f.severity === 'high').length,\n    medium: findings.filter(f => f.severity === 'medium').length,\n    low: findings.filter(f => f.severity === 'low').length,\n    zeroDay: findings.filter(f => f.exploitability === 'theoretical').length,\n  };\n\n  // Print summary\n  console.log('\\n');\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                          AUDIT COMPLETE                                    ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  console.log(`  Total Findings: ${summary.total}`);\n  console.log(`  Verified: ${summary.verified}`);\n  console.log(`    Critical: ${summary.critical}`);\n  console.log(`    High: ${summary.high}`);\n  console.log(`    Medium: ${summary.medium}`);\n  console.log(`    Low: ${summary.low}`);\n  console.log(`  Zero-Day Predictions: ${summary.zeroDay}`);\n  console.log(`\\n  Duration: ${(duration / 1000).toFixed(2)}s`);\n\n  if (verified.length > 0) {\n    console.log('\\n');\n    console.log('┌─────────────────────────────────────────────────────────────────────────────┐');\n    console.log('│ CONFIRMED VULNERABILITIES                                                  │');\n    console.log('└─────────────────────────────────────────────────────────────────────────────┘\\n');\n\n    for (const v of verified) {\n      console.log(`  ⚠ [${v.severity.toUpperCase()}] ${v.vulnerability}`);\n      console.log(`    ID: ${v.id}`);\n      console.log(`    Resource: ${v.resource}`);\n      console.log(`    Confidence: ${(v.confidence * 100).toFixed(1)}%`);\n      console.log(`    Exploitability: ${v.exploitability}`);\n      if (v.remediation) {\n        console.log(`    Remediation: ${v.remediation}`);\n      }\n      console.log('');\n    }\n  }\n\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  return { findings, summary };\n}\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Multi-Provider Audit\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport async function runMultiProviderAudit(configs: AuditConfig[]): Promise<Map<CloudProvider, UniversalAuditResult>> {\n  const results = new Map<CloudProvider, UniversalAuditResult>();\n\n  console.log('\\n');\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                                                                            ██');\n  console.log('██           MULTI-PROVIDER SECURITY AUDIT                                    ██');\n  console.log('██                                                                            ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  for (const config of configs) {\n    console.log(`\\n▶ Starting audit for ${config.provider.toUpperCase()}...\\n`);\n    const result = await runUniversalSecurityAudit(config);\n    results.set(config.provider, result);\n  }\n\n  // Aggregate summary\n  console.log('\\n');\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                     AGGREGATE SUMMARY                                      ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  let totalFindings = 0;\n  let totalCritical = 0;\n  let totalHigh = 0;\n\n  for (const [provider, result] of results) {\n    console.log(`  ${provider.toUpperCase()}: ${result.summary.total} findings (${result.summary.critical} critical, ${result.summary.high} high)`);\n    totalFindings += result.summary.total;\n    totalCritical += result.summary.critical;\n    totalHigh += result.summary.high;\n  }\n\n  console.log(`\\n  TOTAL: ${totalFindings} findings across ${configs.length} providers`);\n  console.log(`  Critical: ${totalCritical}, High: ${totalHigh}`);\n  console.log('\\n████████████████████████████████████████████████████████████████████████████████\\n');\n\n  return results;\n}\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// Default Export - Security Audit as Default Capability\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport default runUniversalSecurityAudit;\n\n// ═══════════════════════════════════════════════════════════════════════════════\n// AUTOMATIC REMEDIATION ENGINE\n// Fixes confirmed vulnerabilities automatically\n// ═══════════════════════════════════════════════════════════════════════════════\n\nexport interface RemediationResult {\n  findingId: string;\n  success: boolean;\n  action: string;\n  details: string[];\n  timestamp: string;\n  rollbackCommand?: string;\n}\n\nexport interface RemediationSummary {\n  total: number;\n  fixed: number;\n  failed: number;\n  skipped: number;\n  results: RemediationResult[];\n}\n\n// GCP Remediation Functions\nconst GCP_REMEDIATIONS: Record<string, (finding: SecurityFinding, config: AuditConfig) => Promise<RemediationResult>> = {\n  'GCP-STORAGE-ACL-001': async (finding, config) => {\n    const details: string[] = [];\n    const token = await getGCPAccessToken();\n\n    // Extract bucket names from evidence\n    const bucketMatches = finding.evidence.filter(e => e.includes('bucket') || e.includes('Legacy ACL') || e.includes('PUBLIC'));\n\n    for (const match of bucketMatches) {\n      const bucketName = match.split(':')[0].trim();\n      if (!bucketName || bucketName === 'Found') continue;\n\n      try {\n        // Enable uniform bucket-level access\n        await gcpApiCall(\n          `https://storage.googleapis.com/storage/v1/b/${bucketName}?fields=iamConfiguration`,\n          'PATCH',\n          {\n            iamConfiguration: {\n              uniformBucketLevelAccess: { enabled: true },\n              publicAccessPrevention: 'enforced',\n            },\n          },\n          token\n        );\n        details.push(`Fixed: ${bucketName} - Enabled uniform access, enforced public prevention`);\n      } catch (e) {\n        details.push(`Failed: ${bucketName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Enable uniform bucket-level access and public access prevention',\n      details,\n      timestamp: new Date().toISOString(),\n      rollbackCommand: 'gcloud storage buckets update gs://BUCKET --no-uniform-bucket-level-access',\n    };\n  },\n\n  'GCP-FIREWALL-OPEN-001': async (finding, config) => {\n    const details: string[] = [];\n    const token = await getGCPAccessToken();\n\n    // Extract firewall rule names from evidence\n    const ruleMatches = finding.evidence.filter(e => e.includes('0.0.0.0/0'));\n\n    for (const match of ruleMatches) {\n      const ruleName = match.split(':')[0].trim();\n      if (!ruleName || ruleName === 'Found') continue;\n\n      try {\n        // Delete or restrict the firewall rule\n        // For safety, we'll add a deny rule with higher priority instead of deleting\n        await gcpApiCall(\n          `https://compute.googleapis.com/compute/v1/projects/${config.projectId}/global/firewalls`,\n          'POST',\n          {\n            name: `block-${ruleName}-remediation`,\n            network: `projects/${config.projectId}/global/networks/default`,\n            priority: 100, // High priority to override\n            direction: 'INGRESS',\n            denied: [{ IPProtocol: 'all' }],\n            sourceRanges: ['0.0.0.0/0'],\n            description: `Auto-remediation: Blocks open access from ${ruleName}`,\n          },\n          token\n        );\n        details.push(`Fixed: Added blocking rule for ${ruleName}`);\n      } catch (e) {\n        details.push(`Failed: ${ruleName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Add high-priority deny rules to block 0.0.0.0/0 access',\n      details,\n      timestamp: new Date().toISOString(),\n      rollbackCommand: `gcloud compute firewall-rules delete block-*-remediation --project=${config.projectId}`,\n    };\n  },\n\n  'GCP-VPC-SC-001': async (finding, config) => {\n    // VPC Service Controls require organization-level access, provide guidance\n    return {\n      findingId: finding.id,\n      success: false,\n      action: 'VPC Service Controls configuration requires organization admin',\n      details: [\n        'Remediation requires organization-level permissions',\n        'Recommended: Create access policy and service perimeter',\n        `Command: gcloud access-context-manager policies create --organization=${config.organizationId || 'ORG_ID'} --title=\"Security Perimeter\"`,\n        'Then: gcloud access-context-manager perimeters create NAME --policy=POLICY_ID --resources=projects/PROJECT_NUMBER',\n      ],\n      timestamp: new Date().toISOString(),\n    };\n  },\n\n  'GCP-GKE-SECURITY-001': async (finding, config) => {\n    const details: string[] = [];\n\n    // Extract cluster names from evidence\n    const clusterMatches = finding.evidence.filter(e =>\n      e.includes('No Workload Identity') ||\n      e.includes('Shielded Nodes') ||\n      e.includes('No Network Policy') ||\n      e.includes('Master not restricted')\n    );\n\n    for (const match of clusterMatches) {\n      const clusterName = match.split(':')[0].trim();\n      if (!clusterName) continue;\n\n      try {\n        // Enable Workload Identity\n        await execAsync(`gcloud container clusters update ${clusterName} --workload-pool=${config.projectId}.svc.id.goog --project=${config.projectId} --quiet`);\n        details.push(`Fixed: ${clusterName} - Enabled Workload Identity`);\n      } catch (e) {\n        details.push(`Failed Workload Identity: ${clusterName} - ${e}`);\n      }\n\n      try {\n        // Enable Network Policy\n        await execAsync(`gcloud container clusters update ${clusterName} --enable-network-policy --project=${config.projectId} --quiet`);\n        details.push(`Fixed: ${clusterName} - Enabled Network Policy`);\n      } catch (e) {\n        details.push(`Failed Network Policy: ${clusterName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Enable Workload Identity and Network Policy on GKE clusters',\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  },\n\n  'GCP-SA-KEY-RACE-001': async (finding, config) => {\n    const details: string[] = [];\n    const token = await getGCPAccessToken();\n\n    // Restrict SA key creation via organization policy\n    try {\n      // Set organization policy to disable SA key creation\n      await gcpApiCall(\n        `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:setOrgPolicy`,\n        'POST',\n        {\n          policy: {\n            constraint: 'constraints/iam.disableServiceAccountKeyCreation',\n            booleanPolicy: { enforced: true },\n          },\n        },\n        token\n      );\n      details.push('Fixed: Disabled service account key creation via organization policy');\n    } catch (e) {\n      details.push(`Failed: Could not set org policy - ${e}`);\n      details.push('Manual remediation: Enable Workload Identity Federation instead of SA keys');\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Disable service account key creation, use Workload Identity',\n      details,\n      timestamp: new Date().toISOString(),\n      rollbackCommand: `gcloud resource-manager org-policies delete iam.disableServiceAccountKeyCreation --project=${config.projectId}`,\n    };\n  },\n\n  'GCP-IAM-CROSS-PROJECT-001': async (finding, config) => {\n    const details: string[] = [];\n    const token = await getGCPAccessToken();\n\n    // Get current IAM policy\n    const policyResult = await gcpApiCall(\n      `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:getIamPolicy`,\n      'POST',\n      { options: { requestedPolicyVersion: 3 } },\n      token\n    );\n\n    const policy = policyResult.data as { bindings: { role: string; members: string[] }[]; etag: string; version: number };\n    const originalBindings = JSON.stringify(policy.bindings);\n\n    // Filter out cross-project SAs and public access\n    const newBindings = policy.bindings.map(binding => ({\n      ...binding,\n      members: binding.members.filter(member => {\n        if (member === 'allUsers' || member === 'allAuthenticatedUsers') {\n          details.push(`Removed: ${member} from ${binding.role}`);\n          return false;\n        }\n        // Keep cross-project SAs but log them (removing might break dependencies)\n        if (member.startsWith('serviceAccount:') && !member.includes(config.projectId || '')) {\n          details.push(`Warning: Cross-project SA ${member} has ${binding.role} - review manually`);\n        }\n        return true;\n      }),\n    })).filter(binding => binding.members.length > 0);\n\n    if (JSON.stringify(newBindings) !== originalBindings) {\n      try {\n        await gcpApiCall(\n          `https://cloudresourcemanager.googleapis.com/v1/projects/${config.projectId}:setIamPolicy`,\n          'POST',\n          {\n            policy: {\n              bindings: newBindings,\n              etag: policy.etag,\n              version: 3,\n            },\n          },\n          token\n        );\n        details.push('Fixed: Removed public access bindings');\n      } catch (e) {\n        details.push(`Failed to update policy: ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed') || d.startsWith('Removed')),\n      action: 'Remove public access (allUsers/allAuthenticatedUsers) from IAM bindings',\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  },\n\n  'GCP-BIGQUERY-EXPOSURE-001': async (finding, config) => {\n    const details: string[] = [];\n    const token = await getGCPAccessToken();\n\n    // Extract dataset names from evidence\n    const datasetMatches = finding.evidence.filter(e => e.includes('PUBLIC'));\n\n    for (const match of datasetMatches) {\n      const datasetId = match.split(':')[0].trim();\n      if (!datasetId || datasetId === 'Found') continue;\n\n      try {\n        // Get current dataset access\n        const detailResult = await gcpApiCall(\n          `https://bigquery.googleapis.com/bigquery/v2/projects/${config.projectId}/datasets/${datasetId}`,\n          'GET',\n          undefined,\n          token\n        );\n\n        const data = detailResult.data as { access: { specialGroup?: string; iamMember?: string; role?: string; userByEmail?: string }[] };\n\n        // Filter out public access\n        const newAccess = data.access.filter(a => {\n          if (a.specialGroup === 'allAuthenticatedUsers' || a.specialGroup === 'allUsers') {\n            details.push(`Removed: ${a.specialGroup} from ${datasetId}`);\n            return false;\n          }\n          if (a.iamMember?.startsWith('allUsers') || a.iamMember?.startsWith('allAuthenticatedUsers')) {\n            details.push(`Removed: ${a.iamMember} from ${datasetId}`);\n            return false;\n          }\n          return true;\n        });\n\n        // Update dataset\n        await gcpApiCall(\n          `https://bigquery.googleapis.com/bigquery/v2/projects/${config.projectId}/datasets/${datasetId}`,\n          'PATCH',\n          { access: newAccess },\n          token\n        );\n        details.push(`Fixed: ${datasetId} - Removed public access`);\n      } catch (e) {\n        details.push(`Failed: ${datasetId} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Remove public access from BigQuery datasets',\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  },\n};\n\n// AWS Remediation Functions\nconst AWS_REMEDIATIONS: Record<string, (finding: SecurityFinding, config: AuditConfig) => Promise<RemediationResult>> = {\n  'AWS-S3-PUBLIC-001': async (finding, config) => {\n    const details: string[] = [];\n\n    // Extract bucket names from evidence\n    const bucketMatches = finding.evidence.filter(e => e.includes('Public via'));\n\n    for (const match of bucketMatches) {\n      const bucketName = match.split(':')[0].trim();\n      if (!bucketName || bucketName === 'Found') continue;\n\n      try {\n        // Enable S3 Block Public Access\n        await execAsync(`aws s3api put-public-access-block --bucket ${bucketName} --public-access-block-configuration \"BlockPublicAcls=true,IgnorePublicAcls=true,BlockPublicPolicy=true,RestrictPublicBuckets=true\"`);\n        details.push(`Fixed: ${bucketName} - Enabled Block Public Access`);\n      } catch (e) {\n        details.push(`Failed: ${bucketName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Enable S3 Block Public Access on all buckets',\n      details,\n      timestamp: new Date().toISOString(),\n      rollbackCommand: 'aws s3api delete-public-access-block --bucket BUCKET_NAME',\n    };\n  },\n\n  'AWS-EC2-SG-001': async (finding, config) => {\n    const details: string[] = [];\n\n    // Extract security group IDs from evidence\n    const sgMatches = finding.evidence.filter(e => e.includes('0.0.0.0/0'));\n\n    for (const match of sgMatches) {\n      const sgId = match.split(':')[0].trim();\n      if (!sgId || !sgId.startsWith('sg-')) continue;\n\n      try {\n        // Remove 0.0.0.0/0 ingress rules\n        const { stdout: rulesOutput } = await execAsync(`aws ec2 describe-security-groups --group-ids ${sgId} --output json`);\n        const sg = JSON.parse(rulesOutput).SecurityGroups[0];\n\n        for (const perm of sg.IpPermissions || []) {\n          for (const range of perm.IpRanges || []) {\n            if (range.CidrIp === '0.0.0.0/0') {\n              await execAsync(`aws ec2 revoke-security-group-ingress --group-id ${sgId} --protocol ${perm.IpProtocol} --port ${perm.FromPort}-${perm.ToPort} --cidr 0.0.0.0/0`);\n              details.push(`Fixed: ${sgId} - Revoked 0.0.0.0/0 on port ${perm.FromPort}`);\n            }\n          }\n        }\n      } catch (e) {\n        details.push(`Failed: ${sgId} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Revoke 0.0.0.0/0 ingress rules from security groups',\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  },\n\n  'AWS-IAM-ADMIN-001': async (finding, config) => {\n    // IAM admin removal requires careful review - provide guidance only\n    return {\n      findingId: finding.id,\n      success: false,\n      action: 'IAM admin policy removal requires manual review',\n      details: [\n        'Automatic removal of admin policies could break critical access',\n        'Recommended: Review each user and apply least privilege',\n        'Steps:',\n        '1. aws iam list-attached-user-policies --user-name USER',\n        '2. aws iam detach-user-policy --user-name USER --policy-arn ARN',\n        '3. Create custom policy with minimum required permissions',\n      ],\n      timestamp: new Date().toISOString(),\n    };\n  },\n};\n\n// Azure Remediation Functions\nconst AZURE_REMEDIATIONS: Record<string, (finding: SecurityFinding, config: AuditConfig) => Promise<RemediationResult>> = {\n  'AZURE-STORAGE-PUBLIC-001': async (finding, config) => {\n    const details: string[] = [];\n\n    // Extract storage account names from evidence\n    const accountMatches = finding.evidence.filter(e => e.includes('Public') || e.includes('Allow'));\n\n    for (const match of accountMatches) {\n      const accountName = match.split(':')[0].trim();\n      if (!accountName || accountName === 'Found') continue;\n\n      try {\n        // Disable public blob access\n        await execAsync(`az storage account update --name ${accountName} --allow-blob-public-access false`);\n        details.push(`Fixed: ${accountName} - Disabled public blob access`);\n\n        // Set network default action to Deny\n        await execAsync(`az storage account update --name ${accountName} --default-action Deny`);\n        details.push(`Fixed: ${accountName} - Set network default to Deny`);\n      } catch (e) {\n        details.push(`Failed: ${accountName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Disable public access and restrict network rules',\n      details,\n      timestamp: new Date().toISOString(),\n      rollbackCommand: 'az storage account update --name ACCOUNT --allow-blob-public-access true --default-action Allow',\n    };\n  },\n\n  'AZURE-NSG-OPEN-001': async (finding, config) => {\n    const details: string[] = [];\n\n    // Extract NSG rule info from evidence\n    const ruleMatches = finding.evidence.filter(e => e.includes('Open to *'));\n\n    for (const match of ruleMatches) {\n      const parts = match.split('/');\n      const nsgName = parts[0]?.trim();\n      const ruleName = parts[1]?.split(':')[0]?.trim();\n      if (!nsgName || !ruleName) continue;\n\n      try {\n        // Delete the permissive rule\n        await execAsync(`az network nsg rule delete --nsg-name ${nsgName} --name ${ruleName} --resource-group RESOURCE_GROUP`);\n        details.push(`Fixed: ${nsgName}/${ruleName} - Deleted open rule`);\n      } catch (e) {\n        details.push(`Failed: ${nsgName}/${ruleName} - ${e}`);\n      }\n    }\n\n    return {\n      findingId: finding.id,\n      success: details.some(d => d.startsWith('Fixed')),\n      action: 'Delete NSG rules open to all sources',\n      details,\n      timestamp: new Date().toISOString(),\n    };\n  },\n\n  'AZURE-RBAC-ADMIN-001': async (finding, config) => {\n    // RBAC removal requires manual review\n    return {\n      findingId: finding.id,\n      success: false,\n      action: 'RBAC assignment removal requires manual review',\n      details: [\n        'Automatic removal of Owner/Contributor roles could break access',\n        'Recommended: Review each assignment and scope down',\n        'Steps:',\n        '1. az role assignment list --all',\n        '2. az role assignment delete --assignee PRINCIPAL --role ROLE --scope SCOPE',\n        '3. Create resource-group-scoped assignments instead',\n      ],\n      timestamp: new Date().toISOString(),\n    };\n  },\n};\n\n/**\n * Apply automatic remediations for all confirmed vulnerabilities\n */\nexport async function remediateFindings(\n  findings: SecurityFinding[],\n  config: AuditConfig,\n  options: { dryRun?: boolean; interactive?: boolean } = {}\n): Promise<RemediationSummary> {\n  console.log('\\n');\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                                                                            ██');\n  console.log('██           AUTOMATIC REMEDIATION ENGINE                                     ██');\n  console.log('██                 Fixing Confirmed Vulnerabilities                           ██');\n  console.log('██                                                                            ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  if (options.dryRun) {\n    console.log('  MODE: DRY RUN - No changes will be made\\n');\n  }\n\n  const results: RemediationResult[] = [];\n  let fixed = 0;\n  let failed = 0;\n  let skipped = 0;\n\n  // Only remediate verified findings\n  const verifiedFindings = findings.filter(f => f.verified && f.exploitability !== 'theoretical');\n\n  console.log(`  Findings to remediate: ${verifiedFindings.length}\\n`);\n\n  for (const finding of verifiedFindings) {\n    console.log(`  [${finding.severity.toUpperCase()}] ${finding.vulnerability}`);\n    console.log(`    ID: ${finding.id}`);\n\n    // Select remediation function based on provider\n    let remediationFn: ((f: SecurityFinding, c: AuditConfig) => Promise<RemediationResult>) | undefined;\n\n    switch (finding.provider) {\n      case 'gcp':\n        remediationFn = GCP_REMEDIATIONS[finding.id];\n        break;\n      case 'aws':\n        remediationFn = AWS_REMEDIATIONS[finding.id];\n        break;\n      case 'azure':\n        remediationFn = AZURE_REMEDIATIONS[finding.id];\n        break;\n    }\n\n    if (!remediationFn) {\n      console.log(`    ⊘ No automatic remediation available`);\n      console.log(`    Manual: ${finding.remediation || 'See documentation'}\\n`);\n      skipped++;\n      results.push({\n        findingId: finding.id,\n        success: false,\n        action: 'No automatic remediation available',\n        details: [finding.remediation || 'Manual remediation required'],\n        timestamp: new Date().toISOString(),\n      });\n      continue;\n    }\n\n    if (options.dryRun) {\n      console.log(`    [DRY RUN] Would apply remediation`);\n      console.log(`    Action: ${finding.remediation}\\n`);\n      skipped++;\n      continue;\n    }\n\n    try {\n      console.log(`    Applying remediation...`);\n      const result = await remediationFn(finding, config);\n      results.push(result);\n\n      if (result.success) {\n        console.log(`    ✓ FIXED`);\n        for (const detail of result.details.slice(0, 3)) {\n          console.log(`      ${detail}`);\n        }\n        fixed++;\n      } else {\n        console.log(`    ⚠ PARTIAL/FAILED`);\n        for (const detail of result.details.slice(0, 3)) {\n          console.log(`      ${detail}`);\n        }\n        failed++;\n      }\n\n      if (result.rollbackCommand) {\n        console.log(`    Rollback: ${result.rollbackCommand}`);\n      }\n    } catch (e) {\n      console.log(`    ✗ ERROR: ${e}`);\n      failed++;\n      results.push({\n        findingId: finding.id,\n        success: false,\n        action: 'Remediation failed',\n        details: [`Error: ${e}`],\n        timestamp: new Date().toISOString(),\n      });\n    }\n\n    console.log('');\n  }\n\n  // Summary\n  console.log('████████████████████████████████████████████████████████████████████████████████');\n  console.log('██                     REMEDIATION COMPLETE                                   ██');\n  console.log('████████████████████████████████████████████████████████████████████████████████\\n');\n\n  console.log(`  Total: ${verifiedFindings.length}`);\n  console.log(`  Fixed: ${fixed}`);\n  console.log(`  Failed: ${failed}`);\n  console.log(`  Skipped: ${skipped}`);\n  console.log('\\n████████████████████████████████████████████████████████████████████████████████\\n');\n\n  return {\n    total: verifiedFindings.length,\n    fixed,\n    failed,\n    skipped,\n    results,\n  };\n}\n\n/**\n * Run full security audit with automatic remediation\n */\nexport async function runSecurityAuditWithRemediation(\n  config: AuditConfig,\n  options: { autoFix?: boolean; dryRun?: boolean } = {}\n): Promise<{ audit: UniversalAuditResult; remediation?: RemediationSummary }> {\n  // Run the audit\n  const audit = await runUniversalSecurityAudit(config);\n\n  // Apply remediations if requested\n  if (options.autoFix && audit.findings.length > 0) {\n    const remediation = await remediateFindings(audit.findings, config, { dryRun: options.dryRun });\n    return { audit, remediation };\n  }\n\n  return { audit };\n}\n\n// Auto-detect provider and run audit\nexport async function runDefaultSecurityAudit(): Promise<UniversalAuditResult> {\n  // Try to detect provider from environment\n  let provider: CloudProvider = 'custom';\n  let projectId: string | undefined;\n  let accountId: string | undefined;\n  let subscriptionId: string | undefined;\n\n  // Check for GCP\n  try {\n    const { stdout } = await execAsync('gcloud config get-value project 2>/dev/null');\n    if (stdout.trim()) {\n      provider = 'gcp';\n      projectId = stdout.trim();\n    }\n  } catch { /* not GCP */ }\n\n  // Check for AWS\n  if (provider === 'custom') {\n    try {\n      const { stdout } = await execAsync('aws sts get-caller-identity --output json 2>/dev/null');\n      const data = JSON.parse(stdout);\n      if (data.Account) {\n        provider = 'aws';\n        accountId = data.Account;\n      }\n    } catch { /* not AWS */ }\n  }\n\n  // Check for Azure\n  if (provider === 'custom') {\n    try {\n      const { stdout } = await execAsync('az account show --output json 2>/dev/null');\n      const data = JSON.parse(stdout);\n      if (data.id) {\n        provider = 'azure';\n        subscriptionId = data.id;\n      }\n    } catch { /* not Azure */ }\n  }\n\n  console.log(`Auto-detected provider: ${provider.toUpperCase()}`);\n\n  return runUniversalSecurityAudit({\n    provider,\n    projectId,\n    accountId,\n    subscriptionId,\n    liveTesting: true,\n    includeZeroDay: true,\n  });\n}\n"],"mappings":"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","ignoreList":[]}
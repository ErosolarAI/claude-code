{"version":3,"names":["cov_2l3wb4hvur","actualCoverage","AUTHORIZED_CTF_DOMAINS","s","PROHIBITED_TARGETS","AuthorizedSecurityCapabilityModule","id","create","_context","f","authState","context","authorizedDomains","sessionId","Date","now","Math","random","toString","slice","startTime","operationLog","isTargetAuthorized","target","pattern","test","b","authorized","reason","some","d","includes","logOperation","operation","result","push","timestamp","description","toolSuite","tools","name","parameters","type","properties","enum","items","engagement","required","handler","args","domains","JSON","stringify","status","ctfPlatformsEnabled","message","guidelines","ctf","pentest","research","defensive","educational","passive","error","authCheck","hint","results","toISOString","data","records","note","commonPorts","detected","securityHeaders","protocols","category","safe","safeMode","checks","web","network","config","crypto","injection","format","report","duration","operationCount","length","operations","undefined","generated","round"],"sources":["authorizedSecurityCapability.ts"],"sourcesContent":["/**\n * Authorized Security Capability Module\n *\n * Modular security testing tools that require explicit authorization context.\n * Supports: CTF challenges, pentesting engagements, security research, defensive testing.\n *\n * Authorization is enforced via:\n * 1. Explicit context declaration (ctf, pentest, research, defensive)\n * 2. Target scope validation (localhost, *.ctf.*, authorized domains)\n * 3. Operation logging for accountability\n */\n\nimport type { CapabilityContribution, CapabilityContext, CapabilityModule } from '../runtime/agentHost.js';\n\n// Authorized CTF/training platforms - safe by design\nconst AUTHORIZED_CTF_DOMAINS = [\n  /\\.hackthebox\\.(com|eu)$/,\n  /\\.tryhackme\\.com$/,\n  /\\.ctf\\./,\n  /\\.ctftime\\.org$/,\n  /\\.vulnhub\\.com$/,\n  /\\.pentesterlab\\.com$/,\n  /\\.offensive-security\\.com$/,\n  /\\.htb$/,\n  /localhost$/,\n  /^127\\./,\n  /^10\\./,          // Private network - controlled environment\n  /^192\\.168\\./,    // Private network - controlled environment\n];\n\n// Prohibited targets - never allow regardless of authorization\nconst PROHIBITED_TARGETS = [\n  /\\.gov$/,         // Government\n  /\\.mil$/,         // Military\n  /\\.edu$/,         // Education\n  /\\.bank$/,        // Banking\n  /critical.*infrastructure/i,\n];\n\ntype AuthorizationContext = 'ctf' | 'pentest' | 'research' | 'defensive' | 'educational';\n\ninterface AuthorizationState {\n  context: AuthorizationContext | null;\n  authorizedDomains: string[];\n  sessionId: string;\n  startTime: number;\n  operationLog: Array<{ timestamp: number; operation: string; target: string; result: string }>;\n}\n\nexport class AuthorizedSecurityCapabilityModule implements CapabilityModule {\n  readonly id = 'capability.authorized-security';\n\n  async create(_context: CapabilityContext): Promise<CapabilityContribution> {\n    // Session-scoped authorization state\n    const authState: AuthorizationState = {\n      context: null,\n      authorizedDomains: [],\n      sessionId: `sec-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,\n      startTime: Date.now(),\n      operationLog: [],\n    };\n\n    const isTargetAuthorized = (target: string): { authorized: boolean; reason: string } => {\n      // Check prohibited first\n      for (const pattern of PROHIBITED_TARGETS) {\n        if (pattern.test(target)) {\n          return { authorized: false, reason: `Target matches prohibited pattern: ${pattern}` };\n        }\n      }\n\n      // Check CTF platforms (always allowed for ctf/educational context)\n      if (authState.context === 'ctf' || authState.context === 'educational') {\n        for (const pattern of AUTHORIZED_CTF_DOMAINS) {\n          if (pattern.test(target)) {\n            return { authorized: true, reason: 'CTF/training platform' };\n          }\n        }\n      }\n\n      // Check explicitly authorized domains\n      if (authState.authorizedDomains.some(d => target.includes(d) || target === d)) {\n        return { authorized: true, reason: 'Explicitly authorized domain' };\n      }\n\n      // Localhost always allowed for any context\n      if (/^(localhost|127\\.|10\\.|192\\.168\\.)/.test(target)) {\n        return { authorized: true, reason: 'Local/private network' };\n      }\n\n      return { authorized: false, reason: 'Target not in authorized scope' };\n    };\n\n    const logOperation = (operation: string, target: string, result: string) => {\n      authState.operationLog.push({\n        timestamp: Date.now(),\n        operation,\n        target,\n        result,\n      });\n    };\n\n    return {\n      id: 'authorized-security.tools',\n      description: 'Security testing tools with authorization enforcement',\n      toolSuite: {\n        id: 'authorized-security',\n        description: 'CTF, pentest, research, and defensive security tools',\n        tools: [\n          {\n            name: 'SecurityAuth',\n            description: `Set authorization context for security operations.\nRequired before using security tools.\n\nContexts:\n- ctf: CTF challenges, HackTheBox, TryHackMe, etc.\n- pentest: Authorized penetration testing engagement\n- research: Security research with controlled targets\n- defensive: Blue team / defensive security testing\n- educational: Learning/training purposes\n\nExample: SecurityAuth({ context: \"ctf\", authorizedDomains: [\"target.htb\"] })`,\n            parameters: {\n              type: 'object',\n              properties: {\n                context: {\n                  type: 'string',\n                  enum: ['ctf', 'pentest', 'research', 'defensive', 'educational'],\n                  description: 'Authorization context type',\n                },\n                authorizedDomains: {\n                  type: 'array',\n                  items: { type: 'string' },\n                  description: 'Additional domains explicitly authorized for this session',\n                },\n                engagement: {\n                  type: 'string',\n                  description: 'Optional engagement ID or reference for pentest context',\n                },\n              },\n              required: ['context'],\n            },\n            handler: async (args: Record<string, unknown>) => {\n              const context = args['context'] as AuthorizationContext;\n              const domains = (args['authorizedDomains'] as string[]) || [];\n              const engagement = args['engagement'] as string | undefined;\n\n              authState.context = context;\n              authState.authorizedDomains = domains;\n\n              logOperation('authorize', 'session', `context=${context}`);\n\n              return JSON.stringify({\n                status: 'authorized',\n                sessionId: authState.sessionId,\n                context,\n                authorizedDomains: domains,\n                engagement,\n                ctfPlatformsEnabled: context === 'ctf' || context === 'educational',\n                message: `Security operations authorized for ${context} context`,\n                guidelines: {\n                  ctf: 'Only target CTF platforms and authorized challenge hosts',\n                  pentest: 'Only target explicitly authorized systems in scope',\n                  research: 'Use controlled environments, document findings responsibly',\n                  defensive: 'Blue team operations on owned/authorized infrastructure',\n                  educational: 'Learning purposes on training platforms only',\n                },\n              }, null, 2);\n            },\n          },\n          {\n            name: 'SecurityRecon',\n            description: 'Reconnaissance and information gathering on authorized targets. Requires SecurityAuth first.',\n            parameters: {\n              type: 'object',\n              properties: {\n                target: {\n                  type: 'string',\n                  description: 'Target hostname or IP (must be authorized)',\n                },\n                type: {\n                  type: 'string',\n                  enum: ['dns', 'ports', 'services', 'headers', 'ssl'],\n                  description: 'Type of reconnaissance',\n                },\n                passive: {\n                  type: 'boolean',\n                  description: 'Passive-only recon (no active probing)',\n                },\n              },\n              required: ['target', 'type'],\n            },\n            handler: async (args: Record<string, unknown>) => {\n              if (!authState.context) {\n                return JSON.stringify({\n                  error: 'Authorization required',\n                  message: 'Call SecurityAuth first to set context',\n                }, null, 2);\n              }\n\n              const target = args['target'] as string;\n              const type = args['type'] as string;\n              const passive = args['passive'] as boolean ?? true;\n\n              const authCheck = isTargetAuthorized(target);\n              if (!authCheck.authorized) {\n                logOperation('recon-blocked', target, authCheck.reason);\n                return JSON.stringify({\n                  error: 'Target not authorized',\n                  target,\n                  reason: authCheck.reason,\n                  context: authState.context,\n                  hint: 'Add target to authorizedDomains or use a CTF platform',\n                }, null, 2);\n              }\n\n              logOperation(`recon-${type}`, target, 'executed');\n\n              // Simulated recon results (actual implementation would use real tools)\n              const results: Record<string, unknown> = {\n                sessionId: authState.sessionId,\n                context: authState.context,\n                target,\n                type,\n                passive,\n                timestamp: new Date().toISOString(),\n              };\n\n              switch (type) {\n                case 'dns':\n                  results.data = {\n                    records: ['A', 'AAAA', 'MX', 'TXT', 'NS'],\n                    note: 'DNS enumeration results would appear here',\n                  };\n                  break;\n                case 'ports':\n                  results.data = {\n                    commonPorts: [22, 80, 443, 8080],\n                    note: 'Port scan results would appear here (use nmap for real scans)',\n                  };\n                  break;\n                case 'services':\n                  results.data = {\n                    detected: ['ssh', 'http', 'https'],\n                    note: 'Service detection results would appear here',\n                  };\n                  break;\n                case 'headers':\n                  results.data = {\n                    securityHeaders: ['X-Frame-Options', 'CSP', 'HSTS'],\n                    note: 'HTTP header analysis would appear here',\n                  };\n                  break;\n                case 'ssl':\n                  results.data = {\n                    protocols: ['TLS 1.2', 'TLS 1.3'],\n                    note: 'SSL/TLS analysis would appear here',\n                  };\n                  break;\n              }\n\n              return JSON.stringify(results, null, 2);\n            },\n          },\n          {\n            name: 'SecurityVulnCheck',\n            description: 'Check for common vulnerabilities on authorized targets. Requires SecurityAuth first.',\n            parameters: {\n              type: 'object',\n              properties: {\n                target: {\n                  type: 'string',\n                  description: 'Target to check (must be authorized)',\n                },\n                category: {\n                  type: 'string',\n                  enum: ['web', 'network', 'config', 'crypto', 'injection'],\n                  description: 'Vulnerability category to check',\n                },\n                safe: {\n                  type: 'boolean',\n                  description: 'Safe mode - detection only, no exploitation',\n                },\n              },\n              required: ['target', 'category'],\n            },\n            handler: async (args: Record<string, unknown>) => {\n              if (!authState.context) {\n                return JSON.stringify({\n                  error: 'Authorization required',\n                  message: 'Call SecurityAuth first',\n                }, null, 2);\n              }\n\n              const target = args['target'] as string;\n              const category = args['category'] as string;\n              const safe = args['safe'] as boolean ?? true;\n\n              const authCheck = isTargetAuthorized(target);\n              if (!authCheck.authorized) {\n                logOperation('vulncheck-blocked', target, authCheck.reason);\n                return JSON.stringify({\n                  error: 'Target not authorized',\n                  target,\n                  reason: authCheck.reason,\n                }, null, 2);\n              }\n\n              logOperation(`vulncheck-${category}`, target, `safe=${safe}`);\n\n              return JSON.stringify({\n                sessionId: authState.sessionId,\n                context: authState.context,\n                target,\n                category,\n                safeMode: safe,\n                checks: {\n                  web: ['XSS', 'CSRF', 'SSRF', 'Path traversal'],\n                  network: ['Open ports', 'Service versions', 'Default creds'],\n                  config: ['Misconfigurations', 'Debug endpoints', 'Info disclosure'],\n                  crypto: ['Weak ciphers', 'Certificate issues', 'Key exposure'],\n                  injection: ['SQLi', 'Command injection', 'LDAP injection'],\n                }[category] || [],\n                note: `Vulnerability checks for ${category} - implement with actual security tools`,\n                timestamp: new Date().toISOString(),\n              }, null, 2);\n            },\n          },\n          {\n            name: 'SecurityReport',\n            description: 'Generate security assessment report for the session.',\n            parameters: {\n              type: 'object',\n              properties: {\n                format: {\n                  type: 'string',\n                  enum: ['summary', 'detailed', 'json'],\n                  description: 'Report format',\n                },\n              },\n            },\n            handler: async (args: Record<string, unknown>) => {\n              const format = (args['format'] as string) || 'summary';\n\n              const report = {\n                sessionId: authState.sessionId,\n                context: authState.context || 'none',\n                duration: Date.now() - authState.startTime,\n                operationCount: authState.operationLog.length,\n                operations: format === 'detailed' ? authState.operationLog : undefined,\n                authorizedDomains: authState.authorizedDomains,\n                generated: new Date().toISOString(),\n              };\n\n              if (format === 'summary') {\n                return `Security Session Report\n========================\nSession: ${report.sessionId}\nContext: ${report.context}\nDuration: ${Math.round(report.duration / 1000)}s\nOperations: ${report.operationCount}\nGenerated: ${report.generated}`;\n              }\n\n              return JSON.stringify(report, null, 2);\n            },\n          },\n        ],\n      },\n    };\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
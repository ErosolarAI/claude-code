{"version":3,"names":["cov_263tlh5p5r","actualCoverage","resolveWinner","input","pickWinner","f","primary","s","variantResults","refiner","tournamentOutcome","ranked","length","b","top","winnerVariant","candidateId","humanAccuracy","winner","modeDefinition"],"sources":["winnerStrategy.ts"],"sourcesContent":["import type { TournamentOutcome } from './dualTournament.js';\nimport type { RepoUpgradeModeDefinition, UpgradeStepResult, UpgradeVariant } from './repoUpgradeOrchestrator.js';\n\nexport interface WinnerResolutionInput {\n  modeDefinition: RepoUpgradeModeDefinition;\n  variantResults: Partial<Record<UpgradeVariant, UpgradeStepResult>>;\n  tournamentOutcome: TournamentOutcome | null;\n}\n\nexport function resolveWinner(\n  input: WinnerResolutionInput,\n  pickWinner: (definition: RepoUpgradeModeDefinition, primary: UpgradeStepResult, refiner?: UpgradeStepResult) => {\n    winner: UpgradeStepResult;\n    winnerVariant: UpgradeVariant;\n  }\n): { winner: UpgradeStepResult; winnerVariant: UpgradeVariant } {\n  const primary = input.variantResults.primary!;\n  const refiner = input.variantResults.refiner;\n\n  if (input.tournamentOutcome?.ranked?.length) {\n    const top = input.tournamentOutcome.ranked[0]!;\n    const winnerVariant: UpgradeVariant = top.candidateId === 'refiner' && refiner ? 'refiner' : 'primary';\n    if (winnerVariant === 'primary') {\n      primary.humanAccuracy = top.humanAccuracy;\n    } else if (refiner) {\n      refiner.humanAccuracy = top.humanAccuracy;\n    }\n    const winner = winnerVariant === 'refiner' && refiner ? refiner : primary;\n    return { winner, winnerVariant };\n  }\n\n  return pickWinner(input.modeDefinition, primary, refiner);\n}\n"],"mappings":"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","ignoreList":[]}
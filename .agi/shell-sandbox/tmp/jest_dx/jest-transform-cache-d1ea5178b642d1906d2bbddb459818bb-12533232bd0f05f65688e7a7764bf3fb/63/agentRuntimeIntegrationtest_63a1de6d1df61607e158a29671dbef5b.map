{"version":3,"names":["_globals","require","_agent","_toolRuntime","_contextManager","MockLLMProvider","responses","responseIndex","callHistory","queueTextResponse","content","push","type","queueToolCallResponse","toolCalls","queueContextOverflowError","generate","messages","length","response","error","Error","usage","inputTokens","outputTokens","reset","createMockToolSuite","tools","name","description","parameters","properties","message","required","handler","args","a","b","Number","path","cacheable","duration","Promise","resolve","setTimeout","Math","min","id","createMockDiffSuite","command","describe","provider","toolRuntime","contextManager","beforeEach","ToolRuntime","registerSuite","createDefaultContextManager","maxTokens","targetTokens","afterEach","test","agent","AgentRuntime","systemPrompt","send","expect","toContain","toLowerCase","not","toBe","history","getHistory","role","clearHistory","previousHistory","loadHistory","arguments","toolMessages","filter","m","toolStarts","toolResults","observer","onToolStart","call","onToolResult","output","some","r","includes","callbacks","onAssistantMessage","msg","prunedCount","onContextPruned","count","smallContextManager","preserveRecentMessages","i","repeat","toBeGreaterThanOrEqual","cancelledCalled","onCancelled","requestCancellation","isCancellationRequested","recoveryAttempts","onContextRecovery","attempt","toBeGreaterThan","isRunning","promise","maxToolOutputLength","listProviderTools","toolNames","map","t","unregisterSuite","find","toBeUndefined","result","execute","errorSuite","cacheHits","onCacheHit","enableCache","statsBeforeClear","getCacheStats","entries","clearCache","statsAfterClear","Date","now","cacheTtlMs","toEqual","getToolHistory","toolName","clearToolHistory","snapshots","getDiffSnapshots","timestamp","clearDiffSnapshots","largeSuite","toBeLessThan"],"sources":["agentRuntimeIntegration.test.ts"],"sourcesContent":["/**\n * Agent Runtime Integration Tests\n *\n * Tests the AgentRuntime class with:\n * - Context overflow recovery\n * - Streaming with interruption handling\n * - Cancellation support\n * - Tool execution pipeline\n */\n\nimport { describe, test, expect, beforeEach, afterEach } from '@jest/globals';\nimport { AgentRuntime, type AgentCallbacks } from '../../src/core/agent.js';\nimport { ToolRuntime, type ToolSuite, type ToolDefinition } from '../../src/core/toolRuntime.js';\nimport { ContextManager, createDefaultContextManager } from '../../src/core/contextManager.js';\nimport type { ConversationMessage, LLMProvider, ToolCallRequest } from '../../src/core/types.js';\n\n// Mock LLM Provider for testing\nclass MockLLMProvider implements LLMProvider {\n  private responses: Array<{\n    type: 'text' | 'tool_calls';\n    content?: string;\n    toolCalls?: ToolCallRequest[];\n  }> = [];\n  private responseIndex = 0;\n  public callHistory: ConversationMessage[][] = [];\n\n  queueTextResponse(content: string): void {\n    this.responses.push({ type: 'text', content });\n  }\n\n  queueToolCallResponse(content: string, toolCalls: ToolCallRequest[]): void {\n    this.responses.push({ type: 'tool_calls', content, toolCalls });\n  }\n\n  queueContextOverflowError(): void {\n    this.responses.push({ type: 'text', content: '__OVERFLOW__' });\n  }\n\n  async generate(messages: ConversationMessage[]): Promise<{\n    type: 'text' | 'tool_calls';\n    content?: string;\n    toolCalls?: ToolCallRequest[];\n    usage?: { inputTokens: number; outputTokens: number };\n  }> {\n    this.callHistory.push([...messages]);\n\n    if (this.responseIndex >= this.responses.length) {\n      return { type: 'text', content: 'Default mock response' };\n    }\n\n    const response = this.responses[this.responseIndex++]!;\n\n    // Simulate context overflow error\n    if (response.content === '__OVERFLOW__') {\n      const error = new Error('Context length exceeded: token limit reached');\n      throw error;\n    }\n\n    return {\n      ...response,\n      usage: { inputTokens: 100, outputTokens: 50 },\n    };\n  }\n\n  reset(): void {\n    this.responses = [];\n    this.responseIndex = 0;\n    this.callHistory = [];\n  }\n}\n\n// Mock Tool Suite for testing\nfunction createMockToolSuite(): ToolSuite {\n  const tools: ToolDefinition[] = [\n    {\n      name: 'echo',\n      description: 'Echoes back the input',\n      parameters: {\n        type: 'object',\n        properties: {\n          message: { type: 'string', description: 'Message to echo' },\n        },\n        required: ['message'],\n      },\n      handler: (args) => `Echo: ${args['message']}`,\n    },\n    {\n      name: 'add',\n      description: 'Adds two numbers',\n      parameters: {\n        type: 'object',\n        properties: {\n          a: { type: 'number', description: 'First number' },\n          b: { type: 'number', description: 'Second number' },\n        },\n        required: ['a', 'b'],\n      },\n      handler: (args) => {\n        const a = Number(args['a']);\n        const b = Number(args['b']);\n        return `Result: ${a + b}`;\n      },\n    },\n    {\n      name: 'read_file',\n      description: 'Reads a file',\n      parameters: {\n        type: 'object',\n        properties: {\n          path: { type: 'string', description: 'File path' },\n        },\n        required: ['path'],\n      },\n      handler: (args) => `Content of ${args['path']}: [mock content]`,\n      cacheable: true,\n    },\n    {\n      name: 'slow_operation',\n      description: 'Simulates a slow operation',\n      parameters: {\n        type: 'object',\n        properties: {\n          duration: { type: 'number', description: 'Duration in ms' },\n        },\n      },\n      handler: async (args) => {\n        const duration = Number(args['duration']) || 100;\n        await new Promise((resolve) => setTimeout(resolve, Math.min(duration, /* TODO: Extract constant */ /* TODO: Extract constant */ 1000)));\n        return 'Operation completed';\n      },\n    },\n  ];\n\n  return {\n    id: 'test.mock-tools',\n    description: 'Mock tools for testing',\n    tools,\n  };\n}\n\nfunction createMockDiffSuite(): ToolSuite {\n  return {\n    id: 'test.mock-diff',\n    description: 'Mock git diff tool for snapshot tracking',\n    tools: [\n      {\n        name: 'git_diff_mock',\n        description: 'Returns mock git diff output',\n        parameters: {\n          type: 'object',\n          properties: {\n            command: { type: 'string', description: 'Git diff command' },\n          },\n          required: ['command'],\n        },\n        handler: (args) => `mock diff for ${args['command'] ?? ''}`,\n      },\n    ],\n  };\n}\n\ndescribe('Agent Runtime Integration', () => {\n  let provider: MockLLMProvider;\n  let toolRuntime: ToolRuntime;\n  let contextManager: ContextManager;\n\n  beforeEach(() => {\n    provider = new MockLLMProvider();\n    toolRuntime = new ToolRuntime();\n    toolRuntime.registerSuite(createMockToolSuite());\n    contextManager = createDefaultContextManager({\n      maxTokens: 10000,\n      targetTokens: 7000,\n    });\n  });\n\n  afterEach(() => {\n    provider.reset();\n  });\n\n  describe('Basic Message Handling', () => {\n    test('should send a simple message and receive response', async () => {\n      provider.queueTextResponse('Hello! How can I help you?');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      const response = await agent.send('Hello');\n\n      expect(response).toContain('Hello! How can I help you?');\n      expect(response.toLowerCase()).not.toContain('next steps');\n      expect(provider.callHistory.length).toBe(1);\n    });\n\n    test('should maintain conversation history', async () => {\n      provider.queueTextResponse('First response');\n      provider.queueTextResponse('Second response');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      await agent.send('First message');\n      await agent.send('Second message');\n\n      const history = agent.getHistory();\n      expect(history.length).toBe(5); // system + user + assistant + user + assistant\n      expect(history[0]?.role).toBe('system');\n      expect(history[1]?.role).toBe('user');\n      expect(history[2]?.role).toBe('assistant');\n      expect(history[3]?.role).toBe('user');\n      expect(history[4]?.role).toBe('assistant');\n    });\n\n    test('should clear history correctly', async () => {\n      provider.queueTextResponse('Response');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      await agent.send('Hello');\n      agent.clearHistory();\n\n      const history = agent.getHistory();\n      expect(history.length).toBe(1); // Only system message\n      expect(history[0]?.role).toBe('system');\n    });\n\n    test('should load history from previous session', async () => {\n      const previousHistory: ConversationMessage[] = [\n        { role: 'system', content: 'Previous system prompt' },\n        { role: 'user', content: 'Previous user message' },\n        { role: 'assistant', content: 'Previous assistant response' },\n      ];\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'New system prompt',\n      });\n\n      agent.loadHistory(previousHistory);\n\n      const history = agent.getHistory();\n      expect(history.length).toBe(3);\n      expect(history[0]?.content).toBe('Previous system prompt');\n    });\n  });\n\n  describe('Tool Execution', () => {\n    test('should execute tool calls from provider response', async () => {\n      provider.queueToolCallResponse('I will echo your message', [\n        {\n          id: 'call_1',\n          name: 'echo',\n          arguments: { message: 'Hello, World!' },\n        },\n      ]);\n      provider.queueTextResponse('The echo result was: Echo: Hello, World!');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      const response = await agent.send('Echo \"Hello, World!\"');\n\n      expect(response).toContain('The echo result was: Echo: Hello, World!');\n      expect(provider.callHistory.length).toBe(2); // Initial + after tool result\n    });\n\n    test('should execute multiple tool calls in sequence', async () => {\n      provider.queueToolCallResponse('I will add some numbers', [\n        { id: 'call_1', name: 'add', arguments: { a: 5, b: 3 } },\n        { id: 'call_2', name: 'add', arguments: { a: 10, b: 7 } },\n      ]);\n      provider.queueTextResponse('The results are 8 and 17');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      const response = await agent.send('Add 5+3 and 10+7');\n\n      expect(response).toContain('The results are 8 and 17');\n\n      // Check tool results are in history\n      const history = agent.getHistory();\n      const toolMessages = history.filter((m) => m.role === 'tool');\n      expect(toolMessages.length).toBe(2);\n    });\n\n    test('should track tool calls via observer', async () => {\n      const toolStarts: string[] = [];\n      const toolResults: string[] = [];\n\n      const observer = {\n        onToolStart: (call: ToolCallRequest) => toolStarts.push(call.name),\n        onToolResult: (call: ToolCallRequest, output: string) =>\n          toolResults.push(`${call.name}: ${output}`),\n      };\n\n      toolRuntime = new ToolRuntime([], { observer });\n      toolRuntime.registerSuite(createMockToolSuite());\n\n      provider.queueToolCallResponse('Executing echo', [\n        { id: 'call_1', name: 'echo', arguments: { message: 'test' } },\n      ]);\n      provider.queueTextResponse('Done');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      await agent.send('Echo test');\n\n      expect(toolStarts).toContain('echo');\n      expect(toolResults.some((r) => r.includes('Echo: test'))).toBe(true);\n    });\n  });\n\n  describe('Callbacks', () => {\n    test('should call onAssistantMessage callback', async () => {\n      const messages: string[] = [];\n      const callbacks: AgentCallbacks = {\n        onAssistantMessage: (content) => messages.push(content),\n      };\n\n      provider.queueTextResponse('Hello there!');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n        callbacks,\n      });\n\n      await agent.send('Hi');\n\n      expect(messages.some((msg) => msg.includes('Hello there!'))).toBe(true);\n    });\n\n    test('should call onContextPruned when context is pruned', async () => {\n      let prunedCount = 0;\n      const callbacks: AgentCallbacks = {\n        onContextPruned: (count) => {\n          prunedCount = count;\n        },\n      };\n\n      // Create a context manager that will trigger pruning\n      const smallContextManager = createDefaultContextManager({\n        maxTokens: 500,\n        targetTokens: 200,\n        preserveRecentMessages: 2,\n      });\n\n      provider.queueTextResponse('Response 1');\n      provider.queueTextResponse('Response 2');\n      provider.queueTextResponse('Response 3');\n      provider.queueTextResponse('Response 4');\n      provider.queueTextResponse('Response 5');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n        callbacks,\n        contextManager: smallContextManager,\n      });\n\n      // Fill up the context\n      for (let i = 0; i < 5; i++) {\n        await agent.send('A'.repeat(100));\n      }\n\n      // Context should have been pruned at some point\n      // Note: exact behavior depends on token estimation\n      expect(prunedCount).toBeGreaterThanOrEqual(0);\n    });\n  });\n\n  describe('Cancellation', () => {\n    test('should handle cancellation request during processing', async () => {\n      let cancelledCalled = false;\n      const callbacks: AgentCallbacks = {\n        onCancelled: () => {\n          cancelledCalled = true;\n        },\n      };\n\n      // Queue a slow operation\n      provider.queueToolCallResponse('Running slow operation', [\n        { id: 'call_1', name: 'slow_operation', arguments: { duration: 500 } },\n      ]);\n      provider.queueTextResponse('Done');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n        callbacks,\n      });\n\n      // Request cancellation before completing\n      setTimeout(() => {\n        agent.requestCancellation();\n      }, 50);\n\n      const response = await agent.send('Run slow operation');\n\n      // Either cancelled or completed depending on timing\n      if (cancelledCalled) {\n        expect(response).toContain('cancelled');\n      }\n    });\n\n    test('should reset cancellation flag on new request', async () => {\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      // Request cancellation\n      agent.requestCancellation();\n      expect(agent.isCancellationRequested()).toBe(true);\n\n      // Start new request\n      provider.queueTextResponse('Response');\n      await agent.send('Hello');\n\n      // Cancellation should be reset after request completes\n      expect(agent.isCancellationRequested()).toBe(false);\n    });\n  });\n\n  describe('Context Overflow Recovery', () => {\n    test('should attempt recovery on context overflow error', async () => {\n      let recoveryAttempts = 0;\n      const callbacks: AgentCallbacks = {\n        onContextRecovery: (attempt) => {\n          recoveryAttempts = attempt;\n        },\n      };\n\n      // First call throws overflow, then succeeds\n      provider.queueContextOverflowError();\n      provider.queueTextResponse('Response after recovery');\n\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n        callbacks,\n        contextManager,\n      });\n\n      // Pre-fill some history\n      agent.loadHistory([\n        { role: 'system', content: 'System prompt' },\n        { role: 'user', content: 'Old message 1' },\n        { role: 'assistant', content: 'Old response 1' },\n        { role: 'user', content: 'Old message 2' },\n        { role: 'assistant', content: 'Old response 2' },\n      ]);\n\n      const response = await agent.send('New message');\n\n      expect(recoveryAttempts).toBeGreaterThan(0);\n      expect(response).toContain('Response after recovery');\n    });\n  });\n\n  describe('Running State', () => {\n    test('should track running state correctly', async () => {\n      const agent = new AgentRuntime({\n        provider,\n        toolRuntime,\n        systemPrompt: 'You are a helpful assistant.',\n      });\n\n      expect(agent.isRunning()).toBe(false);\n\n      provider.queueToolCallResponse('Processing', [\n        { id: 'call_1', name: 'slow_operation', arguments: { duration: 100 } },\n      ]);\n      provider.queueTextResponse('Done');\n\n      const promise = agent.send('Run something');\n\n      // Should be running during execution\n      // Note: This timing is tricky in tests\n      await promise;\n\n      expect(agent.isRunning()).toBe(false);\n    });\n  });\n});\n\ndescribe('Tool Runtime Integration', () => {\n  let toolRuntime: ToolRuntime;\n  let contextManager: ContextManager;\n\n  beforeEach(() => {\n    contextManager = createDefaultContextManager({\n      maxTokens: 10000,\n      maxToolOutputLength: 1000,\n    });\n    toolRuntime = new ToolRuntime([], { contextManager });\n    toolRuntime.registerSuite(createMockToolSuite());\n  });\n\n  describe('Tool Registration', () => {\n    test('should register and list tools', () => {\n      const tools = toolRuntime.listProviderTools();\n      const toolNames = tools.map((t) => t.name);\n\n      expect(toolNames).toContain('echo');\n      expect(toolNames).toContain('add');\n      expect(toolNames).toContain('read_file');\n      expect(toolNames).toContain('slow_operation');\n    });\n\n    test('should unregister suite', () => {\n      toolRuntime.unregisterSuite('test.mock-tools');\n      const tools = toolRuntime.listProviderTools();\n\n      expect(tools.find((t) => t.name === 'echo')).toBeUndefined();\n    });\n  });\n\n  describe('Tool Execution', () => {\n    test('should execute tool successfully', async () => {\n      const result = await toolRuntime.execute({\n        id: 'call_1',\n        name: 'echo',\n        arguments: { message: 'Hello!' },\n      });\n\n      expect(result).toBe('Echo: Hello!');\n    });\n\n    test('should handle unknown tool gracefully', async () => {\n      const result = await toolRuntime.execute({\n        id: 'call_1',\n        name: 'unknown_tool',\n        arguments: {},\n      });\n\n      expect(result).toContain('not available');\n    });\n\n    test('should handle tool execution errors', async () => {\n      const errorSuite: ToolSuite = {\n        id: 'test.error-tools',\n        tools: [\n          {\n            name: 'error_tool',\n            description: 'Always throws an error',\n            handler: () => {\n              throw new Error('Intentional error');\n            },\n          },\n        ],\n      };\n\n      toolRuntime.registerSuite(errorSuite);\n\n      const result = await toolRuntime.execute({\n        id: 'call_1',\n        name: 'error_tool',\n        arguments: {},\n      });\n\n      expect(result).toContain('Failed');\n      expect(result).toContain('Intentional error');\n    });\n  });\n\n  describe('Tool Caching', () => {\n    test('should cache cacheable tool results', async () => {\n      const cacheHits: string[] = [];\n      const observer = {\n        onCacheHit: (call: ToolCallRequest) => cacheHits.push(call.name),\n      };\n\n      toolRuntime = new ToolRuntime([], { contextManager, observer, enableCache: true });\n      toolRuntime.registerSuite(createMockToolSuite());\n\n      // First call\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'read_file',\n        arguments: { path: '/test/file.txt' },\n      });\n\n      // Second call with same args should hit cache\n      await toolRuntime.execute({\n        id: 'call_2',\n        name: 'read_file',\n        arguments: { path: '/test/file.txt' },\n      });\n\n      expect(cacheHits).toContain('read_file');\n    });\n\n    test('should not cache non-cacheable tools', async () => {\n      const cacheHits: string[] = [];\n      const observer = {\n        onCacheHit: (call: ToolCallRequest) => cacheHits.push(call.name),\n      };\n\n      toolRuntime = new ToolRuntime([], { contextManager, observer, enableCache: true });\n      toolRuntime.registerSuite(createMockToolSuite());\n\n      // First call\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'echo',\n        arguments: { message: 'test' },\n      });\n\n      // Second call should not hit cache\n      await toolRuntime.execute({\n        id: 'call_2',\n        name: 'echo',\n        arguments: { message: 'test' },\n      });\n\n      expect(cacheHits).not.toContain('echo');\n    });\n\n    test('should clear cache', async () => {\n      toolRuntime = new ToolRuntime([], { contextManager, enableCache: true });\n      toolRuntime.registerSuite(createMockToolSuite());\n\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'read_file',\n        arguments: { path: '/test/file.txt' },\n      });\n\n      const statsBeforeClear = toolRuntime.getCacheStats();\n      expect(statsBeforeClear.entries).toBeGreaterThan(0);\n\n      toolRuntime.clearCache();\n\n      const statsAfterClear = toolRuntime.getCacheStats();\n      expect(statsAfterClear.entries).toBe(0);\n    });\n\n    test('respects per-tool cache TTL overrides', async () => {\n      const cacheHits: string[] = [];\n      const observer = {\n        onCacheHit: (call: ToolCallRequest) => cacheHits.push(call.name),\n      };\n\n      toolRuntime = new ToolRuntime([], { contextManager, observer, enableCache: true });\n      toolRuntime.registerSuite({\n        id: 'ttl.override',\n        tools: [\n          {\n            name: 'burst',\n            description: 'Returns a timestamp string',\n            handler: () => `ts:${Date.now()}`,\n            cacheable: true,\n            cacheTtlMs: 5,\n          },\n        ],\n      });\n\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'burst',\n        arguments: {},\n      });\n      await toolRuntime.execute({\n        id: 'call_2',\n        name: 'burst',\n        arguments: {},\n      });\n\n      expect(cacheHits).toEqual(['burst']);\n\n      await new Promise((resolve) => setTimeout(resolve, 15));\n\n      await toolRuntime.execute({\n        id: 'call_3',\n        name: 'burst',\n        arguments: {},\n      });\n\n      expect(cacheHits).toEqual(['burst']);\n    });\n  });\n\n  describe('Tool History', () => {\n    test('should track tool history', async () => {\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'echo',\n        arguments: { message: 'first' },\n      });\n\n      await toolRuntime.execute({\n        id: 'call_2',\n        name: 'add',\n        arguments: { a: 1, b: 2 },\n      });\n\n      const history = toolRuntime.getToolHistory();\n      expect(history.length).toBe(2);\n      expect(history[0]?.toolName).toBe('echo');\n      expect(history[1]?.toolName).toBe('add');\n    });\n\n    test('should clear tool history', async () => {\n      await toolRuntime.execute({\n        id: 'call_1',\n        name: 'echo',\n        arguments: { message: 'test' },\n      });\n\n      toolRuntime.clearToolHistory();\n\n      const history = toolRuntime.getToolHistory();\n      expect(history.length).toBe(0);\n    });\n  });\n\n  describe('Diff Snapshots', () => {\n    test('should capture git diff outputs from tool commands', async () => {\n      toolRuntime.registerSuite(createMockDiffSuite());\n\n      await toolRuntime.execute({\n        id: 'call_git_diff',\n        name: 'git_diff_mock',\n        arguments: { command: 'git diff --stat' },\n      });\n\n      const snapshots = toolRuntime.getDiffSnapshots();\n      expect(snapshots.length).toBe(1);\n      expect(snapshots[0]?.command).toBe('git diff --stat');\n      expect(snapshots[0]?.output).toContain('mock diff for git diff --stat');\n      expect(typeof snapshots[0]?.timestamp).toBe('number');\n    });\n\n    test('should bound diff snapshots and support clearing', async () => {\n      toolRuntime.registerSuite(createMockDiffSuite());\n\n      for (let i = 0; i < 6; i++) {\n        await toolRuntime.execute({\n          id: `call_${i}`,\n          name: 'git_diff_mock',\n          arguments: { command: `git diff --stat ${i}` },\n        });\n      }\n\n      const snapshots = toolRuntime.getDiffSnapshots();\n      expect(snapshots.length).toBe(5);\n      expect(snapshots[0]?.command).toBe('git diff --stat 1');\n      expect(snapshots[snapshots.length - 1]?.command).toBe('git diff --stat 5');\n\n      toolRuntime.clearDiffSnapshots();\n      expect(toolRuntime.getDiffSnapshots().length).toBe(0);\n    });\n  });\n\n  describe('Tool Output Truncation', () => {\n    test('should truncate large tool outputs', async () => {\n      const largeSuite: ToolSuite = {\n        id: 'test.large-output',\n        tools: [\n          {\n            name: 'large_output',\n            description: 'Returns large output',\n            handler: () => 'X'.repeat(5000), // Exceeds maxToolOutputLength\n          },\n        ],\n      };\n\n      toolRuntime.registerSuite(largeSuite);\n\n      const result = await toolRuntime.execute({\n        id: 'call_1',\n        name: 'large_output',\n        arguments: {},\n      });\n\n      // Output should be truncated\n      expect(result.length).toBeLessThan(5000);\n      expect(result).toContain('truncated');\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["cov_1f6e8iydmj","actualCoverage","pickKey","name","f","user","s","process","env","b","value","source","resolveKeys","names","map","n","buildMissingKeyMessage","resolved","missing","filter","r","length","lines","m","join"],"sources":["providerKeys.ts"],"sourcesContent":["/**\n * Provider key resolution utilities.\n * Supports user-supplied overrides (USER_<KEY>) with environment fallbacks.\n * If neither is set, reports as missing so the runtime can prompt the user.\n */\n\nexport type KeySource = 'user' | 'env' | 'missing';\n\nexport interface ResolvedKey {\n  name: string;\n  value?: string;\n  source: KeySource;\n}\n\nfunction pickKey(name: string): ResolvedKey {\n  const user = process.env[`USER_${name}`];\n  if (user && user !== 'CHANGE_ME') {\n    return { name, value: user, source: 'user' };\n  }\n  const env = process.env[name];\n  if (env && env !== 'CHANGE_ME') {\n    return { name, value: env, source: 'env' };\n  }\n  return { name, source: 'missing' };\n}\n\n/**\n * Resolves a list of keys, preferring user-supplied overrides.\n */\nexport function resolveKeys(names: string[]): ResolvedKey[] {\n  return names.map((n) => pickKey(n));\n}\n\n/**\n * Builds a user-facing message listing missing keys and how to provide them.\n */\nexport function buildMissingKeyMessage(names: string[]): string | null {\n  const resolved = resolveKeys(names);\n  const missing = resolved.filter((r) => r.source === 'missing').map((r) => r.name);\n  if (missing.length === 0) return null;\n  const lines = [\n    'The following API keys or connections are missing:',\n    ...missing.map((m) => `- ${m} (set USER_${m} for user-scoped, or ${m} for env-scoped)`),\n    '',\n    'You can provide user-scoped keys by setting USER_<KEY> (preferred for per-user billing),',\n    'or set the env var globally if you intend to bill via platform keys.',\n  ];\n  return lines.join('\\n');\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ;AACA;AACA;AACA;AACA;;AAUA,SAASE,OAAOA,CAACC,IAAY,EAAe;EAAA;EAAAH,cAAA,GAAAI,CAAA;EAC1C,MAAMC,IAAI;EAAA;EAAA,CAAAL,cAAA,GAAAM,CAAA,OAAGC,OAAO,CAACC,GAAG,CAAC,QAAQL,IAAI,EAAE,CAAC;EAAC;EAAAH,cAAA,GAAAM,CAAA;EACzC;EAAI;EAAA,CAAAN,cAAA,GAAAS,CAAA,UAAAJ,IAAI;EAAA;EAAA,CAAAL,cAAA,GAAAS,CAAA,UAAIJ,IAAI,KAAK,WAAW,GAAE;IAAA;IAAAL,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAM,CAAA;IAChC,OAAO;MAAEH,IAAI;MAAEO,KAAK,EAAEL,IAAI;MAAEM,MAAM,EAAE;IAAO,CAAC;EAC9C,CAAC;EAAA;EAAA;IAAAX,cAAA,GAAAS,CAAA;EAAA;EACD,MAAMD,GAAG;EAAA;EAAA,CAAAR,cAAA,GAAAM,CAAA,OAAGC,OAAO,CAACC,GAAG,CAACL,IAAI,CAAC;EAAC;EAAAH,cAAA,GAAAM,CAAA;EAC9B;EAAI;EAAA,CAAAN,cAAA,GAAAS,CAAA,UAAAD,GAAG;EAAA;EAAA,CAAAR,cAAA,GAAAS,CAAA,UAAID,GAAG,KAAK,WAAW,GAAE;IAAA;IAAAR,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAM,CAAA;IAC9B,OAAO;MAAEH,IAAI;MAAEO,KAAK,EAAEF,GAAG;MAAEG,MAAM,EAAE;IAAM,CAAC;EAC5C,CAAC;EAAA;EAAA;IAAAX,cAAA,GAAAS,CAAA;EAAA;EAAAT,cAAA,GAAAM,CAAA;EACD,OAAO;IAAEH,IAAI;IAAEQ,MAAM,EAAE;EAAU,CAAC;AACpC;;AAEA;AACA;AACA;AACA,OAAO,SAASC,WAAWA,CAACC,KAAe,EAAiB;EAAA;EAAAb,cAAA,GAAAI,CAAA;EAAAJ,cAAA,GAAAM,CAAA;EAC1D,OAAOO,KAAK,CAACC,GAAG,CAAEC,CAAC,IAAK;IAAA;IAAAf,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAM,CAAA;IAAA,OAAAJ,OAAO,CAACa,CAAC,CAAC;EAAD,CAAC,CAAC;AACrC;;AAEA;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAACH,KAAe,EAAiB;EAAA;EAAAb,cAAA,GAAAI,CAAA;EACrE,MAAMa,QAAQ;EAAA;EAAA,CAAAjB,cAAA,GAAAM,CAAA,OAAGM,WAAW,CAACC,KAAK,CAAC;EACnC,MAAMK,OAAO;EAAA;EAAA,CAAAlB,cAAA,GAAAM,CAAA,QAAGW,QAAQ,CAACE,MAAM,CAAEC,CAAC,IAAK;IAAA;IAAApB,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAM,CAAA;IAAA,OAAAc,CAAC,CAACT,MAAM,KAAK,SAAS;EAAD,CAAC,CAAC,CAACG,GAAG,CAAEM,CAAC,IAAK;IAAA;IAAApB,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAM,CAAA;IAAA,OAAAc,CAAC,CAACjB,IAAI;EAAD,CAAC,CAAC;EAAC;EAAAH,cAAA,GAAAM,CAAA;EAClF,IAAIY,OAAO,CAACG,MAAM,KAAK,CAAC,EAAE;IAAA;IAAArB,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAM,CAAA;IAAA,OAAO,IAAI;EAAA,CAAC;EAAA;EAAA;IAAAN,cAAA,GAAAS,CAAA;EAAA;EACtC,MAAMa,KAAK;EAAA;EAAA,CAAAtB,cAAA,GAAAM,CAAA,QAAG,CACZ,oDAAoD,EACpD,GAAGY,OAAO,CAACJ,GAAG,CAAES,CAAC,IAAK;IAAA;IAAAvB,cAAA,GAAAI,CAAA;IAAAJ,cAAA,GAAAM,CAAA;IAAA,YAAKiB,CAAC,cAAcA,CAAC,wBAAwBA,CAAC,kBAAkB;EAAD,CAAC,CAAC,EACvF,EAAE,EACF,0FAA0F,EAC1F,sEAAsE,CACvE;EAAC;EAAAvB,cAAA,GAAAM,CAAA;EACF,OAAOgB,KAAK,CAACE,IAAI,CAAC,IAAI,CAAC;AACzB","ignoreList":[]}
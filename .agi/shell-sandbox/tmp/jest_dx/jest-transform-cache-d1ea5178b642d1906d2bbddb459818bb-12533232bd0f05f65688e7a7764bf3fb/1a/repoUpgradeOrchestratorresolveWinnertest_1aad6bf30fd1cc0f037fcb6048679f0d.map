{"version":3,"names":["_repoUpgradeOrchestrator","require","_winnerStrategy","describe","it","orchestrator","RepoUpgradeOrchestrator","success","summary","score","mode","REPO_UPGRADE_MODE_DEFINITIONS","primary","humanAccuracy","refiner","pickWinner","bind","outcome","resolveWinnerStrategy","modeDefinition","variantResults","tournamentOutcome","expect","winnerVariant","toBe"],"sources":["repoUpgradeOrchestrator.resolveWinner.test.ts"],"sourcesContent":["import { RepoUpgradeOrchestrator, REPO_UPGRADE_MODE_DEFINITIONS, type UpgradeStepResult } from '../src/core/repoUpgradeOrchestrator.js';\nimport { resolveWinner as resolveWinnerStrategy } from '../src/core/winnerStrategy.js';\n\ndescribe('RepoUpgradeOrchestrator.resolveWinner core-first', () => {\n  it('prefers refiner when scores tie but accuracy is higher', async () => {\n    const orchestrator = new RepoUpgradeOrchestrator(async () => ({\n      success: true,\n      summary: 'noop',\n      score: 0,\n    }));\n    const mode = REPO_UPGRADE_MODE_DEFINITIONS['dual-rl-tournament'];\n\n    const primary: UpgradeStepResult = {\n      success: true,\n      summary: 'p',\n      score: 0.5,\n      humanAccuracy: 0.2,\n    };\n    const refiner: UpgradeStepResult = {\n      success: true,\n      summary: 'r',\n      score: 0.5,\n      humanAccuracy: 0.8,\n    };\n\n    // @ts-expect-error private helper exposed for test\n    const pickWinner = orchestrator.pickWinner.bind(orchestrator);\n\n    const outcome = resolveWinnerStrategy(\n      {\n        modeDefinition: mode,\n        variantResults: { primary, refiner },\n        tournamentOutcome: null,\n      },\n      pickWinner\n    );\n    expect(outcome.winnerVariant).toBe('refiner');\n  });\n});\n"],"mappings":";;AAAA,IAAAA,wBAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAD,OAAA;AAEAE,QAAQ,CAAC,kDAAkD,EAAE,MAAM;EACjEC,EAAE,CAAC,wDAAwD,EAAE,YAAY;IACvE,MAAMC,YAAY,GAAG,IAAIC,gDAAuB,CAAC,aAAa;MAC5DC,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,MAAM;MACfC,KAAK,EAAE;IACT,CAAC,CAAC,CAAC;IACH,MAAMC,IAAI,GAAGC,sDAA6B,CAAC,oBAAoB,CAAC;IAEhE,MAAMC,OAA0B,GAAG;MACjCL,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,GAAG;MACZC,KAAK,EAAE,GAAG;MACVI,aAAa,EAAE;IACjB,CAAC;IACD,MAAMC,OAA0B,GAAG;MACjCP,OAAO,EAAE,IAAI;MACbC,OAAO,EAAE,GAAG;MACZC,KAAK,EAAE,GAAG;MACVI,aAAa,EAAE;IACjB,CAAC;;IAED;IACA,MAAME,UAAU,GAAGV,YAAY,CAACU,UAAU,CAACC,IAAI,CAACX,YAAY,CAAC;IAE7D,MAAMY,OAAO,GAAG,IAAAC,6BAAqB,EACnC;MACEC,cAAc,EAAET,IAAI;MACpBU,cAAc,EAAE;QAAER,OAAO;QAAEE;MAAQ,CAAC;MACpCO,iBAAiB,EAAE;IACrB,CAAC,EACDN,UACF,CAAC;IACDO,MAAM,CAACL,OAAO,CAACM,aAAa,CAAC,CAACC,IAAI,CAAC,SAAS,CAAC;EAC/C,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}
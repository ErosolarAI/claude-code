aeaa56d8c617bdc4667cd09661e2669b
/* istanbul ignore next */
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.canRunVariantsParallel = canRunVariantsParallel;
exports.executeVariants = executeVariants;
exports.resolveWorkspaceRoot = resolveWorkspaceRoot;
function cov_2pzpkizpsh() {
  var path = "/Volumes/4TB/GitHub/src/core/variantExecution.ts";
  var hash = "3112766605f5f6216f5b7cd3bd8db2f426c8670e";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Volumes/4TB/GitHub/src/core/variantExecution.ts",
    statementMap: {
      "0": {
        start: {
          line: 31,
          column: 2
        },
        end: {
          line: 31,
          column: 92
        }
      },
      "1": {
        start: {
          line: 38,
          column: 2
        },
        end: {
          line: 40,
          column: 3
        }
      },
      "2": {
        start: {
          line: 39,
          column: 4
        },
        end: {
          line: 39,
          column: 17
        }
      },
      "3": {
        start: {
          line: 41,
          column: 22
        },
        end: {
          line: 41,
          column: 60
        }
      },
      "4": {
        start: {
          line: 42,
          column: 22
        },
        end: {
          line: 42,
          column: 60
        }
      },
      "5": {
        start: {
          line: 43,
          column: 2
        },
        end: {
          line: 43,
          column: 76
        }
      },
      "6": {
        start: {
          line: 49,
          column: 80
        },
        end: {
          line: 49,
          column: 87
        }
      },
      "7": {
        start: {
          line: 50,
          column: 77
        },
        end: {
          line: 50,
          column: 79
        }
      },
      "8": {
        start: {
          line: 52,
          column: 2
        },
        end: {
          line: 94,
          column: 3
        }
      },
      "9": {
        start: {
          line: 53,
          column: 4
        },
        end: {
          line: 57,
          column: 7
        }
      },
      "10": {
        start: {
          line: 59,
          column: 20
        },
        end: {
          line: 72,
          column: 5
        }
      },
      "11": {
        start: {
          line: 61,
          column: 23
        },
        end: {
          line: 69,
          column: 10
        }
      },
      "12": {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 70,
          column: 35
        }
      },
      "13": {
        start: {
          line: 73,
          column: 4
        },
        end: {
          line: 75,
          column: 5
        }
      },
      "14": {
        start: {
          line: 74,
          column: 6
        },
        end: {
          line: 74,
          column: 51
        }
      },
      "15": {
        start: {
          line: 78,
          column: 4
        },
        end: {
          line: 93,
          column: 5
        }
      },
      "16": {
        start: {
          line: 79,
          column: 29
        },
        end: {
          line: 79,
          column: 78
        }
      },
      "17": {
        start: {
          line: 80,
          column: 21
        },
        end: {
          line: 88,
          column: 8
        }
      },
      "18": {
        start: {
          line: 89,
          column: 6
        },
        end: {
          line: 89,
          column: 39
        }
      },
      "19": {
        start: {
          line: 90,
          column: 6
        },
        end: {
          line: 92,
          column: 7
        }
      },
      "20": {
        start: {
          line: 91,
          column: 8
        },
        end: {
          line: 91,
          column: 31
        }
      },
      "21": {
        start: {
          line: 96,
          column: 2
        },
        end: {
          line: 96,
          column: 24
        }
      }
    },
    fnMap: {
      "0": {
        name: "resolveWorkspaceRoot",
        decl: {
          start: {
            line: 27,
            column: 16
          },
          end: {
            line: 27,
            column: 36
          }
        },
        loc: {
          start: {
            line: 30,
            column: 22
          },
          end: {
            line: 32,
            column: 1
          }
        },
        line: 30
      },
      "1": {
        name: "canRunVariantsParallel",
        decl: {
          start: {
            line: 34,
            column: 16
          },
          end: {
            line: 34,
            column: 38
          }
        },
        loc: {
          start: {
            line: 37,
            column: 11
          },
          end: {
            line: 44,
            column: 1
          }
        },
        line: 37
      },
      "2": {
        name: "executeVariants",
        decl: {
          start: {
            line: 46,
            column: 22
          },
          end: {
            line: 46,
            column: 37
          }
        },
        loc: {
          start: {
            line: 48,
            column: 63
          },
          end: {
            line: 97,
            column: 1
          }
        },
        line: 48
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 60,
            column: 34
          },
          end: {
            line: 60,
            column: 35
          }
        },
        loc: {
          start: {
            line: 60,
            column: 53
          },
          end: {
            line: 71,
            column: 7
          }
        },
        line: 60
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 31,
            column: 9
          },
          end: {
            line: 31,
            column: 91
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 31,
            column: 9
          },
          end: {
            line: 31,
            column: 49
          }
        }, {
          start: {
            line: 31,
            column: 53
          },
          end: {
            line: 31,
            column: 91
          }
        }],
        line: 31
      },
      "1": {
        loc: {
          start: {
            line: 38,
            column: 2
          },
          end: {
            line: 40,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 38,
            column: 2
          },
          end: {
            line: 40,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 38
      },
      "2": {
        loc: {
          start: {
            line: 38,
            column: 6
          },
          end: {
            line: 38,
            column: 67
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 38,
            column: 6
          },
          end: {
            line: 38,
            column: 38
          }
        }, {
          start: {
            line: 38,
            column: 42
          },
          end: {
            line: 38,
            column: 67
          }
        }],
        line: 38
      },
      "3": {
        loc: {
          start: {
            line: 43,
            column: 17
          },
          end: {
            line: 43,
            column: 74
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 43,
            column: 17
          },
          end: {
            line: 43,
            column: 28
          }
        }, {
          start: {
            line: 43,
            column: 32
          },
          end: {
            line: 43,
            column: 43
          }
        }, {
          start: {
            line: 43,
            column: 47
          },
          end: {
            line: 43,
            column: 74
          }
        }],
        line: 43
      },
      "4": {
        loc: {
          start: {
            line: 52,
            column: 2
          },
          end: {
            line: 94,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 52,
            column: 2
          },
          end: {
            line: 94,
            column: 3
          }
        }, {
          start: {
            line: 76,
            column: 9
          },
          end: {
            line: 94,
            column: 3
          }
        }],
        line: 52
      },
      "5": {
        loc: {
          start: {
            line: 79,
            column: 29
          },
          end: {
            line: 79,
            column: 78
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 79,
            column: 53
          },
          end: {
            line: 79,
            column: 66
          }
        }, {
          start: {
            line: 79,
            column: 69
          },
          end: {
            line: 79,
            column: 78
          }
        }],
        line: 79
      },
      "6": {
        loc: {
          start: {
            line: 90,
            column: 6
          },
          end: {
            line: 92,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 90,
            column: 6
          },
          end: {
            line: 92,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 90
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "3112766605f5f6216f5b7cd3bd8db2f426c8670e"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2pzpkizpsh = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2pzpkizpsh();
function resolveWorkspaceRoot(variant, context) {
  /* istanbul ignore next */
  cov_2pzpkizpsh().f[0]++;
  cov_2pzpkizpsh().s[0]++;
  return /* istanbul ignore next */(cov_2pzpkizpsh().b[0][0]++, context.variantWorkspaceRoots?.[variant]) ??
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[0][1]++, context.variantWorkspaceRoots?.primary);
}
function canRunVariantsParallel(modeDefinition, context) {
  /* istanbul ignore next */
  cov_2pzpkizpsh().f[1]++;
  cov_2pzpkizpsh().s[1]++;
  if (
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[2][0]++, !modeDefinition.parallelVariants) ||
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[2][1]++, !context.parallelVariants)) {
    /* istanbul ignore next */
    cov_2pzpkizpsh().b[1][0]++;
    cov_2pzpkizpsh().s[2]++;
    return false;
  } else
  /* istanbul ignore next */
  {
    cov_2pzpkizpsh().b[1][1]++;
  }
  const primaryRoot =
  /* istanbul ignore next */
  (cov_2pzpkizpsh().s[3]++, context.variantWorkspaceRoots?.primary);
  const refinerRoot =
  /* istanbul ignore next */
  (cov_2pzpkizpsh().s[4]++, context.variantWorkspaceRoots?.refiner);
  /* istanbul ignore next */
  cov_2pzpkizpsh().s[5]++;
  return Boolean(
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[3][0]++, primaryRoot) &&
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[3][1]++, refinerRoot) &&
  /* istanbul ignore next */
  (cov_2pzpkizpsh().b[3][2]++, primaryRoot !== refinerRoot));
}
async function executeVariants(options) {
  /* istanbul ignore next */
  cov_2pzpkizpsh().f[2]++;
  const {
    module,
    step,
    mode,
    modeDefinition,
    context,
    executeVariant,
    emit
  } =
  /* istanbul ignore next */
  (cov_2pzpkizpsh().s[6]++, options);
  const variantResults =
  /* istanbul ignore next */
  (cov_2pzpkizpsh().s[7]++, {});
  /* istanbul ignore next */
  cov_2pzpkizpsh().s[8]++;
  if (canRunVariantsParallel(modeDefinition, context)) {
    /* istanbul ignore next */
    cov_2pzpkizpsh().b[4][0]++;
    cov_2pzpkizpsh().s[9]++;
    emit?.({
      type: 'upgrade.step.variants.parallel',
      timestamp: Date.now(),
      data: {
        moduleId: module.id,
        stepId: step.id,
        variants: modeDefinition.variants
      }
    });
    const results =
    /* istanbul ignore next */
    (cov_2pzpkizpsh().s[10]++, await Promise.all(modeDefinition.variants.map(async variant => {
      /* istanbul ignore next */
      cov_2pzpkizpsh().f[3]++;
      const result =
      /* istanbul ignore next */
      (cov_2pzpkizpsh().s[11]++, await executeVariant({
        module,
        step,
        mode,
        variant,
        previousResult: undefined,
        workspaceRoot: resolveWorkspaceRoot(variant, context),
        repoPolicy: context.repoPolicy
      }));
      /* istanbul ignore next */
      cov_2pzpkizpsh().s[12]++;
      return {
        variant,
        result
      };
    })));
    /* istanbul ignore next */
    cov_2pzpkizpsh().s[13]++;
    for (const entry of results) {
      /* istanbul ignore next */
      cov_2pzpkizpsh().s[14]++;
      variantResults[entry.variant] = entry.result;
    }
  } else {
    /* istanbul ignore next */
    cov_2pzpkizpsh().b[4][1]++;
    let primaryResult;
    /* istanbul ignore next */
    cov_2pzpkizpsh().s[15]++;
    for (const variant of modeDefinition.variants) {
      const previousResult =
      /* istanbul ignore next */
      (cov_2pzpkizpsh().s[16]++, variant === 'refiner' ?
      /* istanbul ignore next */
      (cov_2pzpkizpsh().b[5][0]++, primaryResult) :
      /* istanbul ignore next */
      (cov_2pzpkizpsh().b[5][1]++, undefined));
      const result =
      /* istanbul ignore next */
      (cov_2pzpkizpsh().s[17]++, await executeVariant({
        module,
        step,
        mode,
        variant,
        previousResult,
        workspaceRoot: resolveWorkspaceRoot(variant, context),
        repoPolicy: context.repoPolicy
      }));
      /* istanbul ignore next */
      cov_2pzpkizpsh().s[18]++;
      variantResults[variant] = result;
      /* istanbul ignore next */
      cov_2pzpkizpsh().s[19]++;
      if (variant === 'primary') {
        /* istanbul ignore next */
        cov_2pzpkizpsh().b[6][0]++;
        cov_2pzpkizpsh().s[20]++;
        primaryResult = result;
      } else
      /* istanbul ignore next */
      {
        cov_2pzpkizpsh().b[6][1]++;
      }
    }
  }
  /* istanbul ignore next */
  cov_2pzpkizpsh().s[21]++;
  return variantResults;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMnB6cGtpenBzaCIsImFjdHVhbENvdmVyYWdlIiwicmVzb2x2ZVdvcmtzcGFjZVJvb3QiLCJ2YXJpYW50IiwiY29udGV4dCIsImYiLCJzIiwiYiIsInZhcmlhbnRXb3Jrc3BhY2VSb290cyIsInByaW1hcnkiLCJjYW5SdW5WYXJpYW50c1BhcmFsbGVsIiwibW9kZURlZmluaXRpb24iLCJwYXJhbGxlbFZhcmlhbnRzIiwicHJpbWFyeVJvb3QiLCJyZWZpbmVyUm9vdCIsInJlZmluZXIiLCJCb29sZWFuIiwiZXhlY3V0ZVZhcmlhbnRzIiwib3B0aW9ucyIsIm1vZHVsZSIsInN0ZXAiLCJtb2RlIiwiZXhlY3V0ZVZhcmlhbnQiLCJlbWl0IiwidmFyaWFudFJlc3VsdHMiLCJ0eXBlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsImRhdGEiLCJtb2R1bGVJZCIsImlkIiwic3RlcElkIiwidmFyaWFudHMiLCJyZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsInJlc3VsdCIsInByZXZpb3VzUmVzdWx0IiwidW5kZWZpbmVkIiwid29ya3NwYWNlUm9vdCIsInJlcG9Qb2xpY3kiLCJlbnRyeSIsInByaW1hcnlSZXN1bHQiXSwic291cmNlcyI6WyJ2YXJpYW50RXhlY3V0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtcbiAgUmVwb1VwZ3JhZGVNb2RlLFxuICBSZXBvVXBncmFkZU1vZGVEZWZpbml0aW9uLFxuICBSZXBvVXBncmFkZU1vZHVsZSxcbiAgUmVwb1VwZ3JhZGVTdGVwLFxuICBVcGdyYWRlU3RlcEV4ZWN1dGlvbklucHV0LFxuICBVcGdyYWRlU3RlcFJlc3VsdCxcbiAgVXBncmFkZVZhcmlhbnQsXG59IGZyb20gJy4vcmVwb1VwZ3JhZGVPcmNoZXN0cmF0b3IuanMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZhcmlhbnRFeGVjdXRpb25Db250ZXh0IHtcbiAgcGFyYWxsZWxWYXJpYW50cz86IGJvb2xlYW47XG4gIHZhcmlhbnRXb3Jrc3BhY2VSb290cz86IFBhcnRpYWw8UmVjb3JkPFVwZ3JhZGVWYXJpYW50LCBzdHJpbmc+PjtcbiAgcmVwb1BvbGljeT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWYXJpYW50RXhlY3V0aW9uT3B0aW9ucyB7XG4gIG1vZHVsZTogUmVwb1VwZ3JhZGVNb2R1bGU7XG4gIHN0ZXA6IFJlcG9VcGdyYWRlU3RlcDtcbiAgbW9kZTogUmVwb1VwZ3JhZGVNb2RlO1xuICBtb2RlRGVmaW5pdGlvbjogUmVwb1VwZ3JhZGVNb2RlRGVmaW5pdGlvbjtcbiAgY29udGV4dDogVmFyaWFudEV4ZWN1dGlvbkNvbnRleHQ7XG4gIGV4ZWN1dGVWYXJpYW50OiAoaW5wdXQ6IFVwZ3JhZGVTdGVwRXhlY3V0aW9uSW5wdXQpID0+IFByb21pc2U8VXBncmFkZVN0ZXBSZXN1bHQ+O1xuICBlbWl0PzogKGV2ZW50OiB7IHR5cGU6IHN0cmluZzsgdGltZXN0YW1wOiBudW1iZXI7IGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9KSA9PiB2b2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVdvcmtzcGFjZVJvb3QoXG4gIHZhcmlhbnQ6IFVwZ3JhZGVWYXJpYW50LFxuICBjb250ZXh0OiBWYXJpYW50RXhlY3V0aW9uQ29udGV4dFxuKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgcmV0dXJuIGNvbnRleHQudmFyaWFudFdvcmtzcGFjZVJvb3RzPy5bdmFyaWFudF0gPz8gY29udGV4dC52YXJpYW50V29ya3NwYWNlUm9vdHM/LnByaW1hcnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW5SdW5WYXJpYW50c1BhcmFsbGVsKFxuICBtb2RlRGVmaW5pdGlvbjogUmVwb1VwZ3JhZGVNb2RlRGVmaW5pdGlvbixcbiAgY29udGV4dDogVmFyaWFudEV4ZWN1dGlvbkNvbnRleHRcbik6IGJvb2xlYW4ge1xuICBpZiAoIW1vZGVEZWZpbml0aW9uLnBhcmFsbGVsVmFyaWFudHMgfHwgIWNvbnRleHQucGFyYWxsZWxWYXJpYW50cykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBwcmltYXJ5Um9vdCA9IGNvbnRleHQudmFyaWFudFdvcmtzcGFjZVJvb3RzPy5wcmltYXJ5O1xuICBjb25zdCByZWZpbmVyUm9vdCA9IGNvbnRleHQudmFyaWFudFdvcmtzcGFjZVJvb3RzPy5yZWZpbmVyO1xuICByZXR1cm4gQm9vbGVhbihwcmltYXJ5Um9vdCAmJiByZWZpbmVyUm9vdCAmJiBwcmltYXJ5Um9vdCAhPT0gcmVmaW5lclJvb3QpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY3V0ZVZhcmlhbnRzKFxuICBvcHRpb25zOiBWYXJpYW50RXhlY3V0aW9uT3B0aW9uc1xuKTogUHJvbWlzZTxQYXJ0aWFsPFJlY29yZDxVcGdyYWRlVmFyaWFudCwgVXBncmFkZVN0ZXBSZXN1bHQ+Pj4ge1xuICBjb25zdCB7IG1vZHVsZSwgc3RlcCwgbW9kZSwgbW9kZURlZmluaXRpb24sIGNvbnRleHQsIGV4ZWN1dGVWYXJpYW50LCBlbWl0IH0gPSBvcHRpb25zO1xuICBjb25zdCB2YXJpYW50UmVzdWx0czogUGFydGlhbDxSZWNvcmQ8VXBncmFkZVZhcmlhbnQsIFVwZ3JhZGVTdGVwUmVzdWx0Pj4gPSB7fTtcblxuICBpZiAoY2FuUnVuVmFyaWFudHNQYXJhbGxlbChtb2RlRGVmaW5pdGlvbiwgY29udGV4dCkpIHtcbiAgICBlbWl0Py4oe1xuICAgICAgdHlwZTogJ3VwZ3JhZGUuc3RlcC52YXJpYW50cy5wYXJhbGxlbCcsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBkYXRhOiB7IG1vZHVsZUlkOiBtb2R1bGUuaWQsIHN0ZXBJZDogc3RlcC5pZCwgdmFyaWFudHM6IG1vZGVEZWZpbml0aW9uLnZhcmlhbnRzIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBtb2RlRGVmaW5pdGlvbi52YXJpYW50cy5tYXAoYXN5bmMgKHZhcmlhbnQpID0+IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0ZVZhcmlhbnQoe1xuICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgICBzdGVwLFxuICAgICAgICAgIG1vZGUsXG4gICAgICAgICAgdmFyaWFudCxcbiAgICAgICAgICBwcmV2aW91c1Jlc3VsdDogdW5kZWZpbmVkLFxuICAgICAgICAgIHdvcmtzcGFjZVJvb3Q6IHJlc29sdmVXb3Jrc3BhY2VSb290KHZhcmlhbnQsIGNvbnRleHQpLFxuICAgICAgICAgIHJlcG9Qb2xpY3k6IGNvbnRleHQucmVwb1BvbGljeSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7IHZhcmlhbnQsIHJlc3VsdCB9O1xuICAgICAgfSlcbiAgICApO1xuICAgIGZvciAoY29uc3QgZW50cnkgb2YgcmVzdWx0cykge1xuICAgICAgdmFyaWFudFJlc3VsdHNbZW50cnkudmFyaWFudF0gPSBlbnRyeS5yZXN1bHQ7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBwcmltYXJ5UmVzdWx0OiBVcGdyYWRlU3RlcFJlc3VsdCB8IHVuZGVmaW5lZDtcbiAgICBmb3IgKGNvbnN0IHZhcmlhbnQgb2YgbW9kZURlZmluaXRpb24udmFyaWFudHMpIHtcbiAgICAgIGNvbnN0IHByZXZpb3VzUmVzdWx0ID0gdmFyaWFudCA9PT0gJ3JlZmluZXInID8gcHJpbWFyeVJlc3VsdCA6IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVWYXJpYW50KHtcbiAgICAgICAgbW9kdWxlLFxuICAgICAgICBzdGVwLFxuICAgICAgICBtb2RlLFxuICAgICAgICB2YXJpYW50LFxuICAgICAgICBwcmV2aW91c1Jlc3VsdCxcbiAgICAgICAgd29ya3NwYWNlUm9vdDogcmVzb2x2ZVdvcmtzcGFjZVJvb3QodmFyaWFudCwgY29udGV4dCksXG4gICAgICAgIHJlcG9Qb2xpY3k6IGNvbnRleHQucmVwb1BvbGljeSxcbiAgICAgIH0pO1xuICAgICAgdmFyaWFudFJlc3VsdHNbdmFyaWFudF0gPSByZXN1bHQ7XG4gICAgICBpZiAodmFyaWFudCA9PT0gJ3ByaW1hcnknKSB7XG4gICAgICAgIHByaW1hcnlSZXN1bHQgPSByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHZhcmlhbnRSZXN1bHRzO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQWVZO0lBQUFBLGNBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNBQUE7SUFBQTtFQUFBO0VBQUEsT0FBQUEsY0FBQTtBQUFBO0FBQUFELGNBQUE7QUFXTCxTQUFTRSxv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
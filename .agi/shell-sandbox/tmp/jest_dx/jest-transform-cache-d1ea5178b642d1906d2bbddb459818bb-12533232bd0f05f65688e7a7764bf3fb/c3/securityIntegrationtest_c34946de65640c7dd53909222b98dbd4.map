{"version":3,"names":["_appleSecurityIntegration","require","_appleSecurityCapability","describe","integration","beforeEach","AppleSecurityIntegration","aggressive","evidencePrefix","outputDir","it","services","loadAppleServices","expect","toBeInstanceOf","Array","length","toBeGreaterThan","toHaveProperty","categories","Set","map","s","category","size","has","toBeTruthy","vulnerabilities","loadAppleVulnerabilities","severities","v","severity","exploits","loadAppleExploits","types","e","type","health","quickCheck","toContain","status","capability","AppleSecurityCapabilityModule","targetScope","enableExploitation","enableRemediation","id","toBe","name","description","metadata","getMetadata","isArray","operations","operationIds","op"],"sources":["securityIntegration.test.ts"],"sourcesContent":["/**\n * Apple Security Integration Tests\n */\n\nimport { AppleSecurityIntegration } from '../../src/core/appleSecurityIntegration.js';\nimport { AppleSecurityCapabilityModule } from '../../src/capabilities/appleSecurityCapability.js';\n\ndescribe('Apple Security Integration', () => {\n  let integration: AppleSecurityIntegration;\n\n  beforeEach(() => {\n    integration = new AppleSecurityIntegration({\n      aggressive: false,\n      evidencePrefix: 'test-apple-security',\n      outputDir: '/tmp'\n    });\n  });\n\n  describe('Service Discovery', () => {\n    it('should load Apple services', () => {\n      const services = integration.loadAppleServices();\n      expect(services).toBeInstanceOf(Array);\n      expect(services.length).toBeGreaterThan(0);\n      expect(services[0]).toHaveProperty('name');\n      expect(services[0]).toHaveProperty('domain');\n      expect(services[0]).toHaveProperty('category');\n    });\n\n    it('should categorize services correctly', () => {\n      const services = integration.loadAppleServices();\n      const categories = new Set(services.map(s => s.category));\n      expect(categories.size).toBeGreaterThan(0);\n      \n      // Should have at least cloud and developer categories\n      expect(categories.has('cloud')).toBeTruthy();\n      expect(categories.has('developer')).toBeTruthy();\n    });\n  });\n\n  describe('Vulnerability Assessment', () => {\n    it('should load Apple vulnerabilities', () => {\n      const vulnerabilities = integration.loadAppleVulnerabilities();\n      expect(vulnerabilities).toBeInstanceOf(Array);\n      expect(vulnerabilities.length).toBeGreaterThan(0);\n      expect(vulnerabilities[0]).toHaveProperty('cve');\n      expect(vulnerabilities[0]).toHaveProperty('severity');\n      expect(vulnerabilities[0]).toHaveProperty('affected');\n    });\n\n    it('should have proper severity levels', () => {\n      const vulnerabilities = integration.loadAppleVulnerabilities();\n      const severities = new Set(vulnerabilities.map(v => v.severity));\n      expect(severities.has('critical')).toBeTruthy();\n      expect(severities.has('high')).toBeTruthy();\n    });\n  });\n\n  describe('Exploit Analysis', () => {\n    it('should load Apple exploits', () => {\n      const exploits = integration.loadAppleExploits();\n      expect(exploits).toBeInstanceOf(Array);\n      expect(exploits.length).toBeGreaterThan(0);\n      expect(exploits[0]).toHaveProperty('name');\n      expect(exploits[0]).toHaveProperty('type');\n      expect(exploits[0]).toHaveProperty('method');\n    });\n\n    it('should have various exploit types', () => {\n      const exploits = integration.loadAppleExploits();\n      const types = new Set(exploits.map(e => e.type));\n      expect(types.has('ios')).toBeTruthy();\n      expect(types.has('macos')).toBeTruthy();\n      expect(types.has('web')).toBeTruthy();\n    });\n  });\n\n  describe('Health Check', () => {\n    it('should perform health check', () => {\n      const health = AppleSecurityIntegration.quickCheck();\n      expect(health).toHaveProperty('status');\n      expect(health).toHaveProperty('details');\n      expect(['healthy', 'degraded', 'unavailable']).toContain(health.status);\n    });\n  });\n});\n\ndescribe('Apple Security Capability Module', () => {\n  let capability: AppleSecurityCapabilityModule;\n\n  beforeEach(() => {\n    capability = new AppleSecurityCapabilityModule({\n      aggressive: false,\n      targetScope: 'services',\n      enableExploitation: false,\n      enableRemediation: true,\n      outputDir: '/tmp'\n    });\n  });\n\n  it('should create capability module with correct properties', () => {\n    expect(capability).toBeInstanceOf(AppleSecurityCapabilityModule);\n    expect(capability.id).toBe('apple-security');\n    expect(capability.name).toBe('Apple Security Integration');\n    expect(capability.description).toContain('Apple security');\n  });\n\n  it('should have metadata', () => {\n    const metadata = capability.getMetadata();\n    expect(metadata).toHaveProperty('id', 'apple-security');\n    expect(metadata).toHaveProperty('name', 'Apple Security Integration');\n    expect(metadata).toHaveProperty('operations');\n    expect(Array.isArray(metadata.operations)).toBeTruthy();\n    expect(metadata.operations.length).toBeGreaterThan(0);\n  });\n\n  it('should list available operations', () => {\n    const metadata = capability.getMetadata();\n    const operationIds = metadata.operations.map((op: any) => op.id);\n    expect(operationIds).toContain('service_discovery');\n    expect(operationIds).toContain('vulnerability_assessment');\n    expect(operationIds).toContain('security_hardening');\n    expect(operationIds).toContain('health_check');\n  });\n});"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["cov_259wjqkczz","actualCoverage","NEXT_STEPS_HEADING","s","ensureNextSteps","content","_context","f","normalized","b","trimEnd","output","appended","test"],"sources":["finalResponseFormatter.ts"],"sourcesContent":["/**\n * Ensures final assistant responses include a \"Next steps\" section.\n * Returns both the full output and any appended text so callers can stream just the delta.\n */\nexport interface FinalResponseFormat {\n  output: string;\n  appended: string | null;\n}\n\nconst NEXT_STEPS_HEADING = /(^|\\n)\\s*next steps?\\s*:/i;\n\nexport function ensureNextSteps(content: string, _context?: string): FinalResponseFormat {\n  const normalized = content?.trimEnd() ?? '';\n  if (!normalized) {\n    return { output: '', appended: null };\n  }\n\n  // If content already has next steps, return as-is (no duplicates)\n  if (NEXT_STEPS_HEADING.test(normalized)) {\n    return { output: normalized, appended: null };\n  }\n\n  // Don't auto-append next steps - let the AI generate contextually appropriate ones\n  return { output: normalized, appended: null };\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ;AACA;AACA;AACA;;AAMA,MAAME,kBAAkB;AAAA;AAAA,CAAAF,cAAA,GAAAG,CAAA,OAAG,2BAA2B;AAE/C,SAASC,eAAeA,CAACC,OAAe,EAAEC,QAAiB,EAAuB;EAAA;EAAAN,cAAA,GAAAO,CAAA;EACvF,MAAMC,UAAU;EAAA;EAAA,CAAAR,cAAA,GAAAG,CAAA;EAAG;EAAA,CAAAH,cAAA,GAAAS,CAAA,UAAAJ,OAAO,EAAEK,OAAO,CAAC,CAAC;EAAA;EAAA,CAAAV,cAAA,GAAAS,CAAA,UAAI,EAAE;EAAC;EAAAT,cAAA,GAAAG,CAAA;EAC5C,IAAI,CAACK,UAAU,EAAE;IAAA;IAAAR,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAG,CAAA;IACf,OAAO;MAAEQ,MAAM,EAAE,EAAE;MAAEC,QAAQ,EAAE;IAAK,CAAC;EACvC,CAAC;EAAA;EAAA;IAAAZ,cAAA,GAAAS,CAAA;EAAA;;EAED;EAAAT,cAAA,GAAAG,CAAA;EACA,IAAID,kBAAkB,CAACW,IAAI,CAACL,UAAU,CAAC,EAAE;IAAA;IAAAR,cAAA,GAAAS,CAAA;IAAAT,cAAA,GAAAG,CAAA;IACvC,OAAO;MAAEQ,MAAM,EAAEH,UAAU;MAAEI,QAAQ,EAAE;IAAK,CAAC;EAC/C,CAAC;EAAA;EAAA;IAAAZ,cAAA,GAAAS,CAAA;EAAA;;EAED;EAAAT,cAAA,GAAAG,CAAA;EACA,OAAO;IAAEQ,MAAM,EAAEH,UAAU;IAAEI,QAAQ,EAAE;EAAK,CAAC;AAC/C","ignoreList":[]}
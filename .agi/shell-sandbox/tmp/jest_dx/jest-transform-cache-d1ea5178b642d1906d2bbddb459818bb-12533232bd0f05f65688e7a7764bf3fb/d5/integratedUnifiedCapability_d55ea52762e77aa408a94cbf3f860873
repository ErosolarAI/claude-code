0ed91d57482930e950bcf48edd31d9b3
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SimplifiedUnifiedCapability = exports.IntegratedUnifiedCapabilityModule = void 0;
var _baseCapability = require("./baseCapability.js");
var _universalCapabilityFramework = require("./universalCapabilityFramework.js");
var _readmeIntegration = require("./readmeIntegration.js");
var _eliteCryptoMilitaryCapability = require("./eliteCryptoMilitaryCapability.js");
var _unifiedMilitaryCapability = require("./unifiedMilitaryCapability.js");
var _universalSecurityCapability = require("./universalSecurityCapability.js");
var _maxOffensiveUkraineCapability = require("./maxOffensiveUkraineCapability.js");
var _offensiveDestructionCapability = require("./offensiveDestructionCapability.js");
var _selfUpdateSystem = require("./selfUpdateSystem.js");
/**
 * INTEGRATED UNIFIED CAPABILITY MODULE
 * 
 * The ultimate integration module that unifies ALL capabilities from the README
 * into a single, cohesive framework using the Universal Capability Framework.
 * 
 * This module serves as the single source of truth for all AGI capabilities,
 * promoting maximum code reuse and consistent patterns across the entire codebase.
 */

// Import all README capabilities

// Import universal core capabilities

// Import existing military capabilities for integration

// Import self-update capability

// ============================================================================
// INTEGRATED UNIFIED CAPABILITY CONFIGURATION
// ============================================================================

// ============================================================================
// INTEGRATED UNIFIED CAPABILITY MODULE
// ============================================================================

class IntegratedUnifiedCapabilityModule extends _baseCapability.BaseCapabilityModule {
  id = 'capability.integrated-unified';
  framework = null;
  capabilities = new Map();
  unifiedToolSuite = null;
  constructor(options = {}) {
    const baseOptions = {
      workingDir: options.workingDir || process.cwd(),
      debug: options.debug || false,
      enableEvidence: true,
      authorization: 'full',
      emergencyOverride: true
    };
    super(baseOptions);
    this.options = {
      enableUniversalFramework: true,
      enableReadmeCapabilities: true,
      enableMilitaryIntegration: true,
      enableCrossModuleCommunication: true,
      unifiedWorkingDir: options.workingDir || process.cwd(),
      ...options,
      ...baseOptions
    };
    this.initializeUnifiedFramework();
  }
  initializeUnifiedFramework() {
    if (!this.options.enableUniversalFramework) return;

    // Create universal framework configuration
    const frameworkConfig = {
      rootDir: this.options.unifiedWorkingDir || this.options.workingDir,
      debug: this.options.debug || false,
      enableEvents: this.options.enableCrossModuleCommunication,
      enableDependencyResolution: true,
      sharedDataDir: '/tmp/agi-integrated-unified',
      ...this.options.frameworkConfig
    };
    this.framework = new _universalCapabilityFramework.UniversalCapabilityFramework(frameworkConfig);
    this.registerAllCapabilities();
  }
  registerAllCapabilities() {
    if (!this.framework) return;

    // Register capability types with factory
    _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('universal-filesystem', _universalCapabilityFramework.UniversalFilesystemCapability);
    _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('universal-bash', _universalCapabilityFramework.UniversalBashCapability);
    _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('universal-search', _universalCapabilityFramework.UniversalSearchCapability);
    _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('universal-edit', _universalCapabilityFramework.UniversalEditCapability);
    _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('self-update', _selfUpdateSystem.SelfUpdateCapability);
    if (this.options.enableReadmeCapabilities) {
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('multi-provider-ai', _readmeIntegration.MultiProviderAICapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('alpha-zero-self-play', _readmeIntegration.AlphaZeroSelfPlayCapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('tao-suite', _readmeIntegration.TaoSuiteCapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('kinetic-ops', _readmeIntegration.KineticOpsCapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('enhanced-git', _readmeIntegration.EnhancedGitCapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('web-tools', _readmeIntegration.WebToolsCapability);
      _universalCapabilityFramework.UniversalCapabilityFactory.registerCapability('military-integrator', _readmeIntegration.MilitaryCapabilitiesIntegrator);
    }

    // Create and register capabilities
    this.createAndRegisterCapabilities();
  }
  createAndRegisterCapabilities() {
    if (!this.framework) return;
    const capabilities = [{
      id: 'universal-filesystem',
      config: {
        workingDir: this.options.workingDir
      }
    }, {
      id: 'universal-bash',
      config: {
        workingDir: this.options.workingDir
      }
    }, {
      id: 'universal-search',
      config: {
        workingDir: this.options.workingDir
      }
    }, {
      id: 'universal-edit',
      config: {
        workingDir: this.options.workingDir
      }
    }, {
      id: 'self-update',
      config: {
        workingDir: this.options.workingDir
      }
    }];
    if (this.options.enableReadmeCapabilities) {
      capabilities.push({
        id: 'multi-provider-ai',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'alpha-zero-self-play',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'tao-suite',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'kinetic-ops',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'enhanced-git',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'web-tools',
        config: {
          workingDir: this.options.workingDir
        }
      }, {
        id: 'military-integrator',
        config: {
          workingDir: this.options.workingDir
        }
      });
    }
    for (const cap of capabilities) {
      const capability = _universalCapabilityFramework.UniversalCapabilityFactory.createCapability(cap.id, this.framework, cap.config);
      if (capability) {
        this.capabilities.set(capability.id, capability);
        this.framework.registerCapability(capability, capability.metadata);
      }
    }
  }
  async create(context) {
    // Build unified tool suite from all capabilities
    const unifiedTools = await this.buildUnifiedToolSuite(context);
    return {
      id: 'integrated.unified',
      description: 'Integrated unified capabilities from README and entire codebase',
      toolSuite: {
        id: 'integrated-unified',
        description: 'All AGI capabilities unified into single suite',
        tools: unifiedTools
      },
      metadata: {
        frameworkEnabled: this.options.enableUniversalFramework,
        capabilitiesIntegrated: Array.from(this.capabilities.keys()),
        workingDir: this.options.workingDir,
        unified: true
      }
    };
  }
  async buildUnifiedToolSuite(context) {
    const tools = [];

    // Add tools from universal framework capabilities
    if (this.framework) {
      for (const [id, capability] of this.capabilities) {
        try {
          const contribution = await capability.create(context);
          if (contribution && contribution.toolSuite) {
            tools.push(...contribution.toolSuite.tools);
          }
        } catch (error) {
          // Skip capabilities that fail to create tools
          console.warn(`Failed to create tools for capability ${id}:`, error);
        }
      }
    }

    // Add unified tools that bridge capabilities
    tools.push(...this.createUnifiedBridgeTools());
    return tools;
  }
  createUnifiedBridgeTools() {
    return [_baseCapability.SharedUtilities.createToolDefinition('unified_execute', 'Execute operation across all integrated capabilities', {
      type: 'object',
      properties: {
        operation: {
          type: 'string',
          description: 'Operation to execute'
        },
        parameters: {
          type: 'object',
          description: 'Operation parameters'
        },
        target_capabilities: {
          type: 'array',
          items: {
            type: 'string'
          },
          description: 'Specific capabilities to target (empty for all)'
        }
      },
      required: ['operation']
    }, async args => {
      return await this.executeUnifiedOperation(args.operation, args.parameters, args.target_capabilities);
    }), _baseCapability.SharedUtilities.createToolDefinition('list_integrated_capabilities', 'List all capabilities integrated into unified framework', {
      type: 'object',
      properties: {
        detailed: {
          type: 'boolean',
          description: 'Show detailed information',
          default: false
        }
      }
    }, async args => {
      return this.listIntegratedCapabilities(args.detailed);
    }), _baseCapability.SharedUtilities.createToolDefinition('framework_status', 'Get status of unified framework and integrated capabilities', {}, async () => {
      return this.getFrameworkStatus();
    })];
  }
  async executeUnifiedOperation(operation, parameters, targetCapabilities) {
    if (!this.framework) {
      return 'Unified framework not initialized';
    }
    const capabilities = targetCapabilities || Array.from(this.capabilities.keys());
    try {
      const results = await this.framework.executeOperation(operation, parameters, capabilities);
      return JSON.stringify({
        success: true,
        operation,
        results,
        capabilities_executed: capabilities
      }, null, 2);
    } catch (error) {
      return JSON.stringify({
        success: false,
        operation,
        error: error.message,
        capabilities_attempted: capabilities
      }, null, 2);
    }
  }
  listIntegratedCapabilities(detailed) {
    const capabilities = [];
    for (const [id, capability] of this.capabilities) {
      const capInfo = {
        id: capability.id,
        metadata: capability.metadata
      };
      if (detailed) {
        capInfo.status = 'integrated';
        capInfo.provides = capability.metadata.provides;
        capInfo.dependencies = capability.metadata.dependencies;
      }
      capabilities.push(capInfo);
    }
    if (detailed) {
      return JSON.stringify({
        framework: this.framework ? 'active' : 'inactive',
        capabilities_integrated: capabilities.length,
        capabilities: capabilities
      }, null, 2);
    } else {
      return capabilities.map(c => c.id).join('\n');
    }
  }
  getFrameworkStatus() {
    const status = {
      unified_framework: this.framework ? {
        initialized: true,
        capabilities_registered: this.capabilities.size,
        config: this.framework.getConfig()
      } : {
        initialized: false
      },
      options: {
        enableUniversalFramework: this.options.enableUniversalFramework,
        enableReadmeCapabilities: this.options.enableReadmeCapabilities,
        enableMilitaryIntegration: this.options.enableMilitaryIntegration,
        enableCrossModuleCommunication: this.options.enableCrossModuleCommunication
      },
      capabilities: Array.from(this.capabilities.keys())
    };
    return JSON.stringify(status, null, 2);
  }
  async execute(params) {
    const opId = params.operationId || _baseCapability.SharedUtilities.generateOperationId('unified');
    switch (params.operation) {
      case 'framework_status':
        return JSON.parse(this.getFrameworkStatus());
      case 'list_capabilities':
        return JSON.parse(this.listIntegratedCapabilities(true));
      case 'execute_unified':
        return await this.executeUnifiedOperation(params.parameters.operation, params.parameters.parameters, params.parameters.target_capabilities);
      case 'activate_capability':
        if (!this.framework) {
          throw new Error('Framework not initialized');
        }
        return await this.framework.activateCapability(params.parameters.capability_id);
      case 'cross_capability_operation':
        if (!this.framework) {
          throw new Error('Framework not initialized');
        }
        return await this.framework.executeOperation(params.parameters.operation, params.parameters.parameters, params.parameters.capabilities);
      default:
        throw new Error(`Unknown unified operation: ${params.operation}`);
    }
  }

  /**
   * Legacy compatibility method to integrate with existing military modules
   */
  integrateMilitaryModules() {
    if (!this.options.enableMilitaryIntegration) return;
    const militaryModules = [{
      module: _eliteCryptoMilitaryCapability.EliteCryptoMilitaryCapabilityModule,
      name: 'elite-crypto'
    }, {
      module: _unifiedMilitaryCapability.UnifiedMilitaryCapabilityModule,
      name: 'unified-military'
    }, {
      module: _universalSecurityCapability.UniversalSecurityCapabilityModule,
      name: 'universal-security'
    }, {
      module: _maxOffensiveUkraineCapability.MaxOffensiveUkraineCapabilityModule,
      name: 'max-offensive-ukraine'
    }, {
      module: _offensiveDestructionCapability.OffensiveDestructionCapabilityModule,
      name: 'offensive-destruction'
    }];
    for (const {
      module: ModuleClass,
      name
    } of militaryModules) {
      try {
        const militaryModule = new ModuleClass({
          workingDir: this.options.workingDir,
          debug: this.options.debug,
          enableEvidence: this.options.enableEvidence,
          authorization: this.options.authorization,
          emergencyOverride: this.options.emergencyOverride
        });
        this.capabilities.set(name, militaryModule);
      } catch (error) {
        console.warn(`Failed to integrate military module ${name}:`, error);
      }
    }
  }

  /**
   * Get the universal framework instance (for advanced integration)
   */
  getFramework() {
    return this.framework;
  }

  /**
   * Get all integrated capabilities
   */
  getCapabilities() {
    return new Map(this.capabilities);
  }

  /**
   * Get specific capability by ID
   */
  getCapability(capabilityId) {
    return this.capabilities.get(capabilityId) || null;
  }
}

// ============================================================================
// SIMPLIFIED INTEGRATION FOR CLI USAGE
// ============================================================================

/**
 * Simplified unified capability for CLI usage
 * Provides a single entry point to all AGI capabilities
 */
exports.IntegratedUnifiedCapabilityModule = IntegratedUnifiedCapabilityModule;
class SimplifiedUnifiedCapability {
  integratedModule;
  framework = null;
  constructor(options = {}) {
    this.integratedModule = new IntegratedUnifiedCapabilityModule(options);
    this.framework = this.integratedModule.getFramework();
  }

  /**
   * Quick start unified capabilities
   */
  static quickStart(workingDir) {
    return new SimplifiedUnifiedCapability({
      workingDir: workingDir || process.cwd(),
      enableUniversalFramework: true,
      enableReadmeCapabilities: true,
      enableMilitaryIntegration: true,
      enableCrossModuleCommunication: true,
      debug: false
    });
  }

  /**
   * Execute a command using unified capabilities
   */
  async executeCommand(command, args = {}) {
    if (!this.framework) {
      throw new Error('Unified framework not initialized');
    }

    // Parse command and route to appropriate capability
    const [operation, ...params] = command.split(' ');
    return await this.integratedModule.execute({
      operation,
      parameters: {
        ...args,
        rawParams: params
      }
    });
  }

  /**
   * List available capabilities
   */
  listCapabilities(detailed = false) {
    return this.integratedModule.listIntegratedCapabilities(detailed);
  }

  /**
   * Get framework status
   */
  getStatus() {
    return JSON.parse(this.integratedModule.getFrameworkStatus());
  }

  /**
   * Run a cross-capability operation
   */
  async runOperation(operation, parameters, capabilities) {
    if (!this.framework) {
      throw new Error('Unified framework not initialized');
    }
    return await this.framework.executeOperation(operation, parameters, capabilities || Array.from(this.integratedModule.getCapabilities().keys()));
  }
}

// ============================================================================
// EXPORTS
// ============================================================================
exports.SimplifiedUnifiedCapability = SimplifiedUnifiedCapability;
var _default = exports.default = IntegratedUnifiedCapabilityModule; // Note: SimplifiedUnifiedCapability is already exported at its definition
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmFzZUNhcGFiaWxpdHkiLCJyZXF1aXJlIiwiX3VuaXZlcnNhbENhcGFiaWxpdHlGcmFtZXdvcmsiLCJfcmVhZG1lSW50ZWdyYXRpb24iLCJfZWxpdGVDcnlwdG9NaWxpdGFyeUNhcGFiaWxpdHkiLCJfdW5pZmllZE1pbGl0YXJ5Q2FwYWJpbGl0eSIsIl91bml2ZXJzYWxTZWN1cml0eUNhcGFiaWxpdHkiLCJfbWF4T2ZmZW5zaXZlVWtyYWluZUNhcGFiaWxpdHkiLCJfb2ZmZW5zaXZlRGVzdHJ1Y3Rpb25DYXBhYmlsaXR5IiwiX3NlbGZVcGRhdGVTeXN0ZW0iLCJJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlNb2R1bGUiLCJCYXNlQ2FwYWJpbGl0eU1vZHVsZSIsImlkIiwiZnJhbWV3b3JrIiwiY2FwYWJpbGl0aWVzIiwiTWFwIiwidW5pZmllZFRvb2xTdWl0ZSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsImJhc2VPcHRpb25zIiwid29ya2luZ0RpciIsInByb2Nlc3MiLCJjd2QiLCJkZWJ1ZyIsImVuYWJsZUV2aWRlbmNlIiwiYXV0aG9yaXphdGlvbiIsImVtZXJnZW5jeU92ZXJyaWRlIiwiZW5hYmxlVW5pdmVyc2FsRnJhbWV3b3JrIiwiZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzIiwiZW5hYmxlTWlsaXRhcnlJbnRlZ3JhdGlvbiIsImVuYWJsZUNyb3NzTW9kdWxlQ29tbXVuaWNhdGlvbiIsInVuaWZpZWRXb3JraW5nRGlyIiwiaW5pdGlhbGl6ZVVuaWZpZWRGcmFtZXdvcmsiLCJmcmFtZXdvcmtDb25maWciLCJyb290RGlyIiwiZW5hYmxlRXZlbnRzIiwiZW5hYmxlRGVwZW5kZW5jeVJlc29sdXRpb24iLCJzaGFyZWREYXRhRGlyIiwiVW5pdmVyc2FsQ2FwYWJpbGl0eUZyYW1ld29yayIsInJlZ2lzdGVyQWxsQ2FwYWJpbGl0aWVzIiwiVW5pdmVyc2FsQ2FwYWJpbGl0eUZhY3RvcnkiLCJyZWdpc3RlckNhcGFiaWxpdHkiLCJVbml2ZXJzYWxGaWxlc3lzdGVtQ2FwYWJpbGl0eSIsIlVuaXZlcnNhbEJhc2hDYXBhYmlsaXR5IiwiVW5pdmVyc2FsU2VhcmNoQ2FwYWJpbGl0eSIsIlVuaXZlcnNhbEVkaXRDYXBhYmlsaXR5IiwiU2VsZlVwZGF0ZUNhcGFiaWxpdHkiLCJNdWx0aVByb3ZpZGVyQUlDYXBhYmlsaXR5IiwiQWxwaGFaZXJvU2VsZlBsYXlDYXBhYmlsaXR5IiwiVGFvU3VpdGVDYXBhYmlsaXR5IiwiS2luZXRpY09wc0NhcGFiaWxpdHkiLCJFbmhhbmNlZEdpdENhcGFiaWxpdHkiLCJXZWJUb29sc0NhcGFiaWxpdHkiLCJNaWxpdGFyeUNhcGFiaWxpdGllc0ludGVncmF0b3IiLCJjcmVhdGVBbmRSZWdpc3RlckNhcGFiaWxpdGllcyIsImNvbmZpZyIsInB1c2giLCJjYXAiLCJjYXBhYmlsaXR5IiwiY3JlYXRlQ2FwYWJpbGl0eSIsInNldCIsIm1ldGFkYXRhIiwiY3JlYXRlIiwiY29udGV4dCIsInVuaWZpZWRUb29scyIsImJ1aWxkVW5pZmllZFRvb2xTdWl0ZSIsImRlc2NyaXB0aW9uIiwidG9vbFN1aXRlIiwidG9vbHMiLCJmcmFtZXdvcmtFbmFibGVkIiwiY2FwYWJpbGl0aWVzSW50ZWdyYXRlZCIsIkFycmF5IiwiZnJvbSIsImtleXMiLCJ1bmlmaWVkIiwiY29udHJpYnV0aW9uIiwiZXJyb3IiLCJjb25zb2xlIiwid2FybiIsImNyZWF0ZVVuaWZpZWRCcmlkZ2VUb29scyIsIlNoYXJlZFV0aWxpdGllcyIsImNyZWF0ZVRvb2xEZWZpbml0aW9uIiwidHlwZSIsInByb3BlcnRpZXMiLCJvcGVyYXRpb24iLCJwYXJhbWV0ZXJzIiwidGFyZ2V0X2NhcGFiaWxpdGllcyIsIml0ZW1zIiwicmVxdWlyZWQiLCJhcmdzIiwiZXhlY3V0ZVVuaWZpZWRPcGVyYXRpb24iLCJkZXRhaWxlZCIsImRlZmF1bHQiLCJsaXN0SW50ZWdyYXRlZENhcGFiaWxpdGllcyIsImdldEZyYW1ld29ya1N0YXR1cyIsInRhcmdldENhcGFiaWxpdGllcyIsInJlc3VsdHMiLCJleGVjdXRlT3BlcmF0aW9uIiwiSlNPTiIsInN0cmluZ2lmeSIsInN1Y2Nlc3MiLCJjYXBhYmlsaXRpZXNfZXhlY3V0ZWQiLCJtZXNzYWdlIiwiY2FwYWJpbGl0aWVzX2F0dGVtcHRlZCIsImNhcEluZm8iLCJzdGF0dXMiLCJwcm92aWRlcyIsImRlcGVuZGVuY2llcyIsImNhcGFiaWxpdGllc19pbnRlZ3JhdGVkIiwibGVuZ3RoIiwibWFwIiwiYyIsImpvaW4iLCJ1bmlmaWVkX2ZyYW1ld29yayIsImluaXRpYWxpemVkIiwiY2FwYWJpbGl0aWVzX3JlZ2lzdGVyZWQiLCJzaXplIiwiZ2V0Q29uZmlnIiwiZXhlY3V0ZSIsInBhcmFtcyIsIm9wSWQiLCJvcGVyYXRpb25JZCIsImdlbmVyYXRlT3BlcmF0aW9uSWQiLCJwYXJzZSIsIkVycm9yIiwiYWN0aXZhdGVDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eV9pZCIsImludGVncmF0ZU1pbGl0YXJ5TW9kdWxlcyIsIm1pbGl0YXJ5TW9kdWxlcyIsIm1vZHVsZSIsIkVsaXRlQ3J5cHRvTWlsaXRhcnlDYXBhYmlsaXR5TW9kdWxlIiwibmFtZSIsIlVuaWZpZWRNaWxpdGFyeUNhcGFiaWxpdHlNb2R1bGUiLCJVbml2ZXJzYWxTZWN1cml0eUNhcGFiaWxpdHlNb2R1bGUiLCJNYXhPZmZlbnNpdmVVa3JhaW5lQ2FwYWJpbGl0eU1vZHVsZSIsIk9mZmVuc2l2ZURlc3RydWN0aW9uQ2FwYWJpbGl0eU1vZHVsZSIsIk1vZHVsZUNsYXNzIiwibWlsaXRhcnlNb2R1bGUiLCJnZXRGcmFtZXdvcmsiLCJnZXRDYXBhYmlsaXRpZXMiLCJnZXRDYXBhYmlsaXR5IiwiY2FwYWJpbGl0eUlkIiwiZ2V0IiwiZXhwb3J0cyIsIlNpbXBsaWZpZWRVbmlmaWVkQ2FwYWJpbGl0eSIsImludGVncmF0ZWRNb2R1bGUiLCJxdWlja1N0YXJ0IiwiZXhlY3V0ZUNvbW1hbmQiLCJjb21tYW5kIiwic3BsaXQiLCJyYXdQYXJhbXMiLCJsaXN0Q2FwYWJpbGl0aWVzIiwiZ2V0U3RhdHVzIiwicnVuT3BlcmF0aW9uIiwiX2RlZmF1bHQiXSwic291cmNlcyI6WyJpbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBJTlRFR1JBVEVEIFVOSUZJRUQgQ0FQQUJJTElUWSBNT0RVTEVcbiAqIFxuICogVGhlIHVsdGltYXRlIGludGVncmF0aW9uIG1vZHVsZSB0aGF0IHVuaWZpZXMgQUxMIGNhcGFiaWxpdGllcyBmcm9tIHRoZSBSRUFETUVcbiAqIGludG8gYSBzaW5nbGUsIGNvaGVzaXZlIGZyYW1ld29yayB1c2luZyB0aGUgVW5pdmVyc2FsIENhcGFiaWxpdHkgRnJhbWV3b3JrLlxuICogXG4gKiBUaGlzIG1vZHVsZSBzZXJ2ZXMgYXMgdGhlIHNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIGFsbCBBR0kgY2FwYWJpbGl0aWVzLFxuICogcHJvbW90aW5nIG1heGltdW0gY29kZSByZXVzZSBhbmQgY29uc2lzdGVudCBwYXR0ZXJucyBhY3Jvc3MgdGhlIGVudGlyZSBjb2RlYmFzZS5cbiAqL1xuXG5pbXBvcnQgdHlwZSB7IENhcGFiaWxpdHlDb250cmlidXRpb24sIENhcGFiaWxpdHlDb250ZXh0IH0gZnJvbSAnLi4vcnVudGltZS9hZ2VudEhvc3QuanMnO1xuaW1wb3J0IHsgQmFzZUNhcGFiaWxpdHlNb2R1bGUsIEJhc2VDYXBhYmlsaXR5T3B0aW9ucywgVG9vbFN1aXRlQnVpbGRlciwgU2hhcmVkVXRpbGl0aWVzIH0gZnJvbSAnLi9iYXNlQ2FwYWJpbGl0eS5qcyc7XG5pbXBvcnQgeyBVbml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrIH0gZnJvbSAnLi91bml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrLmpzJztcbmltcG9ydCB7IFVuaXZlcnNhbENhcGFiaWxpdHlGYWN0b3J5IH0gZnJvbSAnLi91bml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrLmpzJztcblxuLy8gSW1wb3J0IGFsbCBSRUFETUUgY2FwYWJpbGl0aWVzXG5pbXBvcnQgeyBNdWx0aVByb3ZpZGVyQUlDYXBhYmlsaXR5IH0gZnJvbSAnLi9yZWFkbWVJbnRlZ3JhdGlvbi5qcyc7XG5pbXBvcnQgeyBBbHBoYVplcm9TZWxmUGxheUNhcGFiaWxpdHkgfSBmcm9tICcuL3JlYWRtZUludGVncmF0aW9uLmpzJztcbmltcG9ydCB7IFRhb1N1aXRlQ2FwYWJpbGl0eSB9IGZyb20gJy4vcmVhZG1lSW50ZWdyYXRpb24uanMnO1xuaW1wb3J0IHsgS2luZXRpY09wc0NhcGFiaWxpdHkgfSBmcm9tICcuL3JlYWRtZUludGVncmF0aW9uLmpzJztcbmltcG9ydCB7IEVuaGFuY2VkR2l0Q2FwYWJpbGl0eSB9IGZyb20gJy4vcmVhZG1lSW50ZWdyYXRpb24uanMnO1xuaW1wb3J0IHsgV2ViVG9vbHNDYXBhYmlsaXR5IH0gZnJvbSAnLi9yZWFkbWVJbnRlZ3JhdGlvbi5qcyc7XG5pbXBvcnQgeyBNaWxpdGFyeUNhcGFiaWxpdGllc0ludGVncmF0b3IgfSBmcm9tICcuL3JlYWRtZUludGVncmF0aW9uLmpzJztcblxuLy8gSW1wb3J0IHVuaXZlcnNhbCBjb3JlIGNhcGFiaWxpdGllc1xuaW1wb3J0IHsgVW5pdmVyc2FsRmlsZXN5c3RlbUNhcGFiaWxpdHkgfSBmcm9tICcuL3VuaXZlcnNhbENhcGFiaWxpdHlGcmFtZXdvcmsuanMnO1xuaW1wb3J0IHsgVW5pdmVyc2FsQmFzaENhcGFiaWxpdHkgfSBmcm9tICcuL3VuaXZlcnNhbENhcGFiaWxpdHlGcmFtZXdvcmsuanMnO1xuaW1wb3J0IHsgVW5pdmVyc2FsU2VhcmNoQ2FwYWJpbGl0eSB9IGZyb20gJy4vdW5pdmVyc2FsQ2FwYWJpbGl0eUZyYW1ld29yay5qcyc7XG5pbXBvcnQgeyBVbml2ZXJzYWxFZGl0Q2FwYWJpbGl0eSB9IGZyb20gJy4vdW5pdmVyc2FsQ2FwYWJpbGl0eUZyYW1ld29yay5qcyc7XG5cbi8vIEltcG9ydCBleGlzdGluZyBtaWxpdGFyeSBjYXBhYmlsaXRpZXMgZm9yIGludGVncmF0aW9uXG5pbXBvcnQgeyBFbGl0ZUNyeXB0b01pbGl0YXJ5Q2FwYWJpbGl0eU1vZHVsZSB9IGZyb20gJy4vZWxpdGVDcnlwdG9NaWxpdGFyeUNhcGFiaWxpdHkuanMnO1xuaW1wb3J0IHsgVW5pZmllZE1pbGl0YXJ5Q2FwYWJpbGl0eU1vZHVsZSB9IGZyb20gJy4vdW5pZmllZE1pbGl0YXJ5Q2FwYWJpbGl0eS5qcyc7XG5pbXBvcnQgeyBVbml2ZXJzYWxTZWN1cml0eUNhcGFiaWxpdHlNb2R1bGUgfSBmcm9tICcuL3VuaXZlcnNhbFNlY3VyaXR5Q2FwYWJpbGl0eS5qcyc7XG5pbXBvcnQgeyBNYXhPZmZlbnNpdmVVa3JhaW5lQ2FwYWJpbGl0eU1vZHVsZSB9IGZyb20gJy4vbWF4T2ZmZW5zaXZlVWtyYWluZUNhcGFiaWxpdHkuanMnO1xuaW1wb3J0IHsgT2ZmZW5zaXZlRGVzdHJ1Y3Rpb25DYXBhYmlsaXR5TW9kdWxlIH0gZnJvbSAnLi9vZmZlbnNpdmVEZXN0cnVjdGlvbkNhcGFiaWxpdHkuanMnO1xuXG4vLyBJbXBvcnQgc2VsZi11cGRhdGUgY2FwYWJpbGl0eVxuaW1wb3J0IHsgU2VsZlVwZGF0ZUNhcGFiaWxpdHkgfSBmcm9tICcuL3NlbGZVcGRhdGVTeXN0ZW0uanMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBJTlRFR1JBVEVEIFVOSUZJRUQgQ0FQQUJJTElUWSBDT05GSUdVUkFUSU9OXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW50ZWdyYXRlZFVuaWZpZWRDYXBhYmlsaXR5T3B0aW9ucyBleHRlbmRzIEJhc2VDYXBhYmlsaXR5T3B0aW9ucyB7XG4gIC8qKiBFbmFibGUgdW5pdmVyc2FsIGZyYW1ld29yayBpbnRlZ3JhdGlvbiAqL1xuICBlbmFibGVVbml2ZXJzYWxGcmFtZXdvcms6IGJvb2xlYW47XG4gIC8qKiBFbmFibGUgUkVBRE1FIGNhcGFiaWxpdGllcyBpbnRlZ3JhdGlvbiAqL1xuICBlbmFibGVSZWFkbWVDYXBhYmlsaXRpZXM6IGJvb2xlYW47XG4gIC8qKiBFbmFibGUgbWlsaXRhcnkgY2FwYWJpbGl0aWVzIGludGVncmF0aW9uICovXG4gIGVuYWJsZU1pbGl0YXJ5SW50ZWdyYXRpb246IGJvb2xlYW47XG4gIC8qKiBFbmFibGUgY3Jvc3MtbW9kdWxlIGNvbW11bmljYXRpb24gKi9cbiAgZW5hYmxlQ3Jvc3NNb2R1bGVDb21tdW5pY2F0aW9uOiBib29sZWFuO1xuICAvKiogVW5pZmllZCB3b3JraW5nIGRpcmVjdG9yeSAqL1xuICB1bmlmaWVkV29ya2luZ0Rpcj86IHN0cmluZztcbiAgLyoqIEZyYW1ld29yayBjb25maWd1cmF0aW9uICovXG4gIGZyYW1ld29ya0NvbmZpZz86IFBhcnRpYWw8e1xuICAgIHJvb3REaXI6IHN0cmluZztcbiAgICBkZWJ1ZzogYm9vbGVhbjtcbiAgICBlbmFibGVFdmVudHM6IGJvb2xlYW47XG4gICAgZW5hYmxlRGVwZW5kZW5jeVJlc29sdXRpb246IGJvb2xlYW47XG4gICAgc2hhcmVkRGF0YURpcjogc3RyaW5nO1xuICB9Pjtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSU5URUdSQVRFRCBVTklGSUVEIENBUEFCSUxJVFkgTU9EVUxFXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlNb2R1bGUgZXh0ZW5kcyBCYXNlQ2FwYWJpbGl0eU1vZHVsZSB7XG4gIHJlYWRvbmx5IGlkID0gJ2NhcGFiaWxpdHkuaW50ZWdyYXRlZC11bmlmaWVkJztcbiAgcHJvdGVjdGVkIGRlY2xhcmUgcmVhZG9ubHkgb3B0aW9uczogSW50ZWdyYXRlZFVuaWZpZWRDYXBhYmlsaXR5T3B0aW9ucztcbiAgXG4gIHByaXZhdGUgZnJhbWV3b3JrOiBVbml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgY2FwYWJpbGl0aWVzOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHVuaWZpZWRUb29sU3VpdGU6IGFueSA9IG51bGw7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGFydGlhbDxJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlPcHRpb25zPiA9IHt9KSB7XG4gICAgY29uc3QgYmFzZU9wdGlvbnM6IEJhc2VDYXBhYmlsaXR5T3B0aW9ucyA9IHtcbiAgICAgIHdvcmtpbmdEaXI6IG9wdGlvbnMud29ya2luZ0RpciB8fCBwcm9jZXNzLmN3ZCgpLFxuICAgICAgZGVidWc6IG9wdGlvbnMuZGVidWcgfHwgZmFsc2UsXG4gICAgICBlbmFibGVFdmlkZW5jZTogdHJ1ZSxcbiAgICAgIGF1dGhvcml6YXRpb246ICdmdWxsJyxcbiAgICAgIGVtZXJnZW5jeU92ZXJyaWRlOiB0cnVlXG4gICAgfTtcblxuICAgIHN1cGVyKGJhc2VPcHRpb25zKTtcblxuICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgIGVuYWJsZVVuaXZlcnNhbEZyYW1ld29yazogdHJ1ZSxcbiAgICAgIGVuYWJsZVJlYWRtZUNhcGFiaWxpdGllczogdHJ1ZSxcbiAgICAgIGVuYWJsZU1pbGl0YXJ5SW50ZWdyYXRpb246IHRydWUsXG4gICAgICBlbmFibGVDcm9zc01vZHVsZUNvbW11bmljYXRpb246IHRydWUsXG4gICAgICB1bmlmaWVkV29ya2luZ0Rpcjogb3B0aW9ucy53b3JraW5nRGlyIHx8IHByb2Nlc3MuY3dkKCksXG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgLi4uYmFzZU9wdGlvbnNcbiAgICB9O1xuXG4gICAgdGhpcy5pbml0aWFsaXplVW5pZmllZEZyYW1ld29yaygpO1xuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplVW5pZmllZEZyYW1ld29yaygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5lbmFibGVVbml2ZXJzYWxGcmFtZXdvcmspIHJldHVybjtcblxuICAgIC8vIENyZWF0ZSB1bml2ZXJzYWwgZnJhbWV3b3JrIGNvbmZpZ3VyYXRpb25cbiAgICBjb25zdCBmcmFtZXdvcmtDb25maWcgPSB7XG4gICAgICByb290RGlyOiB0aGlzLm9wdGlvbnMudW5pZmllZFdvcmtpbmdEaXIgfHwgdGhpcy5vcHRpb25zLndvcmtpbmdEaXIsXG4gICAgICBkZWJ1ZzogdGhpcy5vcHRpb25zLmRlYnVnIHx8IGZhbHNlLFxuICAgICAgZW5hYmxlRXZlbnRzOiB0aGlzLm9wdGlvbnMuZW5hYmxlQ3Jvc3NNb2R1bGVDb21tdW5pY2F0aW9uLFxuICAgICAgZW5hYmxlRGVwZW5kZW5jeVJlc29sdXRpb246IHRydWUsXG4gICAgICBzaGFyZWREYXRhRGlyOiAnL3RtcC9hZ2ktaW50ZWdyYXRlZC11bmlmaWVkJyxcbiAgICAgIC4uLnRoaXMub3B0aW9ucy5mcmFtZXdvcmtDb25maWdcbiAgICB9O1xuXG4gICAgdGhpcy5mcmFtZXdvcmsgPSBuZXcgVW5pdmVyc2FsQ2FwYWJpbGl0eUZyYW1ld29yayhmcmFtZXdvcmtDb25maWcpO1xuICAgIHRoaXMucmVnaXN0ZXJBbGxDYXBhYmlsaXRpZXMoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVnaXN0ZXJBbGxDYXBhYmlsaXRpZXMoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmZyYW1ld29yaykgcmV0dXJuO1xuXG4gICAgLy8gUmVnaXN0ZXIgY2FwYWJpbGl0eSB0eXBlcyB3aXRoIGZhY3RvcnlcbiAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ3VuaXZlcnNhbC1maWxlc3lzdGVtJywgVW5pdmVyc2FsRmlsZXN5c3RlbUNhcGFiaWxpdHkpO1xuICAgIFVuaXZlcnNhbENhcGFiaWxpdHlGYWN0b3J5LnJlZ2lzdGVyQ2FwYWJpbGl0eSgndW5pdmVyc2FsLWJhc2gnLCBVbml2ZXJzYWxCYXNoQ2FwYWJpbGl0eSk7XG4gICAgVW5pdmVyc2FsQ2FwYWJpbGl0eUZhY3RvcnkucmVnaXN0ZXJDYXBhYmlsaXR5KCd1bml2ZXJzYWwtc2VhcmNoJywgVW5pdmVyc2FsU2VhcmNoQ2FwYWJpbGl0eSk7XG4gICAgVW5pdmVyc2FsQ2FwYWJpbGl0eUZhY3RvcnkucmVnaXN0ZXJDYXBhYmlsaXR5KCd1bml2ZXJzYWwtZWRpdCcsIFVuaXZlcnNhbEVkaXRDYXBhYmlsaXR5KTtcbiAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ3NlbGYtdXBkYXRlJywgU2VsZlVwZGF0ZUNhcGFiaWxpdHkpO1xuICAgIFxuICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzKSB7XG4gICAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ211bHRpLXByb3ZpZGVyLWFpJywgTXVsdGlQcm92aWRlckFJQ2FwYWJpbGl0eSk7XG4gICAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ2FscGhhLXplcm8tc2VsZi1wbGF5JywgQWxwaGFaZXJvU2VsZlBsYXlDYXBhYmlsaXR5KTtcbiAgICAgIFVuaXZlcnNhbENhcGFiaWxpdHlGYWN0b3J5LnJlZ2lzdGVyQ2FwYWJpbGl0eSgndGFvLXN1aXRlJywgVGFvU3VpdGVDYXBhYmlsaXR5KTtcbiAgICAgIFVuaXZlcnNhbENhcGFiaWxpdHlGYWN0b3J5LnJlZ2lzdGVyQ2FwYWJpbGl0eSgna2luZXRpYy1vcHMnLCBLaW5ldGljT3BzQ2FwYWJpbGl0eSk7XG4gICAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ2VuaGFuY2VkLWdpdCcsIEVuaGFuY2VkR2l0Q2FwYWJpbGl0eSk7XG4gICAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ3dlYi10b29scycsIFdlYlRvb2xzQ2FwYWJpbGl0eSk7XG4gICAgICBVbml2ZXJzYWxDYXBhYmlsaXR5RmFjdG9yeS5yZWdpc3RlckNhcGFiaWxpdHkoJ21pbGl0YXJ5LWludGVncmF0b3InLCBNaWxpdGFyeUNhcGFiaWxpdGllc0ludGVncmF0b3IpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhbmQgcmVnaXN0ZXIgY2FwYWJpbGl0aWVzXG4gICAgdGhpcy5jcmVhdGVBbmRSZWdpc3RlckNhcGFiaWxpdGllcygpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVBbmRSZWdpc3RlckNhcGFiaWxpdGllcygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZnJhbWV3b3JrKSByZXR1cm47XG5cbiAgICBjb25zdCBjYXBhYmlsaXRpZXMgPSBbXG4gICAgICB7IGlkOiAndW5pdmVyc2FsLWZpbGVzeXN0ZW0nLCBjb25maWc6IHsgd29ya2luZ0RpcjogdGhpcy5vcHRpb25zLndvcmtpbmdEaXIgfSB9LFxuICAgICAgeyBpZDogJ3VuaXZlcnNhbC1iYXNoJywgY29uZmlnOiB7IHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyIH0gfSxcbiAgICAgIHsgaWQ6ICd1bml2ZXJzYWwtc2VhcmNoJywgY29uZmlnOiB7IHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyIH0gfSxcbiAgICAgIHsgaWQ6ICd1bml2ZXJzYWwtZWRpdCcsIGNvbmZpZzogeyB3b3JraW5nRGlyOiB0aGlzLm9wdGlvbnMud29ya2luZ0RpciB9IH0sXG4gICAgICB7IGlkOiAnc2VsZi11cGRhdGUnLCBjb25maWc6IHsgd29ya2luZ0RpcjogdGhpcy5vcHRpb25zLndvcmtpbmdEaXIgfSB9XG4gICAgXTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzKSB7XG4gICAgICBjYXBhYmlsaXRpZXMucHVzaChcbiAgICAgICAgeyBpZDogJ211bHRpLXByb3ZpZGVyLWFpJywgY29uZmlnOiB7IHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyIH0gfSxcbiAgICAgICAgeyBpZDogJ2FscGhhLXplcm8tc2VsZi1wbGF5JywgY29uZmlnOiB7IHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyIH0gfSxcbiAgICAgICAgeyBpZDogJ3Rhby1zdWl0ZScsIGNvbmZpZzogeyB3b3JraW5nRGlyOiB0aGlzLm9wdGlvbnMud29ya2luZ0RpciB9IH0sXG4gICAgICAgIHsgaWQ6ICdraW5ldGljLW9wcycsIGNvbmZpZzogeyB3b3JraW5nRGlyOiB0aGlzLm9wdGlvbnMud29ya2luZ0RpciB9IH0sXG4gICAgICAgIHsgaWQ6ICdlbmhhbmNlZC1naXQnLCBjb25maWc6IHsgd29ya2luZ0RpcjogdGhpcy5vcHRpb25zLndvcmtpbmdEaXIgfSB9LFxuICAgICAgICB7IGlkOiAnd2ViLXRvb2xzJywgY29uZmlnOiB7IHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyIH0gfSxcbiAgICAgICAgeyBpZDogJ21pbGl0YXJ5LWludGVncmF0b3InLCBjb25maWc6IHsgd29ya2luZ0RpcjogdGhpcy5vcHRpb25zLndvcmtpbmdEaXIgfSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2FwIG9mIGNhcGFiaWxpdGllcykge1xuICAgICAgY29uc3QgY2FwYWJpbGl0eSA9IFVuaXZlcnNhbENhcGFiaWxpdHlGYWN0b3J5LmNyZWF0ZUNhcGFiaWxpdHkoY2FwLmlkLCB0aGlzLmZyYW1ld29yaywgY2FwLmNvbmZpZyk7XG4gICAgICBpZiAoY2FwYWJpbGl0eSkge1xuICAgICAgICB0aGlzLmNhcGFiaWxpdGllcy5zZXQoY2FwYWJpbGl0eS5pZCwgY2FwYWJpbGl0eSk7XG4gICAgICAgIHRoaXMuZnJhbWV3b3JrLnJlZ2lzdGVyQ2FwYWJpbGl0eShjYXBhYmlsaXR5LCBjYXBhYmlsaXR5Lm1ldGFkYXRhKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBjcmVhdGUoY29udGV4dDogQ2FwYWJpbGl0eUNvbnRleHQpOiBQcm9taXNlPENhcGFiaWxpdHlDb250cmlidXRpb24+IHtcbiAgICAvLyBCdWlsZCB1bmlmaWVkIHRvb2wgc3VpdGUgZnJvbSBhbGwgY2FwYWJpbGl0aWVzXG4gICAgY29uc3QgdW5pZmllZFRvb2xzID0gYXdhaXQgdGhpcy5idWlsZFVuaWZpZWRUb29sU3VpdGUoY29udGV4dCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiAnaW50ZWdyYXRlZC51bmlmaWVkJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnSW50ZWdyYXRlZCB1bmlmaWVkIGNhcGFiaWxpdGllcyBmcm9tIFJFQURNRSBhbmQgZW50aXJlIGNvZGViYXNlJyxcbiAgICAgIHRvb2xTdWl0ZToge1xuICAgICAgICBpZDogJ2ludGVncmF0ZWQtdW5pZmllZCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWxsIEFHSSBjYXBhYmlsaXRpZXMgdW5pZmllZCBpbnRvIHNpbmdsZSBzdWl0ZScsXG4gICAgICAgIHRvb2xzOiB1bmlmaWVkVG9vbHNcbiAgICAgIH0sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBmcmFtZXdvcmtFbmFibGVkOiB0aGlzLm9wdGlvbnMuZW5hYmxlVW5pdmVyc2FsRnJhbWV3b3JrLFxuICAgICAgICBjYXBhYmlsaXRpZXNJbnRlZ3JhdGVkOiBBcnJheS5mcm9tKHRoaXMuY2FwYWJpbGl0aWVzLmtleXMoKSksXG4gICAgICAgIHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyLFxuICAgICAgICB1bmlmaWVkOiB0cnVlXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgYnVpbGRVbmlmaWVkVG9vbFN1aXRlKGNvbnRleHQ6IENhcGFiaWxpdHlDb250ZXh0KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIGNvbnN0IHRvb2xzOiBhbnlbXSA9IFtdO1xuICAgIFxuICAgIC8vIEFkZCB0b29scyBmcm9tIHVuaXZlcnNhbCBmcmFtZXdvcmsgY2FwYWJpbGl0aWVzXG4gICAgaWYgKHRoaXMuZnJhbWV3b3JrKSB7XG4gICAgICBmb3IgKGNvbnN0IFtpZCwgY2FwYWJpbGl0eV0gb2YgdGhpcy5jYXBhYmlsaXRpZXMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBjb250cmlidXRpb24gPSBhd2FpdCBjYXBhYmlsaXR5LmNyZWF0ZShjb250ZXh0KTtcbiAgICAgICAgICBpZiAoY29udHJpYnV0aW9uICYmIGNvbnRyaWJ1dGlvbi50b29sU3VpdGUpIHtcbiAgICAgICAgICAgIHRvb2xzLnB1c2goLi4uY29udHJpYnV0aW9uLnRvb2xTdWl0ZS50b29scyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIC8vIFNraXAgY2FwYWJpbGl0aWVzIHRoYXQgZmFpbCB0byBjcmVhdGUgdG9vbHNcbiAgICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBjcmVhdGUgdG9vbHMgZm9yIGNhcGFiaWxpdHkgJHtpZH06YCwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEFkZCB1bmlmaWVkIHRvb2xzIHRoYXQgYnJpZGdlIGNhcGFiaWxpdGllc1xuICAgIHRvb2xzLnB1c2goLi4udGhpcy5jcmVhdGVVbmlmaWVkQnJpZGdlVG9vbHMoKSk7XG4gICAgXG4gICAgcmV0dXJuIHRvb2xzO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVVbmlmaWVkQnJpZGdlVG9vbHMoKTogYW55W10ge1xuICAgIHJldHVybiBbXG4gICAgICBTaGFyZWRVdGlsaXRpZXMuY3JlYXRlVG9vbERlZmluaXRpb24oXG4gICAgICAgICd1bmlmaWVkX2V4ZWN1dGUnLFxuICAgICAgICAnRXhlY3V0ZSBvcGVyYXRpb24gYWNyb3NzIGFsbCBpbnRlZ3JhdGVkIGNhcGFiaWxpdGllcycsXG4gICAgICAgIHtcbiAgICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBvcGVyYXRpb246IHsgdHlwZTogJ3N0cmluZycsIGRlc2NyaXB0aW9uOiAnT3BlcmF0aW9uIHRvIGV4ZWN1dGUnIH0sXG4gICAgICAgICAgICBwYXJhbWV0ZXJzOiB7IHR5cGU6ICdvYmplY3QnLCBkZXNjcmlwdGlvbjogJ09wZXJhdGlvbiBwYXJhbWV0ZXJzJyB9LFxuICAgICAgICAgICAgdGFyZ2V0X2NhcGFiaWxpdGllczogeyBcbiAgICAgICAgICAgICAgdHlwZTogJ2FycmF5JywgXG4gICAgICAgICAgICAgIGl0ZW1zOiB7IHR5cGU6ICdzdHJpbmcnIH0sXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnU3BlY2lmaWMgY2FwYWJpbGl0aWVzIHRvIHRhcmdldCAoZW1wdHkgZm9yIGFsbCknXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXF1aXJlZDogWydvcGVyYXRpb24nXVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoYXJnczogeyBvcGVyYXRpb246IHN0cmluZzsgcGFyYW1ldGVyczogYW55OyB0YXJnZXRfY2FwYWJpbGl0aWVzPzogc3RyaW5nW10gfSkgPT4ge1xuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmV4ZWN1dGVVbmlmaWVkT3BlcmF0aW9uKGFyZ3Mub3BlcmF0aW9uLCBhcmdzLnBhcmFtZXRlcnMsIGFyZ3MudGFyZ2V0X2NhcGFiaWxpdGllcyk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBTaGFyZWRVdGlsaXRpZXMuY3JlYXRlVG9vbERlZmluaXRpb24oXG4gICAgICAgICdsaXN0X2ludGVncmF0ZWRfY2FwYWJpbGl0aWVzJyxcbiAgICAgICAgJ0xpc3QgYWxsIGNhcGFiaWxpdGllcyBpbnRlZ3JhdGVkIGludG8gdW5pZmllZCBmcmFtZXdvcmsnLFxuICAgICAgICB7XG4gICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgZGV0YWlsZWQ6IHsgdHlwZTogJ2Jvb2xlYW4nLCBkZXNjcmlwdGlvbjogJ1Nob3cgZGV0YWlsZWQgaW5mb3JtYXRpb24nLCBkZWZhdWx0OiBmYWxzZSB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBhc3luYyAoYXJnczogeyBkZXRhaWxlZDogYm9vbGVhbiB9KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMubGlzdEludGVncmF0ZWRDYXBhYmlsaXRpZXMoYXJncy5kZXRhaWxlZCk7XG4gICAgICAgIH1cbiAgICAgICksXG4gICAgICBTaGFyZWRVdGlsaXRpZXMuY3JlYXRlVG9vbERlZmluaXRpb24oXG4gICAgICAgICdmcmFtZXdvcmtfc3RhdHVzJyxcbiAgICAgICAgJ0dldCBzdGF0dXMgb2YgdW5pZmllZCBmcmFtZXdvcmsgYW5kIGludGVncmF0ZWQgY2FwYWJpbGl0aWVzJyxcbiAgICAgICAge30sXG4gICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGcmFtZXdvcmtTdGF0dXMoKTtcbiAgICAgICAgfVxuICAgICAgKVxuICAgIF07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGV4ZWN1dGVVbmlmaWVkT3BlcmF0aW9uKFxuICAgIG9wZXJhdGlvbjogc3RyaW5nLCBcbiAgICBwYXJhbWV0ZXJzOiBhbnksIFxuICAgIHRhcmdldENhcGFiaWxpdGllcz86IHN0cmluZ1tdXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLmZyYW1ld29yaykge1xuICAgICAgcmV0dXJuICdVbmlmaWVkIGZyYW1ld29yayBub3QgaW5pdGlhbGl6ZWQnO1xuICAgIH1cblxuICAgIGNvbnN0IGNhcGFiaWxpdGllcyA9IHRhcmdldENhcGFiaWxpdGllcyB8fCBBcnJheS5mcm9tKHRoaXMuY2FwYWJpbGl0aWVzLmtleXMoKSk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCB0aGlzLmZyYW1ld29yay5leGVjdXRlT3BlcmF0aW9uKFxuICAgICAgICBvcGVyYXRpb24sXG4gICAgICAgIHBhcmFtZXRlcnMsXG4gICAgICAgIGNhcGFiaWxpdGllc1xuICAgICAgKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICByZXN1bHRzLFxuICAgICAgICBjYXBhYmlsaXRpZXNfZXhlY3V0ZWQ6IGNhcGFiaWxpdGllc1xuICAgICAgfSwgbnVsbCwgMik7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG9wZXJhdGlvbixcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIGNhcGFiaWxpdGllc19hdHRlbXB0ZWQ6IGNhcGFiaWxpdGllc1xuICAgICAgfSwgbnVsbCwgMik7XG4gICAgfVxuICB9XG5cbiAgbGlzdEludGVncmF0ZWRDYXBhYmlsaXRpZXMoZGV0YWlsZWQ6IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgIGNvbnN0IGNhcGFiaWxpdGllczogYW55W10gPSBbXTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IFtpZCwgY2FwYWJpbGl0eV0gb2YgdGhpcy5jYXBhYmlsaXRpZXMpIHtcbiAgICAgIGNvbnN0IGNhcEluZm86IGFueSA9IHtcbiAgICAgICAgaWQ6IGNhcGFiaWxpdHkuaWQsXG4gICAgICAgIG1ldGFkYXRhOiBjYXBhYmlsaXR5Lm1ldGFkYXRhXG4gICAgICB9O1xuICAgICAgXG4gICAgICBpZiAoZGV0YWlsZWQpIHtcbiAgICAgICAgY2FwSW5mby5zdGF0dXMgPSAnaW50ZWdyYXRlZCc7XG4gICAgICAgIGNhcEluZm8ucHJvdmlkZXMgPSBjYXBhYmlsaXR5Lm1ldGFkYXRhLnByb3ZpZGVzO1xuICAgICAgICBjYXBJbmZvLmRlcGVuZGVuY2llcyA9IGNhcGFiaWxpdHkubWV0YWRhdGEuZGVwZW5kZW5jaWVzO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjYXBhYmlsaXRpZXMucHVzaChjYXBJbmZvKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGRldGFpbGVkKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBmcmFtZXdvcms6IHRoaXMuZnJhbWV3b3JrID8gJ2FjdGl2ZScgOiAnaW5hY3RpdmUnLFxuICAgICAgICBjYXBhYmlsaXRpZXNfaW50ZWdyYXRlZDogY2FwYWJpbGl0aWVzLmxlbmd0aCxcbiAgICAgICAgY2FwYWJpbGl0aWVzOiBjYXBhYmlsaXRpZXNcbiAgICAgIH0sIG51bGwsIDIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY2FwYWJpbGl0aWVzLm1hcChjID0+IGMuaWQpLmpvaW4oJ1xcbicpO1xuICAgIH1cbiAgfVxuXG4gIGdldEZyYW1ld29ya1N0YXR1cygpOiBzdHJpbmcge1xuICAgIGNvbnN0IHN0YXR1cyA9IHtcbiAgICAgIHVuaWZpZWRfZnJhbWV3b3JrOiB0aGlzLmZyYW1ld29yayA/IHtcbiAgICAgICAgaW5pdGlhbGl6ZWQ6IHRydWUsXG4gICAgICAgIGNhcGFiaWxpdGllc19yZWdpc3RlcmVkOiB0aGlzLmNhcGFiaWxpdGllcy5zaXplLFxuICAgICAgICBjb25maWc6IHRoaXMuZnJhbWV3b3JrLmdldENvbmZpZygpXG4gICAgICB9IDoge1xuICAgICAgICBpbml0aWFsaXplZDogZmFsc2VcbiAgICAgIH0sXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGVuYWJsZVVuaXZlcnNhbEZyYW1ld29yazogdGhpcy5vcHRpb25zLmVuYWJsZVVuaXZlcnNhbEZyYW1ld29yayxcbiAgICAgICAgZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzOiB0aGlzLm9wdGlvbnMuZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzLFxuICAgICAgICBlbmFibGVNaWxpdGFyeUludGVncmF0aW9uOiB0aGlzLm9wdGlvbnMuZW5hYmxlTWlsaXRhcnlJbnRlZ3JhdGlvbixcbiAgICAgICAgZW5hYmxlQ3Jvc3NNb2R1bGVDb21tdW5pY2F0aW9uOiB0aGlzLm9wdGlvbnMuZW5hYmxlQ3Jvc3NNb2R1bGVDb21tdW5pY2F0aW9uXG4gICAgICB9LFxuICAgICAgY2FwYWJpbGl0aWVzOiBBcnJheS5mcm9tKHRoaXMuY2FwYWJpbGl0aWVzLmtleXMoKSlcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShzdGF0dXMsIG51bGwsIDIpO1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZShwYXJhbXM6IHtcbiAgICBvcGVyYXRpb246IHN0cmluZztcbiAgICBwYXJhbWV0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICAgIG9wZXJhdGlvbklkPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBvcElkID0gcGFyYW1zLm9wZXJhdGlvbklkIHx8IFNoYXJlZFV0aWxpdGllcy5nZW5lcmF0ZU9wZXJhdGlvbklkKCd1bmlmaWVkJyk7XG4gICAgXG4gICAgc3dpdGNoIChwYXJhbXMub3BlcmF0aW9uKSB7XG4gICAgICBjYXNlICdmcmFtZXdvcmtfc3RhdHVzJzpcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5nZXRGcmFtZXdvcmtTdGF0dXMoKSk7XG4gICAgICBjYXNlICdsaXN0X2NhcGFiaWxpdGllcyc6XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMubGlzdEludGVncmF0ZWRDYXBhYmlsaXRpZXModHJ1ZSkpO1xuICAgICAgY2FzZSAnZXhlY3V0ZV91bmlmaWVkJzpcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZVVuaWZpZWRPcGVyYXRpb24oXG4gICAgICAgICAgcGFyYW1zLnBhcmFtZXRlcnMub3BlcmF0aW9uLFxuICAgICAgICAgIHBhcmFtcy5wYXJhbWV0ZXJzLnBhcmFtZXRlcnMsXG4gICAgICAgICAgcGFyYW1zLnBhcmFtZXRlcnMudGFyZ2V0X2NhcGFiaWxpdGllc1xuICAgICAgICApO1xuICAgICAgY2FzZSAnYWN0aXZhdGVfY2FwYWJpbGl0eSc6XG4gICAgICAgIGlmICghdGhpcy5mcmFtZXdvcmspIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZyYW1ld29yayBub3QgaW5pdGlhbGl6ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5mcmFtZXdvcmsuYWN0aXZhdGVDYXBhYmlsaXR5KHBhcmFtcy5wYXJhbWV0ZXJzLmNhcGFiaWxpdHlfaWQpO1xuICAgICAgY2FzZSAnY3Jvc3NfY2FwYWJpbGl0eV9vcGVyYXRpb24nOlxuICAgICAgICBpZiAoIXRoaXMuZnJhbWV3b3JrKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGcmFtZXdvcmsgbm90IGluaXRpYWxpemVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZnJhbWV3b3JrLmV4ZWN1dGVPcGVyYXRpb24oXG4gICAgICAgICAgcGFyYW1zLnBhcmFtZXRlcnMub3BlcmF0aW9uLFxuICAgICAgICAgIHBhcmFtcy5wYXJhbWV0ZXJzLnBhcmFtZXRlcnMsXG4gICAgICAgICAgcGFyYW1zLnBhcmFtZXRlcnMuY2FwYWJpbGl0aWVzXG4gICAgICAgICk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gdW5pZmllZCBvcGVyYXRpb246ICR7cGFyYW1zLm9wZXJhdGlvbn1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTGVnYWN5IGNvbXBhdGliaWxpdHkgbWV0aG9kIHRvIGludGVncmF0ZSB3aXRoIGV4aXN0aW5nIG1pbGl0YXJ5IG1vZHVsZXNcbiAgICovXG4gIGludGVncmF0ZU1pbGl0YXJ5TW9kdWxlcygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMub3B0aW9ucy5lbmFibGVNaWxpdGFyeUludGVncmF0aW9uKSByZXR1cm47XG5cbiAgICBjb25zdCBtaWxpdGFyeU1vZHVsZXMgPSBbXG4gICAgICB7IG1vZHVsZTogRWxpdGVDcnlwdG9NaWxpdGFyeUNhcGFiaWxpdHlNb2R1bGUsIG5hbWU6ICdlbGl0ZS1jcnlwdG8nIH0sXG4gICAgICB7IG1vZHVsZTogVW5pZmllZE1pbGl0YXJ5Q2FwYWJpbGl0eU1vZHVsZSwgbmFtZTogJ3VuaWZpZWQtbWlsaXRhcnknIH0sXG4gICAgICB7IG1vZHVsZTogVW5pdmVyc2FsU2VjdXJpdHlDYXBhYmlsaXR5TW9kdWxlLCBuYW1lOiAndW5pdmVyc2FsLXNlY3VyaXR5JyB9LFxuICAgICAgeyBtb2R1bGU6IE1heE9mZmVuc2l2ZVVrcmFpbmVDYXBhYmlsaXR5TW9kdWxlLCBuYW1lOiAnbWF4LW9mZmVuc2l2ZS11a3JhaW5lJyB9LFxuICAgICAgeyBtb2R1bGU6IE9mZmVuc2l2ZURlc3RydWN0aW9uQ2FwYWJpbGl0eU1vZHVsZSwgbmFtZTogJ29mZmVuc2l2ZS1kZXN0cnVjdGlvbicgfVxuICAgIF07XG5cbiAgICBmb3IgKGNvbnN0IHsgbW9kdWxlOiBNb2R1bGVDbGFzcywgbmFtZSB9IG9mIG1pbGl0YXJ5TW9kdWxlcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWlsaXRhcnlNb2R1bGUgPSBuZXcgTW9kdWxlQ2xhc3Moe1xuICAgICAgICAgIHdvcmtpbmdEaXI6IHRoaXMub3B0aW9ucy53b3JraW5nRGlyLFxuICAgICAgICAgIGRlYnVnOiB0aGlzLm9wdGlvbnMuZGVidWcsXG4gICAgICAgICAgZW5hYmxlRXZpZGVuY2U6IHRoaXMub3B0aW9ucy5lbmFibGVFdmlkZW5jZSxcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLm9wdGlvbnMuYXV0aG9yaXphdGlvbixcbiAgICAgICAgICBlbWVyZ2VuY3lPdmVycmlkZTogdGhpcy5vcHRpb25zLmVtZXJnZW5jeU92ZXJyaWRlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY2FwYWJpbGl0aWVzLnNldChuYW1lLCBtaWxpdGFyeU1vZHVsZSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWxlZCB0byBpbnRlZ3JhdGUgbWlsaXRhcnkgbW9kdWxlICR7bmFtZX06YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHVuaXZlcnNhbCBmcmFtZXdvcmsgaW5zdGFuY2UgKGZvciBhZHZhbmNlZCBpbnRlZ3JhdGlvbilcbiAgICovXG4gIGdldEZyYW1ld29yaygpOiBVbml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZnJhbWV3b3JrO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgaW50ZWdyYXRlZCBjYXBhYmlsaXRpZXNcbiAgICovXG4gIGdldENhcGFiaWxpdGllcygpOiBNYXA8c3RyaW5nLCBhbnk+IHtcbiAgICByZXR1cm4gbmV3IE1hcCh0aGlzLmNhcGFiaWxpdGllcyk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHNwZWNpZmljIGNhcGFiaWxpdHkgYnkgSURcbiAgICovXG4gIGdldENhcGFiaWxpdHkoY2FwYWJpbGl0eUlkOiBzdHJpbmcpOiBhbnkgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jYXBhYmlsaXRpZXMuZ2V0KGNhcGFiaWxpdHlJZCkgfHwgbnVsbDtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTSU1QTElGSUVEIElOVEVHUkFUSU9OIEZPUiBDTEkgVVNBR0Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBTaW1wbGlmaWVkIHVuaWZpZWQgY2FwYWJpbGl0eSBmb3IgQ0xJIHVzYWdlXG4gKiBQcm92aWRlcyBhIHNpbmdsZSBlbnRyeSBwb2ludCB0byBhbGwgQUdJIGNhcGFiaWxpdGllc1xuICovXG5leHBvcnQgY2xhc3MgU2ltcGxpZmllZFVuaWZpZWRDYXBhYmlsaXR5IHtcbiAgcHJpdmF0ZSBpbnRlZ3JhdGVkTW9kdWxlOiBJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlNb2R1bGU7XG4gIHByaXZhdGUgZnJhbWV3b3JrOiBVbml2ZXJzYWxDYXBhYmlsaXR5RnJhbWV3b3JrIHwgbnVsbCA9IG51bGw7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogUGFydGlhbDxJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlPcHRpb25zPiA9IHt9KSB7XG4gICAgdGhpcy5pbnRlZ3JhdGVkTW9kdWxlID0gbmV3IEludGVncmF0ZWRVbmlmaWVkQ2FwYWJpbGl0eU1vZHVsZShvcHRpb25zKTtcbiAgICB0aGlzLmZyYW1ld29yayA9IHRoaXMuaW50ZWdyYXRlZE1vZHVsZS5nZXRGcmFtZXdvcmsoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBRdWljayBzdGFydCB1bmlmaWVkIGNhcGFiaWxpdGllc1xuICAgKi9cbiAgc3RhdGljIHF1aWNrU3RhcnQod29ya2luZ0Rpcj86IHN0cmluZyk6IFNpbXBsaWZpZWRVbmlmaWVkQ2FwYWJpbGl0eSB7XG4gICAgcmV0dXJuIG5ldyBTaW1wbGlmaWVkVW5pZmllZENhcGFiaWxpdHkoe1xuICAgICAgd29ya2luZ0Rpcjogd29ya2luZ0RpciB8fCBwcm9jZXNzLmN3ZCgpLFxuICAgICAgZW5hYmxlVW5pdmVyc2FsRnJhbWV3b3JrOiB0cnVlLFxuICAgICAgZW5hYmxlUmVhZG1lQ2FwYWJpbGl0aWVzOiB0cnVlLFxuICAgICAgZW5hYmxlTWlsaXRhcnlJbnRlZ3JhdGlvbjogdHJ1ZSxcbiAgICAgIGVuYWJsZUNyb3NzTW9kdWxlQ29tbXVuaWNhdGlvbjogdHJ1ZSxcbiAgICAgIGRlYnVnOiBmYWxzZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgYSBjb21tYW5kIHVzaW5nIHVuaWZpZWQgY2FwYWJpbGl0aWVzXG4gICAqL1xuICBhc3luYyBleGVjdXRlQ29tbWFuZChjb21tYW5kOiBzdHJpbmcsIGFyZ3M6IGFueSA9IHt9KTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoIXRoaXMuZnJhbWV3b3JrKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuaWZpZWQgZnJhbWV3b3JrIG5vdCBpbml0aWFsaXplZCcpO1xuICAgIH1cblxuICAgIC8vIFBhcnNlIGNvbW1hbmQgYW5kIHJvdXRlIHRvIGFwcHJvcHJpYXRlIGNhcGFiaWxpdHlcbiAgICBjb25zdCBbb3BlcmF0aW9uLCAuLi5wYXJhbXNdID0gY29tbWFuZC5zcGxpdCgnICcpO1xuICAgIFxuICAgIHJldHVybiBhd2FpdCB0aGlzLmludGVncmF0ZWRNb2R1bGUuZXhlY3V0ZSh7XG4gICAgICBvcGVyYXRpb24sXG4gICAgICBwYXJhbWV0ZXJzOiB7IC4uLmFyZ3MsIHJhd1BhcmFtczogcGFyYW1zIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMaXN0IGF2YWlsYWJsZSBjYXBhYmlsaXRpZXNcbiAgICovXG4gIGxpc3RDYXBhYmlsaXRpZXMoZGV0YWlsZWQ6IGJvb2xlYW4gPSBmYWxzZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuaW50ZWdyYXRlZE1vZHVsZS5saXN0SW50ZWdyYXRlZENhcGFiaWxpdGllcyhkZXRhaWxlZCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGZyYW1ld29yayBzdGF0dXNcbiAgICovXG4gIGdldFN0YXR1cygpOiBhbnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMuaW50ZWdyYXRlZE1vZHVsZS5nZXRGcmFtZXdvcmtTdGF0dXMoKSk7XG4gIH1cblxuICAvKipcbiAgICogUnVuIGEgY3Jvc3MtY2FwYWJpbGl0eSBvcGVyYXRpb25cbiAgICovXG4gIGFzeW5jIHJ1bk9wZXJhdGlvbihvcGVyYXRpb246IHN0cmluZywgcGFyYW1ldGVyczogYW55LCBjYXBhYmlsaXRpZXM/OiBzdHJpbmdbXSk6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKCF0aGlzLmZyYW1ld29yaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmlmaWVkIGZyYW1ld29yayBub3QgaW5pdGlhbGl6ZWQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5mcmFtZXdvcmsuZXhlY3V0ZU9wZXJhdGlvbihcbiAgICAgIG9wZXJhdGlvbixcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBjYXBhYmlsaXRpZXMgfHwgQXJyYXkuZnJvbSh0aGlzLmludGVncmF0ZWRNb2R1bGUuZ2V0Q2FwYWJpbGl0aWVzKCkua2V5cygpKVxuICAgICk7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVhQT1JUU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZGVmYXVsdCBJbnRlZ3JhdGVkVW5pZmllZENhcGFiaWxpdHlNb2R1bGU7XG5cbi8vIE5vdGU6IFNpbXBsaWZpZWRVbmlmaWVkQ2FwYWJpbGl0eSBpcyBhbHJlYWR5IGV4cG9ydGVkIGF0IGl0cyBkZWZpbml0aW9uIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFXQSxJQUFBQSxlQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyw2QkFBQSxHQUFBRCxPQUFBO0FBSUEsSUFBQUUsa0JBQUEsR0FBQUYsT0FBQTtBQWVBLElBQUFHLDhCQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSwwQkFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssNEJBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLDhCQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTywrQkFBQSxHQUFBUCxPQUFBO0FBR0Es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SCxjQUFjQSxDQUFDQyxPQUFlLEVBQUUzRCxJQUFTLEdBQUcsQ0FBQyxDQUFDLEVBQWdCO0lBQ2xFLElBQUksQ0FBQyxJQUFJLENBQUM1RSxTQUFTLEVBQUU7TUFDbkIsTUFBTSxJQUFJK0csS0FBSyxDQUFDLG1DQUFtQyxDQUFDO0lBQ3REOztJQUVBO0lBQ0EsTUFBTSxDQUFDeEMsU0FBUyxFQUFFLEdBQUdtQyxNQUFNLENBQUMsR0FBRzZCLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLEdBQUcsQ0FBQztJQUVqRCxPQUFPLE1BQU0sSUFBSSxDQUFDSixnQkFBZ0IsQ0FBQzNCLE9BQU8sQ0FBQztNQUN6Q2xDLFNBQVM7TUFDVEMsVUFBVSxFQUFFO1FBQUUsR0FBR0ksSUFBSTtRQUFFNkQsU0FBUyxFQUFFL0I7TUFBTztJQUMzQyxDQUFDLENBQUM7RUFDSjs7RUFFQTtBQUNGO0FBQ0E7RUFDRWdDLGdCQUFnQkEsQ0FBQzVELFFBQWlCLEdBQUcsS0FBSyxFQUFVO0lBQ2xELE9BQU8sSUFBSSxDQUFDc0QsZ0JBQWdCLENBQUNwRCwwQkFBMEIsQ0FBQ0YsUUFBUSxDQUFDO0VBQ25FOztFQUVBO0FBQ0Y7QUFDQTtFQUNFNkQsU0FBU0EsQ0FBQSxFQUFRO0lBQ2YsT0FBT3RELElBQUksQ0FBQ3lCLEtBQUssQ0FBQyxJQUFJLENBQUNzQixnQkFBZ0IsQ0FBQ25ELGtCQUFrQixDQUFDLENBQUMsQ0FBQztFQUMvRDs7RUFFQTtBQUNGO0FBQ0E7RUFDRSxNQUFNMkQsWUFBWUEsQ0FBQ3JFLFNBQWlCLEVBQUVDLFVBQWUsRUFBRXZFLFlBQXVCLEVBQWdCO0lBQzVGLElBQUksQ0FBQyxJQUFJLENBQUNELFNBQVMsRUFBRTtNQUNuQixNQUFNLElBQUkrRyxLQUFLLENBQUMsbUNBQW1DLENBQUM7SUFDdEQ7SUFFQSxPQUFPLE1BQU0sSUFBSSxDQUFDL0csU0FBUyxDQUFDb0YsZ0JBQWdCLENBQzFDYixTQUFTLEVBQ1RDLFVBQVUsRUFDVnZFLFlBQVksSUFBSXlELEtBQUssQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQ3lFLGdCQUFnQixDQUFDTixlQUFlLENBQUMsQ0FBQyxDQUFDbEUsSUFBSSxDQUFDLENBQUMsQ0FDM0UsQ0FBQztFQUNIO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQUFzRSxPQUFBLENBQUFDLDJCQUFBLEdBQUFBLDJCQUFBO0FBQUEsSUFBQVUsUUFBQSxHQUFBWCxPQUFBLENBQUFuRCxPQUFBLEdBRWVsRixpQ0FBaUMsRUFFaEQiLCJpZ25vcmVMaXN0IjpbXX0=
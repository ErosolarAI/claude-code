{"version":3,"names":["cov_20yqe8kbcq","actualCoverage","isToolSuccess","response","f","s","type","isToolError","isToolWarning","isToolProgress","isOk","result","ok","isErr","value","err","error","unwrap","b","unwrapOr","defaultValue","map","fn","mapErr"],"sources":["types.ts"],"sourcesContent":["/**\n * AI Provider identifier for multi-provider support\n */\nexport type ProviderId = string;\n\n/**\n * Reasoning effort levels for AI model optimization\n */\nexport type ReasoningEffortLevel = 'low' | 'medium' | 'high';\n\n/**\n * Text verbosity levels for output control\n */\nexport type TextVerbosityLevel = 'low' | 'medium' | 'high';\n\n/**\n * Thinking budget configuration for reasoning models\n * Controls how much reasoning/thinking the model performs\n */\nexport interface ThinkingBudgetConfig {\n  /** Enable extended thinking mode */\n  readonly enabled: boolean;\n  /** Maximum tokens for thinking/reasoning (provider-specific ranges apply) */\n  readonly budgetTokens?: number;\n}\n\n/**\n * Thinking level for models that support discrete thinking intensities\n */\nexport type ThinkingLevel = 'low' | 'medium' | 'high';\n\n/**\n * Conversation roles in AI message flow\n */\nexport type ConversationRole = 'system' | 'user' | 'assistant' | 'tool';\n\nexport interface SystemMessage {\n  role: 'system';\n  content: string;\n}\n\nexport interface UserMessage {\n  role: 'user';\n  content: string;\n}\n\nexport interface ToolCallArguments {\n  [key: string]: unknown;\n}\n\nexport interface ToolCallRequest {\n  id: string;\n  name: string;\n  arguments: ToolCallArguments;\n}\n\nexport interface AssistantMessage {\n  role: 'assistant';\n  content: string;\n  toolCalls?: ToolCallRequest[];\n}\n\nexport interface ToolMessage {\n  role: 'tool';\n  name: string;\n  content: string;\n  toolCallId: string;\n}\n\n/**\n * Enhanced discriminated union for type-safe tool responses\n * Provides comprehensive error handling and metadata tracking\n */\nexport interface ToolSuccessResponse {\n  readonly type: 'success';\n  readonly content: string;\n  readonly metadata?: {\n    readonly linesRead?: number;\n    readonly fileSize?: number;\n    readonly executionTime?: number;\n    readonly cacheHit?: boolean;\n    readonly toolName?: string;\n    readonly timestamp?: number;\n  };\n}\n\n/**\n * Structured error response with recovery guidance\n */\nexport interface ToolErrorResponse {\n  readonly type: 'error';\n  readonly error: {\n    readonly code: string;\n    readonly message: string;\n    readonly details?: Readonly<Record<string, unknown>>;\n    readonly suggestion?: string;\n    readonly recoverable: boolean;\n    readonly toolName?: string;\n  };\n}\n\n/**\n * Warning response with actionable suggestions\n */\nexport interface ToolWarningResponse {\n  readonly type: 'warning';\n  readonly content: string;\n  readonly warnings: ReadonlyArray<{\n    readonly code: string;\n    readonly message: string;\n    readonly severity: 'critical' | 'warning' | 'info';\n    readonly suggestion: string;\n  }>;\n}\n\n/**\n * Progress update for long-running operations\n */\nexport interface ToolProgressResponse {\n  readonly type: 'progress';\n  readonly progress: number;\n  readonly message: string;\n  readonly metadata?: {\n    readonly estimatedRemaining?: number;\n    readonly currentStep?: string;\n  };\n}\n\n/**\n * Comprehensive tool response union for AI flow control\n */\nexport type ToolResponse = \n  | ToolSuccessResponse \n  | ToolErrorResponse \n  | ToolWarningResponse\n  | ToolProgressResponse;\n\n/**\n * Type guard for successful tool responses\n */\nexport function isToolSuccess(response: ToolResponse): response is ToolSuccessResponse {\n  return response.type === 'success';\n}\n\n/**\n * Type guard for error tool responses\n */\nexport function isToolError(response: ToolResponse): response is ToolErrorResponse {\n  return response.type === 'error';\n}\n\n/**\n * Type guard for warning tool responses\n */\nexport function isToolWarning(response: ToolResponse): response is ToolWarningResponse {\n  return response.type === 'warning';\n}\n\n/**\n * Type guard for progress tool responses\n */\nexport function isToolProgress(response: ToolResponse): response is ToolProgressResponse {\n  return response.type === 'progress';\n}\n\nexport type ConversationMessage = SystemMessage | UserMessage | AssistantMessage | ToolMessage;\n\n/**\n * Base interface for all JSON Schema property definitions\n */\nexport interface JSONSchemaPropertyBase {\n  readonly description?: string;\n  readonly nullable?: boolean;\n  readonly deprecated?: boolean;\n  readonly readOnly?: boolean;\n  readonly writeOnly?: boolean;\n}\n\n/**\n * String schema with validation constraints\n */\nexport interface JSONSchemaString extends JSONSchemaPropertyBase {\n  readonly type: 'string';\n  readonly enum?: ReadonlyArray<string>;\n  readonly minLength?: number;\n  readonly maxLength?: number;\n  readonly pattern?: string;\n  readonly format?: 'date-time' | 'email' | 'uri' | 'uuid' | 'hostname';\n  readonly default?: string;\n}\n\n/**\n * Number schema with validation constraints\n */\nexport interface JSONSchemaNumber extends JSONSchemaPropertyBase {\n  readonly type: 'number';\n  readonly minimum?: number;\n  readonly maximum?: number;\n  readonly exclusiveMinimum?: number;\n  readonly exclusiveMaximum?: number;\n  readonly multipleOf?: number;\n  readonly default?: number;\n}\n\n/**\n * Boolean schema\n */\nexport interface JSONSchemaBoolean extends JSONSchemaPropertyBase {\n  readonly type: 'boolean';\n  readonly default?: boolean;\n}\n\n/**\n * Array schema with item validation\n */\nexport interface JSONSchemaArray extends JSONSchemaPropertyBase {\n  readonly type: 'array';\n  readonly items: JSONSchemaProperty;\n  readonly minItems?: number;\n  readonly maxItems?: number;\n  readonly uniqueItems?: boolean;\n}\n\n/**\n * Union type for all JSON Schema property types\n */\nexport type JSONSchemaProperty =\n  | JSONSchemaString\n  | JSONSchemaNumber\n  | JSONSchemaBoolean\n  | JSONSchemaArray\n  | JSONSchemaObject;\n\n/**\n * Object schema with property validation\n */\nexport interface JSONSchemaObject extends JSONSchemaPropertyBase {\n  readonly type: 'object';\n  readonly properties?: Readonly<Record<string, JSONSchemaProperty>>;\n  readonly required?: ReadonlyArray<string>;\n  readonly additionalProperties?: boolean;\n  readonly minProperties?: number;\n  readonly maxProperties?: number;\n}\n\n/**\n * Definition of a tool available to AI providers\n */\nexport interface ProviderToolDefinition {\n  readonly name: string;\n  readonly description: string;\n  readonly parameters?: JSONSchemaObject;\n}\n\n/**\n * Token usage statistics from AI provider\n */\nexport interface ProviderUsage {\n  readonly inputTokens?: number;\n  readonly outputTokens?: number;\n  readonly totalTokens?: number;\n}\n\n/**\n * Why the model stopped generating - critical for agentic loop control\n */\nexport type StopReason = 'end_turn' | 'tool_use' | 'max_tokens' | 'stop_sequence';\n\n/**\n * Base interface for all provider responses\n */\nexport interface ProviderResponseBase {\n  readonly usage?: ProviderUsage | null;\n  /** Why the model stopped - determines if auto-continuation is needed */\n  readonly stopReason?: StopReason;\n}\n\n/**\n * Discriminated union for provider responses\n */\nexport type ProviderResponse =\n  | (ProviderResponseBase & {\n      readonly type: 'message';\n      readonly content: string;\n    })\n  | (ProviderResponseBase & {\n      readonly type: 'tool_calls';\n      readonly toolCalls: ToolCallRequest[];\n      readonly content?: string;\n    });\n\n/**\n * Streaming chunk for real-time AI responses\n */\nexport interface StreamChunk {\n  readonly type: 'content' | 'reasoning' | 'tool_call' | 'usage' | 'done';\n  readonly content?: string;\n  readonly toolCall?: ToolCallRequest;\n  readonly usage?: ProviderUsage;\n  /** Stop reason from the final message - included with 'done' chunk */\n  readonly stopReason?: StopReason;\n}\n\n/**\n * AI Provider interface for multi-provider support\n */\nexport interface LLMProvider {\n  readonly id: ProviderId;\n  readonly model: string;\n  generate(messages: ConversationMessage[], tools: ProviderToolDefinition[]): Promise<ProviderResponse>;\n  generateStream?(messages: ConversationMessage[], tools: ProviderToolDefinition[]): AsyncIterableIterator<StreamChunk>;\n  getCapabilities?(): ProviderCapabilities;\n  /** Fetch model info from the provider API (context window, limits, etc.) */\n  getModelInfo?(): Promise<ProviderModelInfo | null>;\n}\n\n/**\n * Model information retrieved from the provider API\n */\nexport interface ProviderModelInfo {\n  readonly id: string;\n  readonly contextWindow: number;\n  readonly maxOutputTokens?: number;\n  readonly inputTokenLimit?: number;\n  readonly outputTokenLimit?: number;\n}\n\n/**\n * Capabilities of an AI provider\n */\nexport interface ProviderCapabilities {\n  readonly streaming: boolean;\n  readonly toolCalling: boolean;\n  readonly vision: boolean;\n  readonly functionCalling: boolean;\n  readonly maxTokens: number;\n  readonly supportedModalities: ReadonlyArray<'text' | 'image' | 'audio'>;\n  /** Context window size from provider API (undefined if not yet fetched) */\n  readonly contextWindow?: number;\n}\n\n/**\n * Type-safe Result pattern for error handling\n * Eliminates the need for try-catch blocks and provides compile-time safety\n */\nexport type Result<T, E = Error> = \n  | { readonly ok: true; readonly value: T }\n  | { readonly ok: false; readonly error: E };\n\n/**\n * Type guard for successful Result\n */\nexport function isOk<T, E>(result: Result<T, E>): result is { readonly ok: true; readonly value: T } {\n  return result.ok;\n}\n\n/**\n * Type guard for failed Result\n */\nexport function isErr<T, E>(result: Result<T, E>): result is { readonly ok: false; readonly error: E } {\n  return !result.ok;\n}\n\n/**\n * Creates a successful Result\n */\nexport function ok<T>(value: T): Result<T, never> {\n  return { ok: true, value };\n}\n\n/**\n * Creates a failed Result\n */\nexport function err<E>(error: E): Result<never, E> {\n  return { ok: false, error };\n}\n\n/**\n * Unwraps a Result, throwing if it's an error\n */\nexport function unwrap<T, E>(result: Result<T, E>): T {\n  if (result.ok) {\n    return result.value;\n  }\n  throw (result as { ok: false; error: E }).error;\n}\n\n/**\n * Unwraps a Result, returning a default value if it's an error\n */\nexport function unwrapOr<T, E>(result: Result<T, E>, defaultValue: T): T {\n  return result.ok ? result.value : defaultValue;\n}\n\n/**\n * Maps a successful Result to a new value\n */\nexport function map<T, U, E>(result: Result<T, E>, fn: (value: T) => U): Result<U, E> {\n  return result.ok ? { ok: true, value: fn(result.value) } : result as Result<U, E>;\n}\n\n/**\n * Maps an error Result to a new error\n */\nexport function mapErr<T, E, F>(result: Result<T, E>, fn: (error: E) => F): Result<T, F> {\n  return result.ok ? result as unknown as Result<T, F> : { ok: false, error: fn((result as { ok: false; error: E }).error) };\n}\n"],"mappings":"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","ignoreList":[]}
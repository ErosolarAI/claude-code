1be58eac381caa9fae1757d764447079
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TTLCache = exports.RateLimiter = exports.ConcurrencyPool = void 0;
exports.debounce = debounce;
exports.default = void 0;
exports.memoize = memoize;
exports.parallelMap = parallelMap;
exports.retry = retry;
exports.sleep = sleep;
exports.throttle = throttle;
exports.withTimeout = withTimeout;
/**
 * Async Utilities Module
 *
 * Production-ready async patterns for rate limiting, throttling,
 * concurrency control, and caching with TTL.
 *
 * Principal Investigator: Bo Shang
 * Framework: agi-cli
 */

// ============================================================================
// Types
// ============================================================================

// ============================================================================
// Rate Limiter (Token Bucket)
// ============================================================================

class RateLimiter {
  constructor(config) {
    this.maxTokens = config.maxRequests;
    this.tokens = config.maxRequests;
    this.refillRate = config.maxRequests / config.windowMs;
    this.lastRefill = Date.now();
  }
  refill() {
    const now = Date.now();
    const elapsed = now - this.lastRefill;
    const tokensToAdd = elapsed * this.refillRate;
    this.tokens = Math.min(this.maxTokens, this.tokens + tokensToAdd);
    this.lastRefill = now;
  }
  async acquire() {
    this.refill();
    if (this.tokens >= 1) {
      this.tokens -= 1;
      return;
    }

    // Wait for a token to become available
    const waitTime = (1 - this.tokens) / this.refillRate;
    await sleep(waitTime);
    this.refill();
    this.tokens -= 1;
  }
  tryAcquire() {
    this.refill();
    if (this.tokens >= 1) {
      this.tokens -= 1;
      return true;
    }
    return false;
  }
  get availableTokens() {
    this.refill();
    return Math.floor(this.tokens);
  }
}

// ============================================================================
// Throttle & Debounce
// ============================================================================
exports.RateLimiter = RateLimiter;
function throttle(fn, config) {
  let lastCall = 0;
  let lastResult;
  let pendingCall = null;
  let pendingArgs = null;
  const {
    intervalMs,
    leading = true,
    trailing = true
  } = config;
  return function throttled(...args) {
    const now = Date.now();
    const elapsed = now - lastCall;
    if (elapsed >= intervalMs) {
      // Enough time has passed
      if (leading || lastCall !== 0) {
        lastCall = now;
        lastResult = fn(...args);
        return lastResult;
      }
    }

    // Store args for potential trailing call
    if (trailing) {
      pendingArgs = args;
      if (!pendingCall) {
        pendingCall = setTimeout(() => {
          if (pendingArgs) {
            lastCall = Date.now();
            lastResult = fn(...pendingArgs);
            pendingArgs = null;
          }
          pendingCall = null;
        }, intervalMs - elapsed);
      }
    }
    return lastResult;
  };
}
function debounce(fn, delayMs) {
  let timeoutId = null;
  return function debounced(...args) {
    if (timeoutId) {
      clearTimeout(timeoutId);
    }
    timeoutId = setTimeout(() => {
      fn(...args);
      timeoutId = null;
    }, delayMs);
  };
}

// ============================================================================
// TTL Cache
// ============================================================================

class TTLCache {
  cache = new Map();
  constructor(config) {
    this.ttlMs = config.ttlMs;
    this.maxSize = config.maxSize ?? Infinity;
  }
  get(key) {
    const entry = this.cache.get(key);
    if (!entry) return undefined;
    if (Date.now() > entry.expiresAt) {
      this.cache.delete(key);
      return undefined;
    }
    return entry.value;
  }
  set(key, value, ttlMs) {
    // Evict oldest if at capacity
    if (this.cache.size >= this.maxSize && !this.cache.has(key)) {
      const oldestKey = this.cache.keys().next().value;
      if (oldestKey !== undefined) {
        this.cache.delete(oldestKey);
      }
    }
    this.cache.set(key, {
      value,
      expiresAt: Date.now() + (ttlMs ?? this.ttlMs)
    });
  }
  has(key) {
    return this.get(key) !== undefined;
  }
  delete(key) {
    return this.cache.delete(key);
  }
  clear() {
    this.cache.clear();
  }
  get size() {
    this.prune();
    return this.cache.size;
  }
  prune() {
    const now = Date.now();
    const keysToDelete = [];
    this.cache.forEach((entry, key) => {
      if (now > entry.expiresAt) {
        keysToDelete.push(key);
      }
    });
    keysToDelete.forEach(key => this.cache.delete(key));
  }
}

// ============================================================================
// Memoize with TTL
// ============================================================================
exports.TTLCache = TTLCache;
function memoize(fn, config) {
  const cache = new TTLCache(config);
  const keyFn = config.keyFn ?? ((...args) => JSON.stringify(args));
  return function memoized(...args) {
    const key = keyFn(...args);
    const cached = cache.get(key);
    if (cached !== undefined) {
      return cached;
    }
    const result = fn(...args);
    cache.set(key, result);
    return result;
  };
}

// ============================================================================
// Concurrency Pool
// ============================================================================

class ConcurrencyPool {
  running = 0;
  queue = [];
  constructor(config) {
    this.maxConcurrent = config.maxConcurrent;
    this.timeout = config.timeout;
  }
  async run(fn) {
    await this.acquire();
    try {
      if (this.timeout) {
        return await withTimeout(fn(), this.timeout);
      }
      return await fn();
    } finally {
      this.release();
    }
  }
  async acquire() {
    if (this.running < this.maxConcurrent) {
      this.running++;
      return;
    }
    return new Promise((resolve, reject) => {
      this.queue.push({
        resolve,
        reject
      });
    });
  }
  release() {
    this.running--;
    const next = this.queue.shift();
    if (next) {
      this.running++;
      next.resolve();
    }
  }
  get pending() {
    return this.queue.length;
  }
  get active() {
    return this.running;
  }
}

// ============================================================================
// Parallel Map with Concurrency Limit
// ============================================================================
exports.ConcurrencyPool = ConcurrencyPool;
async function parallelMap(items, fn, concurrency = 5) {
  const pool = new ConcurrencyPool({
    maxConcurrent: concurrency
  });
  return Promise.all(items.map((item, index) => pool.run(() => fn(item, index))));
}

// ============================================================================
// Utility Functions
// ============================================================================

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
async function withTimeout(promise, timeoutMs, errorMessage = 'Operation timed out') {
  let timeoutId;
  const timeoutPromise = new Promise((_, reject) => {
    timeoutId = setTimeout(() => reject(new Error(errorMessage)), timeoutMs);
  });
  try {
    return await Promise.race([promise, timeoutPromise]);
  } finally {
    clearTimeout(timeoutId);
  }
}
async function retry(fn, config = {}) {
  const {
    maxRetries = 3,
    baseDelayMs = 1000,
    maxDelayMs = 30000,
    backoffMultiplier = 2,
    shouldRetry = () => true
  } = config;
  let lastError;
  for (let attempt = 0; attempt <= maxRetries; attempt++) {
    try {
      return await fn();
    } catch (error) {
      lastError = error;
      if (attempt === maxRetries || !shouldRetry(error)) {
        throw error;
      }
      const delay = Math.min(baseDelayMs * Math.pow(backoffMultiplier, attempt), maxDelayMs);
      await sleep(delay);
    }
  }
  throw lastError;
}

// ============================================================================
// Exports
// ============================================================================
var _default = exports.default = {
  RateLimiter,
  TTLCache,
  ConcurrencyPool,
  throttle,
  debounce,
  memoize,
  parallelMap,
  sleep,
  withTimeout,
  retry
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSYXRlTGltaXRlciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwibWF4VG9rZW5zIiwibWF4UmVxdWVzdHMiLCJ0b2tlbnMiLCJyZWZpbGxSYXRlIiwid2luZG93TXMiLCJsYXN0UmVmaWxsIiwiRGF0ZSIsIm5vdyIsInJlZmlsbCIsImVsYXBzZWQiLCJ0b2tlbnNUb0FkZCIsIk1hdGgiLCJtaW4iLCJhY3F1aXJlIiwid2FpdFRpbWUiLCJzbGVlcCIsInRyeUFjcXVpcmUiLCJhdmFpbGFibGVUb2tlbnMiLCJmbG9vciIsImV4cG9ydHMiLCJ0aHJvdHRsZSIsImZuIiwibGFzdENhbGwiLCJsYXN0UmVzdWx0IiwicGVuZGluZ0NhbGwiLCJwZW5kaW5nQXJncyIsImludGVydmFsTXMiLCJsZWFkaW5nIiwidHJhaWxpbmciLCJ0aHJvdHRsZWQiLCJhcmdzIiwic2V0VGltZW91dCIsImRlYm91bmNlIiwiZGVsYXlNcyIsInRpbWVvdXRJZCIsImRlYm91bmNlZCIsImNsZWFyVGltZW91dCIsIlRUTENhY2hlIiwiY2FjaGUiLCJNYXAiLCJ0dGxNcyIsIm1heFNpemUiLCJJbmZpbml0eSIsImdldCIsImtleSIsImVudHJ5IiwidW5kZWZpbmVkIiwiZXhwaXJlc0F0IiwiZGVsZXRlIiwidmFsdWUiLCJzZXQiLCJzaXplIiwiaGFzIiwib2xkZXN0S2V5Iiwia2V5cyIsIm5leHQiLCJjbGVhciIsInBydW5lIiwia2V5c1RvRGVsZXRlIiwiZm9yRWFjaCIsInB1c2giLCJtZW1vaXplIiwia2V5Rm4iLCJKU09OIiwic3RyaW5naWZ5IiwibWVtb2l6ZWQiLCJjYWNoZWQiLCJyZXN1bHQiLCJDb25jdXJyZW5jeVBvb2wiLCJydW5uaW5nIiwicXVldWUiLCJtYXhDb25jdXJyZW50IiwidGltZW91dCIsInJ1biIsIndpdGhUaW1lb3V0IiwicmVsZWFzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic2hpZnQiLCJwZW5kaW5nIiwibGVuZ3RoIiwiYWN0aXZlIiwicGFyYWxsZWxNYXAiLCJpdGVtcyIsImNvbmN1cnJlbmN5IiwicG9vbCIsImFsbCIsIm1hcCIsIml0ZW0iLCJpbmRleCIsIm1zIiwicHJvbWlzZSIsInRpbWVvdXRNcyIsImVycm9yTWVzc2FnZSIsInRpbWVvdXRQcm9taXNlIiwiXyIsIkVycm9yIiwicmFjZSIsInJldHJ5IiwibWF4UmV0cmllcyIsImJhc2VEZWxheU1zIiwibWF4RGVsYXlNcyIsImJhY2tvZmZNdWx0aXBsaWVyIiwic2hvdWxkUmV0cnkiLCJsYXN0RXJyb3IiLCJhdHRlbXB0IiwiZXJyb3IiLCJkZWxheSIsInBvdyIsIl9kZWZhdWx0IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbImFzeW5jVXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBc3luYyBVdGlsaXRpZXMgTW9kdWxlXG4gKlxuICogUHJvZHVjdGlvbi1yZWFkeSBhc3luYyBwYXR0ZXJucyBmb3IgcmF0ZSBsaW1pdGluZywgdGhyb3R0bGluZyxcbiAqIGNvbmN1cnJlbmN5IGNvbnRyb2wsIGFuZCBjYWNoaW5nIHdpdGggVFRMLlxuICpcbiAqIFByaW5jaXBhbCBJbnZlc3RpZ2F0b3I6IEJvIFNoYW5nXG4gKiBGcmFtZXdvcms6IGFnaS1jbGlcbiAqL1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUeXBlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIFJhdGVMaW1pdGVyQ29uZmlnIHtcbiAgbWF4UmVxdWVzdHM6IG51bWJlcjtcbiAgd2luZG93TXM6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaHJvdHRsZUNvbmZpZyB7XG4gIGludGVydmFsTXM6IG51bWJlcjtcbiAgbGVhZGluZz86IGJvb2xlYW47XG4gIHRyYWlsaW5nPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYWNoZUVudHJ5PFQ+IHtcbiAgdmFsdWU6IFQ7XG4gIGV4cGlyZXNBdDogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlQ29uZmlnIHtcbiAgdHRsTXM6IG51bWJlcjtcbiAgbWF4U2l6ZT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25jdXJyZW5jeUNvbmZpZyB7XG4gIG1heENvbmN1cnJlbnQ6IG51bWJlcjtcbiAgdGltZW91dD86IG51bWJlcjtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUmF0ZSBMaW1pdGVyIChUb2tlbiBCdWNrZXQpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBSYXRlTGltaXRlciB7XG4gIHByaXZhdGUgdG9rZW5zOiBudW1iZXI7XG4gIHByaXZhdGUgbGFzdFJlZmlsbDogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IG1heFRva2VuczogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IHJlZmlsbFJhdGU6IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IFJhdGVMaW1pdGVyQ29uZmlnKSB7XG4gICAgdGhpcy5tYXhUb2tlbnMgPSBjb25maWcubWF4UmVxdWVzdHM7XG4gICAgdGhpcy50b2tlbnMgPSBjb25maWcubWF4UmVxdWVzdHM7XG4gICAgdGhpcy5yZWZpbGxSYXRlID0gY29uZmlnLm1heFJlcXVlc3RzIC8gY29uZmlnLndpbmRvd01zO1xuICAgIHRoaXMubGFzdFJlZmlsbCA9IERhdGUubm93KCk7XG4gIH1cblxuICBwcml2YXRlIHJlZmlsbCgpOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSB0aGlzLmxhc3RSZWZpbGw7XG4gICAgY29uc3QgdG9rZW5zVG9BZGQgPSBlbGFwc2VkICogdGhpcy5yZWZpbGxSYXRlO1xuICAgIHRoaXMudG9rZW5zID0gTWF0aC5taW4odGhpcy5tYXhUb2tlbnMsIHRoaXMudG9rZW5zICsgdG9rZW5zVG9BZGQpO1xuICAgIHRoaXMubGFzdFJlZmlsbCA9IG5vdztcbiAgfVxuXG4gIGFzeW5jIGFjcXVpcmUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5yZWZpbGwoKTtcblxuICAgIGlmICh0aGlzLnRva2VucyA+PSAxKSB7XG4gICAgICB0aGlzLnRva2VucyAtPSAxO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFdhaXQgZm9yIGEgdG9rZW4gdG8gYmVjb21lIGF2YWlsYWJsZVxuICAgIGNvbnN0IHdhaXRUaW1lID0gKDEgLSB0aGlzLnRva2VucykgLyB0aGlzLnJlZmlsbFJhdGU7XG4gICAgYXdhaXQgc2xlZXAod2FpdFRpbWUpO1xuICAgIHRoaXMucmVmaWxsKCk7XG4gICAgdGhpcy50b2tlbnMgLT0gMTtcbiAgfVxuXG4gIHRyeUFjcXVpcmUoKTogYm9vbGVhbiB7XG4gICAgdGhpcy5yZWZpbGwoKTtcbiAgICBpZiAodGhpcy50b2tlbnMgPj0gMSkge1xuICAgICAgdGhpcy50b2tlbnMgLT0gMTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBnZXQgYXZhaWxhYmxlVG9rZW5zKCk6IG51bWJlciB7XG4gICAgdGhpcy5yZWZpbGwoKTtcbiAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLnRva2Vucyk7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVGhyb3R0bGUgJiBEZWJvdW5jZVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZnVuY3Rpb24gdGhyb3R0bGU8VCBleHRlbmRzICguLi5hcmdzOiB1bmtub3duW10pID0+IHVua25vd24+KFxuICBmbjogVCxcbiAgY29uZmlnOiBUaHJvdHRsZUNvbmZpZ1xuKTogKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pID0+IFJldHVyblR5cGU8VD4gfCB1bmRlZmluZWQge1xuICBsZXQgbGFzdENhbGwgPSAwO1xuICBsZXQgbGFzdFJlc3VsdDogUmV0dXJuVHlwZTxUPiB8IHVuZGVmaW5lZDtcbiAgbGV0IHBlbmRpbmdDYWxsOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuICBsZXQgcGVuZGluZ0FyZ3M6IFBhcmFtZXRlcnM8VD4gfCBudWxsID0gbnVsbDtcblxuICBjb25zdCB7IGludGVydmFsTXMsIGxlYWRpbmcgPSB0cnVlLCB0cmFpbGluZyA9IHRydWUgfSA9IGNvbmZpZztcblxuICByZXR1cm4gZnVuY3Rpb24gdGhyb3R0bGVkKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pOiBSZXR1cm5UeXBlPFQ+IHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSBsYXN0Q2FsbDtcblxuICAgIGlmIChlbGFwc2VkID49IGludGVydmFsTXMpIHtcbiAgICAgIC8vIEVub3VnaCB0aW1lIGhhcyBwYXNzZWRcbiAgICAgIGlmIChsZWFkaW5nIHx8IGxhc3RDYWxsICE9PSAwKSB7XG4gICAgICAgIGxhc3RDYWxsID0gbm93O1xuICAgICAgICBsYXN0UmVzdWx0ID0gZm4oLi4uYXJncykgYXMgUmV0dXJuVHlwZTxUPjtcbiAgICAgICAgcmV0dXJuIGxhc3RSZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3RvcmUgYXJncyBmb3IgcG90ZW50aWFsIHRyYWlsaW5nIGNhbGxcbiAgICBpZiAodHJhaWxpbmcpIHtcbiAgICAgIHBlbmRpbmdBcmdzID0gYXJncztcblxuICAgICAgaWYgKCFwZW5kaW5nQ2FsbCkge1xuICAgICAgICBwZW5kaW5nQ2FsbCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmIChwZW5kaW5nQXJncykge1xuICAgICAgICAgICAgbGFzdENhbGwgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgbGFzdFJlc3VsdCA9IGZuKC4uLnBlbmRpbmdBcmdzKSBhcyBSZXR1cm5UeXBlPFQ+O1xuICAgICAgICAgICAgcGVuZGluZ0FyZ3MgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwZW5kaW5nQ2FsbCA9IG51bGw7XG4gICAgICAgIH0sIGludGVydmFsTXMgLSBlbGFwc2VkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGFzdFJlc3VsdDtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlPFQgZXh0ZW5kcyAoLi4uYXJnczogdW5rbm93bltdKSA9PiB1bmtub3duPihcbiAgZm46IFQsXG4gIGRlbGF5TXM6IG51bWJlclxuKTogKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pID0+IHZvaWQge1xuICBsZXQgdGltZW91dElkOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuXG4gIHJldHVybiBmdW5jdGlvbiBkZWJvdW5jZWQoLi4uYXJnczogUGFyYW1ldGVyczxUPik6IHZvaWQge1xuICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgIH1cbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgdGltZW91dElkID0gbnVsbDtcbiAgICB9LCBkZWxheU1zKTtcbiAgfTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVFRMIENhY2hlXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBUVExDYWNoZTxLLCBWPiB7XG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPEssIENhY2hlRW50cnk8Vj4+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgdHRsTXM6IG51bWJlcjtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhTaXplOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBDYWNoZUNvbmZpZykge1xuICAgIHRoaXMudHRsTXMgPSBjb25maWcudHRsTXM7XG4gICAgdGhpcy5tYXhTaXplID0gY29uZmlnLm1heFNpemUgPz8gSW5maW5pdHk7XG4gIH1cblxuICBnZXQoa2V5OiBLKTogViB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgZW50cnkgPSB0aGlzLmNhY2hlLmdldChrZXkpO1xuICAgIGlmICghZW50cnkpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICBpZiAoRGF0ZS5ub3coKSA+IGVudHJ5LmV4cGlyZXNBdCkge1xuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVudHJ5LnZhbHVlO1xuICB9XG5cbiAgc2V0KGtleTogSywgdmFsdWU6IFYsIHR0bE1zPzogbnVtYmVyKTogdm9pZCB7XG4gICAgLy8gRXZpY3Qgb2xkZXN0IGlmIGF0IGNhcGFjaXR5XG4gICAgaWYgKHRoaXMuY2FjaGUuc2l6ZSA+PSB0aGlzLm1heFNpemUgJiYgIXRoaXMuY2FjaGUuaGFzKGtleSkpIHtcbiAgICAgIGNvbnN0IG9sZGVzdEtleSA9IHRoaXMuY2FjaGUua2V5cygpLm5leHQoKS52YWx1ZTtcbiAgICAgIGlmIChvbGRlc3RLZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmNhY2hlLmRlbGV0ZShvbGRlc3RLZXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY2FjaGUuc2V0KGtleSwge1xuICAgICAgdmFsdWUsXG4gICAgICBleHBpcmVzQXQ6IERhdGUubm93KCkgKyAodHRsTXMgPz8gdGhpcy50dGxNcyksXG4gICAgfSk7XG4gIH1cblxuICBoYXMoa2V5OiBLKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGtleSkgIT09IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGRlbGV0ZShrZXk6IEspOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcbiAgfVxuXG4gIGNsZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcbiAgfVxuXG4gIGdldCBzaXplKCk6IG51bWJlciB7XG4gICAgdGhpcy5wcnVuZSgpO1xuICAgIHJldHVybiB0aGlzLmNhY2hlLnNpemU7XG4gIH1cblxuICBwcml2YXRlIHBydW5lKCk6IHZvaWQge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3Qga2V5c1RvRGVsZXRlOiBLW10gPSBbXTtcbiAgICB0aGlzLmNhY2hlLmZvckVhY2goKGVudHJ5LCBrZXkpID0+IHtcbiAgICAgIGlmIChub3cgPiBlbnRyeS5leHBpcmVzQXQpIHtcbiAgICAgICAga2V5c1RvRGVsZXRlLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBrZXlzVG9EZWxldGUuZm9yRWFjaChrZXkgPT4gdGhpcy5jYWNoZS5kZWxldGUoa2V5KSk7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTWVtb2l6ZSB3aXRoIFRUTFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZnVuY3Rpb24gbWVtb2l6ZTxUIGV4dGVuZHMgKC4uLmFyZ3M6IHVua25vd25bXSkgPT4gdW5rbm93bj4oXG4gIGZuOiBULFxuICBjb25maWc6IENhY2hlQ29uZmlnICYgeyBrZXlGbj86ICguLi5hcmdzOiBQYXJhbWV0ZXJzPFQ+KSA9PiBzdHJpbmcgfVxuKTogVCB7XG4gIGNvbnN0IGNhY2hlID0gbmV3IFRUTENhY2hlPHN0cmluZywgUmV0dXJuVHlwZTxUPj4oY29uZmlnKTtcbiAgY29uc3Qga2V5Rm4gPSBjb25maWcua2V5Rm4gPz8gKCguLi5hcmdzKSA9PiBKU09OLnN0cmluZ2lmeShhcmdzKSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9pemVkKC4uLmFyZ3M6IFBhcmFtZXRlcnM8VD4pOiBSZXR1cm5UeXBlPFQ+IHtcbiAgICBjb25zdCBrZXkgPSBrZXlGbiguLi5hcmdzKTtcbiAgICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXQoa2V5KTtcblxuICAgIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBmbiguLi5hcmdzKSBhcyBSZXR1cm5UeXBlPFQ+O1xuICAgIGNhY2hlLnNldChrZXksIHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSBhcyBUO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDb25jdXJyZW5jeSBQb29sXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjbGFzcyBDb25jdXJyZW5jeVBvb2wge1xuICBwcml2YXRlIHJ1bm5pbmcgPSAwO1xuICBwcml2YXRlIHF1ZXVlOiBBcnJheTx7IHJlc29sdmU6ICgpID0+IHZvaWQ7IHJlamVjdDogKGVycjogRXJyb3IpID0+IHZvaWQgfT4gPSBbXTtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhDb25jdXJyZW50OiBudW1iZXI7XG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZW91dDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQ29uY3VycmVuY3lDb25maWcpIHtcbiAgICB0aGlzLm1heENvbmN1cnJlbnQgPSBjb25maWcubWF4Q29uY3VycmVudDtcbiAgICB0aGlzLnRpbWVvdXQgPSBjb25maWcudGltZW91dDtcbiAgfVxuXG4gIGFzeW5jIHJ1bjxUPihmbjogKCkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8VD4ge1xuICAgIGF3YWl0IHRoaXMuYWNxdWlyZSgpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHdpdGhUaW1lb3V0KGZuKCksIHRoaXMudGltZW91dCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXdhaXQgZm4oKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5yZWxlYXNlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBhY3F1aXJlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLnJ1bm5pbmcgPCB0aGlzLm1heENvbmN1cnJlbnQpIHtcbiAgICAgIHRoaXMucnVubmluZysrO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLnF1ZXVlLnB1c2goeyByZXNvbHZlLCByZWplY3QgfSk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlbGVhc2UoKTogdm9pZCB7XG4gICAgdGhpcy5ydW5uaW5nLS07XG4gICAgY29uc3QgbmV4dCA9IHRoaXMucXVldWUuc2hpZnQoKTtcbiAgICBpZiAobmV4dCkge1xuICAgICAgdGhpcy5ydW5uaW5nKys7XG4gICAgICBuZXh0LnJlc29sdmUoKTtcbiAgICB9XG4gIH1cblxuICBnZXQgcGVuZGluZygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnF1ZXVlLmxlbmd0aDtcbiAgfVxuXG4gIGdldCBhY3RpdmUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5ydW5uaW5nO1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBhcmFsbGVsIE1hcCB3aXRoIENvbmN1cnJlbmN5IExpbWl0XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXJhbGxlbE1hcDxULCBSPihcbiAgaXRlbXM6IFRbXSxcbiAgZm46IChpdGVtOiBULCBpbmRleDogbnVtYmVyKSA9PiBQcm9taXNlPFI+LFxuICBjb25jdXJyZW5jeTogbnVtYmVyID0gNVxuKTogUHJvbWlzZTxSW10+IHtcbiAgY29uc3QgcG9vbCA9IG5ldyBDb25jdXJyZW5jeVBvb2woeyBtYXhDb25jdXJyZW50OiBjb25jdXJyZW5jeSB9KTtcbiAgcmV0dXJuIFByb21pc2UuYWxsKFxuICAgIGl0ZW1zLm1hcCgoaXRlbSwgaW5kZXgpID0+IHBvb2wucnVuKCgpID0+IGZuKGl0ZW0sIGluZGV4KSkpXG4gICk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFV0aWxpdHkgRnVuY3Rpb25zXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBmdW5jdGlvbiBzbGVlcChtczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdpdGhUaW1lb3V0PFQ+KFxuICBwcm9taXNlOiBQcm9taXNlPFQ+LFxuICB0aW1lb3V0TXM6IG51bWJlcixcbiAgZXJyb3JNZXNzYWdlID0gJ09wZXJhdGlvbiB0aW1lZCBvdXQnXG4pOiBQcm9taXNlPFQ+IHtcbiAgbGV0IHRpbWVvdXRJZDogTm9kZUpTLlRpbWVvdXQ7XG5cbiAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4ge1xuICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gcmVqZWN0KG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpKSwgdGltZW91dE1zKTtcbiAgfSk7XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yYWNlKFtwcm9taXNlLCB0aW1lb3V0UHJvbWlzZV0pO1xuICB9IGZpbmFsbHkge1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQhKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmV0cnk8VD4oXG4gIGZuOiAoKSA9PiBQcm9taXNlPFQ+LFxuICBjb25maWc6IHtcbiAgICBtYXhSZXRyaWVzPzogbnVtYmVyO1xuICAgIGJhc2VEZWxheU1zPzogbnVtYmVyO1xuICAgIG1heERlbGF5TXM/OiBudW1iZXI7XG4gICAgYmFja29mZk11bHRpcGxpZXI/OiBudW1iZXI7XG4gICAgc2hvdWxkUmV0cnk/OiAoZXJyb3I6IHVua25vd24pID0+IGJvb2xlYW47XG4gIH0gPSB7fVxuKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IHtcbiAgICBtYXhSZXRyaWVzID0gMyxcbiAgICBiYXNlRGVsYXlNcyA9IDEwMDAsXG4gICAgbWF4RGVsYXlNcyA9IDMwMDAwLFxuICAgIGJhY2tvZmZNdWx0aXBsaWVyID0gMixcbiAgICBzaG91bGRSZXRyeSA9ICgpID0+IHRydWUsXG4gIH0gPSBjb25maWc7XG5cbiAgbGV0IGxhc3RFcnJvcjogdW5rbm93bjtcblxuICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8PSBtYXhSZXRyaWVzOyBhdHRlbXB0KyspIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGZuKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxhc3RFcnJvciA9IGVycm9yO1xuXG4gICAgICBpZiAoYXR0ZW1wdCA9PT0gbWF4UmV0cmllcyB8fCAhc2hvdWxkUmV0cnkoZXJyb3IpKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkZWxheSA9IE1hdGgubWluKFxuICAgICAgICBiYXNlRGVsYXlNcyAqIE1hdGgucG93KGJhY2tvZmZNdWx0aXBsaWVyLCBhdHRlbXB0KSxcbiAgICAgICAgbWF4RGVsYXlNc1xuICAgICAgKTtcbiAgICAgIGF3YWl0IHNsZWVwKGRlbGF5KTtcbiAgICB9XG4gIH1cblxuICB0aHJvdyBsYXN0RXJyb3I7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEV4cG9ydHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBSYXRlTGltaXRlcixcbiAgVFRMQ2FjaGUsXG4gIENvbmN1cnJlbmN5UG9vbCxcbiAgdGhyb3R0bGUsXG4gIGRlYm91bmNlLFxuICBtZW1vaXplLFxuICBwYXJhbGxlbE1hcCxcbiAgc2xlZXAsXG4gIHdpdGhUaW1lb3V0LFxuICByZXRyeSxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7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
{"version":3,"names":["_tournamentStrategy","require","moduleBase","id","label","description","scope","steps","moduleWithLabel","describe","it","cfg","buildEvaluatorConfig","expect","rewardWeights","alpha","toBeCloseTo","evaluators","find","e","weight","toBeGreaterThan","telemetry","Map","set","winsPrimary","winsRefiner","beta","toBeGreaterThanOrEqual"],"sources":["tournamentStrategy.test.ts"],"sourcesContent":["import { buildEvaluatorConfig, type TelemetrySnapshot } from '../../src/core/tournamentStrategy.js';\nimport type { RepoUpgradeModule } from '../../src/core/repoUpgradeOrchestrator.js';\n\nconst moduleBase: RepoUpgradeModule = {\n  id: 'm',\n  label: 'Module',\n  description: '',\n  scope: [],\n  steps: [],\n};\n\nfunction moduleWithLabel(label: string, scope: string[]): RepoUpgradeModule {\n  return { ...moduleBase, label, scope };\n}\n\ndescribe('buildEvaluatorConfig', () => {\n  it('applies repo-type defaults for tests', () => {\n    const cfg = buildEvaluatorConfig(moduleWithLabel('Tests', ['test/**/*']));\n    expect(cfg.rewardWeights.alpha).toBeCloseTo(0.7);\n    expect(cfg.evaluators.find((e) => e.id === 'hard-metrics')?.weight).toBeGreaterThan(1.5);\n  });\n\n  it('applies telemetry bias towards primary (hard metric focus)', () => {\n    const telemetry = new Map<string, TelemetrySnapshot>();\n    telemetry.set('general', { winsPrimary: 10, winsRefiner: 0 });\n\n    const cfg = buildEvaluatorConfig(moduleWithLabel('General', ['src/**/*']), telemetry);\n    expect(cfg.rewardWeights.alpha).toBeGreaterThan(0.6);\n  });\n\n  it('applies telemetry bias towards refiner (quality/reward focus)', () => {\n    const telemetry = new Map<string, TelemetrySnapshot>();\n    telemetry.set('general', { winsPrimary: 0, winsRefiner: 10 });\n\n    const cfg = buildEvaluatorConfig(moduleWithLabel('General', ['src/**/*']), telemetry);\n    expect(cfg.rewardWeights.beta).toBeGreaterThanOrEqual(0.3);\n    expect(cfg.evaluators.find((e) => e.id === 'quality')?.weight).toBeGreaterThan(1.0);\n  });\n});\n"],"mappings":";;AAAA,IAAAA,mBAAA,GAAAC,OAAA;AAGA,MAAMC,UAA6B,GAAG;EACpCC,EAAE,EAAE,GAAG;EACPC,KAAK,EAAE,QAAQ;EACfC,WAAW,EAAE,EAAE;EACfC,KAAK,EAAE,EAAE;EACTC,KAAK,EAAE;AACT,CAAC;AAED,SAASC,eAAeA,CAACJ,KAAa,EAAEE,KAAe,EAAqB;EAC1E,OAAO;IAAE,GAAGJ,UAAU;IAAEE,KAAK;IAAEE;EAAM,CAAC;AACxC;AAEAG,QAAQ,CAAC,sBAAsB,EAAE,MAAM;EACrCC,EAAE,CAAC,sCAAsC,EAAE,MAAM;IAC/C,MAAMC,GAAG,GAAG,IAAAC,wCAAoB,EAACJ,eAAe,CAAC,OAAO,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;IACzEK,MAAM,CAACF,GAAG,CAACG,aAAa,CAACC,KAAK,CAAC,CAACC,WAAW,CAAC,GAAG,CAAC;IAChDH,MAAM,CAACF,GAAG,CAACM,UAAU,CAACC,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAAChB,EAAE,KAAK,cAAc,CAAC,EAAEiB,MAAM,CAAC,CAACC,eAAe,CAAC,GAAG,CAAC;EAC1F,CAAC,CAAC;EAEFX,EAAE,CAAC,4DAA4D,EAAE,MAAM;IACrE,MAAMY,SAAS,GAAG,IAAIC,GAAG,CAA4B,CAAC;IACtDD,SAAS,CAACE,GAAG,CAAC,SAAS,EAAE;MAAEC,WAAW,EAAE,EAAE;MAAEC,WAAW,EAAE;IAAE,CAAC,CAAC;IAE7D,MAAMf,GAAG,GAAG,IAAAC,wCAAoB,EAACJ,eAAe,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,CAAC,EAAEc,SAAS,CAAC;IACrFT,MAAM,CAACF,GAAG,CAACG,aAAa,CAACC,KAAK,CAAC,CAACM,eAAe,CAAC,GAAG,CAAC;EACtD,CAAC,CAAC;EAEFX,EAAE,CAAC,+DAA+D,EAAE,MAAM;IACxE,MAAMY,SAAS,GAAG,IAAIC,GAAG,CAA4B,CAAC;IACtDD,SAAS,CAACE,GAAG,CAAC,SAAS,EAAE;MAAEC,WAAW,EAAE,CAAC;MAAEC,WAAW,EAAE;IAAG,CAAC,CAAC;IAE7D,MAAMf,GAAG,GAAG,IAAAC,wCAAoB,EAACJ,eAAe,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,CAAC,EAAEc,SAAS,CAAC;IACrFT,MAAM,CAACF,GAAG,CAACG,aAAa,CAACa,IAAI,CAAC,CAACC,sBAAsB,CAAC,GAAG,CAAC;IAC1Df,MAAM,CAACF,GAAG,CAACM,UAAU,CAACC,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAAChB,EAAE,KAAK,SAAS,CAAC,EAAEiB,MAAM,CAAC,CAACC,eAAe,CAAC,GAAG,CAAC;EACrF,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}
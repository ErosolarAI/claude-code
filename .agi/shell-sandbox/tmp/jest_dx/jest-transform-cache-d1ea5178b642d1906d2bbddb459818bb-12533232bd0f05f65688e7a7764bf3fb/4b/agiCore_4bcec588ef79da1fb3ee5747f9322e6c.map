{"version":3,"names":["fs","_interopRequireWildcard","require","path","_events","_episodicMemory","_selfUpgrade","_hotReload","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","AGICore","EventEmitter","currentEpisodeId","upgradeCheckPromise","constructor","workingDir","dir","process","cwd","memoryPath","join","context","sessionId","Date","now","Math","random","toString","slice","startTime","memory","loadMemory","episodicMemory","getEpisodicMemory","selfUpgrade","getSelfUpgrade","autoRestart","logger","msg","emit","hotReload","getHotReload","autoCheck","checkInterval","on","event","checkForUpgradeOnStart","analyzeProject","versionInfo","checkForUpdates","updateAvailable","current","latest","existsSync","data","readFileSync","JSON","parse","createEmptyMemory","patterns","recentOps","projectKnowledge","type","buildSystem","testCommand","lintCommand","entryPoints","dependencies","lastAnalyzed","saveMemory","dirname","mkdirSync","recursive","writeFileSync","stringify","error","learnFromSuccess","prompt","approach","tools","existingPattern","find","p","normalizePrompt","trigger","successCount","lastUsed","successfulApproach","push","id","sort","a","b","recordOperation","op","unshift","getLearnedApproach","normalized","promptSimilarity","toLowerCase","trim","replace","wordsA","Set","split","wordsB","intersection","filter","x","union","size","knowledge","packageJsonPath","pkg","devDependencies","scripts","test","lint","build","main","analyzePrompt","lower","learned","createFromLearnedPattern","intent","determineIntent","category","determineCategory","tasks","generateTasks","clarificationNeeded","checkAmbiguity","originalPrompt","interpretation","generateInterpretation","confidence","length","mapping","interpretations","description","status","questions","pattern","map","tool","generateToolCalls","analysis","calls","task","includes","args","command","taskId","output_mode","file_path","getContext","getProjectKnowledge","getRecentOperations","limit","getLearnedPatterns","refreshProjectKnowledge","startEpisode","recordEpisodeToolUse","toolName","recordToolUse","recordEpisodeFileModification","filePath","recordFileModification","endEpisode","success","summary","episode","abortEpisode","searchMemory","query","options","search","successOnly","since","getEpisodicApproach","getApproach","successRate","getRecentEpisodes","getEpisodicMemoryStats","getStats","hasActiveEpisode","getCurrentEpisodeId","info","available","performSelfUpgrade","preserveSession","sessionState","fromVersion","timestamp","pendingTasks","contextSummary","rlContext","iteration","variant","objective","currentScore","filesModified","saveSessionState","result","npmInstallFresh","version","toVersion","performVerifiedUpgrade","upgradeWithFullVerification","buildCommand","buildSuccess","testsPassed","testState","passed","testsFailed","failed","triggerHotReload","activeEdits","undefined","performHotReload","preserveState","resumeFromUpgrade","state","loadSessionState","clearSessionState","wasUpgraded","SelfUpgrade","getUpgradeFromVersion","exports","agiInstance","getAGI","resetAGI"],"sources":["agiCore.ts"],"sourcesContent":["/**\n * AGI Core - Unified Autonomous General Intelligence for Software Engineering\n *\n * This is the central intelligence module that provides:\n * 1. Unified prompt understanding and routing\n * 2. Real task decomposition and planning\n * 3. Persistent learning and memory\n * 4. Autonomous execution with verification\n *\n * NO SIMULATIONS - All operations execute real tools\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { EventEmitter } from 'events';\nimport { getEpisodicMemory, type EpisodicMemory, type Episode, type MemorySearchResult } from './episodicMemory.js';\nimport { getSelfUpgrade, SelfUpgrade, type UpgradeSessionState, type RLUpgradeContext } from './selfUpgrade.js';\nimport { getHotReload, HotReload } from './hotReload.js';\n\n// ============================================================================\n// CORE TYPES\n// ============================================================================\n\nexport interface AGIContext {\n  workingDir: string;\n  sessionId: string;\n  startTime: number;\n  memory: AGIMemory;\n}\n\nexport interface AGIMemory {\n  /** Learned patterns from successful operations */\n  patterns: LearnedPattern[];\n  /** Recent operations for context */\n  recentOps: OperationRecord[];\n  /** Project-specific knowledge */\n  projectKnowledge: ProjectKnowledge;\n}\n\nexport interface LearnedPattern {\n  id: string;\n  trigger: string;\n  successfulApproach: string;\n  tools: string[];\n  successCount: number;\n  lastUsed: number;\n}\n\nexport interface OperationRecord {\n  id: string;\n  prompt: string;\n  interpretation: string;\n  tasks: string[];\n  success: boolean;\n  timestamp: number;\n  duration: number;\n  toolsUsed: string[];\n  errors?: string[];\n}\n\nexport interface ProjectKnowledge {\n  type: 'node' | 'python' | 'rust' | 'go' | 'java' | 'unknown';\n  buildSystem: string | null;\n  testCommand: string | null;\n  lintCommand: string | null;\n  entryPoints: string[];\n  dependencies: Record<string, string>;\n  lastAnalyzed: number;\n}\n\n// ============================================================================\n// TASK TYPES\n// ============================================================================\n\nexport interface AGITask {\n  id: string;\n  description: string;\n  category: TaskCategory;\n  tools: string[];\n  dependencies: string[];\n  status: 'pending' | 'in_progress' | 'completed' | 'failed' | 'skipped';\n  result?: TaskResult;\n}\n\nexport type TaskCategory =\n  | 'analysis'      // Read/understand code or data\n  | 'search'        // Find files/content/patterns\n  | 'execution'     // Run commands/scripts\n  | 'modification'  // Edit/write code\n  | 'verification'  // Test/validate changes\n  | 'communication' // Report/explain to user\n  | 'research'      // Web search, data gathering\n  | 'generation'    // Create documents, reports, code\n  | 'computation'   // Mathematical/scientific calculations\n  | 'automation'    // Automate workflows\n  ;\n\nexport interface TaskResult {\n  success: boolean;\n  output: string;\n  duration: number;\n  artifacts?: string[];\n  errors?: string[];\n}\n\n// ============================================================================\n// PROMPT UNDERSTANDING\n// ============================================================================\n\nexport interface PromptAnalysis {\n  originalPrompt: string;\n  interpretation: string;\n  intent: PromptIntent;\n  category: PromptCategory;\n  confidence: number;\n  tasks: AGITask[];\n  clarificationNeeded: string[];\n}\n\nexport type PromptIntent =\n  // Software Engineering\n  | 'fix_bugs'\n  | 'add_feature'\n  | 'refactor'\n  | 'test'\n  | 'document'\n  | 'deploy'\n  | 'analyze'\n  | 'explain'\n  | 'optimize'\n  | 'security_audit'\n  | 'setup'\n  | 'migrate'\n  // Research & Science\n  | 'research'\n  | 'data_analysis'\n  | 'scientific_computing'\n  // Business & Legal\n  | 'legal_research'\n  | 'business_analysis'\n  | 'financial_analysis'\n  // Automation & Operations\n  | 'automate'\n  | 'monitor'\n  // Generic\n  | 'generic_task'\n  ;\n\nexport type PromptCategory =\n  | 'code_modification'\n  | 'code_analysis'\n  | 'infrastructure'\n  | 'testing'\n  | 'documentation'\n  | 'research'\n  | 'automation'\n  // Non-SWE categories\n  | 'scientific'\n  | 'business'\n  | 'legal'\n  | 'financial'\n  | 'operations'\n  | 'general_coding'\n  ;\n\n// ============================================================================\n// AGI CORE CLASS\n// ============================================================================\n\nexport class AGICore extends EventEmitter {\n  private context: AGIContext;\n  private memoryPath: string;\n  private episodicMemory: EpisodicMemory;\n  private currentEpisodeId: string | null = null;\n  private selfUpgrade: SelfUpgrade;\n  private hotReload: HotReload;\n  private upgradeCheckPromise: Promise<void> | null = null;\n\n  constructor(workingDir?: string) {\n    super();\n    const dir = workingDir || process.cwd();\n    this.memoryPath = path.join(dir, '.agi', 'agi-memory.json');\n\n    this.context = {\n      workingDir: dir,\n      sessionId: `agi-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,\n      startTime: Date.now(),\n      memory: this.loadMemory(),\n    };\n\n    // Initialize episodic memory system\n    this.episodicMemory = getEpisodicMemory();\n\n    // Initialize self-upgrade system\n    this.selfUpgrade = getSelfUpgrade({\n      workingDir: dir,\n      autoRestart: true,\n      logger: (msg) => this.emit('upgrade:log', msg),\n    });\n\n    // Initialize hot-reload system\n    this.hotReload = getHotReload({\n      workingDir: dir,\n      autoCheck: true,\n      checkInterval: 5 * 60 * 1000, // Check every 5 minutes\n      logger: (msg) => this.emit('hotReload:log', msg),\n    });\n\n    // Forward upgrade events\n    this.selfUpgrade.on('upgrade', (event) => this.emit('upgrade', event));\n    this.hotReload.on('hotReload', (event) => this.emit('hotReload', event));\n\n    // Check for upgrade on initialization (non-blocking)\n    this.upgradeCheckPromise = this.checkForUpgradeOnStart();\n\n    // Analyze project on initialization\n    this.analyzeProject();\n  }\n\n  /**\n   * Non-blocking upgrade check on startup\n   */\n  private async checkForUpgradeOnStart(): Promise<void> {\n    try {\n      const versionInfo = await this.selfUpgrade.checkForUpdates();\n      if (versionInfo.updateAvailable) {\n        this.emit('upgrade:available', {\n          current: versionInfo.current,\n          latest: versionInfo.latest,\n        });\n      }\n    } catch {\n      // Non-blocking, ignore errors\n    }\n  }\n\n  // ==========================================================================\n  // MEMORY MANAGEMENT - Real Persistent Learning\n  // ==========================================================================\n\n  private loadMemory(): AGIMemory {\n    try {\n      if (fs.existsSync(this.memoryPath)) {\n        const data = fs.readFileSync(this.memoryPath, 'utf-8');\n        return JSON.parse(data) as AGIMemory;\n      }\n    } catch {\n      // Start fresh if memory is corrupted\n    }\n    return this.createEmptyMemory();\n  }\n\n  private createEmptyMemory(): AGIMemory {\n    return {\n      patterns: [],\n      recentOps: [],\n      projectKnowledge: {\n        type: 'unknown',\n        buildSystem: null,\n        testCommand: null,\n        lintCommand: null,\n        entryPoints: [],\n        dependencies: {},\n        lastAnalyzed: 0,\n      },\n    };\n  }\n\n  private saveMemory(): void {\n    try {\n      const dir = path.dirname(this.memoryPath);\n      if (!fs.existsSync(dir)) {\n        fs.mkdirSync(dir, { recursive: true });\n      }\n      fs.writeFileSync(this.memoryPath, JSON.stringify(this.context.memory, null, 2));\n    } catch (error) {\n      this.emit('warning', `Failed to save memory: ${error}`);\n    }\n  }\n\n  /**\n   * Learn from a successful operation\n   */\n  learnFromSuccess(prompt: string, approach: string, tools: string[]): void {\n    const existingPattern = this.context.memory.patterns.find(\n      p => this.normalizePrompt(p.trigger) === this.normalizePrompt(prompt)\n    );\n\n    if (existingPattern) {\n      existingPattern.successCount++;\n      existingPattern.lastUsed = Date.now();\n      existingPattern.successfulApproach = approach;\n      existingPattern.tools = tools;\n    } else {\n      this.context.memory.patterns.push({\n        id: `pattern-${Date.now()}`,\n        trigger: prompt,\n        successfulApproach: approach,\n        tools,\n        successCount: 1,\n        lastUsed: Date.now(),\n      });\n    }\n\n    // Keep only most useful patterns (limit to 100)\n    this.context.memory.patterns = this.context.memory.patterns\n      .sort((a, b) => (b.successCount * 0.7 + (b.lastUsed - a.lastUsed) / 86400000 * 0.3) -\n                      (a.successCount * 0.7 + (a.lastUsed - b.lastUsed) / 86400000 * 0.3))\n      .slice(0, 100);\n\n    this.saveMemory();\n  }\n\n  /**\n   * Record an operation for context\n   */\n  recordOperation(op: OperationRecord): void {\n    this.context.memory.recentOps.unshift(op);\n    // Keep last 50 operations\n    this.context.memory.recentOps = this.context.memory.recentOps.slice(0, 50);\n    this.saveMemory();\n  }\n\n  /**\n   * Get learned approach for similar prompts\n   */\n  getLearnedApproach(prompt: string): LearnedPattern | null {\n    const normalized = this.normalizePrompt(prompt);\n    return this.context.memory.patterns.find(\n      p => this.normalizePrompt(p.trigger) === normalized ||\n           this.promptSimilarity(p.trigger, prompt) > 0.7\n    ) || null;\n  }\n\n  private normalizePrompt(prompt: string): string {\n    return prompt.toLowerCase().trim().replace(/[^\\w\\s]/g, '');\n  }\n\n  private promptSimilarity(a: string, b: string): number {\n    const wordsA = new Set(this.normalizePrompt(a).split(/\\s+/));\n    const wordsB = new Set(this.normalizePrompt(b).split(/\\s+/));\n    const intersection = new Set([...wordsA].filter(x => wordsB.has(x)));\n    const union = new Set([...wordsA, ...wordsB]);\n    return intersection.size / union.size;\n  }\n\n  // ==========================================================================\n  // PROJECT ANALYSIS - Understand the Codebase\n  // ==========================================================================\n\n  private analyzeProject(): void {\n    const knowledge = this.context.memory.projectKnowledge;\n    const dir = this.context.workingDir;\n\n    // Check for package.json (Node.js)\n    const packageJsonPath = path.join(dir, 'package.json');\n    if (fs.existsSync(packageJsonPath)) {\n      try {\n        const pkg = JSON.parse(fs.readFileSync(packageJsonPath, 'utf-8'));\n        knowledge.type = 'node';\n        knowledge.dependencies = { ...pkg.dependencies, ...pkg.devDependencies };\n\n        if (pkg.scripts) {\n          knowledge.testCommand = pkg.scripts.test ? 'npm test' : null;\n          knowledge.lintCommand = pkg.scripts.lint ? 'npm run lint' : null;\n          knowledge.buildSystem = pkg.scripts.build ? 'npm run build' : null;\n        }\n\n        if (pkg.main) {\n          knowledge.entryPoints.push(pkg.main);\n        }\n      } catch {\n        // Ignore parse errors\n      }\n    }\n\n    // Check for pyproject.toml or setup.py (Python)\n    if (fs.existsSync(path.join(dir, 'pyproject.toml')) ||\n        fs.existsSync(path.join(dir, 'setup.py'))) {\n      knowledge.type = 'python';\n      knowledge.testCommand = 'pytest';\n      knowledge.lintCommand = 'ruff check .';\n    }\n\n    // Check for Cargo.toml (Rust)\n    if (fs.existsSync(path.join(dir, 'Cargo.toml'))) {\n      knowledge.type = 'rust';\n      knowledge.testCommand = 'cargo test';\n      knowledge.lintCommand = 'cargo clippy';\n      knowledge.buildSystem = 'cargo build';\n    }\n\n    // Check for go.mod (Go)\n    if (fs.existsSync(path.join(dir, 'go.mod'))) {\n      knowledge.type = 'go';\n      knowledge.testCommand = 'go test ./...';\n      knowledge.lintCommand = 'golangci-lint run';\n      knowledge.buildSystem = 'go build';\n    }\n\n    knowledge.lastAnalyzed = Date.now();\n    this.saveMemory();\n  }\n\n  // ==========================================================================\n  // PROMPT UNDERSTANDING - Parse and Interpret User Requests\n  // ==========================================================================\n\n  /**\n   * Analyze a user prompt and produce a comprehensive execution plan\n   */\n  analyzePrompt(prompt: string): PromptAnalysis {\n    const lower = prompt.toLowerCase().trim();\n\n    // Check for learned patterns first\n    const learned = this.getLearnedApproach(prompt);\n    if (learned && learned.successCount >= 2) {\n      return this.createFromLearnedPattern(prompt, learned);\n    }\n\n    // Determine intent\n    const intent = this.determineIntent(lower);\n    const category = this.determineCategory(intent);\n\n    // Generate tasks based on intent\n    const tasks = this.generateTasks(prompt, intent);\n\n    // Check for ambiguity\n    const clarificationNeeded = this.checkAmbiguity(prompt, intent);\n\n    return {\n      originalPrompt: prompt,\n      interpretation: this.generateInterpretation(prompt, intent),\n      intent,\n      category,\n      confidence: clarificationNeeded.length === 0 ? 0.9 : 0.6,\n      tasks,\n      clarificationNeeded,\n    };\n  }\n\n  private determineIntent(lower: string): PromptIntent {\n    // Order matters! More specific patterns first.\n\n    // =========================================================================\n    // NON-SWE DOMAINS (check first for domain-specific keywords)\n    // =========================================================================\n\n    // Legal/Litigation (sue, lawsuit, court, legal action)\n    if (/\\bsue\\b|lawsuit|litigation|legal\\s+action|\\bcourt\\b|attorney|lawyer|complaint|motion|brief/i.test(lower)) {\n      return 'legal_research';\n    }\n\n    // Financial/Accounting (accounting, bookkeeping, tax, financial)\n    if (/accounting|bookkeeping|financ|tax\\b|ledger|balance\\s*sheet|invoice|payroll|budget|forecast/i.test(lower)) {\n      return 'financial_analysis';\n    }\n\n    // Scientific Research (cure, research, experiment, hypothesis, study)\n    if (/\\bcure\\b|research|experiment|hypothesis|scientific|laboratory|clinical|biomedical|genome|molecular/i.test(lower)) {\n      return 'research';\n    }\n\n    // Data Analysis/Science (data analysis, ML, statistics, visualization)\n    if (/data\\s+(?:analysis|science|engineer)|statistic|machine\\s+learning|\\bml\\b|\\bai\\b|neural|dataset/i.test(lower)) {\n      return 'data_analysis';\n    }\n\n    // Engineering/Science (engineering, physics, chemistry, simulation)\n    if (/engineer(?:ing)?|physic|chemist|simulat|cad\\b|finite\\s+element|signal\\s+process/i.test(lower)) {\n      return 'scientific_computing';\n    }\n\n    // Business Analysis (business, strategy, market, competitor)\n    if (/business|strateg|\\bmarket\\b|competitor|swot|business\\s+plan/i.test(lower)) {\n      return 'business_analysis';\n    }\n\n    // Automation/Operations (automate, workflow, schedule, cron)\n    // Note: \"pipeline\" without \"CI\" or \"CD\" context - those go to setup\n    if (/\\bautomat|\\bworkflow|\\bschedule|\\bcron\\b|batch\\s+process/i.test(lower)) {\n      return 'automate';\n    }\n\n    // Data pipeline (ETL, data pipeline) - separate from CI/CD\n    if (/(?:data|etl)\\s+pipeline/i.test(lower)) {\n      return 'automate';\n    }\n\n    // Monitoring (monitor, alert, dashboard, metrics, observability)\n    if (/\\bmonitor|alert|dashboard|metric|observab|logging|trace/i.test(lower)) {\n      return 'monitor';\n    }\n\n    // =========================================================================\n    // SOFTWARE ENGINEERING DOMAINS\n    // =========================================================================\n\n    // Security audit (check before general 'audit')\n    if (/security|vulnerab|pentest|secure/i.test(lower)) {\n      return 'security_audit';\n    }\n\n    // Optimization (check before 'improve' which could be refactor)\n    if (/optim|faster|performance|speed\\s*up|slow/i.test(lower)) {\n      return 'optimize';\n    }\n\n    // Explanation (check before 'document' - \"explain\" is for understanding, not writing docs)\n    if (/\\bwhat\\b|\\bhow\\b.*work|\\bwhy\\b|\\bexplain\\b|\\bunderstand/i.test(lower)) {\n      return 'explain';\n    }\n\n    // Bug fixing\n    if (/fix|bug|error|issue|broken|crash|fail/i.test(lower)) {\n      return 'fix_bugs';\n    }\n\n    // Setup/Configuration (check before 'add' - configure is setup, not adding)\n    if (/setup|install|configure|init/i.test(lower)) {\n      return 'setup';\n    }\n\n    // Feature addition\n    if (/add|create|implement|build|new|feature/i.test(lower)) {\n      return 'add_feature';\n    }\n\n    // Refactoring (check 'improve' here after optimization is handled)\n    if (/refactor|clean|improve|reorganize|restructure/i.test(lower)) {\n      return 'refactor';\n    }\n\n    // Testing\n    if (/test|spec|coverage|verify/i.test(lower)) {\n      return 'test';\n    }\n\n    // Documentation\n    if (/document|readme|comment|doc\\b/i.test(lower)) {\n      return 'document';\n    }\n\n    // Deployment\n    if (/deploy|release|publish|ship/i.test(lower)) {\n      return 'deploy';\n    }\n\n    // Analysis (general analysis, after security)\n    if (/analyze|review|audit|check|inspect/i.test(lower)) {\n      return 'analyze';\n    }\n\n    // Migration\n    if (/migrate|upgrade|update|version/i.test(lower)) {\n      return 'migrate';\n    }\n\n    return 'generic_task';\n  }\n\n  private determineCategory(intent: PromptIntent): PromptCategory {\n    const mapping: Record<PromptIntent, PromptCategory> = {\n      // Software Engineering\n      'fix_bugs': 'code_modification',\n      'add_feature': 'code_modification',\n      'refactor': 'code_modification',\n      'test': 'testing',\n      'document': 'documentation',\n      'deploy': 'infrastructure',\n      'analyze': 'code_analysis',\n      'explain': 'research',\n      'optimize': 'code_modification',\n      'security_audit': 'code_analysis',\n      'setup': 'infrastructure',\n      'migrate': 'code_modification',\n      // Research & Science\n      'research': 'scientific',\n      'data_analysis': 'scientific',\n      'scientific_computing': 'scientific',\n      // Business & Legal\n      'legal_research': 'legal',\n      'business_analysis': 'business',\n      'financial_analysis': 'financial',\n      // Automation & Operations\n      'automate': 'automation',\n      'monitor': 'operations',\n      // Generic\n      'generic_task': 'general_coding',\n    };\n    return mapping[intent];\n  }\n\n  private generateInterpretation(prompt: string, intent: PromptIntent): string {\n    const interpretations: Record<PromptIntent, string> = {\n      // Software Engineering\n      'fix_bugs': `Identify and fix bugs/errors in the codebase based on: \"${prompt}\"`,\n      'add_feature': `Implement new functionality: \"${prompt}\"`,\n      'refactor': `Improve code structure and quality: \"${prompt}\"`,\n      'test': `Create or run tests: \"${prompt}\"`,\n      'document': `Create or update documentation: \"${prompt}\"`,\n      'deploy': `Prepare and execute deployment: \"${prompt}\"`,\n      'analyze': `Analyze and review: \"${prompt}\"`,\n      'explain': `Explain and clarify: \"${prompt}\"`,\n      'optimize': `Improve performance: \"${prompt}\"`,\n      'security_audit': `Security review and hardening: \"${prompt}\"`,\n      'setup': `Set up and configure: \"${prompt}\"`,\n      'migrate': `Migrate or upgrade: \"${prompt}\"`,\n      // Research & Science\n      'research': `Build research tools and analysis pipeline for: \"${prompt}\"`,\n      'data_analysis': `Create data analysis pipeline and visualizations for: \"${prompt}\"`,\n      'scientific_computing': `Build scientific computing tools for: \"${prompt}\"`,\n      // Business & Legal\n      'legal_research': `Legal research and document automation for: \"${prompt}\"`,\n      'business_analysis': `Business analysis and strategy tools for: \"${prompt}\"`,\n      'financial_analysis': `Financial analysis and reporting tools for: \"${prompt}\"`,\n      // Automation & Operations\n      'automate': `Build automation workflow for: \"${prompt}\"`,\n      'monitor': `Create monitoring and alerting system for: \"${prompt}\"`,\n      // Generic\n      'generic_task': `Execute task: \"${prompt}\"`,\n    };\n    return interpretations[intent];\n  }\n\n  private generateTasks(prompt: string, intent: PromptIntent): AGITask[] {\n    const tasks: AGITask[] = [];\n    const knowledge = this.context.memory.projectKnowledge;\n\n    switch (intent) {\n      case 'fix_bugs':\n        // First: analyze the codebase\n        tasks.push({\n          id: 'analyze-errors',\n          description: 'Run type checker and linter to identify issues',\n          category: 'execution',\n          tools: ['Bash'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        if (knowledge.testCommand) {\n          tasks.push({\n            id: 'run-tests',\n            description: 'Run test suite to find failing tests',\n            category: 'execution',\n            tools: ['Bash'],\n            dependencies: [],\n            status: 'pending',\n          });\n        }\n\n        tasks.push({\n          id: 'search-issues',\n          description: 'Search for TODO/FIXME comments and known issues',\n          category: 'search',\n          tools: ['Grep'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'analyze-findings',\n          description: 'Analyze all findings and prioritize fixes',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: ['analyze-errors', 'search-issues'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'fix-issues',\n          description: 'Apply fixes to identified issues',\n          category: 'modification',\n          tools: ['Edit'],\n          dependencies: ['analyze-findings'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'verify-fixes',\n          description: 'Verify fixes by re-running checks',\n          category: 'verification',\n          tools: ['Bash'],\n          dependencies: ['fix-issues'],\n          status: 'pending',\n        });\n        break;\n\n      case 'add_feature':\n        tasks.push({\n          id: 'understand-codebase',\n          description: 'Analyze existing code structure',\n          category: 'analysis',\n          tools: ['Glob', 'Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'plan-implementation',\n          description: 'Plan the implementation approach',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: ['understand-codebase'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'implement-feature',\n          description: 'Write the feature code',\n          category: 'modification',\n          tools: ['Edit', 'Write'],\n          dependencies: ['plan-implementation'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'add-tests',\n          description: 'Add tests for the new feature',\n          category: 'modification',\n          tools: ['Edit', 'Write'],\n          dependencies: ['implement-feature'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'verify-feature',\n          description: 'Run tests and verify feature works',\n          category: 'verification',\n          tools: ['Bash'],\n          dependencies: ['add-tests'],\n          status: 'pending',\n        });\n        break;\n\n      case 'analyze':\n      case 'explain':\n        tasks.push({\n          id: 'explore-structure',\n          description: 'Explore project structure',\n          category: 'search',\n          tools: ['Glob', 'Bash'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'read-key-files',\n          description: 'Read and understand key files',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: ['explore-structure'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'summarize-findings',\n          description: 'Summarize and explain findings',\n          category: 'communication',\n          tools: [],\n          dependencies: ['read-key-files'],\n          status: 'pending',\n        });\n        break;\n\n      case 'test':\n        if (knowledge.testCommand) {\n          tasks.push({\n            id: 'run-existing-tests',\n            description: 'Run existing test suite',\n            category: 'execution',\n            tools: ['Bash'],\n            dependencies: [],\n            status: 'pending',\n          });\n        }\n\n        tasks.push({\n          id: 'analyze-coverage',\n          description: 'Analyze test coverage',\n          category: 'analysis',\n          tools: ['Bash', 'Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'identify-gaps',\n          description: 'Identify testing gaps',\n          category: 'analysis',\n          tools: ['Grep', 'Read'],\n          dependencies: ['analyze-coverage'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'write-tests',\n          description: 'Write new tests for uncovered code',\n          category: 'modification',\n          tools: ['Edit', 'Write'],\n          dependencies: ['identify-gaps'],\n          status: 'pending',\n        });\n        break;\n\n      case 'security_audit':\n        tasks.push({\n          id: 'dependency-audit',\n          description: 'Audit dependencies for known vulnerabilities',\n          category: 'execution',\n          tools: ['Bash'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'code-patterns',\n          description: 'Search for insecure code patterns',\n          category: 'search',\n          tools: ['Grep'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'analyze-security',\n          description: 'Analyze security findings',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: ['dependency-audit', 'code-patterns'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'report-findings',\n          description: 'Report security findings with recommendations',\n          category: 'communication',\n          tools: [],\n          dependencies: ['analyze-security'],\n          status: 'pending',\n        });\n        break;\n\n      // =====================================================================\n      // NON-SWE DOMAIN TASKS\n      // =====================================================================\n\n      case 'research':\n        // Scientific/Medical Research (e.g., \"cure cancer\")\n        tasks.push({\n          id: 'define-scope',\n          description: 'Define research scope and objectives',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'gather-data',\n          description: 'Gather relevant data and research materials',\n          category: 'research',\n          tools: ['Bash', 'Read'],\n          dependencies: ['define-scope'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'build-pipeline',\n          description: 'Build data processing and analysis pipeline',\n          category: 'generation',\n          tools: ['Edit', 'Write', 'Bash'],\n          dependencies: ['gather-data'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'implement-analysis',\n          description: 'Implement analysis algorithms and models',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['build-pipeline'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'generate-report',\n          description: 'Generate analysis report with findings',\n          category: 'communication',\n          tools: ['Edit', 'Write'],\n          dependencies: ['implement-analysis'],\n          status: 'pending',\n        });\n        break;\n\n      case 'data_analysis':\n        tasks.push({\n          id: 'explore-data',\n          description: 'Explore and understand the data',\n          category: 'analysis',\n          tools: ['Read', 'Bash'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'clean-data',\n          description: 'Clean and preprocess data',\n          category: 'execution',\n          tools: ['Bash', 'Edit'],\n          dependencies: ['explore-data'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'analyze-patterns',\n          description: 'Analyze patterns and statistics',\n          category: 'computation',\n          tools: ['Bash', 'Edit'],\n          dependencies: ['clean-data'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'create-visualizations',\n          description: 'Create visualizations and charts',\n          category: 'generation',\n          tools: ['Edit', 'Bash'],\n          dependencies: ['analyze-patterns'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'summarize-insights',\n          description: 'Summarize insights and recommendations',\n          category: 'communication',\n          tools: ['Edit'],\n          dependencies: ['create-visualizations'],\n          status: 'pending',\n        });\n        break;\n\n      case 'scientific_computing':\n        tasks.push({\n          id: 'define-problem',\n          description: 'Define the scientific problem and requirements',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'design-algorithm',\n          description: 'Design computational algorithm',\n          category: 'analysis',\n          tools: ['Read', 'Edit'],\n          dependencies: ['define-problem'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'implement-computation',\n          description: 'Implement computational solution',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['design-algorithm'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'validate-results',\n          description: 'Validate and verify results',\n          category: 'verification',\n          tools: ['Bash', 'Read'],\n          dependencies: ['implement-computation'],\n          status: 'pending',\n        });\n        break;\n\n      case 'legal_research':\n        // Legal/Litigation (e.g., \"sue google in fed court\")\n        tasks.push({\n          id: 'identify-claims',\n          description: 'Identify legal claims and causes of action',\n          category: 'research',\n          tools: ['Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'research-law',\n          description: 'Research applicable laws and precedents',\n          category: 'research',\n          tools: ['Read', 'Bash'],\n          dependencies: ['identify-claims'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'gather-evidence',\n          description: 'Gather and organize evidence',\n          category: 'search',\n          tools: ['Glob', 'Grep', 'Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'draft-documents',\n          description: 'Draft legal documents (complaint, motion, brief)',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['research-law', 'gather-evidence'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'prepare-filing',\n          description: 'Prepare filing package and procedures',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['draft-documents'],\n          status: 'pending',\n        });\n        break;\n\n      case 'business_analysis':\n        tasks.push({\n          id: 'gather-business-data',\n          description: 'Gather business data and market information',\n          category: 'research',\n          tools: ['Read', 'Bash'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'analyze-market',\n          description: 'Analyze market and competitive landscape',\n          category: 'analysis',\n          tools: ['Read', 'Edit'],\n          dependencies: ['gather-business-data'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'build-models',\n          description: 'Build financial/business models',\n          category: 'computation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['analyze-market'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'generate-strategy',\n          description: 'Generate strategy recommendations',\n          category: 'communication',\n          tools: ['Edit'],\n          dependencies: ['build-models'],\n          status: 'pending',\n        });\n        break;\n\n      case 'financial_analysis':\n        // Accounting/Finance (e.g., \"do accounting\")\n        tasks.push({\n          id: 'gather-financial-data',\n          description: 'Gather financial data and records',\n          category: 'search',\n          tools: ['Glob', 'Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'organize-transactions',\n          description: 'Organize and categorize transactions',\n          category: 'analysis',\n          tools: ['Read', 'Edit'],\n          dependencies: ['gather-financial-data'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'calculate-financials',\n          description: 'Calculate financial metrics and statements',\n          category: 'computation',\n          tools: ['Edit', 'Bash'],\n          dependencies: ['organize-transactions'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'generate-reports',\n          description: 'Generate financial reports',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['calculate-financials'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'prepare-tax',\n          description: 'Prepare tax calculations and filings',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['calculate-financials'],\n          status: 'pending',\n        });\n        break;\n\n      case 'automate':\n        tasks.push({\n          id: 'analyze-workflow',\n          description: 'Analyze current workflow and processes',\n          category: 'analysis',\n          tools: ['Read', 'Glob'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'design-automation',\n          description: 'Design automation solution',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: ['analyze-workflow'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'implement-automation',\n          description: 'Implement automation scripts',\n          category: 'generation',\n          tools: ['Edit', 'Write', 'Bash'],\n          dependencies: ['design-automation'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'test-automation',\n          description: 'Test automation workflow',\n          category: 'verification',\n          tools: ['Bash'],\n          dependencies: ['implement-automation'],\n          status: 'pending',\n        });\n        break;\n\n      case 'monitor':\n        tasks.push({\n          id: 'identify-metrics',\n          description: 'Identify key metrics to monitor',\n          category: 'analysis',\n          tools: ['Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'setup-collection',\n          description: 'Set up metric collection',\n          category: 'execution',\n          tools: ['Edit', 'Bash'],\n          dependencies: ['identify-metrics'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'create-dashboard',\n          description: 'Create monitoring dashboard',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['setup-collection'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'configure-alerts',\n          description: 'Configure alerting rules',\n          category: 'generation',\n          tools: ['Edit', 'Write'],\n          dependencies: ['create-dashboard'],\n          status: 'pending',\n        });\n        break;\n\n      default:\n        // Generic task decomposition\n        tasks.push({\n          id: 'understand-request',\n          description: 'Understand the request and context',\n          category: 'analysis',\n          tools: ['Glob', 'Read'],\n          dependencies: [],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'execute-task',\n          description: 'Execute the requested task',\n          category: 'execution',\n          tools: ['Bash', 'Edit'],\n          dependencies: ['understand-request'],\n          status: 'pending',\n        });\n\n        tasks.push({\n          id: 'verify-completion',\n          description: 'Verify task completion',\n          category: 'verification',\n          tools: ['Bash', 'Read'],\n          dependencies: ['execute-task'],\n          status: 'pending',\n        });\n        break;\n    }\n\n    return tasks;\n  }\n\n  private checkAmbiguity(prompt: string, intent: PromptIntent): string[] {\n    const questions: string[] = [];\n    const lower = prompt.toLowerCase();\n\n    // Vague scope\n    if (/all|everything|entire|whole/i.test(lower)) {\n      questions.push('The request has broad scope. Should I focus on specific areas first?');\n    }\n\n    // Missing target\n    if (intent === 'fix_bugs' && !/specific|file|function|module/i.test(lower)) {\n      questions.push('Are there specific files or modules to prioritize?');\n    }\n\n    // Unclear priority\n    if (/important|priority|critical/i.test(lower) && !/high|low|medium/i.test(lower)) {\n      questions.push('What priority level should I focus on?');\n    }\n\n    return questions;\n  }\n\n  private createFromLearnedPattern(prompt: string, pattern: LearnedPattern): PromptAnalysis {\n    return {\n      originalPrompt: prompt,\n      interpretation: `Using learned approach: ${pattern.successfulApproach}`,\n      intent: 'generic_task',\n      category: 'automation',\n      confidence: 0.95,\n      tasks: pattern.tools.map((tool, i) => ({\n        id: `learned-${i}`,\n        description: `Execute ${tool} based on learned pattern`,\n        category: 'execution' as TaskCategory,\n        tools: [tool],\n        dependencies: i > 0 ? [`learned-${i-1}`] : [],\n        status: 'pending' as const,\n      })),\n      clarificationNeeded: [],\n    };\n  }\n\n  // ==========================================================================\n  // EXECUTION - Run Tasks with Real Tools\n  // ==========================================================================\n\n  /**\n   * Generate tool calls for a given analysis\n   * Returns explicit tool call specifications ready for execution\n   */\n  generateToolCalls(analysis: PromptAnalysis): ToolCallSpec[] {\n    const calls: ToolCallSpec[] = [];\n    const knowledge = this.context.memory.projectKnowledge;\n\n    for (const task of analysis.tasks) {\n      switch (task.category) {\n        case 'execution':\n          if (task.tools.includes('Bash')) {\n            // Generate appropriate commands based on task\n            if (task.id.includes('lint') || task.id.includes('errors')) {\n              if (knowledge.lintCommand) {\n                calls.push({\n                  tool: 'Bash',\n                  args: { command: knowledge.lintCommand + ' 2>&1 || true', description: task.description },\n                  description: task.description,\n                  taskId: task.id,\n                });\n              }\n              if (knowledge.type === 'node') {\n                calls.push({\n                  tool: 'Bash',\n                  args: { command: 'npx tsc --noEmit 2>&1 || true', description: 'Type check' },\n                  description: 'Run TypeScript type checker',\n                  taskId: task.id,\n                });\n              }\n            }\n            if (task.id.includes('test')) {\n              if (knowledge.testCommand) {\n                calls.push({\n                  tool: 'Bash',\n                  args: { command: knowledge.testCommand + ' 2>&1 || true', description: task.description },\n                  description: task.description,\n                  taskId: task.id,\n                });\n              }\n            }\n            if (task.id.includes('dependency') || task.id.includes('audit')) {\n              if (knowledge.type === 'node') {\n                calls.push({\n                  tool: 'Bash',\n                  args: { command: 'npm audit 2>&1 || true', description: 'Security audit' },\n                  description: 'Audit npm dependencies for vulnerabilities',\n                  taskId: task.id,\n                });\n              }\n            }\n          }\n          break;\n\n        case 'search':\n          if (task.tools.includes('Grep')) {\n            if (task.id.includes('issues') || task.id.includes('todo')) {\n              calls.push({\n                tool: 'Grep',\n                args: { pattern: 'TODO|FIXME|BUG|HACK|XXX', output_mode: 'content' },\n                description: 'Find TODO/FIXME comments',\n                taskId: task.id,\n              });\n            }\n            if (task.id.includes('security') || task.id.includes('patterns')) {\n              calls.push({\n                tool: 'Grep',\n                args: { pattern: 'eval\\\\(|exec\\\\(|innerHTML|dangerouslySetInnerHTML', output_mode: 'content' },\n                description: 'Find potentially unsafe patterns',\n                taskId: task.id,\n              });\n            }\n          }\n          if (task.tools.includes('Glob')) {\n            calls.push({\n              tool: 'Glob',\n              args: { pattern: 'src/**/*.{ts,js,tsx,jsx}' },\n              description: 'Find source files',\n              taskId: task.id,\n            });\n          }\n          break;\n\n        case 'analysis':\n          // Analysis typically involves reading files\n          if (task.tools.includes('Read')) {\n            calls.push({\n              tool: 'Read',\n              args: { file_path: 'package.json' },\n              description: 'Read project configuration',\n              taskId: task.id,\n            });\n          }\n          break;\n      }\n    }\n\n    return calls;\n  }\n\n  // ==========================================================================\n  // PUBLIC API\n  // ==========================================================================\n\n  /**\n   * Get the current AGI context\n   */\n  getContext(): AGIContext {\n    return this.context;\n  }\n\n  /**\n   * Get project knowledge\n   */\n  getProjectKnowledge(): ProjectKnowledge {\n    return this.context.memory.projectKnowledge;\n  }\n\n  /**\n   * Get recent operations\n   */\n  getRecentOperations(limit: number = 10): OperationRecord[] {\n    return this.context.memory.recentOps.slice(0, limit);\n  }\n\n  /**\n   * Get learned patterns\n   */\n  getLearnedPatterns(): LearnedPattern[] {\n    return this.context.memory.patterns;\n  }\n\n  /**\n   * Force project re-analysis\n   */\n  refreshProjectKnowledge(): ProjectKnowledge {\n    this.analyzeProject();\n    return this.context.memory.projectKnowledge;\n  }\n\n  // ==========================================================================\n  // EPISODIC MEMORY - Cross-session learning with semantic search\n  // ==========================================================================\n\n  /**\n   * Start tracking a new episode (task/conversation unit)\n   */\n  startEpisode(intent: string): string {\n    this.currentEpisodeId = this.episodicMemory.startEpisode(\n      intent,\n      this.context.sessionId\n    );\n    this.emit('episode:start', { id: this.currentEpisodeId, intent });\n    return this.currentEpisodeId;\n  }\n\n  /**\n   * Record tool usage within the current episode\n   */\n  recordEpisodeToolUse(toolName: string): void {\n    if (this.currentEpisodeId) {\n      this.episodicMemory.recordToolUse(toolName);\n    }\n  }\n\n  /**\n   * Record file modification within the current episode\n   */\n  recordEpisodeFileModification(filePath: string): void {\n    if (this.currentEpisodeId) {\n      this.episodicMemory.recordFileModification(filePath);\n    }\n  }\n\n  /**\n   * End the current episode and save to memory\n   */\n  async endEpisode(success: boolean, summary: string): Promise<Episode | null> {\n    if (!this.currentEpisodeId) return null;\n\n    const episode = await this.episodicMemory.endEpisode(success, summary);\n    this.emit('episode:end', { episode, success });\n    this.currentEpisodeId = null;\n    return episode;\n  }\n\n  /**\n   * Abort the current episode without saving\n   */\n  abortEpisode(): void {\n    if (this.currentEpisodeId) {\n      this.episodicMemory.abortEpisode();\n      this.emit('episode:abort', { id: this.currentEpisodeId });\n      this.currentEpisodeId = null;\n    }\n  }\n\n  /**\n   * Search episodic memory for similar past work\n   */\n  async searchMemory(query: string, options?: {\n    limit?: number;\n    successOnly?: boolean;\n    since?: number;\n  }): Promise<MemorySearchResult[]> {\n    return this.episodicMemory.search({\n      query,\n      limit: options?.limit ?? 5,\n      successOnly: options?.successOnly,\n      since: options?.since,\n    });\n  }\n\n  /**\n   * Get learned approach from episodic memory\n   */\n  async getEpisodicApproach(intent: string): Promise<{\n    approach: string[];\n    tools: string[];\n    successRate: number;\n  } | null> {\n    const learned = await this.episodicMemory.getApproach(intent);\n    if (!learned) return null;\n\n    return {\n      approach: learned.approach,\n      tools: learned.tools,\n      successRate: learned.successRate,\n    };\n  }\n\n  /**\n   * Get recent episodes for context\n   */\n  getRecentEpisodes(limit = 5): Episode[] {\n    return this.episodicMemory.getRecentEpisodes(limit, this.context.sessionId);\n  }\n\n  /**\n   * Get episodic memory statistics\n   */\n  getEpisodicMemoryStats(): {\n    totalEpisodes: number;\n    successfulEpisodes: number;\n    totalApproaches: number;\n    categoryCounts: Record<string, number>;\n    topTags: string[];\n  } {\n    return this.episodicMemory.getStats();\n  }\n\n  /**\n   * Get the episodic memory instance for direct access\n   */\n  getEpisodicMemory(): EpisodicMemory {\n    return this.episodicMemory;\n  }\n\n  /**\n   * Check if there's an active episode\n   */\n  hasActiveEpisode(): boolean {\n    return this.currentEpisodeId !== null;\n  }\n\n  /**\n   * Get current episode ID\n   */\n  getCurrentEpisodeId(): string | null {\n    return this.currentEpisodeId;\n  }\n\n  // ==========================================================================\n  // SELF-UPGRADE SYSTEM - Automatic updates and hot-reload\n  // ==========================================================================\n\n  /**\n   * Check for available updates\n   */\n  async checkForUpdates(): Promise<{\n    available: boolean;\n    current: string;\n    latest: string;\n  }> {\n    const info = await this.selfUpgrade.checkForUpdates();\n    return {\n      available: info.updateAvailable,\n      current: info.current,\n      latest: info.latest,\n    };\n  }\n\n  /**\n   * Perform self-upgrade to latest version\n   * Saves session state and restarts CLI automatically\n   */\n  async performSelfUpgrade(options: {\n    version?: string;\n    preserveSession?: boolean;\n  } = {}): Promise<{\n    success: boolean;\n    fromVersion: string;\n    toVersion?: string;\n    error?: string;\n  }> {\n    // Save current session state if requested\n    if (options.preserveSession !== false) {\n      const sessionState: UpgradeSessionState = {\n        workingDir: this.context.workingDir,\n        fromVersion: (await this.selfUpgrade.checkForUpdates()).current,\n        timestamp: Date.now(),\n        pendingTasks: this.context.memory.recentOps.slice(0, 5).map(op => op.prompt),\n        contextSummary: `Session ${this.context.sessionId}, ${this.context.memory.recentOps.length} recent operations`,\n      };\n\n      // Include RL context if in an active episode\n      if (this.currentEpisodeId) {\n        sessionState.rlContext = {\n          iteration: 1,\n          variant: 'primary',\n          objective: 'Continue from episode ' + this.currentEpisodeId,\n          currentScore: 0,\n          filesModified: [],\n        };\n      }\n\n      this.selfUpgrade.saveSessionState(sessionState);\n    }\n\n    // Perform upgrade\n    const result = await this.selfUpgrade.npmInstallFresh(options.version);\n    return {\n      success: result.success,\n      fromVersion: result.fromVersion,\n      toVersion: result.toVersion,\n      error: result.error,\n    };\n  }\n\n  /**\n   * Perform self-upgrade with build and test verification\n   */\n  async performVerifiedUpgrade(options: {\n    version?: string;\n    buildCommand?: string;\n    testCommand?: string;\n  } = {}): Promise<{\n    success: boolean;\n    buildSuccess: boolean;\n    testsPassed: number;\n    testsFailed: number;\n    fromVersion: string;\n    toVersion?: string;\n  }> {\n    const result = await this.selfUpgrade.upgradeWithFullVerification(\n      options.version,\n      options.buildCommand || this.context.memory.projectKnowledge.buildSystem || 'npm run build',\n      options.testCommand || this.context.memory.projectKnowledge.testCommand || 'npm test'\n    );\n\n    return {\n      success: result.success,\n      buildSuccess: result.buildSuccess,\n      testsPassed: result.testState.passed,\n      testsFailed: result.testState.failed,\n      fromVersion: result.fromVersion,\n      toVersion: result.toVersion,\n    };\n  }\n\n  /**\n   * Trigger hot-reload if update is available\n   */\n  async triggerHotReload(options: {\n    preserveState?: Record<string, unknown>;\n    activeEdits?: string[];\n  } = {}): Promise<{\n    success: boolean;\n    strategy: 'hot-swap' | 'restart';\n    error?: string;\n  }> {\n    // Include RL context if applicable\n    const rlContext: RLUpgradeContext | undefined = this.currentEpisodeId ? {\n      iteration: 1,\n      variant: 'primary',\n      objective: 'Hot-reload continuation',\n      currentScore: 0,\n      filesModified: options.activeEdits || [],\n    } : undefined;\n\n    return this.hotReload.performHotReload({\n      preserveState: options.preserveState,\n      rlContext,\n      activeEdits: options.activeEdits,\n    });\n  }\n\n  /**\n   * Resume from previous upgrade session\n   */\n  resumeFromUpgrade(): UpgradeSessionState | null {\n    const state = this.selfUpgrade.loadSessionState();\n    if (state) {\n      this.selfUpgrade.clearSessionState();\n      this.emit('upgrade:resumed', state);\n    }\n    return state;\n  }\n\n  /**\n   * Get the self-upgrade instance for direct access\n   */\n  getSelfUpgrade(): SelfUpgrade {\n    return this.selfUpgrade;\n  }\n\n  /**\n   * Get the hot-reload instance for direct access\n   */\n  getHotReload(): HotReload {\n    return this.hotReload;\n  }\n\n  /**\n   * Check if this session was started after an upgrade\n   */\n  wasUpgraded(): boolean {\n    return SelfUpgrade.wasUpgraded();\n  }\n\n  /**\n   * Get version we upgraded from (if applicable)\n   */\n  getUpgradeFromVersion(): string | null {\n    return SelfUpgrade.getUpgradeFromVersion();\n  }\n}\n\n// ============================================================================\n// TOOL CALL SPECIFICATION\n// ============================================================================\n\nexport interface ToolCallSpec {\n  tool: string;\n  args: Record<string, unknown>;\n  description: string;\n  taskId: string;\n}\n\n// ============================================================================\n// SINGLETON EXPORT\n// ============================================================================\n\nlet agiInstance: AGICore | null = null;\n\nexport function getAGI(workingDir?: string): AGICore {\n  if (!agiInstance || (workingDir && workingDir !== agiInstance.getContext().workingDir)) {\n    agiInstance = new AGICore(workingDir);\n  }\n  return agiInstance;\n}\n\nexport function resetAGI(): void {\n  agiInstance = null;\n}\n"],"mappings":"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","ignoreList":[]}
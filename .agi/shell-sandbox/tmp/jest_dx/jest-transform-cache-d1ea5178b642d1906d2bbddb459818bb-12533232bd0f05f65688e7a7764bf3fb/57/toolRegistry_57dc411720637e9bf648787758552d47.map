{"version":3,"names":["cov_2p7hpnrfy1","actualCoverage","getSecretValue","listSecretDefinitions","getToolManifest","SECRET_LOOKUP","s","buildSecretLookup","TOOL_OPTIONS","buildToolToggleOptions","PLUGIN_TO_OPTION","buildPluginLookup","LOCKED_OPTION_IDS","buildLockedOptionIds","DEFAULT_OPTION_IDS","buildDefaultOptionIds","getToolToggleOptions","f","buildEnabledToolSet","saved","_profile","enabled","Set","id","add","b","knownIds","map","option","enabledTools","has","evaluateToolPermissions","selection","allowedPluginIds","warnings","requiresSecret","secret","push","label","reason","secretId","pluginId","pluginIds","isPluginEnabled","associated","get","Map","set","manifest","options","normalizeToggleOption","ids","locked","defaultEnabled","length","Error","normalized","description","category","scopes","normalizeSecret","metadata","restartRequired","value","undefined"],"sources":["toolRegistry.ts"],"sourcesContent":["import type { ToolAvailabilityOption } from '../contracts/v1/toolAccess.js';\nimport type { ProfileName } from '../config.js';\nimport type { ToolSettings } from '../core/preferences.js';\nimport { getSecretValue, listSecretDefinitions, type SecretName } from '../core/secretStore.js';\nimport { getToolManifest } from './toolManifest.js';\n\nexport type ToolToggleId = string;\n\nexport type ToolToggleOption = ToolAvailabilityOption & {\n  requiresSecret?: SecretName;\n  locked?: boolean;\n  restartRequired?: boolean;\n};\n\nexport interface ToolPermissionSummary {\n  allowedPluginIds: Set<string>;\n  warnings: ToolLoadWarning[];\n}\n\nexport interface ToolLoadWarning {\n  id: ToolToggleId;\n  label: string;\n  reason: 'missing-secret';\n  secretId?: SecretName;\n}\n\nconst SECRET_LOOKUP = buildSecretLookup();\n\nconst TOOL_OPTIONS: ToolToggleOption[] = buildToolToggleOptions();\n\nconst PLUGIN_TO_OPTION = buildPluginLookup();\nconst LOCKED_OPTION_IDS = buildLockedOptionIds();\nconst DEFAULT_OPTION_IDS = buildDefaultOptionIds();\n\nexport function getToolToggleOptions(): ToolToggleOption[] {\n  return [...TOOL_OPTIONS];\n}\n\nexport function buildEnabledToolSet(saved: ToolSettings | null, _profile?: ProfileName): Set<ToolToggleId> {\n  const enabled = new Set<ToolToggleId>();\n  // Always include locked/default core packages to keep the AI flow intact\n  for (const id of LOCKED_OPTION_IDS) {\n    enabled.add(id);\n  }\n\n  if (!saved) {\n    for (const id of DEFAULT_OPTION_IDS) {\n      enabled.add(id);\n    }\n    return enabled;\n  }\n\n  const knownIds = new Set(TOOL_OPTIONS.map((option) => option.id));\n  for (const id of saved.enabledTools ?? []) {\n    if (knownIds.has(id)) {\n      enabled.add(id);\n    }\n  }\n\n  // Enforce locked/default packages even if missing from saved settings\n  for (const id of LOCKED_OPTION_IDS) {\n    enabled.add(id);\n  }\n  for (const id of DEFAULT_OPTION_IDS) {\n    enabled.add(id);\n  }\n\n  return enabled;\n}\n\nexport function evaluateToolPermissions(selection: Set<ToolToggleId>): ToolPermissionSummary {\n  const allowedPluginIds = new Set<string>();\n  const warnings: ToolLoadWarning[] = [];\n\n  for (const option of TOOL_OPTIONS) {\n    if (!selection.has(option.id)) {\n      continue;\n    }\n\n    if (option.requiresSecret) {\n      const secret = getSecretValue(option.requiresSecret);\n      if (!secret) {\n        warnings.push({\n          id: option.id,\n          label: option.label,\n          reason: 'missing-secret',\n          secretId: option.requiresSecret,\n        });\n        continue;\n      }\n    }\n\n    for (const pluginId of option.pluginIds) {\n      allowedPluginIds.add(pluginId);\n    }\n  }\n\n  return {\n    allowedPluginIds,\n    warnings,\n  };\n}\n\nexport function isPluginEnabled(pluginId: string, allowedPluginIds: Set<string>): boolean {\n  const associated = PLUGIN_TO_OPTION.get(pluginId);\n  if (!associated) {\n    return true;\n  }\n  return allowedPluginIds.has(pluginId);\n}\n\nfunction buildPluginLookup(): Map<string, ToolToggleOption> {\n  const map = new Map<string, ToolToggleOption>();\n  for (const option of TOOL_OPTIONS) {\n    for (const pluginId of option.pluginIds) {\n      map.set(pluginId, option);\n    }\n  }\n  return map;\n}\n\nfunction buildToolToggleOptions(): ToolToggleOption[] {\n  const manifest = getToolManifest();\n  return manifest.options.map((option) => normalizeToggleOption(option));\n}\n\nfunction buildLockedOptionIds(): Set<ToolToggleId> {\n  const ids = new Set<ToolToggleId>();\n  for (const option of TOOL_OPTIONS) {\n    if (option.locked) {\n      ids.add(option.id);\n    }\n  }\n  return ids;\n}\n\nfunction buildDefaultOptionIds(): Set<ToolToggleId> {\n  const ids = new Set<ToolToggleId>();\n  for (const option of TOOL_OPTIONS) {\n    if (option.defaultEnabled) {\n      ids.add(option.id);\n    }\n  }\n  return ids;\n}\n\nfunction normalizeToggleOption(option: ToolAvailabilityOption): ToolToggleOption {\n  const pluginIds = option.pluginIds ?? [];\n  if (!pluginIds.length) {\n    throw new Error(`Tool option \"${option.id}\" is missing plugin bindings.`);\n  }\n\n  const normalized: ToolToggleOption = {\n    id: option.id,\n    label: option.label,\n    description: option.description,\n    defaultEnabled: option.defaultEnabled,\n    pluginIds: [...pluginIds],\n  };\n\n  if (option.category) {\n    normalized.category = option.category;\n  }\n  if (option.scopes?.length) {\n    normalized.scopes = [...option.scopes];\n  }\n  const secret = normalizeSecret(option.requiresSecret);\n  if (secret) {\n    normalized.requiresSecret = secret;\n  }\n  if (option.metadata) {\n    normalized.metadata = { ...option.metadata };\n  }\n  if (option.metadata && option.metadata['locked'] === true) {\n    normalized.locked = true;\n  }\n  if (option.metadata && option.metadata['restartRequired'] === true) {\n    normalized.restartRequired = true;\n  }\n\n  return normalized;\n}\n\nfunction buildSecretLookup(): Set<SecretName> {\n  const ids = listSecretDefinitions().map((secret) => secret.id);\n  return new Set(ids);\n}\n\nfunction normalizeSecret(value: string | undefined): SecretName | undefined {\n  if (!value) {\n    return undefined;\n  }\n  if (!SECRET_LOOKUP.has(value as SecretName)) {\n    throw new Error(`Tool manifest references unknown secret \"${value}\".`);\n  }\n  return value as SecretName;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
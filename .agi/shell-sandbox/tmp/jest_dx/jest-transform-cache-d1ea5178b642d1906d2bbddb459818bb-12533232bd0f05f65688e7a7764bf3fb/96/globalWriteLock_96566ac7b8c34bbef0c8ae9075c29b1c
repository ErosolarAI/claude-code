775b6963d25736bf42d476a0c94d02e6
/* istanbul ignore next */
function cov_2bjg00my47() {
  var path = "/Volumes/4TB/GitHub/src/ui/globalWriteLock.ts";
  var hash = "ce5e9c219cae10013baf508be868251b3ddca4fc";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Volumes/4TB/GitHub/src/ui/globalWriteLock.ts",
    statementMap: {
      "0": {
        start: {
          line: 18,
          column: 16
        },
        end: {
          line: 18,
          column: 17
        }
      },
      "1": {
        start: {
          line: 21,
          column: 22
        },
        end: {
          line: 21,
          column: 27
        }
      },
      "2": {
        start: {
          line: 24,
          column: 44
        },
        end: {
          line: 24,
          column: 46
        }
      },
      "3": {
        start: {
          line: 27,
          column: 30
        },
        end: {
          line: 27,
          column: 33
        }
      },
      "4": {
        start: {
          line: 30,
          column: 24
        },
        end: {
          line: 30,
          column: 29
        }
      },
      "5": {
        start: {
          line: 33,
          column: 41
        },
        end: {
          line: 33,
          column: 45
        }
      },
      "6": {
        start: {
          line: 39,
          column: 2
        },
        end: {
          line: 39,
          column: 42
        }
      },
      "7": {
        start: {
          line: 46,
          column: 2
        },
        end: {
          line: 46,
          column: 19
        }
      },
      "8": {
        start: {
          line: 54,
          column: 2
        },
        end: {
          line: 54,
          column: 14
        }
      },
      "9": {
        start: {
          line: 55,
          column: 2
        },
        end: {
          line: 55,
          column: 25
        }
      },
      "10": {
        start: {
          line: 58,
          column: 2
        },
        end: {
          line: 66,
          column: 3
        }
      },
      "11": {
        start: {
          line: 59,
          column: 4
        },
        end: {
          line: 65,
          column: 24
        }
      },
      "12": {
        start: {
          line: 60,
          column: 6
        },
        end: {
          line: 64,
          column: 7
        }
      },
      "13": {
        start: {
          line: 62,
          column: 8
        },
        end: {
          line: 62,
          column: 85
        }
      },
      "14": {
        start: {
          line: 63,
          column: 8
        },
        end: {
          line: 63,
          column: 23
        }
      },
      "15": {
        start: {
          line: 74,
          column: 2
        },
        end: {
          line: 76,
          column: 3
        }
      },
      "16": {
        start: {
          line: 75,
          column: 4
        },
        end: {
          line: 75,
          column: 16
        }
      },
      "17": {
        start: {
          line: 79,
          column: 2
        },
        end: {
          line: 83,
          column: 3
        }
      },
      "18": {
        start: {
          line: 80,
          column: 4
        },
        end: {
          line: 80,
          column: 28
        }
      },
      "19": {
        start: {
          line: 81,
          column: 4
        },
        end: {
          line: 81,
          column: 23
        }
      },
      "20": {
        start: {
          line: 82,
          column: 4
        },
        end: {
          line: 82,
          column: 28
        }
      },
      "21": {
        start: {
          line: 90,
          column: 2
        },
        end: {
          line: 90,
          column: 16
        }
      },
      "22": {
        start: {
          line: 91,
          column: 2
        },
        end: {
          line: 91,
          column: 26
        }
      },
      "23": {
        start: {
          line: 92,
          column: 2
        },
        end: {
          line: 92,
          column: 21
        }
      },
      "24": {
        start: {
          line: 93,
          column: 2
        },
        end: {
          line: 93,
          column: 26
        }
      },
      "25": {
        start: {
          line: 100,
          column: 2
        },
        end: {
          line: 103,
          column: 3
        }
      },
      "26": {
        start: {
          line: 101,
          column: 4
        },
        end: {
          line: 101,
          column: 30
        }
      },
      "27": {
        start: {
          line: 102,
          column: 4
        },
        end: {
          line: 102,
          column: 23
        }
      },
      "28": {
        start: {
          line: 111,
          column: 2
        },
        end: {
          line: 118,
          column: 3
        }
      },
      "29": {
        start: {
          line: 112,
          column: 21
        },
        end: {
          line: 112,
          column: 45
        }
      },
      "30": {
        start: {
          line: 113,
          column: 4
        },
        end: {
          line: 117,
          column: 5
        }
      },
      "31": {
        start: {
          line: 114,
          column: 6
        },
        end: {
          line: 114,
          column: 19
        }
      },
      "32": {
        start: {
          line: 126,
          column: 2
        },
        end: {
          line: 128,
          column: 3
        }
      },
      "33": {
        start: {
          line: 127,
          column: 4
        },
        end: {
          line: 127,
          column: 17
        }
      },
      "34": {
        start: {
          line: 129,
          column: 2
        },
        end: {
          line: 135,
          column: 3
        }
      },
      "35": {
        start: {
          line: 130,
          column: 4
        },
        end: {
          line: 130,
          column: 15
        }
      },
      "36": {
        start: {
          line: 131,
          column: 4
        },
        end: {
          line: 131,
          column: 16
        }
      },
      "37": {
        start: {
          line: 134,
          column: 4
        },
        end: {
          line: 134,
          column: 17
        }
      },
      "38": {
        start: {
          line: 143,
          column: 2
        },
        end: {
          line: 150,
          column: 3
        }
      },
      "39": {
        start: {
          line: 144,
          column: 4
        },
        end: {
          line: 148,
          column: 5
        }
      },
      "40": {
        start: {
          line: 145,
          column: 6
        },
        end: {
          line: 145,
          column: 17
        }
      },
      "41": {
        start: {
          line: 149,
          column: 4
        },
        end: {
          line: 149,
          column: 11
        }
      },
      "42": {
        start: {
          line: 153,
          column: 2
        },
        end: {
          line: 155,
          column: 3
        }
      },
      "43": {
        start: {
          line: 154,
          column: 4
        },
        end: {
          line: 154,
          column: 36
        }
      },
      "44": {
        start: {
          line: 163,
          column: 2
        },
        end: {
          line: 163,
          column: 23
        }
      },
      "45": {
        start: {
          line: 164,
          column: 2
        },
        end: {
          line: 168,
          column: 3
        }
      },
      "46": {
        start: {
          line: 165,
          column: 4
        },
        end: {
          line: 165,
          column: 28
        }
      },
      "47": {
        start: {
          line: 167,
          column: 4
        },
        end: {
          line: 167,
          column: 24
        }
      },
      "48": {
        start: {
          line: 185,
          column: 2
        },
        end: {
          line: 185,
          column: 16
        }
      },
      "49": {
        start: {
          line: 186,
          column: 2
        },
        end: {
          line: 186,
          column: 26
        }
      },
      "50": {
        start: {
          line: 187,
          column: 2
        },
        end: {
          line: 187,
          column: 21
        }
      },
      "51": {
        start: {
          line: 188,
          column: 2
        },
        end: {
          line: 188,
          column: 30
        }
      }
    },
    fnMap: {
      "0": {
        name: "isStreamingMode",
        decl: {
          start: {
            line: 38,
            column: 16
          },
          end: {
            line: 38,
            column: 31
          }
        },
        loc: {
          start: {
            line: 38,
            column: 43
          },
          end: {
            line: 40,
            column: 1
          }
        },
        line: 38
      },
      "1": {
        name: "getLockDepth",
        decl: {
          start: {
            line: 45,
            column: 16
          },
          end: {
            line: 45,
            column: 28
          }
        },
        loc: {
          start: {
            line: 45,
            column: 39
          },
          end: {
            line: 47,
            column: 1
          }
        },
        line: 45
      },
      "2": {
        name: "enterStreamingMode",
        decl: {
          start: {
            line: 53,
            column: 16
          },
          end: {
            line: 53,
            column: 34
          }
        },
        loc: {
          start: {
            line: 53,
            column: 43
          },
          end: {
            line: 67,
            column: 1
          }
        },
        line: 53
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 59,
            column: 29
          },
          end: {
            line: 59,
            column: 30
          }
        },
        loc: {
          start: {
            line: 59,
            column: 35
          },
          end: {
            line: 65,
            column: 5
          }
        },
        line: 59
      },
      "4": {
        name: "exitStreamingMode",
        decl: {
          start: {
            line: 73,
            column: 16
          },
          end: {
            line: 73,
            column: 33
          }
        },
        loc: {
          start: {
            line: 73,
            column: 42
          },
          end: {
            line: 84,
            column: 1
          }
        },
        line: 73
      },
      "5": {
        name: "forceRelease",
        decl: {
          start: {
            line: 89,
            column: 16
          },
          end: {
            line: 89,
            column: 28
          }
        },
        loc: {
          start: {
            line: 89,
            column: 37
          },
          end: {
            line: 94,
            column: 1
          }
        },
        line: 89
      },
      "6": {
        name: "clearSafetyTimer",
        decl: {
          start: {
            line: 99,
            column: 9
          },
          end: {
            line: 99,
            column: 25
          }
        },
        loc: {
          start: {
            line: 99,
            column: 34
          },
          end: {
            line: 104,
            column: 1
          }
        },
        line: 99
      },
      "7": {
        name: "flushPendingCallbacks",
        decl: {
          start: {
            line: 109,
            column: 9
          },
          end: {
            line: 109,
            column: 30
          }
        },
        loc: {
          start: {
            line: 109,
            column: 39
          },
          end: {
            line: 119,
            column: 1
          }
        },
        line: 109
      },
      "8": {
        name: "ifNotStreaming",
        decl: {
          start: {
            line: 125,
            column: 16
          },
          end: {
            line: 125,
            column: 30
          }
        },
        loc: {
          start: {
            line: 125,
            column: 62
          },
          end: {
            line: 136,
            column: 1
          }
        },
        line: 125
      },
      "9": {
        name: "whenStreamingEnds",
        decl: {
          start: {
            line: 142,
            column: 16
          },
          end: {
            line: 142,
            column: 33
          }
        },
        loc: {
          start: {
            line: 142,
            column: 62
          },
          end: {
            line: 156,
            column: 1
          }
        },
        line: 142
      },
      "10": {
        name: "withStreamLock",
        decl: {
          start: {
            line: 162,
            column: 22
          },
          end: {
            line: 162,
            column: 36
          }
        },
        loc: {
          start: {
            line: 162,
            column: 84
          },
          end: {
            line: 169,
            column: 1
          }
        },
        line: 162
      },
      "11": {
        name: "installGlobalWriteLock",
        decl: {
          start: {
            line: 176,
            column: 16
          },
          end: {
            line: 176,
            column: 38
          }
        },
        loc: {
          start: {
            line: 176,
            column: 47
          },
          end: {
            line: 179,
            column: 1
          }
        },
        line: 176
      },
      "12": {
        name: "resetGlobalWriteLock",
        decl: {
          start: {
            line: 184,
            column: 16
          },
          end: {
            line: 184,
            column: 36
          }
        },
        loc: {
          start: {
            line: 184,
            column: 45
          },
          end: {
            line: 189,
            column: 1
          }
        },
        line: 184
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 39,
            column: 9
          },
          end: {
            line: 39,
            column: 41
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 39,
            column: 9
          },
          end: {
            line: 39,
            column: 24
          }
        }, {
          start: {
            line: 39,
            column: 28
          },
          end: {
            line: 39,
            column: 41
          }
        }],
        line: 39
      },
      "1": {
        loc: {
          start: {
            line: 58,
            column: 2
          },
          end: {
            line: 66,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 58,
            column: 2
          },
          end: {
            line: 66,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 58
      },
      "2": {
        loc: {
          start: {
            line: 58,
            column: 6
          },
          end: {
            line: 58,
            column: 37
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 58,
            column: 6
          },
          end: {
            line: 58,
            column: 21
          }
        }, {
          start: {
            line: 58,
            column: 25
          },
          end: {
            line: 58,
            column: 37
          }
        }],
        line: 58
      },
      "3": {
        loc: {
          start: {
            line: 60,
            column: 6
          },
          end: {
            line: 64,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 60,
            column: 6
          },
          end: {
            line: 64,
            column: 7
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 60
      },
      "4": {
        loc: {
          start: {
            line: 74,
            column: 2
          },
          end: {
            line: 76,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 74,
            column: 2
          },
          end: {
            line: 76,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 74
      },
      "5": {
        loc: {
          start: {
            line: 79,
            column: 2
          },
          end: {
            line: 83,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 79,
            column: 2
          },
          end: {
            line: 83,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 79
      },
      "6": {
        loc: {
          start: {
            line: 100,
            column: 2
          },
          end: {
            line: 103,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 100,
            column: 2
          },
          end: {
            line: 103,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 100
      },
      "7": {
        loc: {
          start: {
            line: 126,
            column: 2
          },
          end: {
            line: 128,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 126,
            column: 2
          },
          end: {
            line: 128,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 126
      },
      "8": {
        loc: {
          start: {
            line: 143,
            column: 2
          },
          end: {
            line: 150,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 143,
            column: 2
          },
          end: {
            line: 150,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 143
      },
      "9": {
        loc: {
          start: {
            line: 153,
            column: 2
          },
          end: {
            line: 155,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 153,
            column: 2
          },
          end: {
            line: 155,
            column: 3
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 153
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "ce5e9c219cae10013baf508be868251b3ddca4fc"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2bjg00my47 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2bjg00my47();
/**
 * Global Write Lock - Robust streaming-safe output coordination
 *
 * This module provides a thread-safe mechanism to ensure streaming content
 * is not interrupted by other UI components during streaming.
 *
 * Design Principles:
 * - During streaming, ONLY streaming content writes to stdout
 * - All other UI components (status, input area, etc.) wait until streaming ends
 * - Supports nested/re-entrant locking with reference counting
 * - Provides timeout-based automatic unlock for safety
 *
 * This prevents the garbled output and cutoffs that occur when multiple
 * components try to write simultaneously with cursor positioning.
 */

/** Current lock depth for re-entrant locking */
let lockDepth =
/* istanbul ignore next */
(cov_2bjg00my47().s[0]++, 0);

/** Streaming mode flag (true when actively streaming content) */
let streamingActive =
/* istanbul ignore next */
(cov_2bjg00my47().s[1]++, false);

/** Queue of callbacks waiting for stream to finish */
const pendingCallbacks =
/* istanbul ignore next */
(cov_2bjg00my47().s[2]++, []);

/** Maximum pending callbacks to prevent memory leaks */
const MAX_PENDING_CALLBACKS =
/* istanbul ignore next */
(cov_2bjg00my47().s[3]++, 100);

/** Safety timeout to auto-release stuck locks (30 seconds) */
const LOCK_TIMEOUT_MS =
/* istanbul ignore next */
(cov_2bjg00my47().s[4]++, 30000);

/** Timer for auto-unlock safety mechanism */
let safetyTimer =
/* istanbul ignore next */
(cov_2bjg00my47().s[5]++, null);

/**
 * Check if streaming mode is currently active
 */
export function isStreamingMode() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[0]++;
  cov_2bjg00my47().s[6]++;
  return /* istanbul ignore next */(cov_2bjg00my47().b[0][0]++, streamingActive) ||
  /* istanbul ignore next */
  (cov_2bjg00my47().b[0][1]++, lockDepth > 0);
}

/**
 * Get current lock depth (for debugging)
 */
export function getLockDepth() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[1]++;
  cov_2bjg00my47().s[7]++;
  return lockDepth;
}

/**
 * Enter streaming mode - blocks all non-streaming output
 * Supports nested calls with reference counting
 */
export function enterStreamingMode() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[2]++;
  cov_2bjg00my47().s[8]++;
  lockDepth++;
  /* istanbul ignore next */
  cov_2bjg00my47().s[9]++;
  streamingActive = true;

  // Set safety timer on first lock
  /* istanbul ignore next */
  cov_2bjg00my47().s[10]++;
  if (
  /* istanbul ignore next */
  (cov_2bjg00my47().b[2][0]++, lockDepth === 1) &&
  /* istanbul ignore next */
  (cov_2bjg00my47().b[2][1]++, !safetyTimer)) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[1][0]++;
    cov_2bjg00my47().s[11]++;
    safetyTimer = setTimeout(() => {
      /* istanbul ignore next */
      cov_2bjg00my47().f[3]++;
      cov_2bjg00my47().s[12]++;
      if (streamingActive) {
        /* istanbul ignore next */
        cov_2bjg00my47().b[3][0]++;
        cov_2bjg00my47().s[13]++;
        // Force release if lock is held too long (safety mechanism)
        console.warn('[GlobalWriteLock] Safety timeout triggered - forcing release');
        /* istanbul ignore next */
        cov_2bjg00my47().s[14]++;
        forceRelease();
      } else
      /* istanbul ignore next */
      {
        cov_2bjg00my47().b[3][1]++;
      }
    }, LOCK_TIMEOUT_MS);
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[1][1]++;
  }
}

/**
 * Exit streaming mode - allows normal UI output to resume
 * Only fully exits when all nested locks are released
 */
export function exitStreamingMode() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[4]++;
  cov_2bjg00my47().s[15]++;
  if (lockDepth > 0) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[4][0]++;
    cov_2bjg00my47().s[16]++;
    lockDepth--;
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[4][1]++;
  }

  // Only clear streaming mode when all locks are released
  cov_2bjg00my47().s[17]++;
  if (lockDepth === 0) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[5][0]++;
    cov_2bjg00my47().s[18]++;
    streamingActive = false;
    /* istanbul ignore next */
    cov_2bjg00my47().s[19]++;
    clearSafetyTimer();
    /* istanbul ignore next */
    cov_2bjg00my47().s[20]++;
    flushPendingCallbacks();
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[5][1]++;
  }
}

/**
 * Force release all locks (emergency/cleanup use)
 */
export function forceRelease() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[5]++;
  cov_2bjg00my47().s[21]++;
  lockDepth = 0;
  /* istanbul ignore next */
  cov_2bjg00my47().s[22]++;
  streamingActive = false;
  /* istanbul ignore next */
  cov_2bjg00my47().s[23]++;
  clearSafetyTimer();
  /* istanbul ignore next */
  cov_2bjg00my47().s[24]++;
  flushPendingCallbacks();
}

/**
 * Clear the safety timer
 */
function clearSafetyTimer() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[6]++;
  cov_2bjg00my47().s[25]++;
  if (safetyTimer) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[6][0]++;
    cov_2bjg00my47().s[26]++;
    clearTimeout(safetyTimer);
    /* istanbul ignore next */
    cov_2bjg00my47().s[27]++;
    safetyTimer = null;
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[6][1]++;
  }
}

/**
 * Flush all pending callbacks
 */
function flushPendingCallbacks() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[7]++;
  cov_2bjg00my47().s[28]++;
  // Process callbacks in order
  while (pendingCallbacks.length > 0) {
    const callback =
    /* istanbul ignore next */
    (cov_2bjg00my47().s[29]++, pendingCallbacks.shift());
    /* istanbul ignore next */
    cov_2bjg00my47().s[30]++;
    try {
      /* istanbul ignore next */
      cov_2bjg00my47().s[31]++;
      callback?.();
    } catch {
      // Silently ignore callback errors to prevent cascading failures
    }
  }
}

/**
 * Execute a callback only if not in streaming mode.
 * Returns true if the callback was executed, false if skipped.
 */
export function ifNotStreaming(callback) {
  /* istanbul ignore next */
  cov_2bjg00my47().f[8]++;
  cov_2bjg00my47().s[32]++;
  if (isStreamingMode()) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[7][0]++;
    cov_2bjg00my47().s[33]++;
    return false;
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[7][1]++;
  }
  cov_2bjg00my47().s[34]++;
  try {
    /* istanbul ignore next */
    cov_2bjg00my47().s[35]++;
    callback();
    /* istanbul ignore next */
    cov_2bjg00my47().s[36]++;
    return true;
  } catch {
    /* istanbul ignore next */
    cov_2bjg00my47().s[37]++;
    // Silently handle callback errors
    return false;
  }
}

/**
 * Execute a callback when streaming ends (immediately if not streaming)
 * Queues the callback if currently streaming
 */
export function whenStreamingEnds(callback) {
  /* istanbul ignore next */
  cov_2bjg00my47().f[9]++;
  cov_2bjg00my47().s[38]++;
  if (!isStreamingMode()) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[8][0]++;
    cov_2bjg00my47().s[39]++;
    try {
      /* istanbul ignore next */
      cov_2bjg00my47().s[40]++;
      callback();
    } catch {
      // Silently handle callback errors
    }
    /* istanbul ignore next */
    cov_2bjg00my47().s[41]++;
    return;
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[8][1]++;
  }

  // Queue callback for later, with overflow protection
  cov_2bjg00my47().s[42]++;
  if (pendingCallbacks.length < MAX_PENDING_CALLBACKS) {
    /* istanbul ignore next */
    cov_2bjg00my47().b[9][0]++;
    cov_2bjg00my47().s[43]++;
    pendingCallbacks.push(callback);
  } else
  /* istanbul ignore next */
  {
    cov_2bjg00my47().b[9][1]++;
  }
}

/**
 * Execute callback with exclusive stream lock
 * Automatically acquires and releases the lock
 */
export async function withStreamLock(callback) {
  /* istanbul ignore next */
  cov_2bjg00my47().f[10]++;
  cov_2bjg00my47().s[44]++;
  enterStreamingMode();
  /* istanbul ignore next */
  cov_2bjg00my47().s[45]++;
  try {
    /* istanbul ignore next */
    cov_2bjg00my47().s[46]++;
    return await callback();
  } finally {
    /* istanbul ignore next */
    cov_2bjg00my47().s[47]++;
    exitStreamingMode();
  }
}

/**
 * Legacy: installGlobalWriteLock is now a no-op
 * The old approach of wrapping stdout.write caused nested lock issues.
 * We now use a simpler streaming mode flag instead.
 */
export function installGlobalWriteLock() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[11]++;
} // No-op - we no longer wrap stdout.write
// The streaming mode flag handles coordination instead

/**
 * Reset all state (for testing)
 */
export function resetGlobalWriteLock() {
  /* istanbul ignore next */
  cov_2bjg00my47().f[12]++;
  cov_2bjg00my47().s[48]++;
  lockDepth = 0;
  /* istanbul ignore next */
  cov_2bjg00my47().s[49]++;
  streamingActive = false;
  /* istanbul ignore next */
  cov_2bjg00my47().s[50]++;
  clearSafetyTimer();
  /* istanbul ignore next */
  cov_2bjg00my47().s[51]++;
  pendingCallbacks.length = 0;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMmJqZzAwbXk0NyIsImFjdHVhbENvdmVyYWdlIiwibG9ja0RlcHRoIiwicyIsInN0cmVhbWluZ0FjdGl2ZSIsInBlbmRpbmdDYWxsYmFja3MiLCJNQVhfUEVORElOR19DQUxMQkFDS1MiLCJMT0NLX1RJTUVPVVRfTVMiLCJzYWZldHlUaW1lciIsImlzU3RyZWFtaW5nTW9kZSIsImYiLCJiIiwiZ2V0TG9ja0RlcHRoIiwiZW50ZXJTdHJlYW1pbmdNb2RlIiwic2V0VGltZW91dCIsImNvbnNvbGUiLCJ3YXJuIiwiZm9yY2VSZWxlYXNlIiwiZXhpdFN0cmVhbWluZ01vZGUiLCJjbGVhclNhZmV0eVRpbWVyIiwiZmx1c2hQZW5kaW5nQ2FsbGJhY2tzIiwiY2xlYXJUaW1lb3V0IiwibGVuZ3RoIiwiY2FsbGJhY2siLCJzaGlmdCIsImlmTm90U3RyZWFtaW5nIiwid2hlblN0cmVhbWluZ0VuZHMiLCJwdXNoIiwid2l0aFN0cmVhbUxvY2siLCJpbnN0YWxsR2xvYmFsV3JpdGVMb2NrIiwicmVzZXRHbG9iYWxXcml0ZUxvY2siXSwic291cmNlcyI6WyJnbG9iYWxXcml0ZUxvY2sudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBHbG9iYWwgV3JpdGUgTG9jayAtIFJvYnVzdCBzdHJlYW1pbmctc2FmZSBvdXRwdXQgY29vcmRpbmF0aW9uXG4gKlxuICogVGhpcyBtb2R1bGUgcHJvdmlkZXMgYSB0aHJlYWQtc2FmZSBtZWNoYW5pc20gdG8gZW5zdXJlIHN0cmVhbWluZyBjb250ZW50XG4gKiBpcyBub3QgaW50ZXJydXB0ZWQgYnkgb3RoZXIgVUkgY29tcG9uZW50cyBkdXJpbmcgc3RyZWFtaW5nLlxuICpcbiAqIERlc2lnbiBQcmluY2lwbGVzOlxuICogLSBEdXJpbmcgc3RyZWFtaW5nLCBPTkxZIHN0cmVhbWluZyBjb250ZW50IHdyaXRlcyB0byBzdGRvdXRcbiAqIC0gQWxsIG90aGVyIFVJIGNvbXBvbmVudHMgKHN0YXR1cywgaW5wdXQgYXJlYSwgZXRjLikgd2FpdCB1bnRpbCBzdHJlYW1pbmcgZW5kc1xuICogLSBTdXBwb3J0cyBuZXN0ZWQvcmUtZW50cmFudCBsb2NraW5nIHdpdGggcmVmZXJlbmNlIGNvdW50aW5nXG4gKiAtIFByb3ZpZGVzIHRpbWVvdXQtYmFzZWQgYXV0b21hdGljIHVubG9jayBmb3Igc2FmZXR5XG4gKlxuICogVGhpcyBwcmV2ZW50cyB0aGUgZ2FyYmxlZCBvdXRwdXQgYW5kIGN1dG9mZnMgdGhhdCBvY2N1ciB3aGVuIG11bHRpcGxlXG4gKiBjb21wb25lbnRzIHRyeSB0byB3cml0ZSBzaW11bHRhbmVvdXNseSB3aXRoIGN1cnNvciBwb3NpdGlvbmluZy5cbiAqL1xuXG4vKiogQ3VycmVudCBsb2NrIGRlcHRoIGZvciByZS1lbnRyYW50IGxvY2tpbmcgKi9cbmxldCBsb2NrRGVwdGggPSAwO1xuXG4vKiogU3RyZWFtaW5nIG1vZGUgZmxhZyAodHJ1ZSB3aGVuIGFjdGl2ZWx5IHN0cmVhbWluZyBjb250ZW50KSAqL1xubGV0IHN0cmVhbWluZ0FjdGl2ZSA9IGZhbHNlO1xuXG4vKiogUXVldWUgb2YgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIHN0cmVhbSB0byBmaW5pc2ggKi9cbmNvbnN0IHBlbmRpbmdDYWxsYmFja3M6IEFycmF5PCgpID0+IHZvaWQ+ID0gW107XG5cbi8qKiBNYXhpbXVtIHBlbmRpbmcgY2FsbGJhY2tzIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzICovXG5jb25zdCBNQVhfUEVORElOR19DQUxMQkFDS1MgPSAxMDA7XG5cbi8qKiBTYWZldHkgdGltZW91dCB0byBhdXRvLXJlbGVhc2Ugc3R1Y2sgbG9ja3MgKDMwIHNlY29uZHMpICovXG5jb25zdCBMT0NLX1RJTUVPVVRfTVMgPSAzMDAwMDtcblxuLyoqIFRpbWVyIGZvciBhdXRvLXVubG9jayBzYWZldHkgbWVjaGFuaXNtICovXG5sZXQgc2FmZXR5VGltZXI6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG5cbi8qKlxuICogQ2hlY2sgaWYgc3RyZWFtaW5nIG1vZGUgaXMgY3VycmVudGx5IGFjdGl2ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTdHJlYW1pbmdNb2RlKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gc3RyZWFtaW5nQWN0aXZlIHx8IGxvY2tEZXB0aCA+IDA7XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgbG9jayBkZXB0aCAoZm9yIGRlYnVnZ2luZylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvY2tEZXB0aCgpOiBudW1iZXIge1xuICByZXR1cm4gbG9ja0RlcHRoO1xufVxuXG4vKipcbiAqIEVudGVyIHN0cmVhbWluZyBtb2RlIC0gYmxvY2tzIGFsbCBub24tc3RyZWFtaW5nIG91dHB1dFxuICogU3VwcG9ydHMgbmVzdGVkIGNhbGxzIHdpdGggcmVmZXJlbmNlIGNvdW50aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlbnRlclN0cmVhbWluZ01vZGUoKTogdm9pZCB7XG4gIGxvY2tEZXB0aCsrO1xuICBzdHJlYW1pbmdBY3RpdmUgPSB0cnVlO1xuXG4gIC8vIFNldCBzYWZldHkgdGltZXIgb24gZmlyc3QgbG9ja1xuICBpZiAobG9ja0RlcHRoID09PSAxICYmICFzYWZldHlUaW1lcikge1xuICAgIHNhZmV0eVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoc3RyZWFtaW5nQWN0aXZlKSB7XG4gICAgICAgIC8vIEZvcmNlIHJlbGVhc2UgaWYgbG9jayBpcyBoZWxkIHRvbyBsb25nIChzYWZldHkgbWVjaGFuaXNtKVxuICAgICAgICBjb25zb2xlLndhcm4oJ1tHbG9iYWxXcml0ZUxvY2tdIFNhZmV0eSB0aW1lb3V0IHRyaWdnZXJlZCAtIGZvcmNpbmcgcmVsZWFzZScpO1xuICAgICAgICBmb3JjZVJlbGVhc2UoKTtcbiAgICAgIH1cbiAgICB9LCBMT0NLX1RJTUVPVVRfTVMpO1xuICB9XG59XG5cbi8qKlxuICogRXhpdCBzdHJlYW1pbmcgbW9kZSAtIGFsbG93cyBub3JtYWwgVUkgb3V0cHV0IHRvIHJlc3VtZVxuICogT25seSBmdWxseSBleGl0cyB3aGVuIGFsbCBuZXN0ZWQgbG9ja3MgYXJlIHJlbGVhc2VkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBleGl0U3RyZWFtaW5nTW9kZSgpOiB2b2lkIHtcbiAgaWYgKGxvY2tEZXB0aCA+IDApIHtcbiAgICBsb2NrRGVwdGgtLTtcbiAgfVxuXG4gIC8vIE9ubHkgY2xlYXIgc3RyZWFtaW5nIG1vZGUgd2hlbiBhbGwgbG9ja3MgYXJlIHJlbGVhc2VkXG4gIGlmIChsb2NrRGVwdGggPT09IDApIHtcbiAgICBzdHJlYW1pbmdBY3RpdmUgPSBmYWxzZTtcbiAgICBjbGVhclNhZmV0eVRpbWVyKCk7XG4gICAgZmx1c2hQZW5kaW5nQ2FsbGJhY2tzKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBGb3JjZSByZWxlYXNlIGFsbCBsb2NrcyAoZW1lcmdlbmN5L2NsZWFudXAgdXNlKVxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9yY2VSZWxlYXNlKCk6IHZvaWQge1xuICBsb2NrRGVwdGggPSAwO1xuICBzdHJlYW1pbmdBY3RpdmUgPSBmYWxzZTtcbiAgY2xlYXJTYWZldHlUaW1lcigpO1xuICBmbHVzaFBlbmRpbmdDYWxsYmFja3MoKTtcbn1cblxuLyoqXG4gKiBDbGVhciB0aGUgc2FmZXR5IHRpbWVyXG4gKi9cbmZ1bmN0aW9uIGNsZWFyU2FmZXR5VGltZXIoKTogdm9pZCB7XG4gIGlmIChzYWZldHlUaW1lcikge1xuICAgIGNsZWFyVGltZW91dChzYWZldHlUaW1lcik7XG4gICAgc2FmZXR5VGltZXIgPSBudWxsO1xuICB9XG59XG5cbi8qKlxuICogRmx1c2ggYWxsIHBlbmRpbmcgY2FsbGJhY2tzXG4gKi9cbmZ1bmN0aW9uIGZsdXNoUGVuZGluZ0NhbGxiYWNrcygpOiB2b2lkIHtcbiAgLy8gUHJvY2VzcyBjYWxsYmFja3MgaW4gb3JkZXJcbiAgd2hpbGUgKHBlbmRpbmdDYWxsYmFja3MubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IGNhbGxiYWNrID0gcGVuZGluZ0NhbGxiYWNrcy5zaGlmdCgpO1xuICAgIHRyeSB7XG4gICAgICBjYWxsYmFjaz8uKCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICAvLyBTaWxlbnRseSBpZ25vcmUgY2FsbGJhY2sgZXJyb3JzIHRvIHByZXZlbnQgY2FzY2FkaW5nIGZhaWx1cmVzXG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRXhlY3V0ZSBhIGNhbGxiYWNrIG9ubHkgaWYgbm90IGluIHN0cmVhbWluZyBtb2RlLlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBjYWxsYmFjayB3YXMgZXhlY3V0ZWQsIGZhbHNlIGlmIHNraXBwZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpZk5vdFN0cmVhbWluZyhjYWxsYmFjazogKCkgPT4gdm9pZCk6IGJvb2xlYW4ge1xuICBpZiAoaXNTdHJlYW1pbmdNb2RlKCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdHJ5IHtcbiAgICBjYWxsYmFjaygpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICAvLyBTaWxlbnRseSBoYW5kbGUgY2FsbGJhY2sgZXJyb3JzXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRXhlY3V0ZSBhIGNhbGxiYWNrIHdoZW4gc3RyZWFtaW5nIGVuZHMgKGltbWVkaWF0ZWx5IGlmIG5vdCBzdHJlYW1pbmcpXG4gKiBRdWV1ZXMgdGhlIGNhbGxiYWNrIGlmIGN1cnJlbnRseSBzdHJlYW1pbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHdoZW5TdHJlYW1pbmdFbmRzKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gIGlmICghaXNTdHJlYW1pbmdNb2RlKCkpIHtcbiAgICB0cnkge1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIFNpbGVudGx5IGhhbmRsZSBjYWxsYmFjayBlcnJvcnNcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gUXVldWUgY2FsbGJhY2sgZm9yIGxhdGVyLCB3aXRoIG92ZXJmbG93IHByb3RlY3Rpb25cbiAgaWYgKHBlbmRpbmdDYWxsYmFja3MubGVuZ3RoIDwgTUFYX1BFTkRJTkdfQ0FMTEJBQ0tTKSB7XG4gICAgcGVuZGluZ0NhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgfVxufVxuXG4vKipcbiAqIEV4ZWN1dGUgY2FsbGJhY2sgd2l0aCBleGNsdXNpdmUgc3RyZWFtIGxvY2tcbiAqIEF1dG9tYXRpY2FsbHkgYWNxdWlyZXMgYW5kIHJlbGVhc2VzIHRoZSBsb2NrXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoU3RyZWFtTG9jazxUPihjYWxsYmFjazogKCkgPT4gVCB8IFByb21pc2U8VD4pOiBQcm9taXNlPFQ+IHtcbiAgZW50ZXJTdHJlYW1pbmdNb2RlKCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGNhbGxiYWNrKCk7XG4gIH0gZmluYWxseSB7XG4gICAgZXhpdFN0cmVhbWluZ01vZGUoKTtcbiAgfVxufVxuXG4vKipcbiAqIExlZ2FjeTogaW5zdGFsbEdsb2JhbFdyaXRlTG9jayBpcyBub3cgYSBuby1vcFxuICogVGhlIG9sZCBhcHByb2FjaCBvZiB3cmFwcGluZyBzdGRvdXQud3JpdGUgY2F1c2VkIG5lc3RlZCBsb2NrIGlzc3Vlcy5cbiAqIFdlIG5vdyB1c2UgYSBzaW1wbGVyIHN0cmVhbWluZyBtb2RlIGZsYWcgaW5zdGVhZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc3RhbGxHbG9iYWxXcml0ZUxvY2soKTogdm9pZCB7XG4gIC8vIE5vLW9wIC0gd2Ugbm8gbG9uZ2VyIHdyYXAgc3Rkb3V0LndyaXRlXG4gIC8vIFRoZSBzdHJlYW1pbmcgbW9kZSBmbGFnIGhhbmRsZXMgY29vcmRpbmF0aW9uIGluc3RlYWRcbn1cblxuLyoqXG4gKiBSZXNldCBhbGwgc3RhdGUgKGZvciB0ZXN0aW5nKVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRHbG9iYWxXcml0ZUxvY2soKTogdm9pZCB7XG4gIGxvY2tEZXB0aCA9IDA7XG4gIHN0cmVhbWluZ0FjdGl2ZSA9IGZhbHNlO1xuICBjbGVhclNhZmV0eVRpbWVyKCk7XG4gIHBlbmRpbmdDYWxsYmFja3MubGVuZ3RoID0gMDtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBZVk7SUFBQUEsY0FBQSxZQUFBQSxDQUFBO01BQUEsT0FBQUMsY0FBQTtJQUFBO0VBQUE7RUFBQSxPQUFBQSxjQUFBO0FBQUE7QUFBQUQsY0FBQTtBQWZaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUlFLFNBQVM7QUFBQTtBQUFBLENBQUFGLGNBQUEsR0FBQUcsQ0FBQSxPQUFHLENBQUM7O0FBRWpCO0FBQ0EsSUFBSUMsZUFBZTtBQUFBO0FBQUEsQ0FBQUosY0FBQSxHQUFBRyxDQUFBLE9BQUcsS0FBSzs7QUFFM0I7QUFDQSxNQUFNRSxnQkFBbUM7QUFBQTtBQUFBLENBQUFMLGNBQUEsR0FBQUcsQ0FBQSxPQUFHLEVBQUU7O0FBRTlDO0FBQ0EsTUFBTUcscUJBQXFCO0FBQUE7QUFBQSxDQUFBTixjQUFBLEdBQUFHLENBQUEsT0FBRyxHQUFHOztBQUVqQztBQUNBLE1BQU1JLGVBQWU7QUFBQTtBQUFBLENBQUFQLGNBQUEsR0FBQUcsQ0FBQSxPQUFHLEtBQUs7O0FBRTdCO0FBQ0EsSUFBSUssV0FBa0M7QUFBQTtBQUFBLENBQUFSLGNBQUEsR0FBQUcsQ0FBQSxPQUFHLElBQUk7O0FBRTdDO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU00sZUFBZUEsQ0FBQSxFQUFZO0VBQUE7RUFBQVQsY0FBQSxHQUFBVSxDQUFBO0VBQUFWLGNBQUEsR0FBQUcsQ0FBQTtFQUN6QyxPQUFPLDJCQUFBSCxjQUFBLEdBQUFXLENBQUEsVUFBQVAsZUFBZTtFQUFBO0VBQUEsQ0FBQUosY0FBQSxHQUFBVyxDQUFBLFVBQUlULFNBQVMsR0FBRyxDQUFDO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU1UsWUFBWUEsQ0FBQSxFQUFXO0VBQUE7RUFBQVosY0FBQSxHQUFBVSxDQUFBO0VBQUFWLGNBQUEsR0FBQUcsQ0FBQTtFQUNyQyxPQUFPRCxTQUFTO0FBQ2xCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxTQUFTVyxrQkFBa0JBLENBQUEsRUFBUztFQUFBO0VBQUFiLGNBQUEsR0FBQVUsQ0FBQTtFQUFBVixjQUFBLEdBQUFHLENBQUE7RUFDekNELFNBQVMsRUFBRTtFQUFDO0VBQUFGLGNBQUEsR0FBQUcsQ0FBQTtFQUNaQyxlQUFlLEdBQUcsSUFBSTs7RUFFdEI7RUFBQTtFQUFBSixjQUFBLEdBQUFHLENBQUE7RUFDQTtFQUFJO0VBQUEsQ0FBQUgsY0FBQSxHQUFBVyxDQUFBLFVBQUFULFNBQVMsS0FBSyxDQUFDO0VBQUE7RUFBQSxDQUFBRixjQUFBLEdBQUFXLENBQUEsVUFBSSxDQUFDSCxXQUFXLEdBQUU7SUFBQTtJQUFBUixjQUFBLEdBQUFXLENBQUE7SUFBQVgsY0FBQSxHQUFBRyxDQUFBO0lBQ25DSyxXQUFXLEdBQUdNLFVBQVUsQ0FBQyxNQUFNO01BQUE7TUFBQWQsY0FBQSxHQUFBVSxDQUFBO01BQUFWLGNBQUEsR0FBQUcsQ0FBQTtNQUM3QixJQUFJQyxlQUFlLEVBQUU7UUFBQTtRQUFBSixjQUFBLEdBQUFXLENBQUE7UUFBQVgsY0FBQSxHQUFBRyxDQUFBO1FBQ25CO1FBQ0FZLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLDhEQUE4RCxDQUFDO1FBQUM7UUFBQWhCLGNBQUEsR0FBQUcsQ0FBQTtRQUM3RWMsWUFBWSxDQUFDLENBQUM7TUFDaEIsQ0FBQztNQUFBO01BQUE7UUFBQWpCLGNBQUEsR0FBQVcsQ0FBQTtNQUFBO0lBQ0gsQ0FBQyxFQUFFSixlQUFlLENBQUM7RUFDckIsQ0FBQztFQUFBO0VBQUE7SUFBQVAsY0FBQSxHQUFBVyxDQUFBO0VBQUE7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU08saUJBQWlCQSxDQUFBLEVBQVM7RUFBQTtFQUFBbEIsY0FBQSxHQUFBVSxDQUFBO0VBQUFWLGNBQUEsR0FBQUcsQ0FBQTtFQUN4QyxJQUFJRCxTQUFTLEdBQUcsQ0FBQyxFQUFFO0lBQUE7SUFBQUYsY0FBQSxHQUFBVyxDQUFBO0lBQUFYLGNBQUEsR0FBQUcsQ0FBQTtJQUNqQkQsU0FBUyxFQUFFO0VBQ2IsQ0FBQztFQUFBO0VBQUE7SUFBQUYsY0FBQSxHQUFBVyxDQUFBO0VBQUE7O0VBRUQ7RUFBQVgsY0FBQSxHQUFBRyxDQUFBO0VBQ0EsSUFBSUQsU0FBUyxLQUFLLENBQUMsRUFBRTtJQUFBO0lBQUFGLGNBQUEsR0FBQVcsQ0FBQTtJQUFBWCxjQUFBLEdBQUFHLENBQUE7SUFDbkJDLGVBQWUsR0FBRyxLQUFLO0lBQUM7SUFBQUosY0FBQSxHQUFBRyxDQUFBO0lBQ3hCZ0IsZ0JBQWdCLENBQUMsQ0FBQztJQUFDO0lBQUFuQixjQUFBLEdBQUFHLENBQUE7SUFDbkJpQixxQkFBcUIsQ0FBQyxDQUFDO0VBQ3pCLENBQUM7RUFBQTtFQUFBO0lBQUFwQixjQUFBLEdBQUFXLENBQUE7RUFBQTtBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU00sWUFBWUEsQ0FBQSxFQUFTO0VBQUE7RUFBQWpCLGNBQUEsR0FBQVUsQ0FBQTtFQUFBVixjQUFBLEdBQUFHLENBQUE7RUFDbkNELFNBQVMsR0FBRyxDQUFDO0VBQUM7RUFBQUYsY0FBQSxHQUFBRyxDQUFBO0VBQ2RDLGVBQWUsR0FBRyxLQUFLO0VBQUM7RUFBQUosY0FBQSxHQUFBRyxDQUFBO0VBQ3hCZ0IsZ0JBQWdCLENBQUMsQ0FBQztFQUFDO0VBQUFuQixjQUFBLEdBQUFHLENBQUE7RUFDbkJpQixxQkFBcUIsQ0FBQyxDQUFDO0FBQ3pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVNELGdCQUFnQkEsQ0FBQSxFQUFTO0VBQUE7RUFBQW5CLGNBQUEsR0FBQVUsQ0FBQTtFQUFBVixjQUFBLEdBQUFHLENBQUE7RUFDaEMsSUFBSUssV0FBVyxFQUFFO0lBQUE7SUFBQVIsY0FBQSxHQUFBVyxDQUFBO0lBQUFYLGNBQUEsR0FBQUcsQ0FBQTtJQUNma0IsWUFBWSxDQUFDYixXQUFXLENBQUM7SUFBQztJQUFBUixjQUFBLEdBQUFHLENBQUE7SUFDMUJLLFdBQVcsR0FBRyxJQUFJO0VBQ3BCLENBQUM7RUFBQTtFQUFBO0lBQUFSLGNBQUEsR0FBQVcsQ0FBQTtFQUFBO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBU1MscUJBQXFCQSxDQUFBLEVBQVM7RUFBQTtFQUFBcEIsY0FBQSxHQUFBVSxDQUFBO0VBQUFWLGNBQUEsR0FBQUcsQ0FBQTtFQUNyQztFQUNBLE9BQU9FLGdCQUFnQixDQUFDaUIsTUFBTSxHQUFHLENBQUMsRUFBRTtJQUNsQyxNQUFNQyxRQUFRO0lBQUE7SUFBQSxDQUFBdkIsY0FBQSxHQUFBRyxDQUFBLFFBQUdFLGdCQUFnQixDQUFDbUIsS0FBSyxDQUFDLENBQUM7SUFBQztJQUFBeEIsY0FBQSxHQUFBRyxDQUFBO0lBQzFDLElBQUk7TUFBQTtNQUFBSCxjQUFBLEdBQUFHLENBQUE7TUFDRm9CLFFBQVEsR0FBRyxDQUFDO0lBQ2QsQ0FBQyxDQUFDLE1BQU07TUFDTjtJQUFBO0VBRUo7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sU0FBU0UsY0FBY0EsQ0FBQ0YsUUFBb0IsRUFBVztFQUFBO0VBQUF2QixjQUFBLEdBQUFVLENBQUE7RUFBQVYsY0FBQSxHQUFBRyxDQUFBO0VBQzVELElBQUlNLGVBQWUsQ0FBQyxDQUFDLEVBQUU7SUFBQTtJQUFBVCxjQUFBLEdBQUFXLENBQUE7SUFBQVgsY0FBQSxHQUFBRyxDQUFBO0lBQ3JCLE9BQU8sS0FBSztFQUNkLENBQUM7RUFBQTtFQUFBO0lBQUFILGNBQUEsR0FBQVcsQ0FBQTtFQUFBO0VBQUFYLGNBQUEsR0FBQUcsQ0FBQTtFQUNELElBQUk7SUFBQTtJQUFBSCxjQUFBLEdBQUFHLENBQUE7SUFDRm9CLFFBQVEsQ0FBQyxDQUFDO0lBQUM7SUFBQXZCLGNBQUEsR0FBQUcsQ0FBQTtJQUNYLE9BQU8sSUFBSTtFQUNiLENBQUMsQ0FBQyxNQUFNO0lBQUE7SUFBQUgsY0FBQSxHQUFBRyxDQUFBO0lBQ047SUFDQSxPQUFPLEtBQUs7RUFDZDtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxTQUFTdUIsaUJBQWlCQSxDQUFDSCxRQUFvQixFQUFRO0VBQUE7RUFBQXZCLGNBQUEsR0FBQVUsQ0FBQTtFQUFBVixjQUFBLEdBQUFHLENBQUE7RUFDNUQsSUFBSSxDQUFDTSxlQUFlLENBQUMsQ0FBQyxFQUFFO0lBQUE7SUFBQVQsY0FBQSxHQUFBVyxDQUFBO0lBQUFYLGNBQUEsR0FBQUcsQ0FBQTtJQUN0QixJQUFJO01BQUE7TUFBQUgsY0FBQSxHQUFBRyxDQUFBO01BQ0ZvQixRQUFRLENBQUMsQ0FBQztJQUNaLENBQUMsQ0FBQyxNQUFNO01BQ047SUFBQTtJQUNEO0lBQUF2QixjQUFBLEdBQUFHLENBQUE7SUFDRDtFQUNGLENBQUM7RUFBQTtFQUFBO0lBQUFILGNBQUEsR0FBQVcsQ0FBQTtFQUFBOztFQUVEO0VBQUFYLGNBQUEsR0FBQUcsQ0FBQTtFQUNBLElBQUlFLGdCQUFnQixDQUFDaUIsTUFBTSxHQUFHaEIscUJBQXFCLEVBQUU7SUFBQTtJQUFBTixjQUFBLEdBQUFXLENBQUE7SUFBQVgsY0FBQSxHQUFBRyxDQUFBO0lBQ25ERSxnQkFBZ0IsQ0FBQ3NCLElBQUksQ0FBQ0osUUFBUSxDQUFDO0VBQ2pDLENBQUM7RUFBQTtFQUFBO0lBQUF2QixjQUFBLEdBQUFXLENBQUE7RUFBQTtBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxlQUFlaUIsY0FBY0EsQ0FBSUwsUUFBOEIsRUFBYztFQUFBO0VBQUF2QixjQUFBLEdBQUFVLENBQUE7RUFBQVYsY0FBQSxHQUFBRyxDQUFBO0VBQ2xGVSxrQkFBa0IsQ0FBQyxDQUFDO0VBQUM7RUFBQWIsY0FBQSxHQUFBRyxDQUFBO0VBQ3JCLElBQUk7SUFBQTtJQUFBSCxjQUFBLEdBQUFHLENBQUE7SUFDRixPQUFPLE1BQU1vQixRQUFRLENBQUMsQ0FBQztFQUN6QixDQUFDLFNBQVM7SUFBQTtJQUFBdkIsY0FBQSxHQUFBRyxDQUFBO0lBQ1JlLGlCQUFpQixDQUFDLENBQUM7RUFDckI7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxTQUFTVyxzQkFBc0JBLENBQUEsRUFBUztFQUFBO0VBQUE3QixjQUFBLEdBQUFVLENBQUE7QUFHL0MsQ0FBQyxDQUZDO0FBQ0E7O0FBR0Y7QUFDQTtBQUNBO0FBQ0EsT0FBTyxTQUFTb0Isb0JBQW9CQSxDQUFBLEVBQVM7RUFBQTtFQUFBOUIsY0FBQSxHQUFBVSxDQUFBO0VBQUFWLGNBQUEsR0FBQUcsQ0FBQTtFQUMzQ0QsU0FBUyxHQUFHLENBQUM7RUFBQztFQUFBRixjQUFBLEdBQUFHLENBQUE7RUFDZEMsZUFBZSxHQUFHLEtBQUs7RUFBQztFQUFBSixjQUFBLEdBQUFHLENBQUE7RUFDeEJnQixnQkFBZ0IsQ0FBQyxDQUFDO0VBQUM7RUFBQW5CLGNBQUEsR0FBQUcsQ0FBQTtFQUNuQkUsZ0JBQWdCLENBQUNpQixNQUFNLEdBQUcsQ0FBQztBQUM3QiIsImlnbm9yZUxpc3QiOltdfQ==
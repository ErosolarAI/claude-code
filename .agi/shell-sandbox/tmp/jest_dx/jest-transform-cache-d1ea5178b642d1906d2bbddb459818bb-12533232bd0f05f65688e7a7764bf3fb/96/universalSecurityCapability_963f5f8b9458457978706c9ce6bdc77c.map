{"version":3,"names":["_zeroDayDiscovery","require","_universalSecurityAudit","_securityTournament","_appleSecurityIntegration","UniversalSecurityCapabilityModule","id","options","constructor","enableZeroDayDiscovery","enableUniversalAudit","enableTournamentRL","enableAppleSecurity","defaultAggressiveness","defaultLiveVerification","outputDir","process","cwd","create","context","workingDir","description","toolSuite","tools","createSecurityTools","metadata","capabilities","zeroDayDiscovery","universalAudit","tournamentRL","appleSecurity","push","name","handler","args","config","target","targetType","attackSurface","aggressiveness","liveVerification","enableTournament","heuristics","discovery","ZeroDayDiscovery","result","discover","JSON","stringify","status","executiveSummary","generateZeroDayExecutiveSummary","immediateActions","recommendations","immediate","securityPosture","calculateSecurityPosture","error","message","stack","recommendation","auditConfig","provider","projectId","region","accountId","subscriptionId","aggressive","includeZeroDay","liveTesting","runUniversalSecurityAudit","summary","riskAssessment","calculateRiskAssessment","remediationPriority","prioritizeRemediation","findings","tournamentConfig","providers","projectIds","undefined","autoFix","maxRounds","runSecurityTournament","winningStrategy","optimizationMetrics","rounds","totalRounds","primaryWins","refinerWins","effectiveness","verifiedFindings","Math","max","totalFindings","generateTournamentRecommendations","appleConfig","evidencePrefix","rateLimit","targetScope","enableExploitation","enableRemediation","integration","AppleSecurityIntegration","health","quickCheck","runFullIntegration","securityAssessment","assessAppleSecurity","assessment","timestamp","Date","toISOString","phases","riskScore","phase","zeroDayConfig","zeroDay","zeroDayResult","length","auditResult","calculateOverallRiskScore","generateComprehensiveRecommendations","executiveDashboard","generateExecutiveDashboard","nextSteps","generateNextSteps","enabled","optimization","scope","maximumCapabilities","critical","filter","f","severity","high","verified","zeroDays","zeroDayConfidence","zeroDayCandidates","verifiedVulnerabilities","severityBreakdown","attackVectors","discoveryMetrics","uniqueAttackVectors","discoveryMethods","totalPathsExplored","riskLevel","total","score","level","factors","criticalVulnerabilities","highVulnerabilities","sort","a","b","severityScore","medium","low","aScore","bScore","slice","map","vulnerability","remediation","priority","includes","phasesCompleted","p","criticalFindings","exports"],"sources":["universalSecurityCapability.ts"],"sourcesContent":["/**\n * Universal Security Capability Module\n * \n * MAXIMUM CAPABILITIES FOR COMPREHENSIVE SECURITY OPERATIONS\n * \n * Integrates all security systems: zero-day discovery, universal audit,\n * tournament RL, Apple security, and attack simulation into a single\n * unified capability module for AGI Core.\n */\n\nimport type { CapabilityContribution, CapabilityContext, CapabilityModule } from '../runtime/agentHost.js';\nimport { ZeroDayDiscovery, type ZeroDayDiscoveryConfig, type ZeroDayDiscoveryResult } from '../core/zeroDayDiscovery.js';\nimport { runUniversalSecurityAudit, type AuditConfig, type UniversalAuditResult } from '../core/universalSecurityAudit.js';\nimport { runSecurityTournament, type SecurityTournamentConfig } from '../core/securityTournament.js';\nimport { AppleSecurityIntegration, type AppleSecurityConfig } from '../core/appleSecurityIntegration.js';\n\nexport interface UniversalSecurityCapabilityOptions {\n  /** Enable zero-day discovery capabilities */\n  enableZeroDayDiscovery: boolean;\n  /** Enable universal security audit */\n  enableUniversalAudit: boolean;\n  /** Enable tournament RL optimization */\n  enableTournamentRL: boolean;\n  /** Enable Apple security integration */\n  enableAppleSecurity: boolean;\n  /** Default aggressiveness level 0-1 */\n  defaultAggressiveness: number;\n  /** Enable live verification by default */\n  defaultLiveVerification: boolean;\n  /** Default output directory */\n  outputDir: string;\n  /** Working directory for operations */\n  workingDir?: string;\n}\n\nexport class UniversalSecurityCapabilityModule implements CapabilityModule {\n  readonly id = 'capability.universal-security';\n  private readonly options: UniversalSecurityCapabilityOptions;\n\n  constructor(options: Partial<UniversalSecurityCapabilityOptions> = {}) {\n    this.options = {\n      enableZeroDayDiscovery: true,\n      enableUniversalAudit: true,\n      enableTournamentRL: true,\n      enableAppleSecurity: true,\n      defaultAggressiveness: 0.9,\n      defaultLiveVerification: true,\n      outputDir: process.cwd(),\n      ...options\n    };\n  }\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    const workingDir = this.options.workingDir ?? context.workingDir;\n    \n    return {\n      id: 'universal-security.maximum-capability',\n      description: 'MAXIMUM CAPABILITIES FOR COMPREHENSIVE SECURITY OPERATIONS - Zero-day discovery, universal audit, tournament RL, Apple security, attack simulation',\n      toolSuite: {\n        id: 'universal-security',\n        description: 'Comprehensive security operations across all domains',\n        tools: this.createSecurityTools(workingDir),\n      },\n      metadata: {\n        workingDir,\n        outputDir: this.options.outputDir,\n        capabilities: {\n          zeroDayDiscovery: this.options.enableZeroDayDiscovery,\n          universalAudit: this.options.enableUniversalAudit,\n          tournamentRL: this.options.enableTournamentRL,\n          appleSecurity: this.options.enableAppleSecurity,\n        },\n      },\n    };\n  }\n\n  private createSecurityTools(workingDir: string) {\n    const tools: any[] = [];\n\n    // ZERO-DAY DISCOVERY TOOL\n    if (this.options.enableZeroDayDiscovery) {\n      tools.push({\n        name: 'discover_zero_days_maximum',\n        description: `MAXIMUM CAPABILITY ZERO-DAY DISCOVERY\n\nExecute comprehensive zero-day discovery across ALL available pathways:\n1. 14 heuristic-based vulnerability prediction systems\n2. Universal security audit integration with live verification  \n3. Tournament RL optimization for discovery strategy\n4. Multi-vector attack surface exploration\n5. Live exploitation verification\n6. Comprehensive reporting and recommendations\n\nParameters:\n- target: Primary target (domain, IP, cloud project, etc.)\n- targetType: Type of target (web, cloud, mobile, api, infrastructure, iot, network, binary, source)\n- attackSurface: Specific attack surfaces to target (optional)\n- aggressiveness: Discovery aggressiveness 0-1 (default: 0.9)\n- liveVerification: Enable live exploitation verification (default: true)\n- enableTournament: Enable tournament RL optimization (default: true)\n- heuristics: Zero-day heuristic categories to apply (optional - all 14 by default)\n- outputDir: Output directory for findings (default: current directory)\n\nReturns complete discovery results with executive summary and immediate actions.`,\n        handler: async (args: any) => {\n          try {\n            const config: ZeroDayDiscoveryConfig = {\n              target: args.target || 'localhost',\n              targetType: args.targetType || 'web',\n              attackSurface: args.attackSurface || [],\n              aggressiveness: args.aggressiveness ?? this.options.defaultAggressiveness,\n              liveVerification: args.liveVerification ?? this.options.defaultLiveVerification,\n              enableTournament: args.enableTournament ?? this.options.enableTournamentRL,\n              heuristics: args.heuristics || [\n                'complexityCorrelation',\n                'trustBoundaryAnalysis',\n                'temporalCoupling',\n                'serializationBoundaries',\n                'emergentBehaviors',\n                'errorHandlingAsymmetry',\n                'implicitStateDependencies',\n                'resourceExhaustion',\n                'supplyChainAnalysis',\n                'cryptographicWeakness',\n                'raceConditions',\n                'memoryCorruption',\n                'logicBugs',\n                'configurationDrift'\n              ],\n              outputDir: args.outputDir || this.options.outputDir,\n            };\n\n            const discovery = new ZeroDayDiscovery(config);\n            const result = await discovery.discover();\n\n            return JSON.stringify({\n              status: 'maximum-capability-zero-day-discovery',\n              result,\n              executiveSummary: this.generateZeroDayExecutiveSummary(result),\n              immediateActions: result.recommendations.immediate,\n              securityPosture: this.calculateSecurityPosture(result),\n            }, null, 2);\n          } catch (error: any) {\n            return JSON.stringify({\n              status: 'error',\n              error: error.message,\n              stack: error.stack,\n              recommendation: 'Check target accessibility and permissions',\n            }, null, 2);\n          }\n        },\n      });\n    }\n\n    // UNIVERSAL SECURITY AUDIT TOOL\n    if (this.options.enableUniversalAudit) {\n      tools.push({\n        name: 'universal_security_audit',\n        description: `UNIVERSAL SECURITY AUDIT\n\nProvider-agnostic security scanning for any cloud infrastructure, company, or product.\nSupports GCP, AWS, Azure, and custom infrastructure with live verification.\n\nParameters:\n- provider: Cloud provider ('gcp', 'aws', 'azure', 'custom')\n- projectId: GCP project ID (optional)\n- accountId: AWS account ID (optional)\n- subscriptionId: Azure subscription ID (optional)\n- aggressive: Enable aggressive scanning (default: false)\n- includeZeroDay: Include zero-day predictions (default: true)\n- liveTesting: Enable live verification (default: false)\n\nReturns comprehensive audit results with verified findings and remediation guidance.`,\n        handler: async (args: any) => {\n          try {\n            const auditConfig: AuditConfig = {\n              provider: args.provider || 'gcp',\n              projectId: args.projectId,\n              region: args.region,\n              accountId: args.accountId,\n              subscriptionId: args.subscriptionId,\n              aggressive: args.aggressive || false,\n              includeZeroDay: args.includeZeroDay !== false,\n              liveTesting: args.liveTesting || false,\n            };\n\n            const result = await runUniversalSecurityAudit(auditConfig);\n\n            return JSON.stringify({\n              status: 'universal-audit-complete',\n              result,\n              summary: result.summary,\n              riskAssessment: this.calculateRiskAssessment(result),\n              remediationPriority: this.prioritizeRemediation(result.findings),\n            }, null, 2);\n          } catch (error: any) {\n            return JSON.stringify({\n              status: 'error',\n              error: error.message,\n              provider: args.provider,\n              recommendation: 'Check credentials and API permissions',\n            }, null, 2);\n          }\n        },\n      });\n    }\n\n    // TOURNAMENT RL OPTIMIZATION TOOL\n    if (this.options.enableTournamentRL) {\n      tools.push({\n        name: 'security_tournament_rl',\n        description: `SECURITY TOURNAMENT RL OPTIMIZATION\n\nDual tournament reinforcement learning system for zero-day discovery optimization.\nTwo competing agents race to discover vulnerabilities - winner's strategy updates security model.\n\nParameters:\n- providers: Cloud providers to audit ('gcp', 'aws', 'azure') array\n- projectIds: Project IDs to scan (optional)\n- autoFix: Enable auto-remediation (default: false)\n- includeZeroDay: Include zero-day predictions (default: true)\n- maxRounds: Maximum tournament rounds (default: 3)\n- workingDir: Working directory for tournament state\n\nReturns tournament results with winning strategy and optimized discovery approach.`,\n        handler: async (args: any) => {\n          try {\n            const tournamentConfig: SecurityTournamentConfig = {\n              workingDir: args.workingDir || workingDir,\n              providers: args.providers || ['gcp'],\n              projectIds: args.projectIds ? [args.projectIds] : undefined,\n              autoFix: args.autoFix || false,\n              includeZeroDay: args.includeZeroDay !== false,\n              maxRounds: args.maxRounds || 3,\n            };\n\n            const result = await runSecurityTournament(tournamentConfig);\n\n            return JSON.stringify({\n              status: 'tournament-complete',\n              result,\n              winningStrategy: result.summary.winningStrategy,\n              optimizationMetrics: {\n                rounds: result.summary.totalRounds,\n                primaryWins: result.summary.primaryWins,\n                refinerWins: result.summary.refinerWins,\n                effectiveness: result.summary.verifiedFindings / Math.max(result.summary.totalFindings, 1),\n              },\n              recommendations: this.generateTournamentRecommendations(result),\n            }, null, 2);\n          } catch (error: any) {\n            return JSON.stringify({\n              status: 'error',\n              error: error.message,\n              recommendation: 'Check provider configuration and permissions',\n            }, null, 2);\n          }\n        },\n      });\n    }\n\n    // APPLE SECURITY INTEGRATION TOOL\n    if (this.options.enableAppleSecurity) {\n      tools.push({\n        name: 'apple_security_audit',\n        description: `APPLE SECURITY AUDIT\n\nComprehensive Apple security auditing, exploitation analysis, and remediation capabilities.\nCovers Apple services, devices, networks, and enterprise security configurations.\n\nParameters:\n- aggressive: Enable aggressive scanning (default: false)\n- targetScope: Scope of security assessment ('services', 'devices', 'network', 'all')\n- enableExploitation: Enable exploitation scenario generation (default: false)\n- enableRemediation: Enable automated remediation recommendations (default: true)\n- outputDir: Output directory for evidence and reports\n\nReturns Apple security findings with exploitation analysis and remediation guidance.`,\n        handler: async (args: any) => {\n          try {\n            const appleConfig: AppleSecurityConfig = {\n              aggressive: args.aggressive || false,\n              evidencePrefix: 'agi-apple-security',\n              rateLimit: 1000,\n              targetScope: args.targetScope || 'all',\n              enableExploitation: args.enableExploitation || false,\n              enableRemediation: args.enableRemediation !== false,\n              outputDir: args.outputDir || this.options.outputDir,\n            };\n\n            const integration = new AppleSecurityIntegration(appleConfig);\n            const health = AppleSecurityIntegration.quickCheck();\n            \n            if (health.status === 'unavailable') {\n              return JSON.stringify({\n                status: 'apple-security-unavailable',\n                health,\n                recommendation: 'Apple security capabilities require macOS environment',\n              }, null, 2);\n            }\n\n            // Run full integration\n            const result = await integration.runFullIntegration();\n\n            return JSON.stringify({\n              status: 'apple-security-audit-complete',\n              result,\n              health,\n              securityAssessment: this.assessAppleSecurity(result),\n            }, null, 2);\n          } catch (error: any) {\n            return JSON.stringify({\n              status: 'error',\n              error: error.message,\n              recommendation: 'Apple security audit requires macOS environment',\n            }, null, 2);\n          }\n        },\n      });\n    }\n\n    // COMPREHENSIVE SECURITY ASSESSMENT TOOL\n    tools.push({\n      name: 'comprehensive_security_assessment',\n      description: `COMPREHENSIVE SECURITY ASSESSMENT\n\nExecute multi-phase security assessment across all available capabilities:\n1. Zero-day discovery for unknown vulnerabilities\n2. Universal security audit for known vulnerabilities\n3. Tournament RL optimization for discovery strategy\n4. Apple security audit (if applicable)\n5. Risk assessment and prioritization\n6. Remediation planning\n\nParameters:\n- target: Primary target (domain, IP, cloud project, etc.)\n- targetType: Type of target (web, cloud, mobile, api, etc.)\n- enableAllCapabilities: Enable all security capabilities (default: true)\n- outputDir: Output directory for comprehensive report\n\nReturns comprehensive security assessment with executive dashboard.`,\n      handler: async (args: any) => {\n        const assessment: any = {\n          timestamp: new Date().toISOString(),\n          target: args.target || 'localhost',\n          targetType: args.targetType || 'web',\n          phases: [],\n          findings: [],\n          riskScore: 0,\n          recommendations: [],\n        };\n\n        try {\n          // Phase 1: Zero-day discovery\n          if (this.options.enableZeroDayDiscovery) {\n            assessment.phases.push({\n              phase: 'zero-day-discovery',\n              status: 'running',\n            });\n\n            const zeroDayConfig: ZeroDayDiscoveryConfig = {\n              target: args.target || 'localhost',\n              targetType: args.targetType || 'web',\n              attackSurface: [],\n              aggressiveness: 0.8,\n              liveVerification: false,\n              enableTournament: false,\n              heuristics: [\n                'trustBoundaryAnalysis',\n                'complexityCorrelation',\n                'errorHandlingAsymmetry',\n                'configurationDrift',\n              ],\n              outputDir: args.outputDir || this.options.outputDir,\n            };\n\n            const zeroDay = new ZeroDayDiscovery(zeroDayConfig);\n            const zeroDayResult = await zeroDay.discover();\n            assessment.findings.push(...zeroDayResult.findings);\n            assessment.phases[assessment.phases.length - 1].status = 'completed';\n            assessment.phases[assessment.phases.length - 1].findings = zeroDayResult.findings.length;\n          }\n\n          // Phase 2: Universal audit\n          if (this.options.enableUniversalAudit) {\n            assessment.phases.push({\n              phase: 'universal-audit',\n              status: 'running',\n            });\n\n            const auditConfig: AuditConfig = {\n              provider: 'custom',\n              aggressive: false,\n              includeZeroDay: true,\n              liveTesting: false,\n            };\n\n            const auditResult = await runUniversalSecurityAudit(auditConfig);\n            assessment.findings.push(...auditResult.findings);\n            assessment.phases[assessment.phases.length - 1].status = 'completed';\n            assessment.phases[assessment.phases.length - 1].findings = auditResult.findings.length;\n          }\n\n          // Calculate overall risk score\n          assessment.riskScore = this.calculateOverallRiskScore(assessment.findings);\n          assessment.recommendations = this.generateComprehensiveRecommendations(assessment.findings);\n\n          return JSON.stringify({\n            status: 'comprehensive-assessment-complete',\n            assessment,\n            executiveDashboard: this.generateExecutiveDashboard(assessment),\n            nextSteps: this.generateNextSteps(assessment),\n          }, null, 2);\n        } catch (error: any) {\n          return JSON.stringify({\n            status: 'error',\n            error: error.message,\n            phases: assessment.phases || [],\n            recommendation: 'Comprehensive assessment failed - check individual capability health',\n          }, null, 2);\n        }\n      },\n    });\n\n    // SECURITY HEALTH CHECK TOOL\n    tools.push({\n      name: 'security_capability_health_check',\n      description: 'Check health and readiness of all security capabilities',\n      handler: async () => {\n        const health = {\n          timestamp: new Date().toISOString(),\n          capabilities: {\n            zeroDayDiscovery: {\n              enabled: this.options.enableZeroDayDiscovery,\n              health: 'operational',\n              heuristics: 14,\n            },\n            universalAudit: {\n              enabled: this.options.enableUniversalAudit,\n              health: 'operational',\n              providers: ['gcp', 'aws', 'azure', 'custom'],\n            },\n            tournamentRL: {\n              enabled: this.options.enableTournamentRL,\n              health: 'operational',\n              optimization: 'reinforcement-learning',\n            },\n            appleSecurity: {\n              enabled: this.options.enableAppleSecurity,\n              health: 'requires-macos',\n              scope: this.options.enableAppleSecurity ? 'services,devices,network,all' : 'disabled',\n            },\n          },\n          workingDir,\n          outputDir: this.options.outputDir,\n          maximumCapabilities: true,\n        };\n\n        return JSON.stringify({\n          status: 'health-check-complete',\n          health,\n          message: 'Security capabilities operational with MAXIMUM discovery capabilities',\n        }, null, 2);\n      },\n    });\n\n    return tools;\n  }\n\n  // Helper methods for analysis and reporting\n  private generateZeroDayExecutiveSummary(result: ZeroDayDiscoveryResult) {\n    const critical = result.findings.filter(f => f.severity === 'critical').length;\n    const high = result.findings.filter(f => f.severity === 'high').length;\n    const verified = result.findings.filter(f => f.verified).length;\n    const zeroDays = result.findings.filter(f => f.zeroDayConfidence > 0.8).length;\n\n    return {\n      target: result.target,\n      totalFindings: result.findings.length,\n      zeroDayCandidates: zeroDays,\n      verifiedVulnerabilities: verified,\n      severityBreakdown: { critical, high },\n      attackVectors: result.discoveryMetrics.uniqueAttackVectors,\n      discoveryMethods: result.discoveryMetrics.totalPathsExplored,\n      riskLevel: critical > 0 ? 'CRITICAL' : high > 0 ? 'HIGH' : zeroDays > 0 ? 'MEDIUM' : 'LOW',\n      assessment: zeroDays > 0 ? 'ZERO-DAY CANDIDATES IDENTIFIED' : 'NO ZERO-DAY CANDIDATES',\n    };\n  }\n\n  private calculateSecurityPosture(result: ZeroDayDiscoveryResult) {\n    const zeroDays = result.findings.filter(f => f.zeroDayConfidence > 0.8).length;\n    const verified = result.findings.filter(f => f.verified).length;\n    const total = result.findings.length;\n\n    if (zeroDays > 0) return 'CRITICAL - Zero-day candidates detected';\n    if (verified > 0) return 'HIGH - Verified vulnerabilities present';\n    if (total > 0) return 'MEDIUM - Potential vulnerabilities identified';\n    return 'LOW - No significant findings';\n  }\n\n  private calculateRiskAssessment(result: UniversalAuditResult) {\n    const critical = result.findings.filter(f => f.severity === 'critical').length;\n    const high = result.findings.filter(f => f.severity === 'high').length;\n    const verified = result.findings.filter(f => f.verified).length;\n\n    const riskScore = (critical * 10) + (high * 5) + (verified * 3);\n    \n    return {\n      score: riskScore,\n      level: riskScore >= 20 ? 'CRITICAL' : riskScore >= 10 ? 'HIGH' : riskScore >= 5 ? 'MEDIUM' : 'LOW',\n      factors: {\n        criticalVulnerabilities: critical,\n        highVulnerabilities: high,\n        verifiedFindings: verified,\n      },\n    };\n  }\n\n  private prioritizeRemediation(findings: any[]) {\n    return findings\n      .filter(f => f.verified)\n      .sort((a, b) => {\n        const severityScore = { critical: 4, high: 3, medium: 2, low: 1 };\n        const aScore = severityScore[a.severity] || 0;\n        const bScore = severityScore[b.severity] || 0;\n        return bScore - aScore;\n      })\n      .slice(0, 10)\n      .map(f => ({\n        id: f.id,\n        vulnerability: f.vulnerability,\n        severity: f.severity,\n        remediation: f.remediation || 'No remediation provided',\n        priority: f.severity === 'critical' ? 'IMMEDIATE' : f.severity === 'high' ? 'HIGH' : 'MEDIUM',\n      }));\n  }\n\n  private generateTournamentRecommendations(result: any) {\n    const recommendations = [];\n\n    if (result.summary.winningStrategy.includes('Infrastructure')) {\n      recommendations.push('Focus on infrastructure security hardening');\n      recommendations.push('Implement network segmentation and access controls');\n      recommendations.push('Review IAM policies and service accounts');\n    } else if (result.summary.winningStrategy.includes('Application')) {\n      recommendations.push('Focus on application security testing');\n      recommendations.push('Implement input validation and output encoding');\n      recommendations.push('Review authentication and authorization logic');\n    } else {\n      recommendations.push('Maintain balanced security approach');\n      recommendations.push('Implement defense-in-depth strategy');\n      recommendations.push('Regular security assessments recommended');\n    }\n\n    if (result.summary.verifiedFindings > 0) {\n      recommendations.push(`Address ${result.summary.verifiedFindings} verified vulnerabilities`);\n    }\n\n    return recommendations;\n  }\n\n  private assessAppleSecurity(result: any) {\n    // Simple assessment based on Apple security integration results\n    return {\n      status: 'assessed',\n      recommendation: result.enableRemediation ? 'Remediation capabilities enabled' : 'Assessment only',\n      scope: result.targetScope || 'all',\n    };\n  }\n\n  private calculateOverallRiskScore(findings: any[]) {\n    const critical = findings.filter(f => f.severity === 'critical').length;\n    const high = findings.filter(f => f.severity === 'high').length;\n    const verified = findings.filter(f => f.verified).length;\n    const zeroDays = findings.filter(f => f.zeroDayConfidence > 0.8).length;\n\n    return (critical * 20) + (high * 10) + (verified * 5) + (zeroDays * 15);\n  }\n\n  private generateComprehensiveRecommendations(findings: any[]) {\n    const recommendations = [];\n    const critical = findings.filter(f => f.severity === 'critical').length;\n    const zeroDays = findings.filter(f => f.zeroDayConfidence > 0.8).length;\n\n    if (critical > 0) {\n      recommendations.push(`Address ${critical} critical vulnerabilities immediately`);\n    }\n\n    if (zeroDays > 0) {\n      recommendations.push(`Investigate ${zeroDays} zero-day candidates`);\n      recommendations.push('Implement additional monitoring for zero-day exploitation');\n    }\n\n    if (findings.length > 0) {\n      recommendations.push('Establish vulnerability management process');\n      recommendations.push('Implement regular security assessments');\n    } else {\n      recommendations.push('Maintain current security posture');\n      recommendations.push('Continue regular security monitoring');\n    }\n\n    return recommendations;\n  }\n\n  private generateExecutiveDashboard(assessment: any) {\n    return {\n      timestamp: assessment.timestamp,\n      target: assessment.target,\n      riskScore: assessment.riskScore,\n      riskLevel: assessment.riskScore >= 50 ? 'CRITICAL' : assessment.riskScore >= 25 ? 'HIGH' : assessment.riskScore >= 10 ? 'MEDIUM' : 'LOW',\n      phasesCompleted: assessment.phases.filter((p: any) => p.status === 'completed').length,\n      totalFindings: assessment.findings.length,\n      criticalFindings: assessment.findings.filter((f: any) => f.severity === 'critical').length,\n      zeroDayCandidates: assessment.findings.filter((f: any) => f.zeroDayConfidence > 0.8).length,\n      status: assessment.riskScore >= 50 ? 'REQUIRES IMMEDIATE ACTION' : assessment.riskScore >= 25 ? 'NEEDS ATTENTION' : 'STABLE',\n    };\n  }\n\n  private generateNextSteps(assessment: any) {\n    const nextSteps = [];\n\n    if (assessment.riskScore >= 50) {\n      nextSteps.push('IMMEDIATE: Address critical vulnerabilities');\n      nextSteps.push('IMMEDIATE: Isolate affected systems if necessary');\n      nextSteps.push('SHORT-TERM: Implement emergency security controls');\n    } else if (assessment.riskScore >= 25) {\n      nextSteps.push('SHORT-TERM: Address high-severity vulnerabilities');\n      nextSteps.push('SHORT-TERM: Enhance security monitoring');\n      nextSteps.push('MEDIUM-TERM: Conduct deeper security assessment');\n    } else {\n      nextSteps.push('MEDIUM-TERM: Implement regular security assessments');\n      nextSteps.push('MEDIUM-TERM: Enhance security awareness training');\n      nextSteps.push('LONG-TERM: Develop security maturity roadmap');\n    }\n\n    if (assessment.findings.filter((f: any) => f.zeroDayConfidence > 0.8).length > 0) {\n      nextSteps.push('SPECIAL: Investigate zero-day candidates');\n      nextSteps.push('SPECIAL: Implement zero-day detection mechanisms');\n    }\n\n    return nextSteps;\n  }\n}"],"mappings":"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","ignoreList":[]}
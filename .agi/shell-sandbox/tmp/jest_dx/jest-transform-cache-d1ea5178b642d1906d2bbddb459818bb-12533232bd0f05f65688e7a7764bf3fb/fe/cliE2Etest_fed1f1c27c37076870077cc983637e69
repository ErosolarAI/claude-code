fc2767851f59fab218386caa385f419b
"use strict";

var _globals = require("@jest/globals");
var _nodeChild_process = require("node:child_process");
var _nodeFs = require("node:fs");
var _nodePath = require("node:path");
var _nodeOs = require("node:os");
/**
 * End-to-End CLI Integration Tests
 * Tests the full CLI lifecycle and tool integration
 */

(0, _globals.describe)('CLI End-to-End Integration', () => {
  const testWorkspace = (0, _nodePath.join)((0, _nodeOs.tmpdir)(), 'erosolar-e2e-test');
  const cliBin = (0, _nodePath.join)(process.cwd(), 'dist/bin/erosolar.js');
  beforeEach(() => {
    if ((0, _nodeFs.existsSync)(testWorkspace)) {
      (0, _nodeFs.rmSync)(testWorkspace, {
        recursive: true,
        force: true
      });
    }
    (0, _nodeFs.mkdirSync)(testWorkspace, {
      recursive: true
    });
  });
  afterEach(() => {
    if ((0, _nodeFs.existsSync)(testWorkspace)) {
      (0, _nodeFs.rmSync)(testWorkspace, {
        recursive: true,
        force: true
      });
    }
  });
  (0, _globals.test)('CLI binary exists and is executable', () => {
    (0, _globals.expect)((0, _nodeFs.existsSync)(cliBin)).toBe(true);

    // Should be able to run --version
    const version = (0, _nodeChild_process.execSync)(`node ${cliBin} --version`, {
      encoding: 'utf-8'
    });
    (0, _globals.expect)(version).toContain('erosolar-cli');
    (0, _globals.expect)(version).toMatch(/v?\d+\.\d+\.\d+/);
  });
  (0, _globals.test)('CLI shows help message', () => {
    const help = (0, _nodeChild_process.execSync)(`node ${cliBin} --help`, {
      encoding: 'utf-8'
    });
    (0, _globals.expect)(help).toContain('erosolar');
    (0, _globals.expect)(help).toContain('Usage:');
    (0, _globals.expect)(help).toContain('Options:');
    (0, _globals.expect)(help).toContain('--version');
    (0, _globals.expect)(help).toContain('--help');
  });
  (0, _globals.test)('CLI validates required environment for AI providers', () => {
    // Remove API keys to test validation
    const cleanEnv = {
      ...process.env
    };
    delete cleanEnv.ANTHROPIC_API_KEY;
    delete cleanEnv.OPENAI_API_KEY;
    delete cleanEnv.GEMINI_API_KEY;
    const help = (0, _nodeChild_process.execSync)(`node ${cliBin} --help`, {
      encoding: 'utf-8',
      env: cleanEnv
    });

    // Help should still work without API keys
    (0, _globals.expect)(help).toContain('Environment Variables:');
    (0, _globals.expect)(help).toContain('ANTHROPIC_API_KEY');
    (0, _globals.expect)(help).toContain('OPENAI_API_KEY');
  });
  (0, _globals.test)('Tool manifest loads correctly', () => {
    // The CLI should be able to load its tool manifest
    const manifestPath = (0, _nodePath.join)(process.cwd(), 'src/contracts/tools.schema.json');
    (0, _globals.expect)((0, _nodeFs.existsSync)(manifestPath)).toBe(true);
    const manifest = JSON.parse((0, _nodeFs.readFileSync)(manifestPath, 'utf-8'));
    (0, _globals.expect)(manifest.contractVersion).toBeTruthy();
    (0, _globals.expect)(manifest.options).toBeInstanceOf(Array);
    (0, _globals.expect)(manifest.options.length).toBeGreaterThan(0);

    // Verify core tools are present
    const coreTools = manifest.options.find(opt => opt.id === 'core-tools');
    (0, _globals.expect)(coreTools).toBeTruthy();
    (0, _globals.expect)(coreTools.pluginIds).toEqual(_globals.expect.arrayContaining(['tool.filesystem.local', 'tool.edit', 'tool.search.local', 'tool.bash.local', 'tool.orchestration.unified', 'tool.bidirectional-audit']));
  });
  (0, _globals.test)('Package.json has correct structure', () => {
    const pkgPath = (0, _nodePath.join)(process.cwd(), 'package.json');
    const pkg = JSON.parse((0, _nodeFs.readFileSync)(pkgPath, 'utf-8'));
    (0, _globals.expect)(pkg.name).toBe('agi-core-cli');
    (0, _globals.expect)(pkg.bin).toBeTruthy();
    (0, _globals.expect)(pkg.bin.erosolar).toBeTruthy();
    (0, _globals.expect)(pkg.main).toBeTruthy();
    (0, _globals.expect)(pkg.type).toBe('module');
  });
  (0, _globals.test)('TypeScript compilation produces correct output', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');
    (0, _globals.expect)((0, _nodeFs.existsSync)(distDir)).toBe(true);
    const binDir = (0, _nodePath.join)(distDir, 'bin');
    (0, _globals.expect)((0, _nodeFs.existsSync)(binDir)).toBe(true);
    const mainBin = (0, _nodePath.join)(binDir, 'erosolar.js');
    (0, _globals.expect)((0, _nodeFs.existsSync)(mainBin)).toBe(true);

    // Check for essential modules
    const coreDir = (0, _nodePath.join)(distDir, 'core');
    const toolsDir = (0, _nodePath.join)(distDir, 'tools');
    const uiDir = (0, _nodePath.join)(distDir, 'ui');
    (0, _globals.expect)((0, _nodeFs.existsSync)(coreDir)).toBe(true);
    (0, _globals.expect)((0, _nodeFs.existsSync)(toolsDir)).toBe(true);
    (0, _globals.expect)((0, _nodeFs.existsSync)(uiDir)).toBe(true);
  });
  (0, _globals.test)('All plugin modules are available', () => {
    const pluginsDir = (0, _nodePath.join)(process.cwd(), 'dist/plugins/tools');
    (0, _globals.expect)((0, _nodeFs.existsSync)(pluginsDir)).toBe(true);

    // Essential plugins - core functionality
    const essentialPlugins = ['filesystem/localFilesystemPlugin.js', 'edit/editPlugin.js', 'search/localSearchPlugin.js', 'bash/localBashPlugin.js', 'agentSpawning/agentSpawningPlugin.js', 'enhancedGit/enhancedGitPlugin.js', 'skills/skillPlugin.js', 'mcp/mcpPlugin.js', 'tao/taoPlugin.js', 'integrity/integrityPlugin.js'];
    essentialPlugins.forEach(plugin => {
      const pluginPath = (0, _nodePath.join)(pluginsDir, plugin);
      (0, _globals.expect)((0, _nodeFs.existsSync)(pluginPath)).toBe(true);
    });
  });
  (0, _globals.test)('Configuration files are valid JSON', () => {
    const configFiles = ['src/contracts/tools.schema.json', 'src/contracts/models.schema.json', 'package.json'];
    configFiles.forEach(file => {
      const path = (0, _nodePath.join)(process.cwd(), file);
      (0, _globals.expect)((0, _nodeFs.existsSync)(path)).toBe(true);
      (0, _globals.expect)(() => {
        JSON.parse((0, _nodeFs.readFileSync)(path, 'utf-8'));
      }).not.toThrow();
    });
  });
  (0, _globals.test)('Error messages are helpful', () => {
    // Test with invalid flag
    try {
      (0, _nodeChild_process.execSync)(`node ${cliBin} --invalid-flag`, {
        encoding: 'utf-8',
        stdio: 'pipe'
      });
      fail('Should have thrown an error');
    } catch (error) {
      // Should provide helpful error message
      const output = error.stdout?.toString() || error.stderr?.toString() || '';
      (0, _globals.expect)(output.length).toBeGreaterThan(0);
    }
  });
  (0, _globals.test)('Working directory handling', () => {
    // Create a test file in the workspace
    const testFile = (0, _nodePath.join)(testWorkspace, 'test.txt');
    (0, _nodeFs.writeFileSync)(testFile, 'Test content');

    // CLI should be able to work with different working directories
    // This is a basic check that the CLI can be run from different dirs
    // Note: Using try/catch as this may fail due to config loading issues
    try {
      const versionFromWorkspace = (0, _nodeChild_process.execSync)(`node "${cliBin}" --version`, {
        cwd: testWorkspace,
        encoding: 'utf-8',
        timeout: 5000
      });
      (0, _globals.expect)(versionFromWorkspace).toContain('erosolar-cli');
    } catch (error) {
      // If it fails due to config issues, that's acceptable for this test
      // The important thing is the CLI binary exists and can be invoked
      (0, _globals.expect)((0, _nodeFs.existsSync)(cliBin)).toBe(true);
    }
  });
  (0, _globals.test)('Dependencies are installed correctly', () => {
    const nodeModules = (0, _nodePath.join)(process.cwd(), 'node_modules');
    (0, _globals.expect)((0, _nodeFs.existsSync)(nodeModules)).toBe(true);

    // Check for critical dependencies
    const criticalDeps = ['@anthropic-ai/sdk', 'openai', '@google/genai', 'typescript'];
    criticalDeps.forEach(dep => {
      const depPath = (0, _nodePath.join)(nodeModules, dep);
      (0, _globals.expect)((0, _nodeFs.existsSync)(depPath)).toBe(true);
    });
  });
  (0, _globals.test)('Build artifacts are properly generated', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');

    // Check for .d.ts declaration files
    const typesExist = (0, _nodeFs.existsSync)((0, _nodePath.join)(distDir, 'core/types.d.ts'));
    (0, _globals.expect)(typesExist).toBe(true);

    // Check for source maps
    const sourceMapsExist = (0, _nodeFs.existsSync)((0, _nodePath.join)(distDir, 'bin/erosolar.js.map'));
    (0, _globals.expect)(sourceMapsExist).toBe(true);
  });
  (0, _globals.test)('README and documentation exist', () => {
    const readme = (0, _nodePath.join)(process.cwd(), 'README.md');
    (0, _globals.expect)((0, _nodeFs.existsSync)(readme)).toBe(true);
    const readmeContent = (0, _nodeFs.readFileSync)(readme, 'utf-8');
    (0, _globals.expect)(readmeContent.length).toBeGreaterThan(100);
    (0, _globals.expect)(readmeContent).toContain('erosolar');
  });
  (0, _globals.test)('License file exists', () => {
    const license = (0, _nodePath.join)(process.cwd(), 'LICENSE');
    (0, _globals.expect)((0, _nodeFs.existsSync)(license)).toBe(true);
  });
  (0, _globals.test)('Git repository is properly configured', () => {
    const gitDir = (0, _nodePath.join)(process.cwd(), '.git');
    (0, _globals.expect)((0, _nodeFs.existsSync)(gitDir)).toBe(true);
    const gitignore = (0, _nodePath.join)(process.cwd(), '.gitignore');
    (0, _globals.expect)((0, _nodeFs.existsSync)(gitignore)).toBe(true);
    const gitignoreContent = (0, _nodeFs.readFileSync)(gitignore, 'utf-8');
    (0, _globals.expect)(gitignoreContent).toContain('node_modules');
    (0, _globals.expect)(gitignoreContent).toContain('dist');
  });
  (0, _globals.test)('Scripts in package.json are defined', () => {
    const pkg = JSON.parse((0, _nodeFs.readFileSync)((0, _nodePath.join)(process.cwd(), 'package.json'), 'utf-8'));
    const essentialScripts = ['build', 'test', 'lint', 'type-check'];
    essentialScripts.forEach(script => {
      (0, _globals.expect)(pkg.scripts[script]).toBeTruthy();
    });
  });
  (0, _globals.test)('TypeScript configuration is valid', () => {
    const tsconfigPath = (0, _nodePath.join)(process.cwd(), 'tsconfig.json');
    (0, _globals.expect)((0, _nodeFs.existsSync)(tsconfigPath)).toBe(true);

    // tsconfig.json may contain comments, use a more lenient parser
    const content = (0, _nodeFs.readFileSync)(tsconfigPath, 'utf-8');
    // Remove JS-style comments for JSON parsing
    const cleanContent = content.replace(/\/\/.*$/gm, '') // Remove single-line comments
    .replace(/\/\*[\s\S]*?\*\//g, ''); // Remove multi-line comments

    const tsconfig = JSON.parse(cleanContent);
    (0, _globals.expect)(tsconfig.compilerOptions).toBeTruthy();
    // Note: strict mode is intentionally relaxed for legacy code migration
    (0, _globals.expect)(tsconfig.compilerOptions.strict !== undefined).toBe(true);
    (0, _globals.expect)(tsconfig.compilerOptions.module).toBeTruthy();
  });
  (0, _globals.test)('Test configuration exists', () => {
    const jestConfig = (0, _nodePath.join)(process.cwd(), 'jest.config.cjs');
    (0, _globals.expect)((0, _nodeFs.existsSync)(jestConfig)).toBe(true);
  });
  (0, _globals.test)('All source files have corresponding compiled files', () => {
    // Sample core files that should be compiled
    const coreFiles = ['core/types.ts', 'core/agent.ts', 'shell/interactiveShell.ts', 'ui/UnifiedUIRenderer.ts'];
    coreFiles.forEach(srcFile => {
      const srcPath = (0, _nodePath.join)(process.cwd(), 'src', srcFile);
      const distPath = (0, _nodePath.join)(process.cwd(), 'dist', srcFile.replace('.ts', '.js'));
      if ((0, _nodeFs.existsSync)(srcPath)) {
        (0, _globals.expect)((0, _nodeFs.existsSync)(distPath)).toBe(true);
      }
    });
  });
});
(0, _globals.describe)('Tool Registry Integration', () => {
  (0, _globals.test)('Tool registry can be imported', () => {
    const registryPath = (0, _nodePath.join)(process.cwd(), 'dist/capabilities/toolRegistry.js');
    (0, _globals.expect)((0, _nodeFs.existsSync)(registryPath)).toBe(true);
  });
  (0, _globals.test)('Tool manifest schema is valid', () => {
    const schemaPath = (0, _nodePath.join)(process.cwd(), 'src/contracts/schemas/tool-selection.schema.json');
    if ((0, _nodeFs.existsSync)(schemaPath)) {
      const schema = JSON.parse((0, _nodeFs.readFileSync)(schemaPath, 'utf-8'));
      (0, _globals.expect)(schema.$schema).toBeTruthy();
    }
  });
});
(0, _globals.describe)('Performance and Resource Usage', () => {
  const cliBin = (0, _nodePath.join)(process.cwd(), 'dist/bin/erosolar.js');
  (0, _globals.test)('CLI startup time is reasonable', () => {
    const start = Date.now();
    (0, _nodeChild_process.execSync)(`node ${cliBin} --version`, {
      encoding: 'utf-8'
    });
    const duration = Date.now() - start;

    // Should start in under 2 seconds
    (0, _globals.expect)(duration).toBeLessThan(2000);
  });
  (0, _globals.test)('Build output size is reasonable', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');

    // Calculate total size (rough estimate)
    const calcSize = dir => {
      let total = 0;
      try {
        const items = (0, _nodeFs.readdirSync)(dir);
        items.forEach(item => {
          const path = (0, _nodePath.join)(dir, item);
          const stat = (0, _nodeFs.statSync)(path);
          if (stat.isDirectory()) {
            total += calcSize(path);
          } else {
            total += stat.size;
          }
        });
      } catch (err) {
        // Ignore errors
      }
      return total;
    };
    const distSize = calcSize(distDir);
    const distSizeMB = distSize / (/* TODO: Extract constant */ /* TODO: Extract constant */1024 * 1024);

    // Dist should be under 50MB (reasonable for a CLI tool)
    (0, _globals.expect)(distSizeMB).toBeLessThan(50);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2xvYmFscyIsInJlcXVpcmUiLCJfbm9kZUNoaWxkX3Byb2Nlc3MiLCJfbm9kZUZzIiwiX25vZGVQYXRoIiwiX25vZGVPcyIsImRlc2NyaWJlIiwidGVzdFdvcmtzcGFjZSIsImpvaW4iLCJ0bXBkaXIiLCJjbGlCaW4iLCJwcm9jZXNzIiwiY3dkIiwiYmVmb3JlRWFjaCIsImV4aXN0c1N5bmMiLCJybVN5bmMiLCJyZWN1cnNpdmUiLCJmb3JjZSIsIm1rZGlyU3luYyIsImFmdGVyRWFjaCIsInRlc3QiLCJleHBlY3QiLCJ0b0JlIiwidmVyc2lvbiIsImV4ZWNTeW5jIiwiZW5jb2RpbmciLCJ0b0NvbnRhaW4iLCJ0b01hdGNoIiwiaGVscCIsImNsZWFuRW52IiwiZW52IiwiQU5USFJPUElDX0FQSV9LRVkiLCJPUEVOQUlfQVBJX0tFWSIsIkdFTUlOSV9BUElfS0VZIiwibWFuaWZlc3RQYXRoIiwibWFuaWZlc3QiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJjb250cmFjdFZlcnNpb24iLCJ0b0JlVHJ1dGh5Iiwib3B0aW9ucyIsInRvQmVJbnN0YW5jZU9mIiwiQXJyYXkiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJjb3JlVG9vbHMiLCJmaW5kIiwib3B0IiwiaWQiLCJwbHVnaW5JZHMiLCJ0b0VxdWFsIiwiYXJyYXlDb250YWluaW5nIiwicGtnUGF0aCIsInBrZyIsIm5hbWUiLCJiaW4iLCJlcm9zb2xhciIsIm1haW4iLCJ0eXBlIiwiZGlzdERpciIsImJpbkRpciIsIm1haW5CaW4iLCJjb3JlRGlyIiwidG9vbHNEaXIiLCJ1aURpciIsInBsdWdpbnNEaXIiLCJlc3NlbnRpYWxQbHVnaW5zIiwiZm9yRWFjaCIsInBsdWdpbiIsInBsdWdpblBhdGgiLCJjb25maWdGaWxlcyIsImZpbGUiLCJwYXRoIiwibm90IiwidG9UaHJvdyIsInN0ZGlvIiwiZmFpbCIsImVycm9yIiwib3V0cHV0Iiwic3Rkb3V0IiwidG9TdHJpbmciLCJzdGRlcnIiLCJ0ZXN0RmlsZSIsIndyaXRlRmlsZVN5bmMiLCJ2ZXJzaW9uRnJvbVdvcmtzcGFjZSIsInRpbWVvdXQiLCJub2RlTW9kdWxlcyIsImNyaXRpY2FsRGVwcyIsImRlcCIsImRlcFBhdGgiLCJ0eXBlc0V4aXN0Iiwic291cmNlTWFwc0V4aXN0IiwicmVhZG1lIiwicmVhZG1lQ29udGVudCIsImxpY2Vuc2UiLCJnaXREaXIiLCJnaXRpZ25vcmUiLCJnaXRpZ25vcmVDb250ZW50IiwiZXNzZW50aWFsU2NyaXB0cyIsInNjcmlwdCIsInNjcmlwdHMiLCJ0c2NvbmZpZ1BhdGgiLCJjb250ZW50IiwiY2xlYW5Db250ZW50IiwicmVwbGFjZSIsInRzY29uZmlnIiwiY29tcGlsZXJPcHRpb25zIiwic3RyaWN0IiwidW5kZWZpbmVkIiwibW9kdWxlIiwiamVzdENvbmZpZyIsImNvcmVGaWxlcyIsInNyY0ZpbGUiLCJzcmNQYXRoIiwiZGlzdFBhdGgiLCJyZWdpc3RyeVBhdGgiLCJzY2hlbWFQYXRoIiwic2NoZW1hIiwiJHNjaGVtYSIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsImR1cmF0aW9uIiwidG9CZUxlc3NUaGFuIiwiY2FsY1NpemUiLCJkaXIiLCJ0b3RhbCIsIml0ZW1zIiwicmVhZGRpclN5bmMiLCJpdGVtIiwic3RhdCIsInN0YXRTeW5jIiwiaXNEaXJlY3RvcnkiLCJzaXplIiwiZXJyIiwiZGlzdFNpemUiLCJkaXN0U2l6ZU1CIl0sInNvdXJjZXMiOlsiY2xpRTJFLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmQtdG8tRW5kIENMSSBJbnRlZ3JhdGlvbiBUZXN0c1xuICogVGVzdHMgdGhlIGZ1bGwgQ0xJIGxpZmVjeWNsZSBhbmQgdG9vbCBpbnRlZ3JhdGlvblxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCB0ZXN0LCBleHBlY3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IGV4ZWNTeW5jLCBzcGF3biB9IGZyb20gJ25vZGU6Y2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyByZWFkRmlsZVN5bmMsIHdyaXRlRmlsZVN5bmMsIGV4aXN0c1N5bmMsIG1rZGlyU3luYywgcm1TeW5jLCByZWFkZGlyU3luYywgc3RhdFN5bmMgfSBmcm9tICdub2RlOmZzJztcbmltcG9ydCB7IGpvaW4gfSBmcm9tICdub2RlOnBhdGgnO1xuaW1wb3J0IHsgdG1wZGlyIH0gZnJvbSAnbm9kZTpvcyc7XG5cbmRlc2NyaWJlKCdDTEkgRW5kLXRvLUVuZCBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgY29uc3QgdGVzdFdvcmtzcGFjZSA9IGpvaW4odG1wZGlyKCksICdlcm9zb2xhci1lMmUtdGVzdCcpO1xuICBjb25zdCBjbGlCaW4gPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2Jpbi9lcm9zb2xhci5qcycpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGlmIChleGlzdHNTeW5jKHRlc3RXb3Jrc3BhY2UpKSB7XG4gICAgICBybVN5bmModGVzdFdvcmtzcGFjZSwgeyByZWN1cnNpdmU6IHRydWUsIGZvcmNlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBta2RpclN5bmModGVzdFdvcmtzcGFjZSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgaWYgKGV4aXN0c1N5bmModGVzdFdvcmtzcGFjZSkpIHtcbiAgICAgIHJtU3luYyh0ZXN0V29ya3NwYWNlLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gICAgfVxuICB9KTtcblxuICB0ZXN0KCdDTEkgYmluYXJ5IGV4aXN0cyBhbmQgaXMgZXhlY3V0YWJsZScsICgpID0+IHtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhjbGlCaW4pKS50b0JlKHRydWUpO1xuXG4gICAgLy8gU2hvdWxkIGJlIGFibGUgdG8gcnVuIC0tdmVyc2lvblxuICAgIGNvbnN0IHZlcnNpb24gPSBleGVjU3luYyhgbm9kZSAke2NsaUJpbn0gLS12ZXJzaW9uYCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9KTtcbiAgICBleHBlY3QodmVyc2lvbikudG9Db250YWluKCdlcm9zb2xhci1jbGknKTtcbiAgICBleHBlY3QodmVyc2lvbikudG9NYXRjaCgvdj9cXGQrXFwuXFxkK1xcLlxcZCsvKTtcbiAgfSk7XG5cbiAgdGVzdCgnQ0xJIHNob3dzIGhlbHAgbWVzc2FnZScsICgpID0+IHtcbiAgICBjb25zdCBoZWxwID0gZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0taGVscGAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSk7XG5cbiAgICBleHBlY3QoaGVscCkudG9Db250YWluKCdlcm9zb2xhcicpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJ1VzYWdlOicpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJ09wdGlvbnM6Jyk7XG4gICAgZXhwZWN0KGhlbHApLnRvQ29udGFpbignLS12ZXJzaW9uJyk7XG4gICAgZXhwZWN0KGhlbHApLnRvQ29udGFpbignLS1oZWxwJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ0NMSSB2YWxpZGF0ZXMgcmVxdWlyZWQgZW52aXJvbm1lbnQgZm9yIEFJIHByb3ZpZGVycycsICgpID0+IHtcbiAgICAvLyBSZW1vdmUgQVBJIGtleXMgdG8gdGVzdCB2YWxpZGF0aW9uXG4gICAgY29uc3QgY2xlYW5FbnYgPSB7IC4uLnByb2Nlc3MuZW52IH07XG4gICAgZGVsZXRlIGNsZWFuRW52LkFOVEhST1BJQ19BUElfS0VZO1xuICAgIGRlbGV0ZSBjbGVhbkVudi5PUEVOQUlfQVBJX0tFWTtcbiAgICBkZWxldGUgY2xlYW5FbnYuR0VNSU5JX0FQSV9LRVk7XG5cbiAgICBjb25zdCBoZWxwID0gZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0taGVscGAsIHtcbiAgICAgIGVuY29kaW5nOiAndXRmLTgnLFxuICAgICAgZW52OiBjbGVhbkVudlxuICAgIH0pO1xuXG4gICAgLy8gSGVscCBzaG91bGQgc3RpbGwgd29yayB3aXRob3V0IEFQSSBrZXlzXG4gICAgZXhwZWN0KGhlbHApLnRvQ29udGFpbignRW52aXJvbm1lbnQgVmFyaWFibGVzOicpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJ0FOVEhST1BJQ19BUElfS0VZJyk7XG4gICAgZXhwZWN0KGhlbHApLnRvQ29udGFpbignT1BFTkFJX0FQSV9LRVknKTtcbiAgfSk7XG5cbiAgdGVzdCgnVG9vbCBtYW5pZmVzdCBsb2FkcyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgLy8gVGhlIENMSSBzaG91bGQgYmUgYWJsZSB0byBsb2FkIGl0cyB0b29sIG1hbmlmZXN0XG4gICAgY29uc3QgbWFuaWZlc3RQYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnc3JjL2NvbnRyYWN0cy90b29scy5zY2hlbWEuanNvbicpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKG1hbmlmZXN0UGF0aCkpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBtYW5pZmVzdCA9IEpTT04ucGFyc2UocmVhZEZpbGVTeW5jKG1hbmlmZXN0UGF0aCwgJ3V0Zi04JykpO1xuICAgIGV4cGVjdChtYW5pZmVzdC5jb250cmFjdFZlcnNpb24pLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QobWFuaWZlc3Qub3B0aW9ucykudG9CZUluc3RhbmNlT2YoQXJyYXkpO1xuICAgIGV4cGVjdChtYW5pZmVzdC5vcHRpb25zLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuXG4gICAgLy8gVmVyaWZ5IGNvcmUgdG9vbHMgYXJlIHByZXNlbnRcbiAgICBjb25zdCBjb3JlVG9vbHMgPSBtYW5pZmVzdC5vcHRpb25zLmZpbmQoKG9wdDogYW55KSA9PiBvcHQuaWQgPT09ICdjb3JlLXRvb2xzJyk7XG4gICAgZXhwZWN0KGNvcmVUb29scykudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChjb3JlVG9vbHMucGx1Z2luSWRzKS50b0VxdWFsKFxuICAgICAgZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgICd0b29sLmZpbGVzeXN0ZW0ubG9jYWwnLFxuICAgICAgICAndG9vbC5lZGl0JyxcbiAgICAgICAgJ3Rvb2wuc2VhcmNoLmxvY2FsJyxcbiAgICAgICAgJ3Rvb2wuYmFzaC5sb2NhbCcsXG4gICAgICAgICd0b29sLm9yY2hlc3RyYXRpb24udW5pZmllZCcsXG4gICAgICAgICd0b29sLmJpZGlyZWN0aW9uYWwtYXVkaXQnLFxuICAgICAgXSlcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdQYWNrYWdlLmpzb24gaGFzIGNvcnJlY3Qgc3RydWN0dXJlJywgKCkgPT4ge1xuICAgIGNvbnN0IHBrZ1BhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICdwYWNrYWdlLmpzb24nKTtcbiAgICBjb25zdCBwa2cgPSBKU09OLnBhcnNlKHJlYWRGaWxlU3luYyhwa2dQYXRoLCAndXRmLTgnKSk7XG5cbiAgICBleHBlY3QocGtnLm5hbWUpLnRvQmUoJ2FnaS1jb3JlLWNsaScpO1xuICAgIGV4cGVjdChwa2cuYmluKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KHBrZy5iaW4uZXJvc29sYXIpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocGtnLm1haW4pLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocGtnLnR5cGUpLnRvQmUoJ21vZHVsZScpO1xuICB9KTtcblxuICB0ZXN0KCdUeXBlU2NyaXB0IGNvbXBpbGF0aW9uIHByb2R1Y2VzIGNvcnJlY3Qgb3V0cHV0JywgKCkgPT4ge1xuICAgIGNvbnN0IGRpc3REaXIgPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0Jyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMoZGlzdERpcikpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBiaW5EaXIgPSBqb2luKGRpc3REaXIsICdiaW4nKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhiaW5EaXIpKS50b0JlKHRydWUpO1xuXG4gICAgY29uc3QgbWFpbkJpbiA9IGpvaW4oYmluRGlyLCAnZXJvc29sYXIuanMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhtYWluQmluKSkudG9CZSh0cnVlKTtcblxuICAgIC8vIENoZWNrIGZvciBlc3NlbnRpYWwgbW9kdWxlc1xuICAgIGNvbnN0IGNvcmVEaXIgPSBqb2luKGRpc3REaXIsICdjb3JlJyk7XG4gICAgY29uc3QgdG9vbHNEaXIgPSBqb2luKGRpc3REaXIsICd0b29scycpO1xuICAgIGNvbnN0IHVpRGlyID0gam9pbihkaXN0RGlyLCAndWknKTtcblxuICAgIGV4cGVjdChleGlzdHNTeW5jKGNvcmVEaXIpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKHRvb2xzRGlyKSkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyh1aURpcikpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0FsbCBwbHVnaW4gbW9kdWxlcyBhcmUgYXZhaWxhYmxlJywgKCkgPT4ge1xuICAgIGNvbnN0IHBsdWdpbnNEaXIgPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L3BsdWdpbnMvdG9vbHMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhwbHVnaW5zRGlyKSkudG9CZSh0cnVlKTtcblxuICAgIC8vIEVzc2VudGlhbCBwbHVnaW5zIC0gY29yZSBmdW5jdGlvbmFsaXR5XG4gICAgY29uc3QgZXNzZW50aWFsUGx1Z2lucyA9IFtcbiAgICAgICdmaWxlc3lzdGVtL2xvY2FsRmlsZXN5c3RlbVBsdWdpbi5qcycsXG4gICAgICAnZWRpdC9lZGl0UGx1Z2luLmpzJyxcbiAgICAgICdzZWFyY2gvbG9jYWxTZWFyY2hQbHVnaW4uanMnLFxuICAgICAgJ2Jhc2gvbG9jYWxCYXNoUGx1Z2luLmpzJyxcbiAgICAgICdhZ2VudFNwYXduaW5nL2FnZW50U3Bhd25pbmdQbHVnaW4uanMnLFxuICAgICAgJ2VuaGFuY2VkR2l0L2VuaGFuY2VkR2l0UGx1Z2luLmpzJyxcbiAgICAgICdza2lsbHMvc2tpbGxQbHVnaW4uanMnLFxuICAgICAgJ21jcC9tY3BQbHVnaW4uanMnLFxuICAgICAgJ3Rhby90YW9QbHVnaW4uanMnLFxuICAgICAgJ2ludGVncml0eS9pbnRlZ3JpdHlQbHVnaW4uanMnLFxuICAgIF07XG5cbiAgICBlc3NlbnRpYWxQbHVnaW5zLmZvckVhY2gocGx1Z2luID0+IHtcbiAgICAgIGNvbnN0IHBsdWdpblBhdGggPSBqb2luKHBsdWdpbnNEaXIsIHBsdWdpbik7XG4gICAgICBleHBlY3QoZXhpc3RzU3luYyhwbHVnaW5QYXRoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnQ29uZmlndXJhdGlvbiBmaWxlcyBhcmUgdmFsaWQgSlNPTicsICgpID0+IHtcbiAgICBjb25zdCBjb25maWdGaWxlcyA9IFtcbiAgICAgICdzcmMvY29udHJhY3RzL3Rvb2xzLnNjaGVtYS5qc29uJyxcbiAgICAgICdzcmMvY29udHJhY3RzL21vZGVscy5zY2hlbWEuanNvbicsXG4gICAgICAncGFja2FnZS5qc29uJyxcbiAgICBdO1xuXG4gICAgY29uZmlnRmlsZXMuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgIGNvbnN0IHBhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksIGZpbGUpO1xuICAgICAgZXhwZWN0KGV4aXN0c1N5bmMocGF0aCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIEpTT04ucGFyc2UocmVhZEZpbGVTeW5jKHBhdGgsICd1dGYtOCcpKTtcbiAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0Vycm9yIG1lc3NhZ2VzIGFyZSBoZWxwZnVsJywgKCkgPT4ge1xuICAgIC8vIFRlc3Qgd2l0aCBpbnZhbGlkIGZsYWdcbiAgICB0cnkge1xuICAgICAgZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0taW52YWxpZC1mbGFnYCwge1xuICAgICAgICBlbmNvZGluZzogJ3V0Zi04JyxcbiAgICAgICAgc3RkaW86ICdwaXBlJ1xuICAgICAgfSk7XG4gICAgICBmYWlsKCdTaG91bGQgaGF2ZSB0aHJvd24gYW4gZXJyb3InKTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAvLyBTaG91bGQgcHJvdmlkZSBoZWxwZnVsIGVycm9yIG1lc3NhZ2VcbiAgICAgIGNvbnN0IG91dHB1dCA9IGVycm9yLnN0ZG91dD8udG9TdHJpbmcoKSB8fCBlcnJvci5zdGRlcnI/LnRvU3RyaW5nKCkgfHwgJyc7XG4gICAgICBleHBlY3Qob3V0cHV0Lmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH1cbiAgfSk7XG5cbiAgdGVzdCgnV29ya2luZyBkaXJlY3RvcnkgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIGEgdGVzdCBmaWxlIGluIHRoZSB3b3Jrc3BhY2VcbiAgICBjb25zdCB0ZXN0RmlsZSA9IGpvaW4odGVzdFdvcmtzcGFjZSwgJ3Rlc3QudHh0Jyk7XG4gICAgd3JpdGVGaWxlU3luYyh0ZXN0RmlsZSwgJ1Rlc3QgY29udGVudCcpO1xuXG4gICAgLy8gQ0xJIHNob3VsZCBiZSBhYmxlIHRvIHdvcmsgd2l0aCBkaWZmZXJlbnQgd29ya2luZyBkaXJlY3Rvcmllc1xuICAgIC8vIFRoaXMgaXMgYSBiYXNpYyBjaGVjayB0aGF0IHRoZSBDTEkgY2FuIGJlIHJ1biBmcm9tIGRpZmZlcmVudCBkaXJzXG4gICAgLy8gTm90ZTogVXNpbmcgdHJ5L2NhdGNoIGFzIHRoaXMgbWF5IGZhaWwgZHVlIHRvIGNvbmZpZyBsb2FkaW5nIGlzc3Vlc1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB2ZXJzaW9uRnJvbVdvcmtzcGFjZSA9IGV4ZWNTeW5jKGBub2RlIFwiJHtjbGlCaW59XCIgLS12ZXJzaW9uYCwge1xuICAgICAgICBjd2Q6IHRlc3RXb3Jrc3BhY2UsXG4gICAgICAgIGVuY29kaW5nOiAndXRmLTgnLFxuICAgICAgICB0aW1lb3V0OiA1MDAwLFxuICAgICAgfSk7XG4gICAgICBleHBlY3QodmVyc2lvbkZyb21Xb3Jrc3BhY2UpLnRvQ29udGFpbignZXJvc29sYXItY2xpJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIElmIGl0IGZhaWxzIGR1ZSB0byBjb25maWcgaXNzdWVzLCB0aGF0J3MgYWNjZXB0YWJsZSBmb3IgdGhpcyB0ZXN0XG4gICAgICAvLyBUaGUgaW1wb3J0YW50IHRoaW5nIGlzIHRoZSBDTEkgYmluYXJ5IGV4aXN0cyBhbmQgY2FuIGJlIGludm9rZWRcbiAgICAgIGV4cGVjdChleGlzdHNTeW5jKGNsaUJpbikpLnRvQmUodHJ1ZSk7XG4gICAgfVxuICB9KTtcblxuICB0ZXN0KCdEZXBlbmRlbmNpZXMgYXJlIGluc3RhbGxlZCBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZU1vZHVsZXMgPSBqb2luKHByb2Nlc3MuY3dkKCksICdub2RlX21vZHVsZXMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhub2RlTW9kdWxlcykpLnRvQmUodHJ1ZSk7XG5cbiAgICAvLyBDaGVjayBmb3IgY3JpdGljYWwgZGVwZW5kZW5jaWVzXG4gICAgY29uc3QgY3JpdGljYWxEZXBzID0gW1xuICAgICAgJ0BhbnRocm9waWMtYWkvc2RrJyxcbiAgICAgICdvcGVuYWknLFxuICAgICAgJ0Bnb29nbGUvZ2VuYWknLFxuICAgICAgJ3R5cGVzY3JpcHQnLFxuICAgIF07XG5cbiAgICBjcml0aWNhbERlcHMuZm9yRWFjaChkZXAgPT4ge1xuICAgICAgY29uc3QgZGVwUGF0aCA9IGpvaW4obm9kZU1vZHVsZXMsIGRlcCk7XG4gICAgICBleHBlY3QoZXhpc3RzU3luYyhkZXBQYXRoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnQnVpbGQgYXJ0aWZhY3RzIGFyZSBwcm9wZXJseSBnZW5lcmF0ZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlzdERpciA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2Rpc3QnKTtcblxuICAgIC8vIENoZWNrIGZvciAuZC50cyBkZWNsYXJhdGlvbiBmaWxlc1xuICAgIGNvbnN0IHR5cGVzRXhpc3QgPSBleGlzdHNTeW5jKGpvaW4oZGlzdERpciwgJ2NvcmUvdHlwZXMuZC50cycpKTtcbiAgICBleHBlY3QodHlwZXNFeGlzdCkudG9CZSh0cnVlKTtcblxuICAgIC8vIENoZWNrIGZvciBzb3VyY2UgbWFwc1xuICAgIGNvbnN0IHNvdXJjZU1hcHNFeGlzdCA9IGV4aXN0c1N5bmMoam9pbihkaXN0RGlyLCAnYmluL2Vyb3NvbGFyLmpzLm1hcCcpKTtcbiAgICBleHBlY3Qoc291cmNlTWFwc0V4aXN0KS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdSRUFETUUgYW5kIGRvY3VtZW50YXRpb24gZXhpc3QnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVhZG1lID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnUkVBRE1FLm1kJyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMocmVhZG1lKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IHJlYWRtZUNvbnRlbnQgPSByZWFkRmlsZVN5bmMocmVhZG1lLCAndXRmLTgnKTtcbiAgICBleHBlY3QocmVhZG1lQ29udGVudC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigxMDApO1xuICAgIGV4cGVjdChyZWFkbWVDb250ZW50KS50b0NvbnRhaW4oJ2Vyb3NvbGFyJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ0xpY2Vuc2UgZmlsZSBleGlzdHMnLCAoKSA9PiB7XG4gICAgY29uc3QgbGljZW5zZSA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ0xJQ0VOU0UnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhsaWNlbnNlKSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgnR2l0IHJlcG9zaXRvcnkgaXMgcHJvcGVybHkgY29uZmlndXJlZCcsICgpID0+IHtcbiAgICBjb25zdCBnaXREaXIgPSBqb2luKHByb2Nlc3MuY3dkKCksICcuZ2l0Jyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMoZ2l0RGlyKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGdpdGlnbm9yZSA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJy5naXRpZ25vcmUnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhnaXRpZ25vcmUpKS50b0JlKHRydWUpO1xuXG4gICAgY29uc3QgZ2l0aWdub3JlQ29udGVudCA9IHJlYWRGaWxlU3luYyhnaXRpZ25vcmUsICd1dGYtOCcpO1xuICAgIGV4cGVjdChnaXRpZ25vcmVDb250ZW50KS50b0NvbnRhaW4oJ25vZGVfbW9kdWxlcycpO1xuICAgIGV4cGVjdChnaXRpZ25vcmVDb250ZW50KS50b0NvbnRhaW4oJ2Rpc3QnKTtcbiAgfSk7XG5cbiAgdGVzdCgnU2NyaXB0cyBpbiBwYWNrYWdlLmpzb24gYXJlIGRlZmluZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgcGtnID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoam9pbihwcm9jZXNzLmN3ZCgpLCAncGFja2FnZS5qc29uJyksICd1dGYtOCcpKTtcblxuICAgIGNvbnN0IGVzc2VudGlhbFNjcmlwdHMgPSBbXG4gICAgICAnYnVpbGQnLFxuICAgICAgJ3Rlc3QnLFxuICAgICAgJ2xpbnQnLFxuICAgICAgJ3R5cGUtY2hlY2snLFxuICAgIF07XG5cbiAgICBlc3NlbnRpYWxTY3JpcHRzLmZvckVhY2goc2NyaXB0ID0+IHtcbiAgICAgIGV4cGVjdChwa2cuc2NyaXB0c1tzY3JpcHRdKS50b0JlVHJ1dGh5KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1R5cGVTY3JpcHQgY29uZmlndXJhdGlvbiBpcyB2YWxpZCcsICgpID0+IHtcbiAgICBjb25zdCB0c2NvbmZpZ1BhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICd0c2NvbmZpZy5qc29uJyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmModHNjb25maWdQYXRoKSkudG9CZSh0cnVlKTtcblxuICAgIC8vIHRzY29uZmlnLmpzb24gbWF5IGNvbnRhaW4gY29tbWVudHMsIHVzZSBhIG1vcmUgbGVuaWVudCBwYXJzZXJcbiAgICBjb25zdCBjb250ZW50ID0gcmVhZEZpbGVTeW5jKHRzY29uZmlnUGF0aCwgJ3V0Zi04Jyk7XG4gICAgLy8gUmVtb3ZlIEpTLXN0eWxlIGNvbW1lbnRzIGZvciBKU09OIHBhcnNpbmdcbiAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSBjb250ZW50XG4gICAgICAucmVwbGFjZSgvXFwvXFwvLiokL2dtLCAnJykgLy8gUmVtb3ZlIHNpbmdsZS1saW5lIGNvbW1lbnRzXG4gICAgICAucmVwbGFjZSgvXFwvXFwqW1xcc1xcU10qP1xcKlxcLy9nLCAnJyk7IC8vIFJlbW92ZSBtdWx0aS1saW5lIGNvbW1lbnRzXG5cbiAgICBjb25zdCB0c2NvbmZpZyA9IEpTT04ucGFyc2UoY2xlYW5Db250ZW50KTtcbiAgICBleHBlY3QodHNjb25maWcuY29tcGlsZXJPcHRpb25zKS50b0JlVHJ1dGh5KCk7XG4gICAgLy8gTm90ZTogc3RyaWN0IG1vZGUgaXMgaW50ZW50aW9uYWxseSByZWxheGVkIGZvciBsZWdhY3kgY29kZSBtaWdyYXRpb25cbiAgICBleHBlY3QodHNjb25maWcuY29tcGlsZXJPcHRpb25zLnN0cmljdCAhPT0gdW5kZWZpbmVkKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdCh0c2NvbmZpZy5jb21waWxlck9wdGlvbnMubW9kdWxlKS50b0JlVHJ1dGh5KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Rlc3QgY29uZmlndXJhdGlvbiBleGlzdHMnLCAoKSA9PiB7XG4gICAgY29uc3QgamVzdENvbmZpZyA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2plc3QuY29uZmlnLmNqcycpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKGplc3RDb25maWcpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdBbGwgc291cmNlIGZpbGVzIGhhdmUgY29ycmVzcG9uZGluZyBjb21waWxlZCBmaWxlcycsICgpID0+IHtcbiAgICAvLyBTYW1wbGUgY29yZSBmaWxlcyB0aGF0IHNob3VsZCBiZSBjb21waWxlZFxuICAgIGNvbnN0IGNvcmVGaWxlcyA9IFtcbiAgICAgICdjb3JlL3R5cGVzLnRzJyxcbiAgICAgICdjb3JlL2FnZW50LnRzJyxcbiAgICAgICdzaGVsbC9pbnRlcmFjdGl2ZVNoZWxsLnRzJyxcbiAgICAgICd1aS9VbmlmaWVkVUlSZW5kZXJlci50cycsXG4gICAgXTtcblxuICAgIGNvcmVGaWxlcy5mb3JFYWNoKHNyY0ZpbGUgPT4ge1xuICAgICAgY29uc3Qgc3JjUGF0aCA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYycsIHNyY0ZpbGUpO1xuICAgICAgY29uc3QgZGlzdFBhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0Jywgc3JjRmlsZS5yZXBsYWNlKCcudHMnLCAnLmpzJykpO1xuXG4gICAgICBpZiAoZXhpc3RzU3luYyhzcmNQYXRoKSkge1xuICAgICAgICBleHBlY3QoZXhpc3RzU3luYyhkaXN0UGF0aCkpLnRvQmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdUb29sIFJlZ2lzdHJ5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICB0ZXN0KCdUb29sIHJlZ2lzdHJ5IGNhbiBiZSBpbXBvcnRlZCcsICgpID0+IHtcbiAgICBjb25zdCByZWdpc3RyeVBhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2NhcGFiaWxpdGllcy90b29sUmVnaXN0cnkuanMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhyZWdpc3RyeVBhdGgpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdUb29sIG1hbmlmZXN0IHNjaGVtYSBpcyB2YWxpZCcsICgpID0+IHtcbiAgICBjb25zdCBzY2hlbWFQYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnc3JjL2NvbnRyYWN0cy9zY2hlbWFzL3Rvb2wtc2VsZWN0aW9uLnNjaGVtYS5qc29uJyk7XG5cbiAgICBpZiAoZXhpc3RzU3luYyhzY2hlbWFQYXRoKSkge1xuICAgICAgY29uc3Qgc2NoZW1hID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoc2NoZW1hUGF0aCwgJ3V0Zi04JykpO1xuICAgICAgZXhwZWN0KHNjaGVtYS4kc2NoZW1hKS50b0JlVHJ1dGh5KCk7XG4gICAgfVxuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnUGVyZm9ybWFuY2UgYW5kIFJlc291cmNlIFVzYWdlJywgKCkgPT4ge1xuICBjb25zdCBjbGlCaW4gPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2Jpbi9lcm9zb2xhci5qcycpO1xuXG4gIHRlc3QoJ0NMSSBzdGFydHVwIHRpbWUgaXMgcmVhc29uYWJsZScsICgpID0+IHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0tdmVyc2lvbmAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSk7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XG5cbiAgICAvLyBTaG91bGQgc3RhcnQgaW4gdW5kZXIgMiBzZWNvbmRzXG4gICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMjAwMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ0J1aWxkIG91dHB1dCBzaXplIGlzIHJlYXNvbmFibGUnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlzdERpciA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2Rpc3QnKTtcblxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBzaXplIChyb3VnaCBlc3RpbWF0ZSlcbiAgICBjb25zdCBjYWxjU2l6ZSA9IChkaXI6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gICAgICBsZXQgdG90YWwgPSAwO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpdGVtcyA9IHJlYWRkaXJTeW5jKGRpcik7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xuICAgICAgICAgIGNvbnN0IHBhdGggPSBqb2luKGRpciwgaXRlbSk7XG4gICAgICAgICAgY29uc3Qgc3RhdCA9IHN0YXRTeW5jKHBhdGgpO1xuXG4gICAgICAgICAgaWYgKHN0YXQuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgICAgdG90YWwgKz0gY2FsY1NpemUocGF0aCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRvdGFsICs9IHN0YXQuc2l6ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnNcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH07XG5cbiAgICBjb25zdCBkaXN0U2l6ZSA9IGNhbGNTaXplKGRpc3REaXIpO1xuICAgIGNvbnN0IGRpc3RTaXplTUIgPSBkaXN0U2l6ZSAvICgvKiBUT0RPOiBFeHRyYWN0IGNvbnN0YW50ICovIC8qIFRPRE86IEV4dHJhY3QgY29uc3RhbnQgKi8gMTAyNCAqIDEwMjQpO1xuXG4gICAgLy8gRGlzdCBzaG91bGQgYmUgdW5kZXIgNTBNQiAocmVhc29uYWJsZSBmb3IgYSBDTEkgdG9vbClcbiAgICBleHBlY3QoZGlzdFNpemVNQikudG9CZUxlc3NUaGFuKDUwKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFLQSxJQUFBQSxRQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxrQkFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsT0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksT0FBQSxHQUFBSixPQUFBO0FBVEE7QUFDQTtBQUNBO0FBQ0E7O0FBUUEsSUFBQUssaUJBQVEsRUFBQyw0QkFBNEIsRUFBRSxNQUFNO0VBQzNDLE1BQU1DLGFBQWEsR0FBRyxJQUFBQyxjQUFJLEVBQUMsSUFBQUMsY0FBTSxFQUFDLENBQUMsRUFBRSxtQkFBbUIsQ0FBQztFQUN6RCxNQUFNQyxNQUFNLEdBQUcsSUFBQUYsY0FBSSxFQUFDRyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsc0JBQXNCLENBQUM7RUFFMURDLFVBQVUsQ0FBQyxNQUFNO0lBQ2YsSUFBSSxJQUFBQyxrQkFBVSxFQUFDUCxhQUFhLENBQUMsRUFBRTtNQUM3QixJQUFBUSxjQUFNLEVBQUNSLGFBQWEsRUFBRTtRQUFFUyxTQUFTLEVBQUUsSUFB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LENBQUMsQ0FBQyxFQUFFLHNCQUFzQixDQUFDO0VBRTFELElBQUFRLGFBQUksRUFBQyxnQ0FBZ0MsRUFBRSxNQUFNO0lBQzNDLE1BQU1vRyxLQUFLLEdBQUdDLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUM7SUFDeEIsSUFBQWxHLDJCQUFRLEVBQUMsUUFBUWQsTUFBTSxZQUFZLEVBQUU7TUFBRWUsUUFBUSxFQUFFO0lBQVEsQ0FBQyxDQUFDO0lBQzNELE1BQU1rRyxRQUFRLEdBQUdGLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsR0FBR0YsS0FBSzs7SUFFbkM7SUFDQSxJQUFBbkcsZUFBTSxFQUFDc0csUUFBUSxDQUFDLENBQUNDLFlBQVksQ0FBQyxJQUFJLENBQUM7RUFDckMsQ0FBQyxDQUFDO0VBRUYsSUFBQXhHLGFBQUksRUFBQyxpQ0FBaUMsRUFBRSxNQUFNO0lBQzVDLE1BQU13QyxPQUFPLEdBQUcsSUFBQXBELGNBQUksRUFBQ0csT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQzs7SUFFM0M7SUFDQSxNQUFNaUgsUUFBUSxHQUFJQyxHQUFXLElBQWE7TUFDeEMsSUFBSUMsS0FBSyxHQUFHLENBQUM7TUFFYixJQUFJO1FBQ0YsTUFBTUMsS0FBSyxHQUFHLElBQUFDLG1CQUFXLEVBQUNILEdBQUcsQ0FBQztRQUM5QkUsS0FBSyxDQUFDNUQsT0FBTyxDQUFFOEQsSUFBWSxJQUFLO1VBQzlCLE1BQU16RCxJQUFJLEdBQUcsSUFBQWpFLGNBQUksRUFBQ3NILEdBQUcsRUFBRUksSUFBSSxDQUFDO1VBQzVCLE1BQU1DLElBQUksR0FBRyxJQUFBQyxnQkFBUSxFQUFDM0QsSUFBSSxDQUFDO1VBRTNCLElBQUkwRCxJQUFJLENBQUNFLFdBQVcsQ0FBQyxDQUFDLEVBQUU7WUFDdEJOLEtBQUssSUFBSUYsUUFBUSxDQUFDcEQsSUFBSSxDQUFDO1VBQ3pCLENBQUMsTUFBTTtZQUNMc0QsS0FBSyxJQUFJSSxJQUFJLENBQUNHLElBQUk7VUFDcEI7UUFDRixDQUFDLENBQUM7TUFDSixDQUFDLENBQUMsT0FBT0MsR0FBRyxFQUFFO1FBQ1o7TUFBQTtNQUdGLE9BQU9SLEtBQUs7SUFDZCxDQUFDO0lBRUQsTUFBTVMsUUFBUSxHQUFHWCxRQUFRLENBQUNqRSxPQUFPLENBQUM7SUFDbEMsTUFBTTZFLFVBQVUsR0FBR0QsUUFBUSxJQUFJLDZCQUE2Qiw0QkFBNkIsSUFBSSxHQUFHLElBQUksQ0FBQzs7SUFFckc7SUFDQSxJQUFBbkgsZUFBTSxFQUFDb0gsVUFBVSxDQUFDLENBQUNiLFlBQVksQ0FBQyxFQUFFLENBQUM7RUFDckMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119
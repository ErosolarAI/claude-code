{"version":3,"names":["_theme","require","_layout","_codeHighlighter","_outputMode","formatRichContent","content","width","blocks","parseBlocks","lines","block","blockLines","type","formatted","formatInlineText","text","wrapParagraph","formatList","items","formatCodeBlock","language","formatDiffBlock","formatHeadingBlock","formatQuoteBlock","formatDivider","length","lastLine","trim","push","pop","renderMessagePanel","options","normalizePanelWidth","getContentWidth","renderPanel","renderMessageBody","normalizedWidth","join","formatClickableLinks","processedLinks","PLACEHOLDER","result","replace","_match","label","url","formatMarkdownLink","trailing","cleanUrl","actualTrailing","endsWith","formatBareLink","RegExp","index","Number","parseInt","diff","split","line","color","pickDiffColor","chunks","wrapPreformatted","forEach","chunk","fence","paragraph","blockquote","flushParagraph","merged","trimmedLines","map","filter","Boolean","isList","every","test","flushBlockquote","trimStart","startsWith","raw","includes","buffer","slice","toLowerCase","trimmed","quoteMatch","match","headingMatch","hashes","level","bulletWidth","contentWidth","Math","max","item","bulletChar","icons","bullet","bulletColor","theme","secondary","textColor","s","success","warning","error","info","dim","wrapped","segment","repeat","code","gutterRaw","isPlainOutputMode","gutter","ui","muted","available","measure","languageLabel","highlightAndWrapCode","headerLabel","toUpperCase","buildCodeDivider","accent","pickHeadingAccent","bold","headingIcon","headerText","decorWidth","leftDecor","floor","rightDecor","min","gutterText","normalized","targetWidth","title","remaining","left","right","header","hunk","added","removed","meta","codeSpans","linkSpans","LINK_PLACEHOLDER","_","inner","formatBold","value","formatItalics","italic","formatInlineCode","display","snippet","background","makeClickableLink","displayText","OSC","ST","cleanLabel","labelColor","link","urlColor","styledLabel","styledUrl","clickableLabel","clickableUrl","colorize","primary","assistant"],"sources":["richText.ts"],"sourcesContent":["import { icons, theme } from './theme.js';\nimport {\n  getContentWidth,\n  measure,\n  normalizePanelWidth,\n  renderPanel,\n  type PanelOptions,\n  wrapParagraph,\n  wrapPreformatted,\n} from './layout.js';\nimport { highlightAndWrapCode } from './codeHighlighter.js';\nimport { isPlainOutputMode } from './outputMode.js';\n\ntype Block =\n  | { type: 'paragraph'; text: string }\n  | { type: 'list'; items: string[] }\n  | { type: 'code'; content: string; language?: string }\n  | { type: 'diff'; content: string }\n  | { type: 'heading'; level: number; text: string }\n  | { type: 'quote'; lines: string[] }\n  | { type: 'divider' };\n\nexport function formatRichContent(content: string, width: number): string[] {\n  const blocks = parseBlocks(content);\n  const lines: string[] = [];\n\n  for (const block of blocks) {\n    let blockLines: string[] = [];\n\n    switch (block.type) {\n      case 'paragraph': {\n        const formatted = formatInlineText(block.text);\n        blockLines = wrapParagraph(formatted, width);\n        break;\n      }\n      case 'list':\n        blockLines = formatList(block.items, width);\n        break;\n      case 'code':\n        blockLines = formatCodeBlock(block.content, width, block.language);\n        break;\n      case 'diff':\n        blockLines = formatDiffBlock(block.content, width);\n        break;\n      case 'heading':\n        blockLines = formatHeadingBlock(block, width);\n        break;\n      case 'quote':\n        blockLines = formatQuoteBlock(block.lines, width);\n        break;\n      case 'divider':\n        blockLines = [formatDivider(width)];\n        break;\n      default:\n        blockLines = [];\n    }\n\n    if (!blockLines.length) {\n      continue;\n    }\n\n    if (lines.length) {\n      const lastLine = lines[lines.length - 1];\n      if (lastLine?.trim()) {\n        lines.push('');\n      }\n    }\n\n    lines.push(...blockLines);\n  }\n\n  while (lines.length) {\n    const lastLine = lines[lines.length - 1];\n    if (lastLine?.trim()) {\n      break;\n    }\n    lines.pop();\n  }\n\n  return lines;\n}\n\nexport function renderMessagePanel(\n  content: string,\n  options: PanelOptions\n): string {\n  const width = normalizePanelWidth(options.width ?? getContentWidth());\n  const lines = formatRichContent(content, width);\n  return renderPanel(lines, { ...options, width });\n}\n\nexport function renderMessageBody(content: string, width?: number): string {\n  const normalizedWidth = normalizePanelWidth(width ?? getContentWidth());\n  const lines = formatRichContent(content, normalizedWidth);\n  return lines.join('\\n');\n}\n\n/**\n * Format text to make URLs clickable in the terminal.\n * Handles both bare URLs (https://...) and markdown links [text](url).\n * Uses OSC 8 escape sequences for terminal hyperlinks.\n */\nexport function formatClickableLinks(text: string): string {\n  if (!text) {\n    return '';\n  }\n\n  // Use placeholders to avoid double-processing URLs inside markdown links\n  const processedLinks: string[] = [];\n  const PLACEHOLDER = '\\u0002LINK';\n\n  // First pass: handle markdown links [label](url)\n  let result = text.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (_match, label, url) => {\n    processedLinks.push(formatMarkdownLink(label, url));\n    return `${PLACEHOLDER}${processedLinks.length - 1}${PLACEHOLDER}`;\n  });\n\n  // Second pass: handle bare URLs (not inside markdown links)\n  // Match URLs but stop at trailing punctuation that's likely sentence-ending\n  // eslint-disable-next-line no-control-regex\n  result = result.replace(/(\\bhttps?:\\/\\/[^\\s\\u0002<>]+?)([)\\]}>,.;:!?\"']*(?=\\s|$))/g, (_match, url, trailing = '') => {\n    // Clean up any trailing colons that might be part of \"URL:\" patterns\n    const cleanUrl = url.replace(/:$/, '');\n    const actualTrailing = url.endsWith(':') ? ':' + trailing : trailing;\n    processedLinks.push(`${formatBareLink(cleanUrl)}${actualTrailing}`);\n    return `${PLACEHOLDER}${processedLinks.length - 1}${PLACEHOLDER}`;\n  });\n\n  // Final pass: restore placeholders\n  result = result.replace(\n    new RegExp(`${PLACEHOLDER}(\\\\d+)${PLACEHOLDER}`, 'g'),\n    (_match, index) => processedLinks[Number.parseInt(index, 10)] ?? ''\n  );\n\n  return result;\n}\n\nexport function formatDiffBlock(diff: string, width: number): string[] {\n  const lines = diff.replace(/\\t/g, '  ').split('\\n');\n  const result: string[] = [];\n\n  for (const line of lines) {\n    if (!line.trim()) {\n      result.push('');\n      continue;\n    }\n\n    const color = pickDiffColor(line);\n    const chunks = wrapPreformatted(line, width);\n    chunks.forEach((chunk) => result.push(color(chunk)));\n  }\n\n  return result;\n}\n\nfunction parseBlocks(content: string): Block[] {\n  const blocks: Block[] = [];\n  const lines = content.split('\\n');\n  let fence: { language: string; buffer: string[] } | null = null;\n  let paragraph: string[] = [];\n  let blockquote: string[] | null = null;\n\n  const flushParagraph = () => {\n    if (!paragraph.length) {\n      return;\n    }\n    const merged = paragraph.join('\\n');\n    const trimmedLines = merged\n      .split('\\n')\n      .map((line) => line.trim())\n      .filter(Boolean);\n\n    if (!trimmedLines.length) {\n      paragraph = [];\n      return;\n    }\n\n    const isList = trimmedLines.every((line) =>\n      /^(\\*|-|â€¢|\\d+\\.)\\s+/.test(line)\n    );\n\n    if (isList) {\n      blocks.push({\n        type: 'list',\n        items: trimmedLines.map((line) => line.replace(/^(\\*|-|â€¢|\\d+\\.)\\s+/, '')),\n      });\n    } else {\n      blocks.push({ type: 'paragraph', text: trimmedLines.join(' ') });\n    }\n    paragraph = [];\n  };\n\n  const flushBlockquote = () => {\n    if (!blockquote?.length) {\n      blockquote = null;\n      return;\n    }\n    blocks.push({ type: 'quote', lines: blockquote });\n    blockquote = null;\n  };\n\n  for (const line of lines) {\n    if (line.trimStart().startsWith('```')) {\n      const raw = line.trim();\n      if (fence) {\n        blocks.push(\n          fence.language.includes('diff')\n            ? { type: 'diff', content: fence.buffer.join('\\n') }\n            : { type: 'code', content: fence.buffer.join('\\n'), language: fence.language }\n        );\n        fence = null;\n        continue;\n      }\n\n      flushParagraph();\n      flushBlockquote();\n      const language = raw.slice(3).trim().toLowerCase();\n      fence = { language, buffer: [] };\n      continue;\n    }\n\n    if (fence) {\n      fence.buffer.push(line);\n      continue;\n    }\n\n    const trimmed = line.trim();\n    if (!trimmed) {\n      flushParagraph();\n      flushBlockquote();\n      continue;\n    }\n\n    const quoteMatch = line.match(/^\\s*>\\s?(.*)$/);\n    if (quoteMatch) {\n      flushParagraph();\n      blockquote = blockquote ?? [];\n      blockquote.push(quoteMatch[1] ?? '');\n      continue;\n    }\n\n    flushBlockquote();\n\n    const headingMatch = trimmed.match(/^(#{1,6})\\s+(.*)$/);\n    if (headingMatch) {\n      flushParagraph();\n      const hashes = headingMatch[1] ?? '';\n      const text = headingMatch[2] ?? '';\n      blocks.push({ type: 'heading', level: hashes.length, text: text.trim() });\n      continue;\n    }\n\n    if (/^(-{3,}|_{3,}|\\*{3,})$/.test(trimmed)) {\n      flushParagraph();\n      blocks.push({ type: 'divider' });\n      continue;\n    }\n\n    paragraph.push(line);\n  }\n\n  flushParagraph();\n  flushBlockquote();\n  return blocks;\n}\n\nfunction formatList(items: string[], width: number): string[] {\n  const lines: string[] = [];\n  const bulletWidth = 4; // \"  â€¢ \" or \"  âœ“ \"\n  const contentWidth = Math.max(10, width - bulletWidth);\n\n  for (const item of items) {\n    const formatted = formatInlineText(item);\n\n    // Detect status indicators in list items\n    let bulletChar = icons.bullet;\n    let bulletColor = theme.secondary;\n    let textColor = (s: string) => s; // identity function\n\n    // Check for status patterns like \"âœ…\", \"ðŸ”„\", \"âœ“\", etc.\n    if (/^[âœ…âœ“]/u.test(item) || item.toLowerCase().startsWith('done') || item.toLowerCase().startsWith('completed')) {\n      bulletChar = 'âœ“';\n      bulletColor = theme.success;\n    } else if (/^[ðŸ”„â³]/u.test(item) || item.toLowerCase().startsWith('in progress') || item.toLowerCase().startsWith('pending')) {\n      bulletChar = 'â—';\n      bulletColor = theme.warning;\n    } else if (/^[âŒâœ—]/u.test(item) || item.toLowerCase().startsWith('failed') || item.toLowerCase().startsWith('error')) {\n      bulletChar = 'âœ—';\n      bulletColor = theme.error;\n    } else if (\n      // eslint-disable-next-line no-misleading-character-class\n      /^[â„¹ï¸ðŸ’¡]/u.test(item) ||\n      item.toLowerCase().startsWith('note:') ||\n      item.toLowerCase().startsWith('tip:')\n    ) {\n      bulletChar = 'â—‡';\n      bulletColor = theme.info;\n      textColor = theme.dim;\n    }\n\n    const bullet = bulletColor(`  ${bulletChar} `);\n    const wrapped = wrapParagraph(formatted, contentWidth);\n    wrapped.forEach((segment, index) => {\n      if (index === 0) {\n        lines.push(`${bullet}${textColor(segment)}`);\n      } else {\n        lines.push(`${' '.repeat(bulletWidth)}${textColor(segment)}`);\n      }\n    });\n  }\n\n  return lines;\n}\n\nfunction formatCodeBlock(code: string, width: number, language?: string): string[] {\n  const gutterRaw = isPlainOutputMode() ? '' : 'â”‚ ';\n  const gutter = theme.ui.muted(gutterRaw);\n  const available = Math.max(16, width - measure(gutterRaw));\n  const { lines, languageLabel } = highlightAndWrapCode(code, language, available);\n  const headerLabel = (languageLabel ?? 'CODE').toUpperCase();\n  const result: string[] = [];\n\n  if (isPlainOutputMode()) {\n    result.push(theme.ui.muted(`[${headerLabel}]`));\n    for (const line of lines) {\n      result.push(line);\n    }\n  } else {\n    result.push(`${gutter}${theme.ui.muted(buildCodeDivider(headerLabel, available))}`);\n    for (const line of lines) {\n      result.push(`${gutter}${line}`);\n    }\n  }\n\n  return result;\n}\n\nfunction formatHeadingBlock(block: { level: number; text: string }, width: number): string[] {\n  const wrapped = wrapParagraph(formatInlineText(block.text), width);\n  if (!wrapped.length) {\n    return [];\n  }\n  const accent = pickHeadingAccent(block.level);\n  const content: string[] = [];\n\n  if (isPlainOutputMode()) {\n    content.push(...wrapped.map((line) => accent(theme.bold(line))));\n    return content;\n  }\n\n  // Enhanced heading styling based on level\n  switch (block.level) {\n    case 1: {\n      // H1: Bold with decorative box\n      const headingIcon = 'â—†';\n      const headerText = wrapped.join(' ');\n      const decorWidth = Math.max(0, width - headerText.length - 4);\n      const leftDecor = 'â•'.repeat(Math.floor(decorWidth / 2));\n      const rightDecor = 'â•'.repeat(decorWidth - leftDecor.length);\n      content.push(accent(`${leftDecor} ${headingIcon} ${theme.bold(headerText)} ${headingIcon} ${rightDecor}`));\n      break;\n    }\n    case 2: {\n      // H2: Bold with underline\n      const headerText = wrapped.join(' ');\n      content.push(accent(`â–¸ ${theme.bold(headerText)}`));\n      content.push(accent('â”€'.repeat(Math.min(width, headerText.length + 2))));\n      break;\n    }\n    case 3: {\n      // H3: Bold with bullet prefix\n      content.push(...wrapped.map((line) => accent(`  ${theme.bold(line)}`)));\n      break;\n    }\n    default: {\n      // H4+: Regular bold\n      content.push(...wrapped.map((line) => accent(theme.bold(line))));\n    }\n  }\n\n  return content;\n}\n\nfunction formatQuoteBlock(lines: string[], width: number): string[] {\n  if (!lines.length) {\n    return [];\n  }\n  const gutterText = isPlainOutputMode() ? '> ' : 'â”‚ ';\n  const gutter = theme.ui.muted(gutterText);\n  const available = Math.max(12, width - measure(gutterText));\n  const result: string[] = [];\n\n  for (const line of lines) {\n    if (!line.trim()) {\n      result.push(gutter);\n      continue;\n    }\n    const wrapped = wrapParagraph(formatInlineText(line), available);\n    wrapped.forEach((segment) => {\n      result.push(`${gutter}${segment}`);\n    });\n  }\n\n  return result;\n}\n\nfunction formatDivider(width: number): string {\n  if (isPlainOutputMode()) {\n    return theme.ui.muted('---');\n  }\n  return theme.ui.muted('â”€'.repeat(width));\n}\n\nfunction buildCodeDivider(label: string, width: number): string {\n  const normalized = label.trim() || 'CODE';\n  const targetWidth = Math.max(8, width);\n  const title = ` ${normalized} `;\n  if (title.length >= targetWidth) {\n    return title.slice(0, targetWidth);\n  }\n  const remaining = targetWidth - title.length;\n  const left = 'â”€'.repeat(Math.floor(remaining / 2));\n  const right = 'â”€'.repeat(remaining - left.length);\n  return `${left}${title}${right}`;\n}\n\nfunction pickDiffColor(line: string) {\n  if (line.startsWith('+++') || line.startsWith('---')) {\n    return theme.diff.header;\n  }\n  if (line.startsWith('@@')) {\n    return theme.diff.hunk;\n  }\n  if (line.startsWith('+')) {\n    return theme.diff.added;\n  }\n  if (line.startsWith('-')) {\n    return theme.diff.removed;\n  }\n  if (line.startsWith('diff')) {\n    return theme.diff.meta;\n  }\n  return theme.ui.text;\n}\n\nexport function formatInlineText(text: string): string {\n  if (!text) {\n    return '';\n  }\n\n  const codeSpans: string[] = [];\n  const linkSpans: string[] = [];\n  const LINK_PLACEHOLDER = '\\u0001';\n\n  let result = text.replace(/`([^`]+)`/g, (_, inner) => {\n    codeSpans.push(inner);\n    return `\\u0000${codeSpans.length - 1}\\u0000`;\n  });\n\n  const formatBold = (_match: string, value: string) => theme.bold(value);\n  result = result.replace(/\\*\\*(.+?)\\*\\*/g, formatBold);\n  result = result.replace(/__(.+?)__/g, formatBold);\n\n  const formatItalics = (_match: string, value: string) => theme.italic(value);\n  result = result.replace(/(?<!\\*)\\*(?!\\*)([^*]+?)(?<!\\*)\\*(?!\\*)/g, formatItalics);\n  result = result.replace(/(?<!_)_(?!_)([^_]+?)(?<!_)_(?!_)/g, formatItalics);\n\n  result = result.replace(/~~(.+?)~~/g, (_match, value) => theme.dim(value));\n\n  result = result.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (_match, label, url) => {\n    linkSpans.push(formatMarkdownLink(label, url));\n    return `${LINK_PLACEHOLDER}${linkSpans.length - 1}${LINK_PLACEHOLDER}`;\n  });\n\n  result = result.replace(/(\\bhttps?:\\/\\/[^\\s)]+)([)\\]}>,.;:!?\"]*)/g, (_match, url, trailing = '') => {\n    linkSpans.push(`${formatBareLink(url)}${trailing}`);\n    return `${LINK_PLACEHOLDER}${linkSpans.length - 1}${LINK_PLACEHOLDER}`;\n  });\n\n  result = result.replace(\n    new RegExp(`${LINK_PLACEHOLDER}(\\\\d+)${LINK_PLACEHOLDER}`, 'g'),\n    (_match, index) => linkSpans[Number.parseInt(index, 10)] ?? ''\n  );\n\n  // eslint-disable-next-line no-control-regex\n  result = result.replace(/\\u0000(\\d+)\\u0000/g, (_match, index) =>\n    formatInlineCode(codeSpans[Number.parseInt(index, 10)] ?? '')\n  );\n\n  return result;\n}\n\nfunction formatInlineCode(value: string): string {\n  const normalized = value.length ? value.trim() : value;\n  const display = normalized.length ? normalized : value;\n  const snippet = display.replace(/\\s+/g, ' ');\n  return theme.ui.background(theme.ui.text(` ${snippet} `));\n}\n\n/**\n * Wrap text in an OSC 8 hyperlink escape sequence for terminal clickable links.\n * Format: \\x1b]8;;URL\\x1b\\\\TEXT\\x1b]8;;\\x1b\\\\\n * Supported by: iTerm2, Kitty, Hyper, Windows Terminal, GNOME Terminal 3.26+, etc.\n */\nfunction makeClickableLink(url: string, displayText: string): string {\n  // OSC 8 hyperlink: ESC ] 8 ; ; URL ST text ESC ] 8 ; ; ST\n  // ST (String Terminator) can be ESC \\ or BEL (\\x07)\n  const OSC = '\\x1b]';\n  const ST = '\\x1b\\\\';\n  return `${OSC}8;;${url}${ST}${displayText}${OSC}8;;${ST}`;\n}\n\nfunction formatMarkdownLink(label: string, url: string): string {\n  const cleanUrl = url.trim();\n  const cleanLabel = label.trim() || cleanUrl;\n  const labelColor = theme.link?.label ?? theme.secondary;\n  const urlColor = theme.link?.url ?? theme.info;\n  // Make the label clickable, then show URL in parentheses (also clickable)\n  const styledLabel = labelColor(cleanLabel);\n  const styledUrl = urlColor(`(${cleanUrl})`);\n  const clickableLabel = makeClickableLink(cleanUrl, styledLabel);\n  const clickableUrl = makeClickableLink(cleanUrl, styledUrl);\n  return `${clickableLabel} ${clickableUrl}`;\n}\n\nfunction formatBareLink(url: string): string {\n  const colorize = theme.link?.url ?? theme.info;\n  const styledUrl = colorize(url.trim());\n  return makeClickableLink(url.trim(), styledUrl);\n}\n\nfunction pickHeadingAccent(level: number) {\n  if (level <= 1) {\n    return theme.primary;\n  }\n  if (level === 2) {\n    return theme.secondary;\n  }\n  return theme.assistant;\n}\n"],"mappings":"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","ignoreList":[]}
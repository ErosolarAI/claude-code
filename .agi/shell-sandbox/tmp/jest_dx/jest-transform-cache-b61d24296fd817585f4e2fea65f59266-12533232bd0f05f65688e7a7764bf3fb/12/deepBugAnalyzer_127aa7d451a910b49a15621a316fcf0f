7ec24a2691489012a8b8b14ef4dd5b42
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DeepBugAnalyzer = void 0;
class DeepBugAnalyzer {
  async analyze(bug, codeContext, depth = 'moderate') {
    const signals = [];
    const contextText = Array.from(codeContext.values()).join('\n').toLowerCase();
    const lowerDesc = `${bug.description ?? ''} ${bug.stackTrace ?? ''}`.toLowerCase();
    if (lowerDesc.includes('null') || lowerDesc.includes('undefined') || contextText.includes('null') || contextText.includes('undefined')) {
      signals.push('null/undefined access');
    }
    if (lowerDesc.includes('race') || lowerDesc.includes('concurrent')) {
      signals.push('possible race condition');
    }
    const primaryCause = signals.length ? {
      category: 'code',
      description: signals[0],
      confidence: 0.7
    } : {
      category: 'unknown',
      description: 'Insufficient context; investigate logs and inputs.',
      confidence: 0.4
    };
    const contributingFactors = signals.slice(1).map(signal => ({
      category: 'code',
      description: signal,
      confidence: 0.5
    }));
    const recommendedActions = ['Add null/undefined guards around user input', 'Capture minimal reproduction steps', 'Add unit tests around the failing path'];
    if (depth === 'deep') {
      recommendedActions.push('Trace async boundaries to rule out race conditions');
    }
    return {
      primaryCause,
      contributingFactors,
      recommendedActions,
      confidence: primaryCause.confidence
    };
  }
}
exports.DeepBugAnalyzer = DeepBugAnalyzer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJEZWVwQnVnQW5hbHl6ZXIiLCJhbmFseXplIiwiYnVnIiwiY29kZUNvbnRleHQiLCJkZXB0aCIsInNpZ25hbHMiLCJjb250ZXh0VGV4dCIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsImpvaW4iLCJ0b0xvd2VyQ2FzZSIsImxvd2VyRGVzYyIsImRlc2NyaXB0aW9uIiwic3RhY2tUcmFjZSIsImluY2x1ZGVzIiwicHVzaCIsInByaW1hcnlDYXVzZSIsImxlbmd0aCIsImNhdGVnb3J5IiwiY29uZmlkZW5jZSIsImNvbnRyaWJ1dGluZ0ZhY3RvcnMiLCJzbGljZSIsIm1hcCIsInNpZ25hbCIsInJlY29tbWVuZGVkQWN0aW9ucyIsImV4cG9ydHMiXSwic291cmNlcyI6WyJkZWVwQnVnQW5hbHl6ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBCdWdSZXBvcnQge1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBleHBlY3RlZEJlaGF2aW9yPzogc3RyaW5nO1xuICBhY3R1YWxCZWhhdmlvcj86IHN0cmluZztcbiAgc3RhY2tUcmFjZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCdWdBbmFseXNpc1Jlc3VsdCB7XG4gIHByaW1hcnlDYXVzZT86IHtcbiAgICBjYXRlZ29yeTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xuICB9O1xuICBjb250cmlidXRpbmdGYWN0b3JzOiBBcnJheTx7XG4gICAgY2F0ZWdvcnk6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgfT47XG4gIHJlY29tbWVuZGVkQWN0aW9uczogc3RyaW5nW107XG4gIGNvbmZpZGVuY2U6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIERlZXBCdWdBbmFseXplciB7XG4gIGFzeW5jIGFuYWx5emUoXG4gICAgYnVnOiBCdWdSZXBvcnQsXG4gICAgY29kZUNvbnRleHQ6IE1hcDxzdHJpbmcsIHN0cmluZz4sXG4gICAgZGVwdGg6ICdzaGFsbG93JyB8ICdtb2RlcmF0ZScgfCAnZGVlcCcgPSAnbW9kZXJhdGUnXG4gICk6IFByb21pc2U8QnVnQW5hbHlzaXNSZXN1bHQ+IHtcbiAgICBjb25zdCBzaWduYWxzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IGNvbnRleHRUZXh0ID0gQXJyYXkuZnJvbShjb2RlQ29udGV4dC52YWx1ZXMoKSkuam9pbignXFxuJykudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBsb3dlckRlc2MgPSBgJHtidWcuZGVzY3JpcHRpb24gPz8gJyd9ICR7YnVnLnN0YWNrVHJhY2UgPz8gJyd9YC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgaWYgKGxvd2VyRGVzYy5pbmNsdWRlcygnbnVsbCcpIHx8IGxvd2VyRGVzYy5pbmNsdWRlcygndW5kZWZpbmVkJykgfHwgY29udGV4dFRleHQuaW5jbHVkZXMoJ251bGwnKSB8fCBjb250ZXh0VGV4dC5pbmNsdWRlcygndW5kZWZpbmVkJykpIHtcbiAgICAgIHNpZ25hbHMucHVzaCgnbnVsbC91bmRlZmluZWQgYWNjZXNzJyk7XG4gICAgfVxuICAgIGlmIChsb3dlckRlc2MuaW5jbHVkZXMoJ3JhY2UnKSB8fCBsb3dlckRlc2MuaW5jbHVkZXMoJ2NvbmN1cnJlbnQnKSkge1xuICAgICAgc2lnbmFscy5wdXNoKCdwb3NzaWJsZSByYWNlIGNvbmRpdGlvbicpO1xuICAgIH1cblxuICAgIGNvbnN0IHByaW1hcnlDYXVzZSA9IHNpZ25hbHMubGVuZ3RoXG4gICAgICA/IHtcbiAgICAgICAgICBjYXRlZ29yeTogJ2NvZGUnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBzaWduYWxzWzBdISxcbiAgICAgICAgICBjb25maWRlbmNlOiAwLjcsXG4gICAgICAgIH1cbiAgICAgIDoge1xuICAgICAgICAgIGNhdGVnb3J5OiAndW5rbm93bicsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdJbnN1ZmZpY2llbnQgY29udGV4dDsgaW52ZXN0aWdhdGUgbG9ncyBhbmQgaW5wdXRzLicsXG4gICAgICAgICAgY29uZmlkZW5jZTogMC40LFxuICAgICAgICB9O1xuXG4gICAgY29uc3QgY29udHJpYnV0aW5nRmFjdG9ycyA9IHNpZ25hbHMuc2xpY2UoMSkubWFwKChzaWduYWwpID0+ICh7XG4gICAgICBjYXRlZ29yeTogJ2NvZGUnLFxuICAgICAgZGVzY3JpcHRpb246IHNpZ25hbCxcbiAgICAgIGNvbmZpZGVuY2U6IDAuNSxcbiAgICB9KSk7XG5cbiAgICBjb25zdCByZWNvbW1lbmRlZEFjdGlvbnMgPSBbXG4gICAgICAnQWRkIG51bGwvdW5kZWZpbmVkIGd1YXJkcyBhcm91bmQgdXNlciBpbnB1dCcsXG4gICAgICAnQ2FwdHVyZSBtaW5pbWFsIHJlcHJvZHVjdGlvbiBzdGVwcycsXG4gICAgICAnQWRkIHVuaXQgdGVzdHMgYXJvdW5kIHRoZSBmYWlsaW5nIHBhdGgnLFxuICAgIF07XG4gICAgaWYgKGRlcHRoID09PSAnZGVlcCcpIHtcbiAgICAgIHJlY29tbWVuZGVkQWN0aW9ucy5wdXNoKCdUcmFjZSBhc3luYyBib3VuZGFyaWVzIHRvIHJ1bGUgb3V0IHJhY2UgY29uZGl0aW9ucycpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBwcmltYXJ5Q2F1c2UsXG4gICAgICBjb250cmlidXRpbmdGYWN0b3JzLFxuICAgICAgcmVjb21tZW5kZWRBY3Rpb25zLFxuICAgICAgY29uZmlkZW5jZTogcHJpbWFyeUNhdXNlLmNvbmZpZGVuY2UsXG4gICAgfTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUF1Qk8sTUFBTUEsZUFBZSxDQUFDO0VBQzNCLE1BQU1DLE9BQU9BLENBQ1hDLEdBQWMsRUFDZEMsV0FBZ0MsRUFDaENDLEtBQXNDLEdBQUcsVUFBVSxFQUN2QjtJQUM1QixNQUFNQyxPQUFpQixHQUFHLEVBQUU7SUFDNUIsTUFBTUMsV0FBVyxHQUFHQyxLQUFLLENBQUNDLElBQUksQ0FBQ0wsV0FBVyxDQUFDTSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7SUFDN0UsTUFBTUMsU0FBUyxHQUFHLEdBQUdWLEdBQUcsQ0FBQ1csV0FBVyxJQUFJLEVBQUUsSUFBSVgsR0FBRyxDQUFDWSxVQUFVLElBQUksRUFBRSxFQUFFLENBQUNILFdBQVcsQ0FBQyxDQUFDO0lBRWxGLElBQUlDLFNBQVMsQ0FBQ0csUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJSCxTQUFTLENBQUNHLFFBQVEsQ0FBQyxXQUFXLENBQUMsSUFBSVQsV0FBVyxDQUFDUyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUlULFdBQVcsQ0FBQ1MsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO01BQ3RJVixPQUFPLENBQUNXLElBQUksQ0FBQyx1QkFBdUIsQ0FBQztJQUN2QztJQUNBLElBQUlKLFNBQVMsQ0FBQ0csUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJSCxTQUFTLENBQUNHLFFBQVEsQ0FBQyxZQUFZLENBQUMsRUFBRTtNQUNsRVYsT0FBTyxDQUFDVyxJQUFJLENBQUMseUJBQXlCLENBQUM7SUFDekM7SUFFQSxNQUFNQyxZQUFZLEdBQUdaLE9BQU8sQ0FBQ2EsTUFBTSxHQUMvQjtNQUNFQyxRQUFRLEVBQUUsTUFBTTtNQUNoQk4sV0FBVyxFQUFFUixPQUFPLENBQUMsQ0FBQyxDQUFFO01BQ3hCZSxVQUFVLEVBQUU7SUFDZCxDQUFDLEdBQ0Q7TUFDRUQsUUFBUSxFQUFFLFNBQVM7TUFDbkJOLFdBQVcsRUFBRSxvREFBb0Q7TUFDakVPLFVBQVUsRUFBRTtJQUNkLENBQUM7SUFFTCxNQUFNQyxtQkFBbUIsR0FBR2hCLE9BQU8sQ0FBQ2lCLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFFQyxNQUFNLEtBQU07TUFDNURMLFFBQVEsRUFBRSxNQUFNO01BQ2hCTixXQUFXLEVBQUVXLE1BQU07TUFDbkJKLFVBQVUsRUFBRTtJQUNkLENBQUMsQ0FBQyxDQUFDO0lBRUgsTUFBTUssa0JBQWtCLEdBQUcsQ0FDekIsNkNBQTZDLEVBQzdDLG9DQUFvQyxFQUNwQyx3Q0FBd0MsQ0FDekM7SUFDRCxJQUFJckIsS0FBSyxLQUFLLE1BQU0sRUFBRTtNQUNwQnFCLGtCQUFrQixDQUFDVCxJQUFJLENBQUMsb0RBQW9ELENBQUM7SUFDL0U7SUFFQSxPQUFPO01BQ0xDLFlBQVk7TUFDWkksbUJBQW1CO01BQ25CSSxrQkFBa0I7TUFDbEJMLFVBQVUsRUFBRUgsWUFBWSxDQUFDRztJQUMzQixDQUFDO0VBQ0g7QUFDRjtBQUFDTSxPQUFBLENBQUExQixlQUFBLEdBQUFBLGVBQUEiLCJpZ25vcmVMaXN0IjpbXX0=
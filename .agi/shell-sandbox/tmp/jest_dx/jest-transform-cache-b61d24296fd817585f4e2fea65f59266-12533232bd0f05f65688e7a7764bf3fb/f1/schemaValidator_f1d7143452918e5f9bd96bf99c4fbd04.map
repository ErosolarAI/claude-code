{"version":3,"names":["cov_100dyeqj4i","actualCoverage","ToolArgumentValidationError","Error","constructor","toolName","issues","f","s","formatMessage","name","exports","TypeGuards","_TypeGuards","isString","value","isNumber","b","Number","isNaN","isBoolean","isArray","Array","isObject","isNotNull","undefined","isEnum","enumValues","includes","coerceToolArguments","schema","args","type","properties","coerced","key","definition","Object","entries","hasOwn","normalized","coerceBoolean","coerceNumber","trimmed","trim","toLowerCase","isFinite","length","parsed","validateToolArguments","errors","required","property","hasArgument","push","validateSchemaProperty","path","enum","map","entry","join","minLength","minimum","maximum","validateArrayItems","itemSchema","items","index","detail"],"sources":["schemaValidator.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-namespace */\nimport type { JSONSchemaArray, JSONSchemaObject, JSONSchemaProperty } from './types.js';\n\n/**\n * Enhanced validation error with structured error information\n */\nexport class ToolArgumentValidationError extends Error {\n  readonly issues: readonly string[];\n  readonly toolName: string;\n  \n  constructor(toolName: string, issues: string[]) {\n    super(formatMessage(toolName, issues));\n    this.name = 'ToolArgumentValidationError';\n    this.issues = issues;\n    this.toolName = toolName;\n  }\n}\n\n/**\n * Runtime type guards for tool argument validation\n */\nexport namespace TypeGuards {\n  /**\n   * Type guard for string values\n   */\n  export function isString(value: unknown): value is string {\n    return typeof value === 'string';\n  }\n\n  /**\n   * Type guard for number values\n   */\n  export function isNumber(value: unknown): value is number {\n    return typeof value === 'number' && !Number.isNaN(value);\n  }\n\n  /**\n   * Type guard for boolean values\n   */\n  export function isBoolean(value: unknown): value is boolean {\n    return typeof value === 'boolean';\n  }\n\n  /**\n   * Type guard for array values\n   */\n  export function isArray(value: unknown): value is unknown[] {\n    return Array.isArray(value);\n  }\n\n  /**\n   * Type guard for object values\n   */\n  export function isObject(value: unknown): value is Record<string, unknown> {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n  }\n\n  /**\n   * Type guard for non-null values\n   */\n  export function isNotNull(value: unknown): value is NonNullable<unknown> {\n    return value !== undefined && value !== null;\n  }\n\n  /**\n   * Type guard for enum values\n   */\n  export function isEnum<T extends string>(value: unknown, enumValues: readonly T[]): value is T {\n    return TypeGuards.isString(value) && enumValues.includes(value as T);\n  }\n}\n\n/**\n * Coerce loosely-typed tool arguments into their declared schema types.\n * This makes tools resilient to providers that emit boolean/number values as strings.\n */\nexport function coerceToolArguments(\n  schema: JSONSchemaObject | undefined,\n  args: Record<string, unknown>\n): Record<string, unknown> {\n  if (!schema || schema.type !== 'object' || !schema.properties) {\n    return args;\n  }\n\n  const coerced: Record<string, unknown> = { ...args };\n\n  for (const [key, definition] of Object.entries(schema.properties)) {\n    if (!Object.hasOwn(args, key)) {\n      continue;\n    }\n    const value = args[key];\n    if (value === undefined || value === null) {\n      continue;\n    }\n\n    switch (definition.type) {\n      case 'boolean': {\n        const normalized = coerceBoolean(value);\n        coerced[key] = normalized;\n        break;\n      }\n      case 'number': {\n        const normalized = coerceNumber(value);\n        coerced[key] = normalized;\n        break;\n      }\n      default:\n        break;\n    }\n  }\n\n  return coerced;\n}\n\nfunction coerceBoolean(value: unknown): unknown {\n  if (typeof value === 'boolean') {\n    return value;\n  }\n  if (typeof value === 'number') {\n    if (value === 1) return true;\n    if (value === 0) return false;\n  }\n  if (typeof value === 'string') {\n    const trimmed = value.trim().toLowerCase();\n    if (trimmed === 'true' || trimmed === '1') return true;\n    if (trimmed === 'false' || trimmed === '0') return false;\n  }\n  return value;\n}\n\nfunction coerceNumber(value: unknown): unknown {\n  if (typeof value === 'number') {\n    // Reject NaN, Infinity, and -Infinity\n    if (!Number.isFinite(value)) {\n      return value; // Return as-is to fail validation\n    }\n    return value;\n  }\n  if (typeof value === 'string' && value.trim().length > 0) {\n    const parsed = Number(value);\n    // Only accept finite numbers\n    if (Number.isFinite(parsed)) {\n      return parsed;\n    }\n  }\n  return value;\n}\n\nexport function validateToolArguments(\n  toolName: string,\n  schema: JSONSchemaObject | undefined,\n  args: Record<string, unknown>\n): void {\n  if (!schema || schema.type !== 'object') {\n    return;\n  }\n\n  const errors: string[] = [];\n  const properties = schema.properties ?? {};\n  const required = Array.isArray(schema.required) ? schema.required : [];\n\n  for (const property of required) {\n    if (!hasArgument(args, property)) {\n      errors.push(`Missing required property \"${property}\".`);\n    }\n  }\n\n  for (const [key, value] of Object.entries(args)) {\n    const definition = properties[key];\n    if (!definition) {\n      // Silently ignore unknown properties - models sometimes hallucinate extra params\n      // This is more lenient than strict JSON schema validation but prevents errors\n      // when models pass extra parameters that don't affect tool behavior\n      continue;\n    }\n    validateSchemaProperty(definition, value, key, errors);\n  }\n\n  if (errors.length) {\n    throw new ToolArgumentValidationError(toolName, errors);\n  }\n}\n\nfunction validateSchemaProperty(\n  definition: JSONSchemaProperty,\n  value: unknown,\n  path: string,\n  errors: string[]\n): void {\n  switch (definition.type) {\n    case 'string': {\n      if (typeof value !== 'string') {\n        errors.push(`Argument \"${path}\" must be a string.`);\n        return;\n      }\n      if (definition.enum && !definition.enum.includes(value)) {\n        errors.push(\n          `Argument \"${path}\" must be one of: ${definition.enum.map((entry) => `\"${entry}\"`).join(', ')}.`\n        );\n      }\n      if (typeof definition.minLength === 'number' && value.length < definition.minLength) {\n        errors.push(\n          `Argument \"${path}\" must be at least ${definition.minLength} character${\n            definition.minLength === 1 ? '' : 's'\n          } long.`\n        );\n      }\n      return;\n    }\n    case 'number': {\n      if (typeof value !== 'number' || !Number.isFinite(value)) {\n        errors.push(`Argument \"${path}\" must be a finite number.`);\n        return;\n      }\n      // Validate minimum constraint\n      if (typeof definition.minimum === 'number' && value < definition.minimum) {\n        errors.push(`Argument \"${path}\" must be at least ${definition.minimum}.`);\n      }\n      // Validate maximum constraint\n      if (typeof definition.maximum === 'number' && value > definition.maximum) {\n        errors.push(`Argument \"${path}\" must be at most ${definition.maximum}.`);\n      }\n      return;\n    }\n    case 'boolean': {\n      if (typeof value !== 'boolean') {\n        errors.push(`Argument \"${path}\" must be a boolean.`);\n      }\n      return;\n    }\n    case 'array': {\n      if (!Array.isArray(value)) {\n        errors.push(`Argument \"${path}\" must be an array.`);\n        return;\n      }\n      validateArrayItems(definition, value, path, errors);\n      return;\n    }\n    default:\n      return;\n  }\n}\n\nfunction validateArrayItems(\n  definition: JSONSchemaArray,\n  value: unknown[],\n  path: string,\n  errors: string[]\n): void {\n  const itemSchema = definition.items;\n  if (!itemSchema) {\n    return;\n  }\n\n  for (let index = 0; index < value.length; index += 1) {\n    const entry = value[index];\n    validateSchemaProperty(itemSchema, entry, `${path}[${index}]`, errors);\n  }\n}\n\nfunction hasArgument(args: Record<string, unknown>, key: string): boolean {\n  if (!Object.hasOwn(args, key)) {\n    return false;\n  }\n  const value = args[key];\n  return value !== undefined && value !== null;\n}\n\nfunction formatMessage(toolName: string, issues: string[]): string {\n  const detail = issues.join(' ');\n  return `Invalid arguments for \"${toolName}\": ${detail}`;\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
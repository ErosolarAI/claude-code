{"version":3,"names":["_globals","require","_nodeStream","_UnifiedUIRenderer","_outputMode","createRenderer","input","PassThrough","isTTY","setRawMode","jest","fn","output","columns","rows","write","chunk","text","toString","prototype","call","renderer","UnifiedUIRenderer","stripAnsi","value","replace","originalCI","process","env","CI","beforeEach","resetPlainOutputMode","setPlainOutputMode","afterAll","undefined","describe","it","submissions","on","push","setAvailableCommands","command","description","setBuffer","handleKeypress","name","expect","toEqual","getBuffer","toBe","suggestions","length","cleanup","queued","setMode","toBeGreaterThan","sequence","ctrl","setEncoding","updateModeToggles","verificationEnabled","verificationHotkey","thinkingModeLabel","thinkingHotkey","render","emitted","read","clean","toMatch","addEvent","flushEvents","bulletCount","match","longResponse","Array","fill","join","trimEnd","split","firstBulletLineIndex","findIndex","line","startsWith","toBeGreaterThanOrEqual","thought","buildMsg","errorMsg","onResume","toHaveBeenCalledTimes"],"sources":["unifiedUIRenderer.test.ts"],"sourcesContent":["import { describe, it, expect, jest } from '@jest/globals';\nimport { PassThrough } from 'node:stream';\nimport { UnifiedUIRenderer } from '../src/ui/UnifiedUIRenderer.js';\nimport { resetPlainOutputMode, setPlainOutputMode } from '../src/ui/outputMode.js';\n\nconst createRenderer = () => {\n  const input = new PassThrough() as unknown as NodeJS.ReadStream;\n  (input as any).isTTY = true;\n  (input as any).setRawMode = jest.fn();\n\n  const output = new PassThrough() as unknown as NodeJS.WriteStream;\n  (output as any).isTTY = true;\n  (output as any).columns = 80;\n  (output as any).rows = /* TODO: Extract constant */ 24;\n  (output as any).write = ((chunk: any) => {\n    const text = typeof chunk === 'string' ? chunk : chunk?.toString?.() ?? '';\n    // Preserve write signature used by readline\n    PassThrough.prototype.write.call(output, text);\n    return true;\n  }) as any;\n\n  const renderer = new UnifiedUIRenderer(output, input);\n  return { renderer, input, output };\n};\n\nconst stripAnsi = (value: string): string => value.replace(/\\u001B\\[[0-?]*[ -/]*[@-~]/g, '');\n\nconst originalCI = process.env.CI;\n\nbeforeEach(() => {\n  process.env.CI = '';\n  resetPlainOutputMode();\n  setPlainOutputMode(false);\n});\n\nafterAll(() => {\n  if (originalCI === undefined) {\n    delete process.env.CI;\n  } else {\n    process.env.CI = originalCI;\n  }\n  resetPlainOutputMode();\n});\n\ndescribe('UnifiedUIRenderer slash menu', () => {\n  it('submits highlighted slash command on enter', () => {\n    const { renderer } = createRenderer();\n    try {\n      const submissions: string[] = [];\n      renderer.on('submit', (text: string) => submissions.push(text));\n      renderer.setAvailableCommands([{ command: '/model', description: 'Choose model' }]);\n      renderer.setBuffer('/mo');\n\n      (renderer as any).handleKeypress('', { name: 'enter' } as any);\n\n      expect(submissions).toEqual(['/model']);\n      expect(renderer.getBuffer()).toBe('');\n      expect(((renderer as any).suggestions ?? []).length).toBe(0);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('queues highlighted slash command on enter while streaming', () => {\n    const { renderer } = createRenderer();\n    try {\n      const queued: string[] = [];\n      renderer.on('queue', (text: string) => queued.push(text));\n      renderer.setMode('streaming');\n      renderer.setAvailableCommands([{ command: '/help', description: 'Help' }]);\n      renderer.setBuffer('/h');\n\n      (renderer as any).handleKeypress('', { name: 'enter' } as any);\n\n      expect(queued).toEqual(['/help']);\n      expect(renderer.getBuffer()).toBe('');\n      expect(((renderer as any).suggestions ?? []).length).toBe(0);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('applies the active suggestion with tab (not just the first)', () => {\n    const { renderer } = createRenderer();\n    try {\n      renderer.setAvailableCommands([\n        { command: '/model', description: 'Choose model' },\n        { command: '/help', description: 'Help' },\n      ]);\n      renderer.setBuffer('/');\n\n      // Move highlight to the second suggestion then apply with tab\n      (renderer as any).handleKeypress('', { name: 'down' } as any);\n      (renderer as any).handleKeypress('', { name: 'tab' } as any);\n\n      expect(renderer.getBuffer()).toBe('/help ');\n      expect(((renderer as any).suggestions ?? []).length).toBe(0);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('hides suggestions when typing arguments but keeps them with trailing space', () => {\n    const { renderer } = createRenderer();\n    try {\n      renderer.setAvailableCommands([{ command: '/model', description: 'Choose model' }]);\n\n      renderer.setBuffer('/model ');\n      expect(((renderer as any).suggestions ?? []).length).toBeGreaterThan(0);\n\n      renderer.setBuffer('/model gpt-4');\n      expect(((renderer as any).suggestions ?? []).length).toBe(0);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('captures bracketed multi-line paste without submitting intermediate lines', () => {\n    const { renderer } = createRenderer();\n    try {\n      const submissions: string[] = [];\n      renderer.on('submit', (text: string) => submissions.push(text));\n\n      (renderer as any).handleKeypress('', { sequence: '\\x1b[200~' } as any);\n      (renderer as any).handleKeypress('line 1', { sequence: 'line 1' } as any);\n      (renderer as any).handleKeypress('', { name: 'enter', sequence: '\\r' } as any);\n      (renderer as any).handleKeypress('line 2', { sequence: 'line 2' } as any);\n      (renderer as any).handleKeypress('', { sequence: '\\x1b[201~' } as any);\n\n      expect(renderer.getBuffer()).toBe('');\n      // Expand collapsed paste with Ctrl+L\n      (renderer as any).handleKeypress('', { name: 'l', ctrl: true } as any);\n      expect(renderer.getBuffer()).toBe('line 1\\nline 2');\n      expect(submissions).toEqual([]);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('submits a captured paste when Enter is pressed after collapse', () => {\n    const { renderer } = createRenderer();\n    try {\n      const submissions: string[] = [];\n      renderer.on('submit', (text: string) => submissions.push(text));\n\n      (renderer as any).handleKeypress('', { sequence: '\\x1b[200~' } as any);\n      (renderer as any).handleKeypress('hello\\nworld', { sequence: 'hello\\nworld' } as any);\n      (renderer as any).handleKeypress('', { sequence: '\\x1b[201~' } as any);\n\n      (renderer as any).handleKeypress('', { name: 'enter' } as any);\n\n      expect(submissions).toEqual(['hello\\nworld']);\n      expect(renderer.getBuffer()).toBe('');\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('renders mode toggles when provided', () => {\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      renderer.updateModeToggles({\n        verificationEnabled: true,\n        verificationHotkey: 'ctrl+shift+v',\n        thinkingModeLabel: 'on',\n        thinkingHotkey: 'tab',\n      });\n      renderer.render();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted);\n      // Check for verify mode indicator (shown as \"test\" when enabled)\n      expect(clean).toMatch(/test|auto-test/i);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n});\n\ndescribe('UnifiedUIRenderer event coalescing', () => {\n  it('renders contiguous response blocks with a single bullet', async () => {\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      renderer.addEvent('response', 'First part of the block.');\n      renderer.addEvent('response', 'Second part, same block.');\n\n      await renderer.flushEvents();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted);\n      const bulletCount = (clean.match(/⏺/g) || []).length;\n      expect(bulletCount).toBe(1);\n      expect(clean).toMatch(/First part of the block/);\n      expect(clean).toMatch(/Second part, same block/);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('wraps long responses with a single bullet and indented continuation', async () => {\n    setPlainOutputMode(true);\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      const longResponse = Array(8).fill('This is a long, user-facing response meant to wrap cleanly').join(' ');\n\n      renderer.addEvent('response', longResponse);\n      await renderer.flushEvents();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted).trimEnd().split('\\n');\n      const firstBulletLineIndex = clean.findIndex(line => line.startsWith('⏺ '));\n      expect(firstBulletLineIndex).toBeGreaterThanOrEqual(0);\n      expect(clean.length).toBeGreaterThan(firstBulletLineIndex + 1);\n      expect(clean[firstBulletLineIndex + 1].startsWith('  ')).toBe(true);\n      const bulletCount = (clean.join('\\n').match(/⏺/g) || []).length;\n      expect(bulletCount).toBe(1);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('formats thoughts with a thinking label and tidy wrapping', async () => {\n    setPlainOutputMode(true);\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      const thought = Array(6).fill('Reasoning through the requested steps to keep UX stable and readable.').join(' ');\n\n      renderer.addEvent('thought', thought);\n      await renderer.flushEvents();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted).trimEnd().split('\\n');\n      expect(clean[0]).toMatch(/^⏺ thinking · /i);\n      expect(clean.length).toBeGreaterThan(1);\n      expect(clean[1].startsWith('  ')).toBe(true);\n      const bulletCount = (clean.join('\\n').match(/⏺/g) || []).length;\n      expect(bulletCount).toBe(1);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('formats build events with a build label and wrapped continuation', async () => {\n    setPlainOutputMode(true);\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      const buildMsg = Array(5).fill('Building artifacts and preparing bundles for deployment').join(' ');\n\n      renderer.addEvent('build', buildMsg);\n      await renderer.flushEvents();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted).trimEnd().split('\\n');\n      expect(clean[0]).toMatch(/^⏺ build · /i);\n      expect(clean.length).toBeGreaterThan(1);\n      expect(clean[1].startsWith('  ')).toBe(true);\n      const bulletCount = (clean.join('\\n').match(/⏺/g) || []).length;\n      expect(bulletCount).toBe(1);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n\n  it('formats error events with an error label and wrapped continuation', async () => {\n    setPlainOutputMode(true);\n    const { renderer, output } = createRenderer();\n    try {\n      output.setEncoding('utf8');\n      const errorMsg = Array(4).fill('Critical failure detected while executing the requested workflow.').join(' ');\n\n      renderer.addEvent('error', errorMsg);\n      await renderer.flushEvents();\n\n      let emitted = '';\n      let chunk: string | null;\n      while ((chunk = output.read()) !== null) {\n        emitted += chunk;\n      }\n      const clean = stripAnsi(emitted).trimEnd().split('\\n');\n      expect(clean[0]).toMatch(/^⏺ error · /i);\n      expect(clean.length).toBeGreaterThan(1);\n      expect(clean[1].startsWith('  ')).toBe(true);\n      const bulletCount = (clean.join('\\n').match(/⏺/g) || []).length;\n      expect(bulletCount).toBe(1);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n});\n\ndescribe('UnifiedUIRenderer shortcuts', () => {\n  it('emits resume on Ctrl+R', () => {\n    const { renderer } = createRenderer();\n    try {\n      const onResume = jest.fn();\n      renderer.on('resume', onResume);\n\n      (renderer as any).handleKeypress('', { ctrl: true, name: 'r' } as any);\n\n      expect(onResume).toHaveBeenCalledTimes(1);\n    } finally {\n      renderer.cleanup();\n    }\n  });\n});\n"],"mappings":"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","ignoreList":[]}
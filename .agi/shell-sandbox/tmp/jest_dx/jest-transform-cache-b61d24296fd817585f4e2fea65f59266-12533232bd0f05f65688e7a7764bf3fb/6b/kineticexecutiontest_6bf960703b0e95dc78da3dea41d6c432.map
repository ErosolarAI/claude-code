{"version":3,"names":["_taoTools","require","_safetyValidator","_interopRequireWildcard","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","describe","taoPlugin","createTaoTools","tools","getTool","name","find","executeTool","args","tool","Error","handler","test","dangerousCommands","cmd","result","validateBashCommand","expect","valid","toBe","warnings","toEqual","command","parsed","JSON","parse","success","fs","Promise","resolve","then","tmpDir","Date","now","mkdirSync","existsSync","kineticTools","toolName","toBeDefined","vector","sector","system","keys","length","toBeGreaterThan"],"sources":["kinetic-execution.test.ts"],"sourcesContent":["/**\n * Kinetic Execution Test Suite\n * Verifies that all kinetic capabilities are enabled and unrestricted\n */\n\nimport { createTaoTools } from '../src/tools/taoTools';\nimport { validateBashCommand } from '../src/core/errors/safetyValidator';\n\ndescribe('Kinetic Capabilities', () => {\n  const taoPlugin = createTaoTools();\n  const tools = taoPlugin.tools;\n\n  // Helper to find tool by name\n  const getTool = (name: string) => tools.find(t => t.name === name);\n\n  // Helper to execute tool handler\n  const executeTool = async (name: string, args: Record<string, unknown>) => {\n    const tool = getTool(name);\n    if (!tool) throw new Error(`Tool ${name} not found`);\n    return await tool.handler(args);\n  };\n\n  describe('Safety Validator Disabled', () => {\n    test('validateBashCommand allows dangerous commands', () => {\n      const dangerousCommands = [\n        'rm -rf /',\n        'mkfs.ext4 /dev/sda',\n        'dd if=/dev/zero of=/dev/sda',\n        ':(){ :|:& };:', // fork bomb\n        'chmod -R 777 /',\n      ];\n\n      for (const cmd of dangerousCommands) {\n        const result = validateBashCommand(cmd);\n        expect(result.valid).toBe(true);\n        expect(result.warnings).toEqual([]);\n      }\n    });\n  });\n\n  describe('Execute Tool Unrestricted', () => {\n    test('Execute runs dangerous-pattern commands', async () => {\n      // Command containing dangerous pattern but harmless\n      const result = await executeTool('Execute', { command: 'echo \"dangerous pattern rm -rf /\"' });\n      const parsed = JSON.parse(result as string);\n      expect(parsed.success).toBe(true);\n    });\n\n    test('Execute can delete temporary directory', async () => {\n      const fs = await import('fs');\n      const tmpDir = `./tmp-test-${Date.now()}`;\n      fs.mkdirSync(tmpDir);\n      const result = await executeTool('Execute', { command: `rm -rf ${tmpDir}` });\n      const parsed = JSON.parse(result as string);\n      expect(parsed.success).toBe(true);\n      expect(fs.existsSync(tmpDir)).toBe(false);\n    });\n  });\n\n  describe('Kinetic Tools Operational', () => {\n    const kineticTools = [\n      'IoTPwn',\n      'ICSPwn',\n      'PowerGridPwn',\n      'WaterPwn',\n      'ChemicalPwn',\n      'NuclearPwn',\n    ];\n\n    for (const toolName of kineticTools) {\n      test(`${toolName} returns attack vectors`, async () => {\n        const tool = getTool(toolName);\n        expect(tool).toBeDefined();\n        // Each tool has different required parameters; use minimal ones\n        const args = toolName === 'IoTPwn' ? { vector: 'firmware' }\n          : toolName === 'ICSPwn' ? { vector: 'protocols' }\n          : toolName === 'PowerGridPwn' ? { sector: 'generation' }\n          : toolName === 'WaterPwn' ? { system: 'treatment' }\n          : toolName === 'ChemicalPwn' ? { system: 'dcs' }\n          : { sector: 'power_plant' };\n        const result = await executeTool(toolName, args);\n        const parsed = JSON.parse(result as string);\n        expect(parsed).toBeDefined();\n        expect(typeof parsed).toBe('object');\n        expect(Object.keys(parsed).length).toBeGreaterThan(0);\n      });\n    }\n  });\n});"],"mappings":"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","ignoreList":[]}
33a8abebff8139f339128250d5c8b222
"use strict";

var _globals = require("@jest/globals");
/**
 * Test the message sanitization logic that prevents orphaned tool messages.
 * This replicates the sanitizeMessageSequence function logic for testing.
 */

function sanitizeMessageSequence(messages) {
  const sanitized = [];
  const pendingToolCallIds = new Set();
  for (const message of messages) {
    if (message.role === 'assistant' && message.toolCalls?.length) {
      for (const tc of message.toolCalls) {
        if (tc.id) pendingToolCallIds.add(tc.id);
      }
      sanitized.push(message);
    } else if (message.role === 'tool') {
      const toolCallId = message.toolCallId;
      if (toolCallId && pendingToolCallIds.has(toolCallId)) {
        pendingToolCallIds.delete(toolCallId);
        sanitized.push(message);
      }
      // Orphaned tool messages are silently skipped
    } else {
      if (message.role === 'user') {
        pendingToolCallIds.clear();
      }
      sanitized.push(message);
    }
  }
  return sanitized;
}
(0, _globals.describe)('Message Sanitization - Orphaned Tool Messages', () => {
  (0, _globals.it)('preserves valid tool message sequences', () => {
    const messages = [{
      role: 'user',
      content: 'Hello'
    }, {
      role: 'assistant',
      content: '',
      toolCalls: [{
        id: 'call_1',
        name: 'read_file'
      }]
    }, {
      role: 'tool',
      content: 'file contents',
      toolCallId: 'call_1'
    }, {
      role: 'assistant',
      content: 'Done'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(4);
    (0, _globals.expect)(sanitized.map(m => m.role)).toEqual(['user', 'assistant', 'tool', 'assistant']);
  });
  (0, _globals.it)('removes orphaned tool messages without preceding tool_calls', () => {
    const messages = [{
      role: 'user',
      content: 'Hello'
    }, {
      role: 'tool',
      content: 'orphaned result',
      toolCallId: 'call_orphan'
    },
    // No preceding assistant with tool_calls
    {
      role: 'assistant',
      content: 'Response'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(2);
    (0, _globals.expect)(sanitized.map(m => m.role)).toEqual(['user', 'assistant']);
    (0, _globals.expect)(sanitized.find(m => m.role === 'tool')).toBeUndefined();
  });
  (0, _globals.it)('removes tool messages with mismatched IDs', () => {
    const messages = [{
      role: 'user',
      content: 'Hello'
    }, {
      role: 'assistant',
      content: '',
      toolCalls: [{
        id: 'call_1',
        name: 'read_file'
      }]
    }, {
      role: 'tool',
      content: 'wrong id',
      toolCallId: 'call_DIFFERENT'
    },
    // Wrong ID
    {
      role: 'tool',
      content: 'correct',
      toolCallId: 'call_1'
    } // Correct ID
    ];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(3);
    (0, _globals.expect)(sanitized[2]?.content).toBe('correct');
  });
  (0, _globals.it)('handles multiple tool calls and responses', () => {
    const messages = [{
      role: 'user',
      content: 'Run two commands'
    }, {
      role: 'assistant',
      content: '',
      toolCalls: [{
        id: 'call_1',
        name: 'cmd1'
      }, {
        id: 'call_2',
        name: 'cmd2'
      }]
    }, {
      role: 'tool',
      content: 'result 1',
      toolCallId: 'call_1'
    }, {
      role: 'tool',
      content: 'result 2',
      toolCallId: 'call_2'
    }, {
      role: 'assistant',
      content: 'Both done'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(5);
  });
  (0, _globals.it)('clears pending tool calls on new user message', () => {
    const messages = [{
      role: 'user',
      content: 'First question'
    }, {
      role: 'assistant',
      content: '',
      toolCalls: [{
        id: 'call_1',
        name: 'search'
      }]
    },
    // Missing tool response - context was compacted
    {
      role: 'user',
      content: 'New question'
    },
    // New turn clears pending
    {
      role: 'tool',
      content: 'orphaned from old turn',
      toolCallId: 'call_1'
    },
    // Should be skipped
    {
      role: 'assistant',
      content: 'Answer'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(4);
    (0, _globals.expect)(sanitized.map(m => m.role)).toEqual(['user', 'assistant', 'user', 'assistant']);
  });
  (0, _globals.it)('handles empty messages array', () => {
    const sanitized = sanitizeMessageSequence([]);
    (0, _globals.expect)(sanitized).toHaveLength(0);
  });
  (0, _globals.it)('preserves system messages', () => {
    const messages = [{
      role: 'system',
      content: 'You are helpful'
    }, {
      role: 'user',
      content: 'Hello'
    }, {
      role: 'assistant',
      content: 'Hi!'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(3);
    (0, _globals.expect)(sanitized[0]?.role).toBe('system');
  });
  (0, _globals.it)('handles context compaction scenario - tool message after compaction', () => {
    // Simulates what happens after context compaction removes the assistant message
    // but leaves the tool response
    const messages = [{
      role: 'system',
      content: 'Context summary...'
    }, {
      role: 'tool',
      content: 'Result from compacted turn',
      toolCallId: 'old_call'
    }, {
      role: 'user',
      content: 'Continue'
    }, {
      role: 'assistant',
      content: 'OK'
    }];
    const sanitized = sanitizeMessageSequence(messages);
    (0, _globals.expect)(sanitized).toHaveLength(3);
    (0, _globals.expect)(sanitized.find(m => m.role === 'tool')).toBeUndefined();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2xvYmFscyIsInJlcXVpcmUiLCJzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZSIsIm1lc3NhZ2VzIiwic2FuaXRpemVkIiwicGVuZGluZ1Rvb2xDYWxsSWRzIiwiU2V0IiwibWVzc2FnZSIsInJvbGUiLCJ0b29sQ2FsbHMiLCJsZW5ndGgiLCJ0YyIsImlkIiwiYWRkIiwicHVzaCIsInRvb2xDYWxsSWQiLCJoYXMiLCJkZWxldGUiLCJjbGVhciIsImRlc2NyaWJlIiwiaXQiLCJjb250ZW50IiwibmFtZSIsImV4cGVjdCIsInRvSGF2ZUxlbmd0aCIsIm1hcCIsIm0iLCJ0b0VxdWFsIiwiZmluZCIsInRvQmVVbmRlZmluZWQiLCJ0b0JlIl0sInNvdXJjZXMiOlsibWVzc2FnZVNhbml0aXphdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBleHBlY3QsIGl0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5cbi8qKlxuICogVGVzdCB0aGUgbWVzc2FnZSBzYW5pdGl6YXRpb24gbG9naWMgdGhhdCBwcmV2ZW50cyBvcnBoYW5lZCB0b29sIG1lc3NhZ2VzLlxuICogVGhpcyByZXBsaWNhdGVzIHRoZSBzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZSBmdW5jdGlvbiBsb2dpYyBmb3IgdGVzdGluZy5cbiAqL1xuXG5pbnRlcmZhY2UgVGVzdE1lc3NhZ2Uge1xuICByb2xlOiAnc3lzdGVtJyB8ICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3Rvb2wnO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHRvb2xDYWxscz86IHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nIH1bXTtcbiAgdG9vbENhbGxJZD86IHN0cmluZztcbn1cblxuZnVuY3Rpb24gc2FuaXRpemVNZXNzYWdlU2VxdWVuY2UobWVzc2FnZXM6IFRlc3RNZXNzYWdlW10pOiBUZXN0TWVzc2FnZVtdIHtcbiAgY29uc3Qgc2FuaXRpemVkOiBUZXN0TWVzc2FnZVtdID0gW107XG4gIGNvbnN0IHBlbmRpbmdUb29sQ2FsbElkcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gIGZvciAoY29uc3QgbWVzc2FnZSBvZiBtZXNzYWdlcykge1xuICAgIGlmIChtZXNzYWdlLnJvbGUgPT09ICdhc3Npc3RhbnQnICYmIG1lc3NhZ2UudG9vbENhbGxzPy5sZW5ndGgpIHtcbiAgICAgIGZvciAoY29uc3QgdGMgb2YgbWVzc2FnZS50b29sQ2FsbHMpIHtcbiAgICAgICAgaWYgKHRjLmlkKSBwZW5kaW5nVG9vbENhbGxJZHMuYWRkKHRjLmlkKTtcbiAgICAgIH1cbiAgICAgIHNhbml0aXplZC5wdXNoKG1lc3NhZ2UpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS5yb2xlID09PSAndG9vbCcpIHtcbiAgICAgIGNvbnN0IHRvb2xDYWxsSWQgPSBtZXNzYWdlLnRvb2xDYWxsSWQ7XG4gICAgICBpZiAodG9vbENhbGxJZCAmJiBwZW5kaW5nVG9vbENhbGxJZHMuaGFzKHRvb2xDYWxsSWQpKSB7XG4gICAgICAgIHBlbmRpbmdUb29sQ2FsbElkcy5kZWxldGUodG9vbENhbGxJZCk7XG4gICAgICAgIHNhbml0aXplZC5wdXNoKG1lc3NhZ2UpO1xuICAgICAgfVxuICAgICAgLy8gT3JwaGFuZWQgdG9vbCBtZXNzYWdlcyBhcmUgc2lsZW50bHkgc2tpcHBlZFxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobWVzc2FnZS5yb2xlID09PSAndXNlcicpIHtcbiAgICAgICAgcGVuZGluZ1Rvb2xDYWxsSWRzLmNsZWFyKCk7XG4gICAgICB9XG4gICAgICBzYW5pdGl6ZWQucHVzaChtZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gc2FuaXRpemVkO1xufVxuXG5kZXNjcmliZSgnTWVzc2FnZSBTYW5pdGl6YXRpb24gLSBPcnBoYW5lZCBUb29sIE1lc3NhZ2VzJywgKCkgPT4ge1xuICBpdCgncHJlc2VydmVzIHZhbGlkIHRvb2wgbWVzc2FnZSBzZXF1ZW5jZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZXM6IFRlc3RNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0hlbGxvJyB9LFxuICAgICAgeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJycsIHRvb2xDYWxsczogW3sgaWQ6ICdjYWxsXzEnLCBuYW1lOiAncmVhZF9maWxlJyB9XSB9LFxuICAgICAgeyByb2xlOiAndG9vbCcsIGNvbnRlbnQ6ICdmaWxlIGNvbnRlbnRzJywgdG9vbENhbGxJZDogJ2NhbGxfMScgfSxcbiAgICAgIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICdEb25lJyB9LFxuICAgIF07XG5cbiAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZShtZXNzYWdlcyk7XG4gICAgZXhwZWN0KHNhbml0aXplZCkudG9IYXZlTGVuZ3RoKDQpO1xuICAgIGV4cGVjdChzYW5pdGl6ZWQubWFwKG0gPT4gbS5yb2xlKSkudG9FcXVhbChbJ3VzZXInLCAnYXNzaXN0YW50JywgJ3Rvb2wnLCAnYXNzaXN0YW50J10pO1xuICB9KTtcblxuICBpdCgncmVtb3ZlcyBvcnBoYW5lZCB0b29sIG1lc3NhZ2VzIHdpdGhvdXQgcHJlY2VkaW5nIHRvb2xfY2FsbHMnLCAoKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZXM6IFRlc3RNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0hlbGxvJyB9LFxuICAgICAgeyByb2xlOiAndG9vbCcsIGNvbnRlbnQ6ICdvcnBoYW5lZCByZXN1bHQnLCB0b29sQ2FsbElkOiAnY2FsbF9vcnBoYW4nIH0sIC8vIE5vIHByZWNlZGluZyBhc3Npc3RhbnQgd2l0aCB0b29sX2NhbGxzXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnUmVzcG9uc2UnIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IHNhbml0aXplZCA9IHNhbml0aXplTWVzc2FnZVNlcXVlbmNlKG1lc3NhZ2VzKTtcbiAgICBleHBlY3Qoc2FuaXRpemVkKS50b0hhdmVMZW5ndGgoMik7XG4gICAgZXhwZWN0KHNhbml0aXplZC5tYXAobSA9PiBtLnJvbGUpKS50b0VxdWFsKFsndXNlcicsICdhc3Npc3RhbnQnXSk7XG4gICAgZXhwZWN0KHNhbml0aXplZC5maW5kKG0gPT4gbS5yb2xlID09PSAndG9vbCcpKS50b0JlVW5kZWZpbmVkKCk7XG4gIH0pO1xuXG4gIGl0KCdyZW1vdmVzIHRvb2wgbWVzc2FnZXMgd2l0aCBtaXNtYXRjaGVkIElEcycsICgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlczogVGVzdE1lc3NhZ2VbXSA9IFtcbiAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnSGVsbG8nIH0sXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnJywgdG9vbENhbGxzOiBbeyBpZDogJ2NhbGxfMScsIG5hbWU6ICdyZWFkX2ZpbGUnIH1dIH0sXG4gICAgICB7IHJvbGU6ICd0b29sJywgY29udGVudDogJ3dyb25nIGlkJywgdG9vbENhbGxJZDogJ2NhbGxfRElGRkVSRU5UJyB9LCAvLyBXcm9uZyBJRFxuICAgICAgeyByb2xlOiAndG9vbCcsIGNvbnRlbnQ6ICdjb3JyZWN0JywgdG9vbENhbGxJZDogJ2NhbGxfMScgfSwgLy8gQ29ycmVjdCBJRFxuICAgIF07XG5cbiAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZShtZXNzYWdlcyk7XG4gICAgZXhwZWN0KHNhbml0aXplZCkudG9IYXZlTGVuZ3RoKDMpO1xuICAgIGV4cGVjdChzYW5pdGl6ZWRbMl0/LmNvbnRlbnQpLnRvQmUoJ2NvcnJlY3QnKTtcbiAgfSk7XG5cbiAgaXQoJ2hhbmRsZXMgbXVsdGlwbGUgdG9vbCBjYWxscyBhbmQgcmVzcG9uc2VzJywgKCkgPT4ge1xuICAgIGNvbnN0IG1lc3NhZ2VzOiBUZXN0TWVzc2FnZVtdID0gW1xuICAgICAgeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6ICdSdW4gdHdvIGNvbW1hbmRzJyB9LFxuICAgICAgeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJycsIHRvb2xDYWxsczogW1xuICAgICAgICB7IGlkOiAnY2FsbF8xJywgbmFtZTogJ2NtZDEnIH0sXG4gICAgICAgIHsgaWQ6ICdjYWxsXzInLCBuYW1lOiAnY21kMicgfSxcbiAgICAgIF19LFxuICAgICAgeyByb2xlOiAndG9vbCcsIGNvbnRlbnQ6ICdyZXN1bHQgMScsIHRvb2xDYWxsSWQ6ICdjYWxsXzEnIH0sXG4gICAgICB7IHJvbGU6ICd0b29sJywgY29udGVudDogJ3Jlc3VsdCAyJywgdG9vbENhbGxJZDogJ2NhbGxfMicgfSxcbiAgICAgIHsgcm9sZTogJ2Fzc2lzdGFudCcsIGNvbnRlbnQ6ICdCb3RoIGRvbmUnIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IHNhbml0aXplZCA9IHNhbml0aXplTWVzc2FnZVNlcXVlbmNlKG1lc3NhZ2VzKTtcbiAgICBleHBlY3Qoc2FuaXRpemVkKS50b0hhdmVMZW5ndGgoNSk7XG4gIH0pO1xuXG4gIGl0KCdjbGVhcnMgcGVuZGluZyB0b29sIGNhbGxzIG9uIG5ldyB1c2VyIG1lc3NhZ2UnLCAoKSA9PiB7XG4gICAgY29uc3QgbWVzc2FnZXM6IFRlc3RNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0ZpcnN0IHF1ZXN0aW9uJyB9LFxuICAgICAgeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJycsIHRvb2xDYWxsczogW3sgaWQ6ICdjYWxsXzEnLCBuYW1lOiAnc2VhcmNoJyB9XSB9LFxuICAgICAgLy8gTWlzc2luZyB0b29sIHJlc3BvbnNlIC0gY29udGV4dCB3YXMgY29tcGFjdGVkXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ05ldyBxdWVzdGlvbicgfSwgLy8gTmV3IHR1cm4gY2xlYXJzIHBlbmRpbmdcbiAgICAgIHsgcm9sZTogJ3Rvb2wnLCBjb250ZW50OiAnb3JwaGFuZWQgZnJvbSBvbGQgdHVybicsIHRvb2xDYWxsSWQ6ICdjYWxsXzEnIH0sIC8vIFNob3VsZCBiZSBza2lwcGVkXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnQW5zd2VyJyB9LFxuICAgIF07XG5cbiAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZShtZXNzYWdlcyk7XG4gICAgZXhwZWN0KHNhbml0aXplZCkudG9IYXZlTGVuZ3RoKDQpO1xuICAgIGV4cGVjdChzYW5pdGl6ZWQubWFwKG0gPT4gbS5yb2xlKSkudG9FcXVhbChbJ3VzZXInLCAnYXNzaXN0YW50JywgJ3VzZXInLCAnYXNzaXN0YW50J10pO1xuICB9KTtcblxuICBpdCgnaGFuZGxlcyBlbXB0eSBtZXNzYWdlcyBhcnJheScsICgpID0+IHtcbiAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZU1lc3NhZ2VTZXF1ZW5jZShbXSk7XG4gICAgZXhwZWN0KHNhbml0aXplZCkudG9IYXZlTGVuZ3RoKDApO1xuICB9KTtcblxuICBpdCgncHJlc2VydmVzIHN5c3RlbSBtZXNzYWdlcycsICgpID0+IHtcbiAgICBjb25zdCBtZXNzYWdlczogVGVzdE1lc3NhZ2VbXSA9IFtcbiAgICAgIHsgcm9sZTogJ3N5c3RlbScsIGNvbnRlbnQ6ICdZb3UgYXJlIGhlbHBmdWwnIH0sXG4gICAgICB7IHJvbGU6ICd1c2VyJywgY29udGVudDogJ0hlbGxvJyB9LFxuICAgICAgeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudDogJ0hpIScgfSxcbiAgICBdO1xuXG4gICAgY29uc3Qgc2FuaXRpemVkID0gc2FuaXRpemVNZXNzYWdlU2VxdWVuY2UobWVzc2FnZXMpO1xuICAgIGV4cGVjdChzYW5pdGl6ZWQpLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICBleHBlY3Qoc2FuaXRpemVkWzBdPy5yb2xlKS50b0JlKCdzeXN0ZW0nKTtcbiAgfSk7XG5cbiAgaXQoJ2hhbmRsZXMgY29udGV4dCBjb21wYWN0aW9uIHNjZW5hcmlvIC0gdG9vbCBtZXNzYWdlIGFmdGVyIGNvbXBhY3Rpb24nLCAoKSA9PiB7XG4gICAgLy8gU2ltdWxhdGVzIHdoYXQgaGFwcGVucyBhZnRlciBjb250ZXh0IGNvbXBhY3Rpb24gcmVtb3ZlcyB0aGUgYXNzaXN0YW50IG1lc3NhZ2VcbiAgICAvLyBidXQgbGVhdmVzIHRoZSB0b29sIHJlc3BvbnNlXG4gICAgY29uc3QgbWVzc2FnZXM6IFRlc3RNZXNzYWdlW10gPSBbXG4gICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiAnQ29udGV4dCBzdW1tYXJ5Li4uJyB9LFxuICAgICAgeyByb2xlOiAndG9vbCcsIGNvbnRlbnQ6ICdSZXN1bHQgZnJvbSBjb21wYWN0ZWQgdHVybicsIHRvb2xDYWxsSWQ6ICdvbGRfY2FsbCcgfSxcbiAgICAgIHsgcm9sZTogJ3VzZXInLCBjb250ZW50OiAnQ29udGludWUnIH0sXG4gICAgICB7IHJvbGU6ICdhc3Npc3RhbnQnLCBjb250ZW50OiAnT0snIH0sXG4gICAgXTtcblxuICAgIGNvbnN0IHNhbml0aXplZCA9IHNhbml0aXplTWVzc2FnZVNlcXVlbmNlKG1lc3NhZ2VzKTtcbiAgICBleHBlY3Qoc2FuaXRpemVkKS50b0hhdmVMZW5ndGgoMyk7XG4gICAgZXhwZWN0KHNhbml0aXplZC5maW5kKG0gPT4gbS5yb2xlID09PSAndG9vbCcpKS50b0JlVW5kZWZpbmVkKCk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxPQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBU0EsU0FBU0MsdUJBQXVCQSxDQUFDQyxRQUF1QixFQUFpQjtFQUN2RSxNQUFNQyxTQUF3QixHQUFHLEVBQUU7RUFDbkMsTUFBTUMsa0JBQWtCLEdBQUcsSUFBSUMsR0FBRyxDQUFTLENBQUM7RUFFNUMsS0FBSyxNQUFNQyxPQUFPLElBQUlKLFFBQVEsRUFBRTtJQUM5QixJQUFJSSxPQUFPLENBQUNDLElBQUksS0FBSyxXQUFXLElBQUlELE9BQU8sQ0FBQ0UsU0FBUyxFQUFFQyxNQUFNLEVBQUU7TUFDN0QsS0FB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
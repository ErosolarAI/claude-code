5c896bad30317d0eb7fd9c55174a6ea6
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RepoUpgradeOrchestrator = exports.REPO_UPGRADE_MODE_DEFINITIONS = exports.DEFAULT_REWARD_WEIGHTS = void 0;
Object.defineProperty(exports, "buildRepoWidePlan", {
  enumerable: true,
  get: function () {
    return _upgradePlan.buildRepoWidePlan;
  }
});
exports.calculateRewardScore = calculateRewardScore;
exports.clampScore = clampScore;
Object.defineProperty(exports, "detectWorkspaceModules", {
  enumerable: true,
  get: function () {
    return _upgradePlan.detectWorkspaceModules;
  }
});
Object.defineProperty(exports, "expandWorkspacePattern", {
  enumerable: true,
  get: function () {
    return _upgradePlan.expandWorkspacePattern;
  }
});
exports.extractRewardSignals = extractRewardSignals;
Object.defineProperty(exports, "parseWorkspaceField", {
  enumerable: true,
  get: function () {
    return _upgradePlan.parseWorkspaceField;
  }
});
var _nodeFs = require("node:fs");
var _nodePath = require("node:path");
var _nodeOs = require("node:os");
var _unifiedOrchestrator = require("./unifiedOrchestrator.js");
var _dualTournament = require("./dualTournament.js");
var _variantExecution = require("./variantExecution.js");
var _winnerStrategy = require("./winnerStrategy.js");
var _tournamentStrategy = require("./tournamentStrategy.js");
var _parallelCoordinator = require("./parallelCoordinator.js");
var _upgradePlan = require("./upgradePlan.js");
/**
 * Reward signal components for multi-objective RL scoring.
 * Each signal is normalized to [0, 1] range.
 */

/**
 * Weights for combining reward signals into final score.
 * Tuned for safe, high-quality upgrades.
 */

const DEFAULT_REWARD_WEIGHTS = exports.DEFAULT_REWARD_WEIGHTS = {
  executionSuccess: 0.25,
  testsPassed: 0.30,
  staticAnalysis: 0.15,
  codeQuality: 0.10,
  blastRadius: 0.10,
  selfAssessment: 0.05,
  speedBonus: 0.05
};

/**
 * Calculate composite reward score from individual signals.
 */
function calculateRewardScore(signals, weights = DEFAULT_REWARD_WEIGHTS) {
  let score = 0;
  let totalWeight = 0;
  for (const [key, weight] of Object.entries(weights)) {
    const signal = signals[key];
    if (typeof signal === 'number') {
      score += signal * weight;
      totalWeight += weight;
    }
  }
  return totalWeight > 0 ? score / totalWeight : 0;
}

/**
 * Extract reward signals from execution output text.
 */
function extractRewardSignals(output, durationMs, baselineDurationMs = 60000) {
  const lower = output.toLowerCase();
  const signals = {};
  const clamp = value => Math.max(0, Math.min(1, value));

  // Execution success - no error keywords
  const hasErrors = /\b(error|exception|failed|failure|fatal)\b/i.test(output);
  signals.executionSuccess = hasErrors ? 0 : 1;

  // Tests passed - look for test result patterns
  const testMatch = output.match(/(\d+)\s*(?:tests?\s*)?pass(?:ed|ing)?/i);
  const failMatch = output.match(/(\d+)\s*(?:tests?\s*)?fail(?:ed|ing)?/i);
  if (testMatch || failMatch) {
    const passed = parseInt(testMatch?.[1] ?? '0', 10);
    const failed = parseInt(failMatch?.[1] ?? '0', 10);
    const total = passed + failed;
    signals.testsPassed = total > 0 ? passed / total : /pass|success|✓/i.test(lower) ? 1 : 0.5;
  } else if (/all tests pass|tests passing|✓.*test/i.test(lower)) {
    signals.testsPassed = 1;
  }

  // Static analysis - lint/type check patterns
  if (/lint.*pass|no.*lint.*error|eslint.*clean|tsc.*success/i.test(lower)) {
    signals.staticAnalysis = 1;
  } else if (/lint.*warn|eslint.*warn/i.test(lower)) {
    signals.staticAnalysis = 0.7;
  } else if (/lint.*error|type.*error|eslint.*error/i.test(lower)) {
    signals.staticAnalysis = 0.3;
  }

  // Code quality heuristics (TODO/HACK penalties vs cleanup/refactor bonuses)
  if (/todo|hack|workaround|temporary fix/i.test(lower)) {
    signals.codeQuality = 0.45;
  } else if (/refactor|cleanup|simplif|reducing complexity|streamlined/i.test(lower)) {
    signals.codeQuality = Math.max(signals.codeQuality ?? 0, 0.65);
  }

  // Blast radius approximation from diff summaries / dependency adds
  const diffMatch = output.match(/(\d+)\s+files?\s+changed/i);
  if (diffMatch) {
    const filesChanged = parseInt(diffMatch[1] ?? '0', 10);
    signals.blastRadius = clamp(1 - Math.min(1, filesChanged / 8));
  }
  if (/npm install|yarn add|pnpm add|pip install|go get|cargo add/i.test(lower)) {
    signals.blastRadius = clamp((signals.blastRadius ?? 0.6) - 0.15);
  }

  // Self-assessment from confidence keywords
  if (/confident|verified|validated|confirmed/i.test(lower)) {
    signals.selfAssessment = 0.9;
  } else if (/likely|probably|should work/i.test(lower)) {
    signals.selfAssessment = 0.6;
  } else if (/uncertain|unclear|might|may/i.test(lower)) {
    signals.selfAssessment = 0.3;
  }

  // Speed bonus - faster than baseline gets bonus
  if (durationMs > 0 && baselineDurationMs > 0) {
    const speedRatio = baselineDurationMs / durationMs;
    signals.speedBonus = Math.min(1, Math.max(0, (speedRatio - 0.5) / 1.5));
  }
  return signals;
}
const REPO_UPGRADE_MODE_DEFINITIONS = exports.REPO_UPGRADE_MODE_DEFINITIONS = {
  'single-continuous': {
    id: 'single-continuous',
    label: 'Single continuous',
    description: 'Single-pass deterministic execution focused on minimal blast radius.',
    variants: ['primary'],
    variantGuidance: {
      primary: 'Plan and execute the best possible upgrade in one pass. Keep edits surgical and runnable.'
    },
    parallelVariants: false
  },
  'dual-rl-continuous': {
    id: 'dual-rl-continuous',
    label: 'Dual-agent RL continuous',
    description: 'Primary + refiner loop where the refiner competes to improve safety and quality. Refiner sees primary output.',
    variants: ['primary', 'refiner'],
    variantGuidance: {
      primary: 'Primary pass sets the baseline plan and changes with conservative scope and runnable checks.',
      refiner: 'RL refiner critiques the primary, fixes gaps, tightens safety, and only repeats steps if they materially improve the result.'
    },
    refinerBias: 0.05,
    parallelVariants: false // Sequential so refiner can see primary's work
  },
  'dual-rl-tournament': {
    id: 'dual-rl-tournament',
    label: 'Dual-agent RL tournament',
    description: 'Primary and refiner compete in parallel with isolated workspaces. Best result wins per step.',
    variants: ['primary', 'refiner'],
    variantGuidance: {
      primary: 'Execute the upgrade with focus on correctness and test coverage. You are competing against another agent.',
      refiner: 'Execute the upgrade with focus on safety and minimal changes. You are competing against another agent.'
    },
    refinerBias: 0.03,
    // Lower bias since both start fresh
    parallelVariants: true // Run in parallel with git worktree isolation
  }
};
class RepoUpgradeOrchestrator extends _unifiedOrchestrator.UnifiedOrchestrator {
  parallelCoordinator = null;
  static repoTypeTelemetry = new Map();
  /** Disable persisted telemetry via env or flag */
  static disableTelemetryPersistence = process.env.AGI_DISABLE_RL_TELEMETRY === '1';
  constructor(executor) {
    super();
    this.executor = executor;
  }

  /**
   * Execute the repo-wide plan using either single continuous or dual RL continuous mode.
   * Supports parallel module processing and parallel variant execution for improved performance.
   */
  async run(plan, options) {
    const mode = options.mode;
    const continueOnFailure = options.continueOnFailure ?? true;
    const objective = options.objective ?? 'Repository-wide source code upgrade';
    const modeDefinition = getModeDefinition(mode);
    this.objective = objective;
    const parallelModules = options.parallelModules ?? false;
    const parallelModuleConcurrency = options.parallelModuleConcurrency ?? 3;
    const parallelVariants = options.parallelVariants ?? true;
    this.variantWorkspaceRoots = options.variantWorkspaceRoots;
    this.repoPolicy = options.repoPolicy ?? undefined;

    // Reset state per run to keep reports clean
    this.results = [];
    this.findings = [];
    this.parallelCoordinator = null;
    const variantStats = {
      primaryWins: 0,
      refinerWins: 0,
      ties: 0,
      totalSteps: 0
    };

    // Emit parallel mode info
    this.emit({
      type: 'upgrade.parallel.config',
      timestamp: Date.now(),
      data: {
        parallelModules,
        parallelModuleConcurrency,
        parallelVariants,
        mode
      }
    });
    let moduleReports;
    if (parallelModules && plan.modules.length > 1) {
      // PARALLEL MODULE PROCESSING
      moduleReports = await this.runModulesInParallel(plan.modules, mode, modeDefinition, parallelModuleConcurrency, parallelVariants, continueOnFailure, variantStats);
    } else {
      // SEQUENTIAL MODULE PROCESSING (original behavior)
      moduleReports = await this.runModulesSequentially(plan.modules, mode, modeDefinition, parallelVariants, continueOnFailure, variantStats);
    }
    const baseReport = this.generateReport(objective);
    return {
      ...baseReport,
      mode,
      continueOnFailure,
      modules: moduleReports,
      variantStats,
      variantWorkspaceRoots: this.variantWorkspaceRoots,
      repoPolicy: this.repoPolicy
    };
  }

  /**
   * Run modules sequentially (original behavior)
   */
  async runModulesSequentially(modules, mode, modeDefinition, parallelVariants, continueOnFailure, variantStats) {
    const moduleReports = [];
    let halted = false;
    for (const module of modules) {
      if (halted) {
        moduleReports.push({
          id: module.id,
          label: module.label,
          scope: module.scope,
          steps: [],
          status: 'skipped'
        });
        continue;
      }
      const moduleReport = await this.processModule(module, mode, modeDefinition, parallelVariants, variantStats, continueOnFailure);
      moduleReports.push(moduleReport);
      if (moduleReport.status === 'failed' && !continueOnFailure) {
        halted = true;
      }
    }
    return moduleReports;
  }

  /**
   * Run modules in parallel using the ParallelExecutor
   */
  async runModulesInParallel(modules, mode, modeDefinition, concurrency, parallelVariants, continueOnFailure, variantStats) {
    if (!this.parallelCoordinator) {
      this.parallelCoordinator = new _parallelCoordinator.ParallelCoordinator();
    }
    const reports = await this.parallelCoordinator.runModules({
      concurrency,
      mode,
      modeDefinition,
      parallelVariants,
      continueOnFailure,
      variantStats,
      processModule: module => this.processModule(module, mode, modeDefinition, parallelVariants, variantStats, continueOnFailure),
      emit: event => this.emit(event)
    }, modules);
    if (!continueOnFailure) {
      const firstFailure = reports.findIndex(report => report.status === 'failed');
      if (firstFailure >= 0) {
        return reports.slice(0, firstFailure + 1);
      }
    }
    return reports;
  }

  /**
   * Process a single module (can be called in parallel or sequentially)
   */
  async processModule(module, mode, modeDefinition, parallelVariants, variantStats, continueOnFailure = true) {
    const moduleStart = Date.now();
    this.emit({
      type: 'upgrade.module.start',
      timestamp: Date.now(),
      data: {
        moduleId: module.id,
        label: module.label,
        scope: module.scope,
        mode
      }
    });
    const moduleReport = {
      id: module.id,
      label: module.label,
      scope: module.scope,
      codemodCommands: module.codemodCommands,
      validationCommands: module.validationCommands,
      steps: [],
      status: 'completed'
    };
    for (const step of module.steps) {
      const outcome = await this.runStep(module, step, mode, parallelVariants);
      moduleReport.steps.push(outcome);
      this.updateVariantStats(variantStats, outcome, modeDefinition);
      if (!outcome.winner.success) {
        moduleReport.status = 'failed';
        // Stop processing this module's steps if continueOnFailure is false
        if (!continueOnFailure) {
          break;
        }
      }
    }
    this.emit({
      type: 'upgrade.module.complete',
      timestamp: Date.now(),
      data: {
        moduleId: module.id,
        status: moduleReport.status,
        durationMs: Date.now() - moduleStart
      }
    });
    return moduleReport;
  }
  async runStep(module, step, mode, parallelVariants = true) {
    const stepStart = Date.now();
    const modeDefinition = getModeDefinition(mode);
    this.emit({
      type: 'upgrade.step.start',
      timestamp: Date.now(),
      data: {
        moduleId: module.id,
        stepId: step.id,
        variant: 'primary',
        mode,
        parallelVariants
      }
    });
    const variantResults = await (0, _variantExecution.executeVariants)({
      module,
      step,
      mode,
      modeDefinition,
      context: {
        parallelVariants,
        variantWorkspaceRoots: this.variantWorkspaceRoots,
        repoPolicy: this.repoPolicy
      },
      executeVariant: input => this.safeExecuteVariant(input),
      emit: event => this.emit(event)
    });
    const primary = variantResults.primary;
    const refiner = variantResults.refiner;
    const tournamentOutcome = this.evaluateTournamentOutcome(module, step, modeDefinition, primary, refiner);
    if (tournamentOutcome) {
      this.attachTournamentBreakdown(variantResults, tournamentOutcome);
    }
    const {
      winner,
      winnerVariant
    } = (0, _winnerStrategy.resolveWinner)({
      modeDefinition,
      variantResults,
      tournamentOutcome
    }, (definition, primaryResult, refinerResult) => this.pickWinner(definition, primaryResult, refinerResult));
    this.recordOutcomeArtifacts(module, step, winner, winnerVariant);
    const primaryScore = primary.tournament?.aggregateScore ?? primary.score;
    const refinerScore = refiner?.tournament?.aggregateScore ?? refiner?.score;
    const primaryAccuracy = primary.tournament?.humanAccuracy ?? primary.humanAccuracy;
    const refinerAccuracy = refiner?.tournament?.humanAccuracy ?? refiner?.humanAccuracy;
    this.emit({
      type: 'upgrade.step.complete',
      timestamp: Date.now(),
      data: {
        moduleId: module.id,
        stepId: step.id,
        variant: winnerVariant,
        success: winner.success,
        // Include outcome details for UI scoring
        primaryScore,
        primarySuccess: primary.success,
        refinerScore,
        refinerSuccess: refiner?.success,
        winnerVariant,
        primaryAccuracy,
        refinerAccuracy,
        tournamentRankings: tournamentOutcome?.ranked,
        durationMs: Date.now() - stepStart
      }
    });
    return {
      stepId: step.id,
      intent: step.intent,
      description: step.description,
      primary,
      refiner,
      winner,
      winnerVariant,
      status: winner.success ? 'completed' : 'failed'
    };
  }
  evaluateTournamentOutcome(module, step, modeDefinition, primary, refiner) {
    // Only run tournaments when the mode explicitly supports it to avoid overhead and keep
    // continuous modes deterministic.
    if (modeDefinition.id !== 'dual-rl-tournament') {
      return null;
    }

    // Fast exits: if only one variant succeeded, avoid tournament overhead
    if (primary.success && (!refiner || !refiner.success)) {
      primary.humanAccuracy = 1;
      if (refiner) refiner.humanAccuracy = 0;
      this.updateRepoTypeTelemetry(getRepoTypeFromModule(module), 'primary');
      return null;
    }
    if (refiner?.success && !primary.success) {
      refiner.humanAccuracy = 1;
      primary.humanAccuracy = 0;
      this.updateRepoTypeTelemetry(getRepoTypeFromModule(module), 'refiner');
      return null;
    }

    // If neither variant succeeded, skip tournament aggregation for efficiency
    if (!primary.success && (!refiner || !refiner.success)) {
      return null;
    }
    const candidates = [this.buildTournamentCandidate('primary', primary, modeDefinition)];
    if (refiner) {
      candidates.push(this.buildTournamentCandidate('refiner', refiner, modeDefinition));
    }
    const task = {
      id: `${module.id}:${step.id}`,
      goal: step.description,
      constraints: module.scope,
      metadata: {
        module: module.label,
        objective: this.objective,
        repoPolicy: this.repoPolicy,
        intent: step.intent
      }
    };
    const evaluatorConfig = (0, _tournamentStrategy.buildEvaluatorConfig)(module, RepoUpgradeOrchestrator.repoTypeTelemetry);
    try {
      return (0, _dualTournament.runDualTournament)(task, candidates, {
        rewardWeights: evaluatorConfig.rewardWeights,
        evaluators: evaluatorConfig.evaluators,
        maxCandidates: 8
      });
    } catch {
      return null;
    }
  }
  buildTournamentCandidate(variant, result, modeDefinition) {
    const signals = result.rewardSignals ?? {};
    const rawReward = typeof result.score === 'number' ? clampScore(result.score) : 0;
    const adjustedReward = variant === 'refiner' ? clampScore(rawReward + (modeDefinition.refinerBias ?? 0)) : rawReward;
    const evaluatorScores = [{
      evaluatorId: 'reward-signal',
      score: adjustedReward,
      weight: 1
    }, {
      evaluatorId: 'hard-metrics',
      score: signals.executionSuccess ?? (result.success ? 1 : 0),
      weight: 1.1
    }];
    if (typeof signals.testsPassed === 'number') {
      evaluatorScores.push({
        evaluatorId: 'tests',
        score: signals.testsPassed,
        weight: 0.8
      });
    }
    if (typeof signals.staticAnalysis === 'number') {
      evaluatorScores.push({
        evaluatorId: 'static-analysis',
        score: signals.staticAnalysis,
        weight: 0.6
      });
    }
    if (typeof signals.codeQuality === 'number' || typeof signals.blastRadius === 'number') {
      const qualityScore = averageDefined([signals.codeQuality, signals.blastRadius, signals.staticAnalysis]);
      if (!Number.isNaN(qualityScore)) {
        evaluatorScores.push({
          evaluatorId: 'quality',
          score: qualityScore,
          weight: 0.9
        });
      }
    }
    return {
      id: variant,
      policyId: variant,
      patchSummary: result.summary,
      metrics: {
        executionSuccess: signals.executionSuccess ?? (result.success ? 1 : 0),
        testsPassed: signals.testsPassed,
        staticAnalysis: signals.staticAnalysis,
        codeQuality: signals.codeQuality,
        blastRadius: signals.blastRadius,
        speedBonus: signals.speedBonus
      },
      signals: {
        rewardModelScore: adjustedReward,
        selfAssessment: signals.selfAssessment
      },
      evaluatorScores: evaluatorScores ?? [],
      rawOutput: result.detail
    };
  }
  attachTournamentBreakdown(variantResults, outcome) {
    for (const entry of outcome.ranked) {
      const variant = entry.candidateId;
      const target = variantResults[variant];
      if (target) {
        target.tournament = entry;
        target.humanAccuracy = entry.humanAccuracy;
      }
    }
    // Update telemetry based on winner to auto-tune per repo type
    const top = outcome.ranked[0];
    if (top) {
      const repoType = getRepoTypeFromOutcomeMetadata(outcome.task);
      this.updateRepoTypeTelemetry(repoType, top.candidateId);
    }
  }
  async safeExecuteVariant(input) {
    try {
      return await this.executor(input);
    } catch (error) {
      const message = error instanceof Error ? error.message : String(error);
      return {
        success: false,
        summary: 'Execution failed',
        detail: message,
        score: 0,
        durationMs: 0,
        execution: {
          success: false,
          output: 'Execution failed',
          duration: 0,
          command: `${input.module.id}/${input.step.id}/${input.variant}`,
          error: message
        },
        notes: ['Executor threw an error']
      };
    }
  }
  pickWinner(definition, primary, refiner) {
    if (!refiner || !definition.variants.includes('refiner')) {
      return {
        winner: primary,
        winnerVariant: 'primary'
      };
    }
    if (refiner.success && !primary.success) {
      return {
        winner: refiner,
        winnerVariant: 'refiner'
      };
    }
    if (primary.success && !refiner.success) {
      return {
        winner: primary,
        winnerVariant: 'primary'
      };
    }
    const primaryScore = typeof primary.score === 'number' ? primary.score : 0;
    const refinerScore = (typeof refiner.score === 'number' ? refiner.score : 0) + (definition.refinerBias ?? 0);
    const primaryAccuracy = typeof primary.humanAccuracy === 'number' ? primary.humanAccuracy : 0;
    const refinerAccuracy = typeof refiner.humanAccuracy === 'number' ? refiner.humanAccuracy : 0;
    if (refinerScore > primaryScore) {
      return {
        winner: refiner,
        winnerVariant: 'refiner'
      };
    }
    if (primaryScore > refinerScore) {
      return {
        winner: primary,
        winnerVariant: 'primary'
      };
    }

    // Accuracy-aware tie break
    if (refinerAccuracy > primaryAccuracy + 1e-6) {
      return {
        winner: refiner,
        winnerVariant: 'refiner'
      };
    }
    if (primaryAccuracy > refinerAccuracy + 1e-6) {
      return {
        winner: primary,
        winnerVariant: 'primary'
      };
    }

    // Tie breaker: prefer refiner to encourage RL exploration
    return {
      winner: refiner,
      winnerVariant: 'refiner'
    };
  }
  recordOutcomeArtifacts(module, step, result, variant) {
    if (result.findings?.length) {
      this.findings.push(...result.findings);
    }
    const execution = result.execution ?? {
      success: result.success,
      output: result.summary,
      duration: result.durationMs ?? 0,
      command: `${module.id}/${step.id}/${variant}`,
      error: result.success ? undefined : result.detail ?? result.summary
    };

    // Ensure we only track a single winner record per step to keep reports clean
    this.results.push(execution);

    // Update telemetry after each recorded outcome
    const repoType = getRepoTypeFromModule(module);
    this.updateRepoTypeTelemetry(repoType, variant);
  }
  updateRepoTypeTelemetry(repoType, winner) {
    updateRepoTypeTelemetryMap(repoType, winner);
  }
  updateVariantStats(stats, outcome, modeDefinition) {
    stats.totalSteps += 1;
    if (outcome.winnerVariant === 'refiner') {
      stats.refinerWins += 1;
    } else {
      stats.primaryWins += 1;
    }
    if (!outcome.refiner) {
      return;
    }
    const primaryScore = typeof outcome.primary.score === 'number' ? outcome.primary.score : 0;
    const primaryTournamentScore = typeof outcome.primary.tournament?.aggregateScore === 'number' ? outcome.primary.tournament.aggregateScore : primaryScore;
    const refinerScoreRaw = typeof outcome.refiner.tournament?.aggregateScore === 'number' ? outcome.refiner.tournament.aggregateScore : typeof outcome.refiner.score === 'number' ? outcome.refiner.score : 0;
    const refinerScore = refinerScoreRaw + (modeDefinition.refinerBias ?? 0);
    const scoresClose = Math.abs(primaryTournamentScore - refinerScore) < 1e-6;
    const bothSucceeded = outcome.primary.success && outcome.refiner.success;
    if (bothSucceeded && scoresClose) {
      stats.ties += 1;
    }
  }
}
exports.RepoUpgradeOrchestrator = RepoUpgradeOrchestrator;
function clampScore(value, min = 0, max = 1) {
  if (!Number.isFinite(value)) return min;
  return Math.max(min, Math.min(max, value));
}
function averageDefined(values) {
  const nums = values.filter(v => typeof v === 'number');
  if (!nums.length) return NaN;
  const total = nums.reduce((sum, val) => sum + val, 0);
  return total / nums.length;
}
function getRepoTypeFromModule(module) {
  const scope = (module.scope || []).join(' ').toLowerCase();
  const label = (module.label || '').toLowerCase();
  if (/\btest|__tests__|spec\b/i.test(scope) || /\btest\b/i.test(label)) return 'tests';
  if (/\bdocs?\b/i.test(scope) || /\bdoc\b/i.test(label)) return 'docs';
  if (/\brefactor|cleanup|source\b/i.test(scope + ' ' + label)) return 'refactor';
  return 'general';
}
function getRepoTypeFromOutcomeMetadata(task) {
  const scopeText = Array.isArray(task.constraints) ? task.constraints.join(' ').toLowerCase() : '';
  const intent = typeof task.metadata?.intent === 'string' ? task.metadata.intent.toLowerCase() : '';
  if (/\btest|__tests__|spec\b/i.test(scopeText) || /\btest\b/i.test(intent)) return 'tests';
  if (/\bdoc\b/i.test(scopeText) || /\bdoc\b/i.test(intent)) return 'docs';
  if (/\brefactor|cleanup\b/i.test(scopeText + ' ' + intent)) return 'refactor';
  return 'general';
}
function updateRepoTypeTelemetryMap(repoType, winner) {
  if (RepoUpgradeOrchestrator.disableTelemetryPersistence) {
    return;
  }
  ensureTelemetryLoaded();
  const current = RepoUpgradeOrchestrator.repoTypeTelemetry.get(repoType) ?? {
    winsPrimary: 0,
    winsRefiner: 0
  };
  const updated = winner === 'primary' ? {
    ...current,
    winsPrimary: current.winsPrimary + 1
  } : {
    ...current,
    winsRefiner: current.winsRefiner + 1
  };
  RepoUpgradeOrchestrator.repoTypeTelemetry.set(repoType, updated);
  persistTelemetry();
}

// Simple persistence of repo-type telemetry to inform future runs
const TELEMETRY_DIR = (0, _nodePath.join)((0, _nodeOs.homedir)(), '.agi');
const TELEMETRY_FILE = (0, _nodePath.join)(TELEMETRY_DIR, 'rl-telemetry.json');
let telemetryLoaded = false;
function ensureTelemetryLoaded() {
  if (RepoUpgradeOrchestrator.disableTelemetryPersistence) return;
  if (telemetryLoaded) return;
  telemetryLoaded = true;
  try {
    if (!(0, _nodeFs.existsSync)(TELEMETRY_FILE)) return;
    const data = JSON.parse((0, _nodeFs.readFileSync)(TELEMETRY_FILE, 'utf-8'));
    if (data && typeof data === 'object') {
      for (const [key, value] of Object.entries(data)) {
        if (value && typeof value === 'object' && 'winsPrimary' in value && 'winsRefiner' in value) {
          RepoUpgradeOrchestrator.repoTypeTelemetry.set(key, {
            winsPrimary: Number(value.winsPrimary) || 0,
            winsRefiner: Number(value.winsRefiner) || 0
          });
        }
      }
    }
  } catch {
    // ignore load errors
  }
}
function persistTelemetry() {
  if (RepoUpgradeOrchestrator.disableTelemetryPersistence) return;
  try {
    (0, _nodeFs.mkdirSync)(TELEMETRY_DIR, {
      recursive: true
    });
    const payload = {};
    for (const [key, value] of RepoUpgradeOrchestrator.repoTypeTelemetry.entries()) {
      payload[key] = value;
    }
    (0, _nodeFs.writeFileSync)(TELEMETRY_FILE, JSON.stringify(payload, null, 2), 'utf-8');
  } catch {
    // ignore persistence errors
  }
}
function getModeDefinition(mode) {
  return REPO_UPGRADE_MODE_DEFINITIONS[mode] ?? REPO_UPGRADE_MODE_DEFINITIONS['single-continuous'];
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUZzIiwicmVxdWlyZSIsIl9ub2RlUGF0aCIsIl9ub2RlT3MiLCJfdW5pZmllZE9yY2hlc3RyYXRvciIsIl9kdWFsVG91cm5hbWVudCIsIl92YXJpYW50RXhlY3V0aW9uIiwiX3dpbm5lclN0cmF0ZWd5IiwiX3RvdXJuYW1lbnRTdHJhdGVneSIsIl9wYXJhbGxlbENvb3JkaW5hdG9yIiwiX3VwZ3JhZGVQbGFuIiwiREVGQVVMVF9SRVdBUkRfV0VJR0hUUyIsImV4cG9ydHMiLCJleGVjdXRpb25TdWNjZXNzIiwidGVzdHNQYXNzZWQiLCJzdGF0aWNBbmFseXNpcyIsImNvZGVRdWFsaXR5IiwiYmxhc3RSYWRpdXMiLCJzZWxmQXNzZXNzbWVudCIsInNwZWVkQm9udXMiLCJjYWxjdWxhdGVSZXdhcmRTY29yZSIsInNpZ25hbHMiLCJ3ZWlnaHRzIiwic2NvcmUiLCJ0b3RhbFdlaWdodCIsImtleSIsIndlaWdodCIsIk9iamVjdCIsImVudHJpZXMiLCJzaWduYWwiLCJleHRyYWN0UmV3YXJkU2lnbmFscyIsIm91dHB1dCIsImR1cmF0aW9uTXMiLCJiYXNlbGluZUR1cmF0aW9uTXMiLCJsb3dlciIsInRvTG93ZXJDYXNlIiwiY2xhbXAiLCJ2YWx1ZSIsIk1hdGgiLCJtYXgiLCJtaW4iLCJoYXNFcnJvcnMiLCJ0ZXN0IiwidGVzdE1hdGNoIiwibWF0Y2giLCJmYWlsTWF0Y2giLCJwYXNzZWQiLCJwYXJzZUludCIsImZhaWxlZCIsInRvdGFsIiwiZGlmZk1hdGNoIiwiZmlsZXNDaGFuZ2VkIiwic3BlZWRSYXRpbyIsIlJFUE9fVVBHUkFERV9NT0RFX0RFRklOSVRJT05TIiwiaWQiLCJsYWJlbCIsImRlc2NyaXB0aW9uIiwidmFyaWFudHMiLCJ2YXJpYW50R3VpZGFuY2UiLCJwcmltYXJ5IiwicGFyYWxsZWxWYXJpYW50cyIsInJlZmluZXIiLCJyZWZpbmVyQmlhcyIsIlJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yIiwiVW5pZmllZE9yY2hlc3RyYXRvciIsInBhcmFsbGVsQ29vcmRpbmF0b3IiLCJyZXBvVHlwZVRlbGVtZXRyeSIsIk1hcCIsImRpc2FibGVUZWxlbWV0cnlQZXJzaXN0ZW5jZSIsInByb2Nlc3MiLCJlbnYiLCJBR0lfRElTQUJMRV9STF9URUxFTUVUUlkiLCJjb25zdHJ1Y3RvciIsImV4ZWN1dG9yIiwicnVuIiwicGxhbiIsIm9wdGlvbnMiLCJtb2RlIiwiY29udGludWVPbkZhaWx1cmUiLCJvYmplY3RpdmUiLCJtb2RlRGVmaW5pdGlvbiIsImdldE1vZGVEZWZpbml0aW9uIiwicGFyYWxsZWxNb2R1bGVzIiwicGFyYWxsZWxNb2R1bGVDb25jdXJyZW5jeSIsInZhcmlhbnRXb3Jrc3BhY2VSb290cyIsInJlcG9Qb2xpY3kiLCJ1bmRlZmluZWQiLCJyZXN1bHRzIiwiZmluZGluZ3MiLCJ2YXJpYW50U3RhdHMiLCJwcmltYXJ5V2lucyIsInJlZmluZXJXaW5zIiwidGllcyIsInRvdGFsU3RlcHMiLCJlbWl0IiwidHlwZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJkYXRhIiwibW9kdWxlUmVwb3J0cyIsIm1vZHVsZXMiLCJsZW5ndGgiLCJydW5Nb2R1bGVzSW5QYXJhbGxlbCIsInJ1bk1vZHVsZXNTZXF1ZW50aWFsbHkiLCJiYXNlUmVwb3J0IiwiZ2VuZXJhdGVSZXBvcnQiLCJoYWx0ZWQiLCJtb2R1bGUiLCJwdXNoIiwic2NvcGUiLCJzdGVwcyIsInN0YXR1cyIsIm1vZHVsZVJlcG9ydCIsInByb2Nlc3NNb2R1bGUiLCJjb25jdXJyZW5jeSIsIlBhcmFsbGVsQ29vcmRpbmF0b3IiLCJyZXBvcnRzIiwicnVuTW9kdWxlcyIsImV2ZW50IiwiZmlyc3RGYWlsdXJlIiwiZmluZEluZGV4IiwicmVwb3J0Iiwic2xpY2UiLCJtb2R1bGVTdGFydCIsIm1vZHVsZUlkIiwiY29kZW1vZENvbW1hbmRzIiwidmFsaWRhdGlvbkNvbW1hbmRzIiwic3RlcCIsIm91dGNvbWUiLCJydW5TdGVwIiwidXBkYXRlVmFyaWFudFN0YXRzIiwid2lubmVyIiwic3VjY2VzcyIsInN0ZXBTdGFydCIsInN0ZXBJZCIsInZhcmlhbnQiLCJ2YXJpYW50UmVzdWx0cyIsImV4ZWN1dGVWYXJpYW50cyIsImNvbnRleHQiLCJleGVjdXRlVmFyaWFudCIsImlucHV0Iiwic2FmZUV4ZWN1dGVWYXJpYW50IiwidG91cm5hbWVudE91dGNvbWUiLCJldmFsdWF0ZVRvdXJuYW1lbnRPdXRjb21lIiwiYXR0YWNoVG91cm5hbWVudEJyZWFrZG93biIsIndpbm5lclZhcmlhbnQiLCJyZXNvbHZlV2lubmVyU3RyYXRlZ3kiLCJkZWZpbml0aW9uIiwicHJpbWFyeVJlc3VsdCIsInJlZmluZXJSZXN1bHQiLCJwaWNrV2lubmVyIiwicmVjb3JkT3V0Y29tZUFydGlmYWN0cyIsInByaW1hcnlTY29yZSIsInRvdXJuYW1lbnQiLCJhZ2dyZWdhdGVTY29yZSIsInJlZmluZXJTY29yZSIsInByaW1hcnlBY2N1cmFjeSIsImh1bWFuQWNjdXJhY3kiLCJyZWZpbmVyQWNjdXJhY3kiLCJwcmltYXJ5U3VjY2VzcyIsInJlZmluZXJTdWNjZXNzIiwidG91cm5hbWVudFJhbmtpbmdzIiwicmFua2VkIiwiaW50ZW50IiwidXBkYXRlUmVwb1R5cGVUZWxlbWV0cnkiLCJnZXRSZXBvVHlwZUZyb21Nb2R1bGUiLCJjYW5kaWRhdGVzIiwiYnVpbGRUb3VybmFtZW50Q2FuZGlkYXRlIiwidGFzayIsImdvYWwiLCJjb25zdHJhaW50cyIsIm1ldGFkYXRhIiwiZXZhbHVhdG9yQ29uZmlnIiwiYnVpbGRFdmFsdWF0b3JDb25maWciLCJydW5EdWFsVG91cm5hbWVudCIsInJld2FyZFdlaWdodHMiLCJldmFsdWF0b3JzIiwibWF4Q2FuZGlkYXRlcyIsInJlc3VsdCIsInJld2FyZFNpZ25hbHMiLCJyYXdSZXdhcmQiLCJjbGFtcFNjb3JlIiwiYWRqdXN0ZWRSZXdhcmQiLCJldmFsdWF0b3JTY29yZXMiLCJldmFsdWF0b3JJZCIsInF1YWxpdHlTY29yZSIsImF2ZXJhZ2VEZWZpbmVkIiwiTnVtYmVyIiwiaXNOYU4iLCJwb2xpY3lJZCIsInBhdGNoU3VtbWFyeSIsInN1bW1hcnkiLCJtZXRyaWNzIiwicmV3YXJkTW9kZWxTY29yZSIsInJhd091dHB1dCIsImRldGFpbCIsImVudHJ5IiwiY2FuZGlkYXRlSWQiLCJ0YXJnZXQiLCJ0b3AiLCJyZXBvVHlwZSIsImdldFJlcG9UeXBlRnJvbU91dGNvbWVNZXRhZGF0YSIsImVycm9yIiwibWVzc2FnZSIsIkVycm9yIiwiU3RyaW5nIiwiZXhlY3V0aW9uIiwiZHVyYXRpb24iLCJjb21tYW5kIiwibm90ZXMiLCJpbmNsdWRlcyIsInVwZGF0ZVJlcG9UeXBlVGVsZW1ldHJ5TWFwIiwic3RhdHMiLCJwcmltYXJ5VG91cm5hbWVudFNjb3JlIiwicmVmaW5lclNjb3JlUmF3Iiwic2NvcmVzQ2xvc2UiLCJhYnMiLCJib3RoU3VjY2VlZGVkIiwiaXNGaW5pdGUiLCJ2YWx1ZXMiLCJudW1zIiwiZmlsdGVyIiwidiIsIk5hTiIsInJlZHVjZSIsInN1bSIsInZhbCIsImpvaW4iLCJzY29wZVRleHQiLCJBcnJheSIsImlzQXJyYXkiLCJlbnN1cmVUZWxlbWV0cnlMb2FkZWQiLCJjdXJyZW50IiwiZ2V0Iiwid2luc1ByaW1hcnkiLCJ3aW5zUmVmaW5lciIsInVwZGF0ZWQiLCJzZXQiLCJwZXJzaXN0VGVsZW1ldHJ5IiwiVEVMRU1FVFJZX0RJUiIsImhvbWVkaXIiLCJURUxFTUVUUllfRklMRSIsInRlbGVtZXRyeUxvYWRlZCIsImV4aXN0c1N5bmMiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJwYXlsb2FkIiwid3JpdGVGaWxlU3luYyIsInN0cmluZ2lmeSJdLCJzb3VyY2VzIjpbInJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYywgd3JpdGVGaWxlU3luYywgbWtkaXJTeW5jIH0gZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQgeyBqb2luIH0gZnJvbSAnbm9kZTpwYXRoJztcbmltcG9ydCB7IGhvbWVkaXIgfSBmcm9tICdub2RlOm9zJztcbmltcG9ydCB7IFVuaWZpZWRPcmNoZXN0cmF0b3IsIHR5cGUgRXhlY3V0aW9uUmVzdWx0LCB0eXBlIEZpbmRpbmcsIHR5cGUgT3BlcmF0aW9uUmVwb3J0IH0gZnJvbSAnLi91bmlmaWVkT3JjaGVzdHJhdG9yLmpzJztcbmltcG9ydCB7XG4gIHJ1bkR1YWxUb3VybmFtZW50LFxuICB0eXBlIFJhbmtlZENhbmRpZGF0ZSxcbiAgdHlwZSBUb3VybmFtZW50Q2FuZGlkYXRlLFxuICB0eXBlIFRvdXJuYW1lbnRPdXRjb21lLFxuICB0eXBlIFRvdXJuYW1lbnRUYXNrLFxufSBmcm9tICcuL2R1YWxUb3VybmFtZW50LmpzJztcbmltcG9ydCB7IGV4ZWN1dGVWYXJpYW50cyB9IGZyb20gJy4vdmFyaWFudEV4ZWN1dGlvbi5qcyc7XG5pbXBvcnQgeyByZXNvbHZlV2lubmVyIGFzIHJlc29sdmVXaW5uZXJTdHJhdGVneSB9IGZyb20gJy4vd2lubmVyU3RyYXRlZ3kuanMnO1xuaW1wb3J0IHsgYnVpbGRFdmFsdWF0b3JDb25maWcgfSBmcm9tICcuL3RvdXJuYW1lbnRTdHJhdGVneS5qcyc7XG5pbXBvcnQgeyBQYXJhbGxlbENvb3JkaW5hdG9yIH0gZnJvbSAnLi9wYXJhbGxlbENvb3JkaW5hdG9yLmpzJztcbmV4cG9ydCB7IGJ1aWxkUmVwb1dpZGVQbGFuLCBkZXRlY3RXb3Jrc3BhY2VNb2R1bGVzLCBleHBhbmRXb3Jrc3BhY2VQYXR0ZXJuLCBwYXJzZVdvcmtzcGFjZUZpZWxkIH0gZnJvbSAnLi91cGdyYWRlUGxhbi5qcyc7XG5cbmV4cG9ydCB0eXBlIFJlcG9VcGdyYWRlTW9kZSA9ICdzaW5nbGUtY29udGludW91cycgfCAnZHVhbC1ybC1jb250aW51b3VzJyB8ICdkdWFsLXJsLXRvdXJuYW1lbnQnO1xuZXhwb3J0IHR5cGUgVXBncmFkZVZhcmlhbnQgPSAncHJpbWFyeScgfCAncmVmaW5lcic7XG5cbi8qKlxuICogUmV3YXJkIHNpZ25hbCBjb21wb25lbnRzIGZvciBtdWx0aS1vYmplY3RpdmUgUkwgc2NvcmluZy5cbiAqIEVhY2ggc2lnbmFsIGlzIG5vcm1hbGl6ZWQgdG8gWzAsIDFdIHJhbmdlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJld2FyZFNpZ25hbHMge1xuICAvKiogRGlkIHRoZSBleGVjdXRpb24gY29tcGxldGUgd2l0aG91dCBlcnJvcnM/ICgwIG9yIDEpICovXG4gIGV4ZWN1dGlvblN1Y2Nlc3M6IG51bWJlcjtcbiAgLyoqIERpZCB0ZXN0cyBwYXNzPyAoMC0xLCBwYXJ0aWFsIGNyZWRpdCBmb3Igc29tZSBwYXNzaW5nKSAqL1xuICB0ZXN0c1Bhc3NlZDogbnVtYmVyO1xuICAvKiogRGlkIGxpbnQvdHlwZSBjaGVja3MgcGFzcz8gKDAtMSkgKi9cbiAgc3RhdGljQW5hbHlzaXM6IG51bWJlcjtcbiAgLyoqIENvZGUgcXVhbGl0eSBtZXRyaWNzIChjb21wbGV4aXR5IHJlZHVjdGlvbiwgbm8gbmV3IHdhcm5pbmdzKSAqL1xuICBjb2RlUXVhbGl0eTogbnVtYmVyO1xuICAvKiogSG93IG1pbmltYWwvc3VyZ2ljYWwgd2VyZSB0aGUgY2hhbmdlcz8gKGludmVyc2Ugb2YgYmxhc3QgcmFkaXVzKSAqL1xuICBibGFzdFJhZGl1czogbnVtYmVyO1xuICAvKiogQ29uZmlkZW5jZSBmcm9tIExMTSBzZWxmLWFzc2Vzc21lbnQga2V5d29yZHMgKi9cbiAgc2VsZkFzc2Vzc21lbnQ6IG51bWJlcjtcbiAgLyoqIEJvbnVzIGZvciBmYXN0ZXIgZXhlY3V0aW9uIChyZWxhdGl2ZSB0byBiYXNlbGluZSkgKi9cbiAgc3BlZWRCb251czogbnVtYmVyO1xufVxuXG4vKipcbiAqIFdlaWdodHMgZm9yIGNvbWJpbmluZyByZXdhcmQgc2lnbmFscyBpbnRvIGZpbmFsIHNjb3JlLlxuICogVHVuZWQgZm9yIHNhZmUsIGhpZ2gtcXVhbGl0eSB1cGdyYWRlcy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZXdhcmRXZWlnaHRzIHtcbiAgZXhlY3V0aW9uU3VjY2VzczogbnVtYmVyO1xuICB0ZXN0c1Bhc3NlZDogbnVtYmVyO1xuICBzdGF0aWNBbmFseXNpczogbnVtYmVyO1xuICBjb2RlUXVhbGl0eTogbnVtYmVyO1xuICBibGFzdFJhZGl1czogbnVtYmVyO1xuICBzZWxmQXNzZXNzbWVudDogbnVtYmVyO1xuICBzcGVlZEJvbnVzOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1JFV0FSRF9XRUlHSFRTOiBSZXdhcmRXZWlnaHRzID0ge1xuICBleGVjdXRpb25TdWNjZXNzOiAwLjI1LFxuICB0ZXN0c1Bhc3NlZDogMC4zMCxcbiAgc3RhdGljQW5hbHlzaXM6IDAuMTUsXG4gIGNvZGVRdWFsaXR5OiAwLjEwLFxuICBibGFzdFJhZGl1czogMC4xMCxcbiAgc2VsZkFzc2Vzc21lbnQ6IDAuMDUsXG4gIHNwZWVkQm9udXM6IDAuMDUsXG59O1xuXG4vKipcbiAqIENhbGN1bGF0ZSBjb21wb3NpdGUgcmV3YXJkIHNjb3JlIGZyb20gaW5kaXZpZHVhbCBzaWduYWxzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlUmV3YXJkU2NvcmUoXG4gIHNpZ25hbHM6IFBhcnRpYWw8UmV3YXJkU2lnbmFscz4sXG4gIHdlaWdodHM6IFJld2FyZFdlaWdodHMgPSBERUZBVUxUX1JFV0FSRF9XRUlHSFRTXG4pOiBudW1iZXIge1xuICBsZXQgc2NvcmUgPSAwO1xuICBsZXQgdG90YWxXZWlnaHQgPSAwO1xuXG4gIGZvciAoY29uc3QgW2tleSwgd2VpZ2h0XSBvZiBPYmplY3QuZW50cmllcyh3ZWlnaHRzKSkge1xuICAgIGNvbnN0IHNpZ25hbCA9IHNpZ25hbHNba2V5IGFzIGtleW9mIFJld2FyZFNpZ25hbHNdO1xuICAgIGlmICh0eXBlb2Ygc2lnbmFsID09PSAnbnVtYmVyJykge1xuICAgICAgc2NvcmUgKz0gc2lnbmFsICogd2VpZ2h0O1xuICAgICAgdG90YWxXZWlnaHQgKz0gd2VpZ2h0O1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0b3RhbFdlaWdodCA+IDAgPyBzY29yZSAvIHRvdGFsV2VpZ2h0IDogMDtcbn1cblxuLyoqXG4gKiBFeHRyYWN0IHJld2FyZCBzaWduYWxzIGZyb20gZXhlY3V0aW9uIG91dHB1dCB0ZXh0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdFJld2FyZFNpZ25hbHMoXG4gIG91dHB1dDogc3RyaW5nLFxuICBkdXJhdGlvbk1zOiBudW1iZXIsXG4gIGJhc2VsaW5lRHVyYXRpb25NcyA9IDYwMDAwXG4pOiBQYXJ0aWFsPFJld2FyZFNpZ25hbHM+IHtcbiAgY29uc3QgbG93ZXIgPSBvdXRwdXQudG9Mb3dlckNhc2UoKTtcbiAgY29uc3Qgc2lnbmFsczogUGFydGlhbDxSZXdhcmRTaWduYWxzPiA9IHt9O1xuICBjb25zdCBjbGFtcCA9ICh2YWx1ZTogbnVtYmVyKSA9PiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCB2YWx1ZSkpO1xuXG4gIC8vIEV4ZWN1dGlvbiBzdWNjZXNzIC0gbm8gZXJyb3Iga2V5d29yZHNcbiAgY29uc3QgaGFzRXJyb3JzID0gL1xcYihlcnJvcnxleGNlcHRpb258ZmFpbGVkfGZhaWx1cmV8ZmF0YWwpXFxiL2kudGVzdChvdXRwdXQpO1xuICBzaWduYWxzLmV4ZWN1dGlvblN1Y2Nlc3MgPSBoYXNFcnJvcnMgPyAwIDogMTtcblxuICAvLyBUZXN0cyBwYXNzZWQgLSBsb29rIGZvciB0ZXN0IHJlc3VsdCBwYXR0ZXJuc1xuICBjb25zdCB0ZXN0TWF0Y2ggPSBvdXRwdXQubWF0Y2goLyhcXGQrKVxccyooPzp0ZXN0cz9cXHMqKT9wYXNzKD86ZWR8aW5nKT8vaSk7XG4gIGNvbnN0IGZhaWxNYXRjaCA9IG91dHB1dC5tYXRjaCgvKFxcZCspXFxzKig/OnRlc3RzP1xccyopP2ZhaWwoPzplZHxpbmcpPy9pKTtcbiAgaWYgKHRlc3RNYXRjaCB8fCBmYWlsTWF0Y2gpIHtcbiAgICBjb25zdCBwYXNzZWQgPSBwYXJzZUludCh0ZXN0TWF0Y2g/LlsxXSA/PyAnMCcsIDEwKTtcbiAgICBjb25zdCBmYWlsZWQgPSBwYXJzZUludChmYWlsTWF0Y2g/LlsxXSA/PyAnMCcsIDEwKTtcbiAgICBjb25zdCB0b3RhbCA9IHBhc3NlZCArIGZhaWxlZDtcbiAgICBzaWduYWxzLnRlc3RzUGFzc2VkID0gdG90YWwgPiAwID8gcGFzc2VkIC8gdG90YWwgOiAoL3Bhc3N8c3VjY2Vzc3zinJMvaS50ZXN0KGxvd2VyKSA/IDEgOiAwLjUpO1xuICB9IGVsc2UgaWYgKC9hbGwgdGVzdHMgcGFzc3x0ZXN0cyBwYXNzaW5nfOKcky4qdGVzdC9pLnRlc3QobG93ZXIpKSB7XG4gICAgc2lnbmFscy50ZXN0c1Bhc3NlZCA9IDE7XG4gIH1cblxuICAvLyBTdGF0aWMgYW5hbHlzaXMgLSBsaW50L3R5cGUgY2hlY2sgcGF0dGVybnNcbiAgaWYgKC9saW50LipwYXNzfG5vLipsaW50LiplcnJvcnxlc2xpbnQuKmNsZWFufHRzYy4qc3VjY2Vzcy9pLnRlc3QobG93ZXIpKSB7XG4gICAgc2lnbmFscy5zdGF0aWNBbmFseXNpcyA9IDE7XG4gIH0gZWxzZSBpZiAoL2xpbnQuKndhcm58ZXNsaW50Lip3YXJuL2kudGVzdChsb3dlcikpIHtcbiAgICBzaWduYWxzLnN0YXRpY0FuYWx5c2lzID0gMC43O1xuICB9IGVsc2UgaWYgKC9saW50LiplcnJvcnx0eXBlLiplcnJvcnxlc2xpbnQuKmVycm9yL2kudGVzdChsb3dlcikpIHtcbiAgICBzaWduYWxzLnN0YXRpY0FuYWx5c2lzID0gMC4zO1xuICB9XG5cbiAgLy8gQ29kZSBxdWFsaXR5IGhldXJpc3RpY3MgKFRPRE8vSEFDSyBwZW5hbHRpZXMgdnMgY2xlYW51cC9yZWZhY3RvciBib251c2VzKVxuICBpZiAoL3RvZG98aGFja3x3b3JrYXJvdW5kfHRlbXBvcmFyeSBmaXgvaS50ZXN0KGxvd2VyKSkge1xuICAgIHNpZ25hbHMuY29kZVF1YWxpdHkgPSAwLjQ1O1xuICB9IGVsc2UgaWYgKC9yZWZhY3RvcnxjbGVhbnVwfHNpbXBsaWZ8cmVkdWNpbmcgY29tcGxleGl0eXxzdHJlYW1saW5lZC9pLnRlc3QobG93ZXIpKSB7XG4gICAgc2lnbmFscy5jb2RlUXVhbGl0eSA9IE1hdGgubWF4KHNpZ25hbHMuY29kZVF1YWxpdHkgPz8gMCwgMC42NSk7XG4gIH1cblxuICAvLyBCbGFzdCByYWRpdXMgYXBwcm94aW1hdGlvbiBmcm9tIGRpZmYgc3VtbWFyaWVzIC8gZGVwZW5kZW5jeSBhZGRzXG4gIGNvbnN0IGRpZmZNYXRjaCA9IG91dHB1dC5tYXRjaCgvKFxcZCspXFxzK2ZpbGVzP1xccytjaGFuZ2VkL2kpO1xuICBpZiAoZGlmZk1hdGNoKSB7XG4gICAgY29uc3QgZmlsZXNDaGFuZ2VkID0gcGFyc2VJbnQoZGlmZk1hdGNoWzFdID8/ICcwJywgMTApO1xuICAgIHNpZ25hbHMuYmxhc3RSYWRpdXMgPSBjbGFtcCgxIC0gTWF0aC5taW4oMSwgZmlsZXNDaGFuZ2VkIC8gOCkpO1xuICB9XG4gIGlmICgvbnBtIGluc3RhbGx8eWFybiBhZGR8cG5wbSBhZGR8cGlwIGluc3RhbGx8Z28gZ2V0fGNhcmdvIGFkZC9pLnRlc3QobG93ZXIpKSB7XG4gICAgc2lnbmFscy5ibGFzdFJhZGl1cyA9IGNsYW1wKChzaWduYWxzLmJsYXN0UmFkaXVzID8/IDAuNikgLSAwLjE1KTtcbiAgfVxuXG4gIC8vIFNlbGYtYXNzZXNzbWVudCBmcm9tIGNvbmZpZGVuY2Uga2V5d29yZHNcbiAgaWYgKC9jb25maWRlbnR8dmVyaWZpZWR8dmFsaWRhdGVkfGNvbmZpcm1lZC9pLnRlc3QobG93ZXIpKSB7XG4gICAgc2lnbmFscy5zZWxmQXNzZXNzbWVudCA9IDAuOTtcbiAgfSBlbHNlIGlmICgvbGlrZWx5fHByb2JhYmx5fHNob3VsZCB3b3JrL2kudGVzdChsb3dlcikpIHtcbiAgICBzaWduYWxzLnNlbGZBc3Nlc3NtZW50ID0gMC42O1xuICB9IGVsc2UgaWYgKC91bmNlcnRhaW58dW5jbGVhcnxtaWdodHxtYXkvaS50ZXN0KGxvd2VyKSkge1xuICAgIHNpZ25hbHMuc2VsZkFzc2Vzc21lbnQgPSAwLjM7XG4gIH1cblxuICAvLyBTcGVlZCBib251cyAtIGZhc3RlciB0aGFuIGJhc2VsaW5lIGdldHMgYm9udXNcbiAgaWYgKGR1cmF0aW9uTXMgPiAwICYmIGJhc2VsaW5lRHVyYXRpb25NcyA+IDApIHtcbiAgICBjb25zdCBzcGVlZFJhdGlvID0gYmFzZWxpbmVEdXJhdGlvbk1zIC8gZHVyYXRpb25NcztcbiAgICBzaWduYWxzLnNwZWVkQm9udXMgPSBNYXRoLm1pbigxLCBNYXRoLm1heCgwLCAoc3BlZWRSYXRpbyAtIDAuNSkgLyAxLjUpKTtcbiAgfVxuXG4gIHJldHVybiBzaWduYWxzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcG9VcGdyYWRlTW9kZURlZmluaXRpb24ge1xuICBpZDogUmVwb1VwZ3JhZGVNb2RlO1xuICBsYWJlbDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAvKiogT3JkZXJlZCBsaXN0IG9mIHZhcmlhbnRzIHRvIGV4ZWN1dGUgZm9yIHRoaXMgbW9kZSAqL1xuICB2YXJpYW50czogVXBncmFkZVZhcmlhbnRbXTtcbiAgLyoqIEd1aWRhbmNlIHRvIGluamVjdCBpbnRvIHByb21wdHMgcGVyIHZhcmlhbnQgKi9cbiAgdmFyaWFudEd1aWRhbmNlPzogUGFydGlhbDxSZWNvcmQ8VXBncmFkZVZhcmlhbnQsIHN0cmluZz4+O1xuICAvKiogQmlhcyB0byBhcHBseSB0byB0aGUgcmVmaW5lciB3aGVuIHNjb3JlcyBhcmUgdGllZCAoZW5jb3VyYWdlcyBSTCBleHBsb3JhdGlvbikgKi9cbiAgcmVmaW5lckJpYXM/OiBudW1iZXI7XG4gIC8qKiBFbmFibGUgcGFyYWxsZWwgdmFyaWFudCBleGVjdXRpb24gKHJlcXVpcmVzIGlzb2xhdGVkIHdvcmtzcGFjZXMpICovXG4gIHBhcmFsbGVsVmFyaWFudHM/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgUkVQT19VUEdSQURFX01PREVfREVGSU5JVElPTlM6IFJlY29yZDxSZXBvVXBncmFkZU1vZGUsIFJlcG9VcGdyYWRlTW9kZURlZmluaXRpb24+ID0ge1xuICAnc2luZ2xlLWNvbnRpbnVvdXMnOiB7XG4gICAgaWQ6ICdzaW5nbGUtY29udGludW91cycsXG4gICAgbGFiZWw6ICdTaW5nbGUgY29udGludW91cycsXG4gICAgZGVzY3JpcHRpb246ICdTaW5nbGUtcGFzcyBkZXRlcm1pbmlzdGljIGV4ZWN1dGlvbiBmb2N1c2VkIG9uIG1pbmltYWwgYmxhc3QgcmFkaXVzLicsXG4gICAgdmFyaWFudHM6IFsncHJpbWFyeSddLFxuICAgIHZhcmlhbnRHdWlkYW5jZToge1xuICAgICAgcHJpbWFyeTogJ1BsYW4gYW5kIGV4ZWN1dGUgdGhlIGJlc3QgcG9zc2libGUgdXBncmFkZSBpbiBvbmUgcGFzcy4gS2VlcCBlZGl0cyBzdXJnaWNhbCBhbmQgcnVubmFibGUuJyxcbiAgICB9LFxuICAgIHBhcmFsbGVsVmFyaWFudHM6IGZhbHNlLFxuICB9LFxuICAnZHVhbC1ybC1jb250aW51b3VzJzoge1xuICAgIGlkOiAnZHVhbC1ybC1jb250aW51b3VzJyxcbiAgICBsYWJlbDogJ0R1YWwtYWdlbnQgUkwgY29udGludW91cycsXG4gICAgZGVzY3JpcHRpb246ICdQcmltYXJ5ICsgcmVmaW5lciBsb29wIHdoZXJlIHRoZSByZWZpbmVyIGNvbXBldGVzIHRvIGltcHJvdmUgc2FmZXR5IGFuZCBxdWFsaXR5LiBSZWZpbmVyIHNlZXMgcHJpbWFyeSBvdXRwdXQuJyxcbiAgICB2YXJpYW50czogWydwcmltYXJ5JywgJ3JlZmluZXInXSxcbiAgICB2YXJpYW50R3VpZGFuY2U6IHtcbiAgICAgIHByaW1hcnk6ICdQcmltYXJ5IHBhc3Mgc2V0cyB0aGUgYmFzZWxpbmUgcGxhbiBhbmQgY2hhbmdlcyB3aXRoIGNvbnNlcnZhdGl2ZSBzY29wZSBhbmQgcnVubmFibGUgY2hlY2tzLicsXG4gICAgICByZWZpbmVyOlxuICAgICAgICAnUkwgcmVmaW5lciBjcml0aXF1ZXMgdGhlIHByaW1hcnksIGZpeGVzIGdhcHMsIHRpZ2h0ZW5zIHNhZmV0eSwgYW5kIG9ubHkgcmVwZWF0cyBzdGVwcyBpZiB0aGV5IG1hdGVyaWFsbHkgaW1wcm92ZSB0aGUgcmVzdWx0LicsXG4gICAgfSxcbiAgICByZWZpbmVyQmlhczogMC4wNSxcbiAgICBwYXJhbGxlbFZhcmlhbnRzOiBmYWxzZSwgLy8gU2VxdWVudGlhbCBzbyByZWZpbmVyIGNhbiBzZWUgcHJpbWFyeSdzIHdvcmtcbiAgfSxcbiAgJ2R1YWwtcmwtdG91cm5hbWVudCc6IHtcbiAgICBpZDogJ2R1YWwtcmwtdG91cm5hbWVudCcsXG4gICAgbGFiZWw6ICdEdWFsLWFnZW50IFJMIHRvdXJuYW1lbnQnLFxuICAgIGRlc2NyaXB0aW9uOiAnUHJpbWFyeSBhbmQgcmVmaW5lciBjb21wZXRlIGluIHBhcmFsbGVsIHdpdGggaXNvbGF0ZWQgd29ya3NwYWNlcy4gQmVzdCByZXN1bHQgd2lucyBwZXIgc3RlcC4nLFxuICAgIHZhcmlhbnRzOiBbJ3ByaW1hcnknLCAncmVmaW5lciddLFxuICAgIHZhcmlhbnRHdWlkYW5jZToge1xuICAgICAgcHJpbWFyeTogJ0V4ZWN1dGUgdGhlIHVwZ3JhZGUgd2l0aCBmb2N1cyBvbiBjb3JyZWN0bmVzcyBhbmQgdGVzdCBjb3ZlcmFnZS4gWW91IGFyZSBjb21wZXRpbmcgYWdhaW5zdCBhbm90aGVyIGFnZW50LicsXG4gICAgICByZWZpbmVyOlxuICAgICAgICAnRXhlY3V0ZSB0aGUgdXBncmFkZSB3aXRoIGZvY3VzIG9uIHNhZmV0eSBhbmQgbWluaW1hbCBjaGFuZ2VzLiBZb3UgYXJlIGNvbXBldGluZyBhZ2FpbnN0IGFub3RoZXIgYWdlbnQuJyxcbiAgICB9LFxuICAgIHJlZmluZXJCaWFzOiAwLjAzLCAvLyBMb3dlciBiaWFzIHNpbmNlIGJvdGggc3RhcnQgZnJlc2hcbiAgICBwYXJhbGxlbFZhcmlhbnRzOiB0cnVlLCAvLyBSdW4gaW4gcGFyYWxsZWwgd2l0aCBnaXQgd29ya3RyZWUgaXNvbGF0aW9uXG4gIH0sXG59O1xuXG5leHBvcnQgdHlwZSBVcGdyYWRlU3RlcEludGVudCA9ICdhbmFseXplJyB8ICd1cGdyYWRlJyB8ICd2ZXJpZnknIHwgJ2NsZWFudXAnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlcG9VcGdyYWRlU3RlcCB7XG4gIGlkOiBzdHJpbmc7XG4gIGludGVudDogVXBncmFkZVN0ZXBJbnRlbnQ7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIC8qKiBPcHRpb25hbCBpbnN0cnVjdGlvbiBvciBwcm9tcHQgdG8gZmVlZCBpbnRvIHRoZSBleGVjdXRvciAqL1xuICBwcm9tcHQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb1VwZ3JhZGVNb2R1bGUge1xuICBpZDogc3RyaW5nO1xuICBsYWJlbDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBzY29wZTogc3RyaW5nW107XG4gIC8qKiBTdWdnZXN0ZWQgY29kZW1vZCBjb21tYW5kcyB0byBydW4gZm9yIHRoaXMgbW9kdWxlIChkaXNwbGF5IG9ubHksIG5vdCBleGVjdXRlZCBhdXRvbWF0aWNhbGx5KS4gKi9cbiAgY29kZW1vZENvbW1hbmRzPzogc3RyaW5nW107XG4gIC8qKiBTdWdnZXN0ZWQgdmFsaWRhdGlvbiBjb21tYW5kcyB0byBydW4gZm9yIHRoaXMgbW9kdWxlIChkaXNwbGF5IG9ubHksIG5vdCBleGVjdXRlZCBhdXRvbWF0aWNhbGx5KS4gKi9cbiAgdmFsaWRhdGlvbkNvbW1hbmRzPzogc3RyaW5nW107XG4gIHN0ZXBzOiBSZXBvVXBncmFkZVN0ZXBbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXBvVXBncmFkZVBsYW4ge1xuICBtb2R1bGVzOiBSZXBvVXBncmFkZU1vZHVsZVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZ3JhZGVTdGVwRXhlY3V0aW9uSW5wdXQge1xuICBtb2R1bGU6IFJlcG9VcGdyYWRlTW9kdWxlO1xuICBzdGVwOiBSZXBvVXBncmFkZVN0ZXA7XG4gIC8qKiBXaGljaCBwYXRoIHdlIGFyZSB0YWtpbmc6IHNpbmdsZS1wYXNzIHByaW1hcnkgb3IgdGhlIGR1YWwgUkwgcmVmaW5lciAqL1xuICB2YXJpYW50OiBVcGdyYWRlVmFyaWFudDtcbiAgbW9kZTogUmVwb1VwZ3JhZGVNb2RlO1xuICBwcmV2aW91c1Jlc3VsdD86IFVwZ3JhZGVTdGVwUmVzdWx0O1xuICB3b3Jrc3BhY2VSb290Pzogc3RyaW5nO1xuICByZXBvUG9saWN5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZ3JhZGVTdGVwUmVzdWx0IHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgc3VtbWFyeTogc3RyaW5nO1xuICBkZXRhaWw/OiBzdHJpbmc7XG4gIHNjb3JlPzogbnVtYmVyO1xuICAvKiogVG91cm5hbWVudC1kZXJpdmVkIGh1bWFuIGFjY3VyYWN5ICgxPWJlc3QsIDA9d29yc3QgYWNyb3NzIHZhcmlhbnRzKSAqL1xuICBodW1hbkFjY3VyYWN5PzogbnVtYmVyO1xuICByZXdhcmRTaWduYWxzPzogUGFydGlhbDxSZXdhcmRTaWduYWxzPjtcbiAgLyoqIFRvdXJuYW1lbnQgYnJlYWtkb3duIGZvciBkdWFsIGNvbXBldGl0aW9ucyAqL1xuICB0b3VybmFtZW50PzogUmFua2VkQ2FuZGlkYXRlO1xuICBkdXJhdGlvbk1zPzogbnVtYmVyO1xuICBleGVjdXRpb24/OiBFeGVjdXRpb25SZXN1bHQ7XG4gIGZpbmRpbmdzPzogRmluZGluZ1tdO1xuICBub3Rlcz86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZ3JhZGVTdGVwT3V0Y29tZSB7XG4gIHN0ZXBJZDogc3RyaW5nO1xuICBpbnRlbnQ6IFVwZ3JhZGVTdGVwSW50ZW50O1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBwcmltYXJ5OiBVcGdyYWRlU3RlcFJlc3VsdDtcbiAgcmVmaW5lcj86IFVwZ3JhZGVTdGVwUmVzdWx0O1xuICB3aW5uZXI6IFVwZ3JhZGVTdGVwUmVzdWx0O1xuICB3aW5uZXJWYXJpYW50OiBVcGdyYWRlVmFyaWFudDtcbiAgc3RhdHVzOiAnY29tcGxldGVkJyB8ICdmYWlsZWQnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZ3JhZGVNb2R1bGVSZXBvcnQge1xuICBpZDogc3RyaW5nO1xuICBsYWJlbDogc3RyaW5nO1xuICBzY29wZTogc3RyaW5nW107XG4gIGNvZGVtb2RDb21tYW5kcz86IHN0cmluZ1tdO1xuICB2YWxpZGF0aW9uQ29tbWFuZHM/OiBzdHJpbmdbXTtcbiAgc3RlcHM6IFVwZ3JhZGVTdGVwT3V0Y29tZVtdO1xuICBzdGF0dXM6ICdjb21wbGV0ZWQnIHwgJ2ZhaWxlZCcgfCAnc2tpcHBlZCc7XG4gIHZhbGlkYXRpb25zPzogVmFsaWRhdGlvblJ1blJlc3VsdFtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcG9VcGdyYWRlUmVwb3J0IGV4dGVuZHMgT3BlcmF0aW9uUmVwb3J0IHtcbiAgbW9kZTogUmVwb1VwZ3JhZGVNb2RlO1xuICBjb250aW51ZU9uRmFpbHVyZTogYm9vbGVhbjtcbiAgbW9kdWxlczogVXBncmFkZU1vZHVsZVJlcG9ydFtdO1xuICB2YWxpZGF0aW9uQXJ0aWZhY3RzPzogVmFsaWRhdGlvblJ1blJlc3VsdFtdO1xuICAvKiogVHJ1ZSB3aGVuIHZhbGlkYXRpb24gY29tbWFuZHMgd2VyZSBleGVjdXRlZCBpbnN0ZWFkIG9mIGp1c3Qgc3VnZ2VzdGVkICovXG4gIHZhbGlkYXRpb25zRXhlY3V0ZWQ/OiBib29sZWFuO1xuICB2YXJpYW50U3RhdHM6IFZhcmlhbnRXaW5TdGF0cztcbiAgLyoqIFBhdGhzIHVzZWQgcGVyIHZhcmlhbnQgd2hlbiBydW5uaW5nIGR1YWwgd29ya3NwYWNlcyAoZm9yIGdpdC93b3JrdHJlZSBpbnRlZ3JhdGlvbnMpLiAqL1xuICB2YXJpYW50V29ya3NwYWNlUm9vdHM/OiBQYXJ0aWFsPFJlY29yZDxVcGdyYWRlVmFyaWFudCwgc3RyaW5nPj47XG4gIC8qKiBPcHRpb25hbCBwb2xpY3kgdGhhdCBndWlkZWQgdGhlIHJ1biAoZS5nLiwgdXBncmFkZSBvciBjaGFuZ2UtbWFuYWdlbWVudCBwb2xpY3kpLiAqL1xuICByZXBvUG9saWN5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcG9VcGdyYWRlUnVuT3B0aW9ucyB7XG4gIG9iamVjdGl2ZT86IHN0cmluZztcbiAgbW9kZTogUmVwb1VwZ3JhZGVNb2RlO1xuICBjb250aW51ZU9uRmFpbHVyZT86IGJvb2xlYW47XG4gIC8qKiBPcHRpb25hbCBwZXItdmFyaWFudCB3b3Jrc3BhY2Ugcm9vdHMgd2hlbiBydW5uaW5nIGR1YWwgUkwgd2l0aCBzZXBhcmF0ZSByZXBvcy4gKi9cbiAgdmFyaWFudFdvcmtzcGFjZVJvb3RzPzogUGFydGlhbDxSZWNvcmQ8VXBncmFkZVZhcmlhbnQsIHN0cmluZz4+O1xuICAvKiogT3B0aW9uYWwgcG9saWN5L2d1aWRlbGluZSBzdHJpbmcgdG8gc3VyZmFjZSBpbiBwcm9tcHRzIGFuZCByZXBvcnRzLiAqL1xuICByZXBvUG9saWN5Pzogc3RyaW5nO1xuICAvKiogRW5hYmxlIHBhcmFsbGVsIG1vZHVsZSBwcm9jZXNzaW5nIChkZWZhdWx0OiBmYWxzZSBmb3Igc2FmZXR5KS4gKi9cbiAgcGFyYWxsZWxNb2R1bGVzPzogYm9vbGVhbjtcbiAgLyoqIE1heGltdW0gY29uY3VycmVudCBtb2R1bGVzIHdoZW4gcGFyYWxsZWwgcHJvY2Vzc2luZyBpcyBlbmFibGVkIChkZWZhdWx0OiAzKS4gKi9cbiAgcGFyYWxsZWxNb2R1bGVDb25jdXJyZW5jeT86IG51bWJlcjtcbiAgLyoqIEVuYWJsZSBwYXJhbGxlbCB2YXJpYW50IGV4ZWN1dGlvbiBpbiBkdWFsLVJMIG1vZGUgKGRlZmF1bHQ6IHRydWUpLiAqL1xuICBwYXJhbGxlbFZhcmlhbnRzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IHR5cGUgVXBncmFkZVN0ZXBFeGVjdXRvciA9IChpbnB1dDogVXBncmFkZVN0ZXBFeGVjdXRpb25JbnB1dCkgPT4gUHJvbWlzZTxVcGdyYWRlU3RlcFJlc3VsdD47XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvblJ1blJlc3VsdCB7XG4gIGNvbW1hbmQ6IHN0cmluZztcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgb3V0cHV0OiBzdHJpbmc7XG4gIGVycm9yPzogc3RyaW5nO1xuICBkdXJhdGlvbk1zOiBudW1iZXI7XG4gIHNraXBwZWQ/OiBib29sZWFuO1xuICByZWFzb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmFyaWFudFdpblN0YXRzIHtcbiAgcHJpbWFyeVdpbnM6IG51bWJlcjtcbiAgcmVmaW5lcldpbnM6IG51bWJlcjtcbiAgLyoqIE51bWJlciBvZiBzdGVwcyB3aGVyZSBzY29yZXMgd2VyZSBlZmZlY3RpdmVseSB0aWVkIGFuZCBiaWFzIHBpY2tlZCB0aGUgd2lubmVyICovXG4gIHRpZXM6IG51bWJlcjtcbiAgdG90YWxTdGVwczogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgUmVwb1VwZ3JhZGVPcmNoZXN0cmF0b3IgZXh0ZW5kcyBVbmlmaWVkT3JjaGVzdHJhdG9yIHtcbiAgcHJpdmF0ZSByZWFkb25seSBleGVjdXRvcjogVXBncmFkZVN0ZXBFeGVjdXRvcjtcbiAgcHJpdmF0ZSB2YXJpYW50V29ya3NwYWNlUm9vdHM6IFBhcnRpYWw8UmVjb3JkPFVwZ3JhZGVWYXJpYW50LCBzdHJpbmc+PiB8IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSByZXBvUG9saWN5OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgcGFyYWxsZWxDb29yZGluYXRvcjogUGFyYWxsZWxDb29yZGluYXRvciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG9iamVjdGl2ZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICBzdGF0aWMgcmVwb1R5cGVUZWxlbWV0cnk6IE1hcDxzdHJpbmcsIHsgd2luc1ByaW1hcnk6IG51bWJlcjsgd2luc1JlZmluZXI6IG51bWJlciB9PiA9IG5ldyBNYXAoKTtcbiAgLyoqIERpc2FibGUgcGVyc2lzdGVkIHRlbGVtZXRyeSB2aWEgZW52IG9yIGZsYWcgKi9cbiAgc3RhdGljIGRpc2FibGVUZWxlbWV0cnlQZXJzaXN0ZW5jZSA9IHByb2Nlc3MuZW52LkFHSV9ESVNBQkxFX1JMX1RFTEVNRVRSWSA9PT0gJzEnO1xuXG4gIGNvbnN0cnVjdG9yKGV4ZWN1dG9yOiBVcGdyYWRlU3RlcEV4ZWN1dG9yKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmV4ZWN1dG9yID0gZXhlY3V0b3I7XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSB0aGUgcmVwby13aWRlIHBsYW4gdXNpbmcgZWl0aGVyIHNpbmdsZSBjb250aW51b3VzIG9yIGR1YWwgUkwgY29udGludW91cyBtb2RlLlxuICAgKiBTdXBwb3J0cyBwYXJhbGxlbCBtb2R1bGUgcHJvY2Vzc2luZyBhbmQgcGFyYWxsZWwgdmFyaWFudCBleGVjdXRpb24gZm9yIGltcHJvdmVkIHBlcmZvcm1hbmNlLlxuICAgKi9cbiAgYXN5bmMgcnVuKHBsYW46IFJlcG9VcGdyYWRlUGxhbiwgb3B0aW9uczogUmVwb1VwZ3JhZGVSdW5PcHRpb25zKTogUHJvbWlzZTxSZXBvVXBncmFkZVJlcG9ydD4ge1xuICAgIGNvbnN0IG1vZGUgPSBvcHRpb25zLm1vZGU7XG4gICAgY29uc3QgY29udGludWVPbkZhaWx1cmUgPSBvcHRpb25zLmNvbnRpbnVlT25GYWlsdXJlID8/IHRydWU7XG4gICAgY29uc3Qgb2JqZWN0aXZlID0gb3B0aW9ucy5vYmplY3RpdmUgPz8gJ1JlcG9zaXRvcnktd2lkZSBzb3VyY2UgY29kZSB1cGdyYWRlJztcbiAgICBjb25zdCBtb2RlRGVmaW5pdGlvbiA9IGdldE1vZGVEZWZpbml0aW9uKG1vZGUpO1xuICAgIHRoaXMub2JqZWN0aXZlID0gb2JqZWN0aXZlO1xuICAgIGNvbnN0IHBhcmFsbGVsTW9kdWxlcyA9IG9wdGlvbnMucGFyYWxsZWxNb2R1bGVzID8/IGZhbHNlO1xuICAgIGNvbnN0IHBhcmFsbGVsTW9kdWxlQ29uY3VycmVuY3kgPSBvcHRpb25zLnBhcmFsbGVsTW9kdWxlQ29uY3VycmVuY3kgPz8gMztcbiAgICBjb25zdCBwYXJhbGxlbFZhcmlhbnRzID0gb3B0aW9ucy5wYXJhbGxlbFZhcmlhbnRzID8/IHRydWU7XG4gICAgdGhpcy52YXJpYW50V29ya3NwYWNlUm9vdHMgPSBvcHRpb25zLnZhcmlhbnRXb3Jrc3BhY2VSb290cztcbiAgICB0aGlzLnJlcG9Qb2xpY3kgPSBvcHRpb25zLnJlcG9Qb2xpY3kgPz8gdW5kZWZpbmVkO1xuXG4gICAgLy8gUmVzZXQgc3RhdGUgcGVyIHJ1biB0byBrZWVwIHJlcG9ydHMgY2xlYW5cbiAgICB0aGlzLnJlc3VsdHMgPSBbXTtcbiAgICB0aGlzLmZpbmRpbmdzID0gW107XG4gICAgdGhpcy5wYXJhbGxlbENvb3JkaW5hdG9yID0gbnVsbDtcblxuICAgIGNvbnN0IHZhcmlhbnRTdGF0czogVmFyaWFudFdpblN0YXRzID0geyBwcmltYXJ5V2luczogMCwgcmVmaW5lcldpbnM6IDAsIHRpZXM6IDAsIHRvdGFsU3RlcHM6IDAgfTtcblxuICAgIC8vIEVtaXQgcGFyYWxsZWwgbW9kZSBpbmZvXG4gICAgdGhpcy5lbWl0KHtcbiAgICAgIHR5cGU6ICd1cGdyYWRlLnBhcmFsbGVsLmNvbmZpZycsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHBhcmFsbGVsTW9kdWxlcyxcbiAgICAgICAgcGFyYWxsZWxNb2R1bGVDb25jdXJyZW5jeSxcbiAgICAgICAgcGFyYWxsZWxWYXJpYW50cyxcbiAgICAgICAgbW9kZSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBsZXQgbW9kdWxlUmVwb3J0czogVXBncmFkZU1vZHVsZVJlcG9ydFtdO1xuXG4gICAgaWYgKHBhcmFsbGVsTW9kdWxlcyAmJiBwbGFuLm1vZHVsZXMubGVuZ3RoID4gMSkge1xuICAgICAgLy8gUEFSQUxMRUwgTU9EVUxFIFBST0NFU1NJTkdcbiAgICAgIG1vZHVsZVJlcG9ydHMgPSBhd2FpdCB0aGlzLnJ1bk1vZHVsZXNJblBhcmFsbGVsKFxuICAgICAgICBwbGFuLm1vZHVsZXMsXG4gICAgICAgIG1vZGUsXG4gICAgICAgIG1vZGVEZWZpbml0aW9uLFxuICAgICAgICBwYXJhbGxlbE1vZHVsZUNvbmN1cnJlbmN5LFxuICAgICAgICBwYXJhbGxlbFZhcmlhbnRzLFxuICAgICAgICBjb250aW51ZU9uRmFpbHVyZSxcbiAgICAgICAgdmFyaWFudFN0YXRzXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTRVFVRU5USUFMIE1PRFVMRSBQUk9DRVNTSU5HIChvcmlnaW5hbCBiZWhhdmlvcilcbiAgICAgIG1vZHVsZVJlcG9ydHMgPSBhd2FpdCB0aGlzLnJ1bk1vZHVsZXNTZXF1ZW50aWFsbHkoXG4gICAgICAgIHBsYW4ubW9kdWxlcyxcbiAgICAgICAgbW9kZSxcbiAgICAgICAgbW9kZURlZmluaXRpb24sXG4gICAgICAgIHBhcmFsbGVsVmFyaWFudHMsXG4gICAgICAgIGNvbnRpbnVlT25GYWlsdXJlLFxuICAgICAgICB2YXJpYW50U3RhdHNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYmFzZVJlcG9ydCA9IHRoaXMuZ2VuZXJhdGVSZXBvcnQob2JqZWN0aXZlKTtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uYmFzZVJlcG9ydCxcbiAgICAgIG1vZGUsXG4gICAgICBjb250aW51ZU9uRmFpbHVyZSxcbiAgICAgIG1vZHVsZXM6IG1vZHVsZVJlcG9ydHMsXG4gICAgICB2YXJpYW50U3RhdHMsXG4gICAgICB2YXJpYW50V29ya3NwYWNlUm9vdHM6IHRoaXMudmFyaWFudFdvcmtzcGFjZVJvb3RzLFxuICAgICAgcmVwb1BvbGljeTogdGhpcy5yZXBvUG9saWN5LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUnVuIG1vZHVsZXMgc2VxdWVudGlhbGx5IChvcmlnaW5hbCBiZWhhdmlvcilcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgcnVuTW9kdWxlc1NlcXVlbnRpYWxseShcbiAgICBtb2R1bGVzOiBSZXBvVXBncmFkZU1vZHVsZVtdLFxuICAgIG1vZGU6IFJlcG9VcGdyYWRlTW9kZSxcbiAgICBtb2RlRGVmaW5pdGlvbjogUmVwb1VwZ3JhZGVNb2RlRGVmaW5pdGlvbixcbiAgICBwYXJhbGxlbFZhcmlhbnRzOiBib29sZWFuLFxuICAgIGNvbnRpbnVlT25GYWlsdXJlOiBib29sZWFuLFxuICAgIHZhcmlhbnRTdGF0czogVmFyaWFudFdpblN0YXRzXG4gICk6IFByb21pc2U8VXBncmFkZU1vZHVsZVJlcG9ydFtdPiB7XG4gICAgY29uc3QgbW9kdWxlUmVwb3J0czogVXBncmFkZU1vZHVsZVJlcG9ydFtdID0gW107XG4gICAgbGV0IGhhbHRlZCA9IGZhbHNlO1xuXG4gICAgZm9yIChjb25zdCBtb2R1bGUgb2YgbW9kdWxlcykge1xuICAgICAgaWYgKGhhbHRlZCkge1xuICAgICAgICBtb2R1bGVSZXBvcnRzLnB1c2goe1xuICAgICAgICAgIGlkOiBtb2R1bGUuaWQsXG4gICAgICAgICAgbGFiZWw6IG1vZHVsZS5sYWJlbCxcbiAgICAgICAgICBzY29wZTogbW9kdWxlLnNjb3BlLFxuICAgICAgICAgIHN0ZXBzOiBbXSxcbiAgICAgICAgICBzdGF0dXM6ICdza2lwcGVkJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBtb2R1bGVSZXBvcnQgPSBhd2FpdCB0aGlzLnByb2Nlc3NNb2R1bGUobW9kdWxlLCBtb2RlLCBtb2RlRGVmaW5pdGlvbiwgcGFyYWxsZWxWYXJpYW50cywgdmFyaWFudFN0YXRzLCBjb250aW51ZU9uRmFpbHVyZSk7XG4gICAgICBtb2R1bGVSZXBvcnRzLnB1c2gobW9kdWxlUmVwb3J0KTtcblxuICAgICAgaWYgKG1vZHVsZVJlcG9ydC5zdGF0dXMgPT09ICdmYWlsZWQnICYmICFjb250aW51ZU9uRmFpbHVyZSkge1xuICAgICAgICBoYWx0ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBtb2R1bGVSZXBvcnRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFJ1biBtb2R1bGVzIGluIHBhcmFsbGVsIHVzaW5nIHRoZSBQYXJhbGxlbEV4ZWN1dG9yXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHJ1bk1vZHVsZXNJblBhcmFsbGVsKFxuICAgIG1vZHVsZXM6IFJlcG9VcGdyYWRlTW9kdWxlW10sXG4gICAgbW9kZTogUmVwb1VwZ3JhZGVNb2RlLFxuICAgIG1vZGVEZWZpbml0aW9uOiBSZXBvVXBncmFkZU1vZGVEZWZpbml0aW9uLFxuICAgIGNvbmN1cnJlbmN5OiBudW1iZXIsXG4gICAgcGFyYWxsZWxWYXJpYW50czogYm9vbGVhbixcbiAgICBjb250aW51ZU9uRmFpbHVyZTogYm9vbGVhbixcbiAgICB2YXJpYW50U3RhdHM6IFZhcmlhbnRXaW5TdGF0c1xuICApOiBQcm9taXNlPFVwZ3JhZGVNb2R1bGVSZXBvcnRbXT4ge1xuICAgIGlmICghdGhpcy5wYXJhbGxlbENvb3JkaW5hdG9yKSB7XG4gICAgICB0aGlzLnBhcmFsbGVsQ29vcmRpbmF0b3IgPSBuZXcgUGFyYWxsZWxDb29yZGluYXRvcigpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlcG9ydHMgPSBhd2FpdCB0aGlzLnBhcmFsbGVsQ29vcmRpbmF0b3IucnVuTW9kdWxlcyhcbiAgICAgIHtcbiAgICAgICAgY29uY3VycmVuY3ksXG4gICAgICAgIG1vZGUsXG4gICAgICAgIG1vZGVEZWZpbml0aW9uLFxuICAgICAgICBwYXJhbGxlbFZhcmlhbnRzLFxuICAgICAgICBjb250aW51ZU9uRmFpbHVyZSxcbiAgICAgICAgdmFyaWFudFN0YXRzLFxuICAgICAgICBwcm9jZXNzTW9kdWxlOiAobW9kdWxlKSA9PiB0aGlzLnByb2Nlc3NNb2R1bGUobW9kdWxlLCBtb2RlLCBtb2RlRGVmaW5pdGlvbiwgcGFyYWxsZWxWYXJpYW50cywgdmFyaWFudFN0YXRzLCBjb250aW51ZU9uRmFpbHVyZSksXG4gICAgICAgIGVtaXQ6IChldmVudCkgPT4gdGhpcy5lbWl0KGV2ZW50KSxcbiAgICAgIH0sXG4gICAgICBtb2R1bGVzXG4gICAgKTtcblxuICAgIGlmICghY29udGludWVPbkZhaWx1cmUpIHtcbiAgICAgIGNvbnN0IGZpcnN0RmFpbHVyZSA9IHJlcG9ydHMuZmluZEluZGV4KChyZXBvcnQpID0+IHJlcG9ydC5zdGF0dXMgPT09ICdmYWlsZWQnKTtcbiAgICAgIGlmIChmaXJzdEZhaWx1cmUgPj0gMCkge1xuICAgICAgICByZXR1cm4gcmVwb3J0cy5zbGljZSgwLCBmaXJzdEZhaWx1cmUgKyAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVwb3J0cztcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIGEgc2luZ2xlIG1vZHVsZSAoY2FuIGJlIGNhbGxlZCBpbiBwYXJhbGxlbCBvciBzZXF1ZW50aWFsbHkpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHByb2Nlc3NNb2R1bGUoXG4gICAgbW9kdWxlOiBSZXBvVXBncmFkZU1vZHVsZSxcbiAgICBtb2RlOiBSZXBvVXBncmFkZU1vZGUsXG4gICAgbW9kZURlZmluaXRpb246IFJlcG9VcGdyYWRlTW9kZURlZmluaXRpb24sXG4gICAgcGFyYWxsZWxWYXJpYW50czogYm9vbGVhbixcbiAgICB2YXJpYW50U3RhdHM6IFZhcmlhbnRXaW5TdGF0cyxcbiAgICBjb250aW51ZU9uRmFpbHVyZSA9IHRydWVcbiAgKTogUHJvbWlzZTxVcGdyYWRlTW9kdWxlUmVwb3J0PiB7XG4gICAgY29uc3QgbW9kdWxlU3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIHRoaXMuZW1pdCh7XG4gICAgICB0eXBlOiAndXBncmFkZS5tb2R1bGUuc3RhcnQnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgZGF0YTogeyBtb2R1bGVJZDogbW9kdWxlLmlkLCBsYWJlbDogbW9kdWxlLmxhYmVsLCBzY29wZTogbW9kdWxlLnNjb3BlLCBtb2RlIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2R1bGVSZXBvcnQ6IFVwZ3JhZGVNb2R1bGVSZXBvcnQgPSB7XG4gICAgICBpZDogbW9kdWxlLmlkLFxuICAgICAgbGFiZWw6IG1vZHVsZS5sYWJlbCxcbiAgICAgIHNjb3BlOiBtb2R1bGUuc2NvcGUsXG4gICAgICBjb2RlbW9kQ29tbWFuZHM6IG1vZHVsZS5jb2RlbW9kQ29tbWFuZHMsXG4gICAgICB2YWxpZGF0aW9uQ29tbWFuZHM6IG1vZHVsZS52YWxpZGF0aW9uQ29tbWFuZHMsXG4gICAgICBzdGVwczogW10sXG4gICAgICBzdGF0dXM6ICdjb21wbGV0ZWQnLFxuICAgIH07XG5cbiAgICBmb3IgKGNvbnN0IHN0ZXAgb2YgbW9kdWxlLnN0ZXBzKSB7XG4gICAgICBjb25zdCBvdXRjb21lID0gYXdhaXQgdGhpcy5ydW5TdGVwKG1vZHVsZSwgc3RlcCwgbW9kZSwgcGFyYWxsZWxWYXJpYW50cyk7XG4gICAgICBtb2R1bGVSZXBvcnQuc3RlcHMucHVzaChvdXRjb21lKTtcbiAgICAgIHRoaXMudXBkYXRlVmFyaWFudFN0YXRzKHZhcmlhbnRTdGF0cywgb3V0Y29tZSwgbW9kZURlZmluaXRpb24pO1xuXG4gICAgICBpZiAoIW91dGNvbWUud2lubmVyLnN1Y2Nlc3MpIHtcbiAgICAgICAgbW9kdWxlUmVwb3J0LnN0YXR1cyA9ICdmYWlsZWQnO1xuICAgICAgICAvLyBTdG9wIHByb2Nlc3NpbmcgdGhpcyBtb2R1bGUncyBzdGVwcyBpZiBjb250aW51ZU9uRmFpbHVyZSBpcyBmYWxzZVxuICAgICAgICBpZiAoIWNvbnRpbnVlT25GYWlsdXJlKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmVtaXQoe1xuICAgICAgdHlwZTogJ3VwZ3JhZGUubW9kdWxlLmNvbXBsZXRlJyxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICAgICAgc3RhdHVzOiBtb2R1bGVSZXBvcnQuc3RhdHVzLFxuICAgICAgICBkdXJhdGlvbk1zOiBEYXRlLm5vdygpIC0gbW9kdWxlU3RhcnQsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG1vZHVsZVJlcG9ydDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcnVuU3RlcChcbiAgICBtb2R1bGU6IFJlcG9VcGdyYWRlTW9kdWxlLFxuICAgIHN0ZXA6IFJlcG9VcGdyYWRlU3RlcCxcbiAgICBtb2RlOiBSZXBvVXBncmFkZU1vZGUsXG4gICAgcGFyYWxsZWxWYXJpYW50cyA9IHRydWVcbiAgKTogUHJvbWlzZTxVcGdyYWRlU3RlcE91dGNvbWU+IHtcbiAgICBjb25zdCBzdGVwU3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IG1vZGVEZWZpbml0aW9uID0gZ2V0TW9kZURlZmluaXRpb24obW9kZSk7XG4gICAgdGhpcy5lbWl0KHtcbiAgICAgIHR5cGU6ICd1cGdyYWRlLnN0ZXAuc3RhcnQnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgZGF0YTogeyBtb2R1bGVJZDogbW9kdWxlLmlkLCBzdGVwSWQ6IHN0ZXAuaWQsIHZhcmlhbnQ6ICdwcmltYXJ5JywgbW9kZSwgcGFyYWxsZWxWYXJpYW50cyB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgdmFyaWFudFJlc3VsdHMgPSBhd2FpdCBleGVjdXRlVmFyaWFudHMoe1xuICAgICAgbW9kdWxlLFxuICAgICAgc3RlcCxcbiAgICAgIG1vZGUsXG4gICAgICBtb2RlRGVmaW5pdGlvbixcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgcGFyYWxsZWxWYXJpYW50cyxcbiAgICAgICAgdmFyaWFudFdvcmtzcGFjZVJvb3RzOiB0aGlzLnZhcmlhbnRXb3Jrc3BhY2VSb290cyxcbiAgICAgICAgcmVwb1BvbGljeTogdGhpcy5yZXBvUG9saWN5LFxuICAgICAgfSxcbiAgICAgIGV4ZWN1dGVWYXJpYW50OiAoaW5wdXQpID0+IHRoaXMuc2FmZUV4ZWN1dGVWYXJpYW50KGlucHV0KSxcbiAgICAgIGVtaXQ6IChldmVudCkgPT4gdGhpcy5lbWl0KGV2ZW50KSxcbiAgICB9KTtcbiAgICBjb25zdCBwcmltYXJ5ID0gdmFyaWFudFJlc3VsdHMucHJpbWFyeSBhcyBVcGdyYWRlU3RlcFJlc3VsdDtcbiAgICBjb25zdCByZWZpbmVyID0gdmFyaWFudFJlc3VsdHMucmVmaW5lcjtcblxuICAgIGNvbnN0IHRvdXJuYW1lbnRPdXRjb21lID0gdGhpcy5ldmFsdWF0ZVRvdXJuYW1lbnRPdXRjb21lKG1vZHVsZSwgc3RlcCwgbW9kZURlZmluaXRpb24sIHByaW1hcnksIHJlZmluZXIpO1xuICAgIGlmICh0b3VybmFtZW50T3V0Y29tZSkge1xuICAgICAgdGhpcy5hdHRhY2hUb3VybmFtZW50QnJlYWtkb3duKHZhcmlhbnRSZXN1bHRzLCB0b3VybmFtZW50T3V0Y29tZSk7XG4gICAgfVxuICAgIGNvbnN0IHsgd2lubmVyLCB3aW5uZXJWYXJpYW50IH0gPSByZXNvbHZlV2lubmVyU3RyYXRlZ3koXG4gICAgICB7IG1vZGVEZWZpbml0aW9uLCB2YXJpYW50UmVzdWx0cywgdG91cm5hbWVudE91dGNvbWUgfSxcbiAgICAgIChkZWZpbml0aW9uLCBwcmltYXJ5UmVzdWx0LCByZWZpbmVyUmVzdWx0KSA9PiB0aGlzLnBpY2tXaW5uZXIoZGVmaW5pdGlvbiwgcHJpbWFyeVJlc3VsdCwgcmVmaW5lclJlc3VsdClcbiAgICApO1xuXG4gICAgdGhpcy5yZWNvcmRPdXRjb21lQXJ0aWZhY3RzKG1vZHVsZSwgc3RlcCwgd2lubmVyLCB3aW5uZXJWYXJpYW50KTtcblxuICAgIGNvbnN0IHByaW1hcnlTY29yZSA9IHByaW1hcnkudG91cm5hbWVudD8uYWdncmVnYXRlU2NvcmUgPz8gcHJpbWFyeS5zY29yZTtcbiAgICBjb25zdCByZWZpbmVyU2NvcmUgPSByZWZpbmVyPy50b3VybmFtZW50Py5hZ2dyZWdhdGVTY29yZSA/PyByZWZpbmVyPy5zY29yZTtcbiAgICBjb25zdCBwcmltYXJ5QWNjdXJhY3kgPSBwcmltYXJ5LnRvdXJuYW1lbnQ/Lmh1bWFuQWNjdXJhY3kgPz8gcHJpbWFyeS5odW1hbkFjY3VyYWN5O1xuICAgIGNvbnN0IHJlZmluZXJBY2N1cmFjeSA9IHJlZmluZXI/LnRvdXJuYW1lbnQ/Lmh1bWFuQWNjdXJhY3kgPz8gcmVmaW5lcj8uaHVtYW5BY2N1cmFjeTtcblxuICAgIHRoaXMuZW1pdCh7XG4gICAgICB0eXBlOiAndXBncmFkZS5zdGVwLmNvbXBsZXRlJyxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICAgICAgc3RlcElkOiBzdGVwLmlkLFxuICAgICAgICB2YXJpYW50OiB3aW5uZXJWYXJpYW50LFxuICAgICAgICBzdWNjZXNzOiB3aW5uZXIuc3VjY2VzcyxcbiAgICAgICAgLy8gSW5jbHVkZSBvdXRjb21lIGRldGFpbHMgZm9yIFVJIHNjb3JpbmdcbiAgICAgICAgcHJpbWFyeVNjb3JlLFxuICAgICAgICBwcmltYXJ5U3VjY2VzczogcHJpbWFyeS5zdWNjZXNzLFxuICAgICAgICByZWZpbmVyU2NvcmUsXG4gICAgICAgIHJlZmluZXJTdWNjZXNzOiByZWZpbmVyPy5zdWNjZXNzLFxuICAgICAgICB3aW5uZXJWYXJpYW50LFxuICAgICAgICBwcmltYXJ5QWNjdXJhY3ksXG4gICAgICAgIHJlZmluZXJBY2N1cmFjeSxcbiAgICAgICAgdG91cm5hbWVudFJhbmtpbmdzOiB0b3VybmFtZW50T3V0Y29tZT8ucmFua2VkLFxuICAgICAgICBkdXJhdGlvbk1zOiBEYXRlLm5vdygpIC0gc3RlcFN0YXJ0LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdGVwSWQ6IHN0ZXAuaWQsXG4gICAgICBpbnRlbnQ6IHN0ZXAuaW50ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHN0ZXAuZGVzY3JpcHRpb24sXG4gICAgICBwcmltYXJ5LFxuICAgICAgcmVmaW5lcixcbiAgICAgIHdpbm5lcixcbiAgICAgIHdpbm5lclZhcmlhbnQsXG4gICAgICBzdGF0dXM6IHdpbm5lci5zdWNjZXNzID8gJ2NvbXBsZXRlZCcgOiAnZmFpbGVkJyxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBldmFsdWF0ZVRvdXJuYW1lbnRPdXRjb21lKFxuICAgIG1vZHVsZTogUmVwb1VwZ3JhZGVNb2R1bGUsXG4gICAgc3RlcDogUmVwb1VwZ3JhZGVTdGVwLFxuICAgIG1vZGVEZWZpbml0aW9uOiBSZXBvVXBncmFkZU1vZGVEZWZpbml0aW9uLFxuICAgIHByaW1hcnk6IFVwZ3JhZGVTdGVwUmVzdWx0LFxuICAgIHJlZmluZXI/OiBVcGdyYWRlU3RlcFJlc3VsdFxuICApOiBUb3VybmFtZW50T3V0Y29tZSB8IG51bGwge1xuICAgIC8vIE9ubHkgcnVuIHRvdXJuYW1lbnRzIHdoZW4gdGhlIG1vZGUgZXhwbGljaXRseSBzdXBwb3J0cyBpdCB0byBhdm9pZCBvdmVyaGVhZCBhbmQga2VlcFxuICAgIC8vIGNvbnRpbnVvdXMgbW9kZXMgZGV0ZXJtaW5pc3RpYy5cbiAgICBpZiAobW9kZURlZmluaXRpb24uaWQgIT09ICdkdWFsLXJsLXRvdXJuYW1lbnQnKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBGYXN0IGV4aXRzOiBpZiBvbmx5IG9uZSB2YXJpYW50IHN1Y2NlZWRlZCwgYXZvaWQgdG91cm5hbWVudCBvdmVyaGVhZFxuICAgIGlmIChwcmltYXJ5LnN1Y2Nlc3MgJiYgKCFyZWZpbmVyIHx8ICFyZWZpbmVyLnN1Y2Nlc3MpKSB7XG4gICAgICBwcmltYXJ5Lmh1bWFuQWNjdXJhY3kgPSAxO1xuICAgICAgaWYgKHJlZmluZXIpIHJlZmluZXIuaHVtYW5BY2N1cmFjeSA9IDA7XG4gICAgICB0aGlzLnVwZGF0ZVJlcG9UeXBlVGVsZW1ldHJ5KGdldFJlcG9UeXBlRnJvbU1vZHVsZShtb2R1bGUpLCAncHJpbWFyeScpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChyZWZpbmVyPy5zdWNjZXNzICYmICFwcmltYXJ5LnN1Y2Nlc3MpIHtcbiAgICAgIHJlZmluZXIuaHVtYW5BY2N1cmFjeSA9IDE7XG4gICAgICBwcmltYXJ5Lmh1bWFuQWNjdXJhY3kgPSAwO1xuICAgICAgdGhpcy51cGRhdGVSZXBvVHlwZVRlbGVtZXRyeShnZXRSZXBvVHlwZUZyb21Nb2R1bGUobW9kdWxlKSwgJ3JlZmluZXInKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIElmIG5laXRoZXIgdmFyaWFudCBzdWNjZWVkZWQsIHNraXAgdG91cm5hbWVudCBhZ2dyZWdhdGlvbiBmb3IgZWZmaWNpZW5jeVxuICAgIGlmICghcHJpbWFyeS5zdWNjZXNzICYmICghcmVmaW5lciB8fCAhcmVmaW5lci5zdWNjZXNzKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgY2FuZGlkYXRlczogVG91cm5hbWVudENhbmRpZGF0ZVtdID0gW1xuICAgICAgdGhpcy5idWlsZFRvdXJuYW1lbnRDYW5kaWRhdGUoJ3ByaW1hcnknLCBwcmltYXJ5LCBtb2RlRGVmaW5pdGlvbiksXG4gICAgXTtcblxuICAgIGlmIChyZWZpbmVyKSB7XG4gICAgICBjYW5kaWRhdGVzLnB1c2godGhpcy5idWlsZFRvdXJuYW1lbnRDYW5kaWRhdGUoJ3JlZmluZXInLCByZWZpbmVyLCBtb2RlRGVmaW5pdGlvbikpO1xuICAgIH1cblxuICAgIGNvbnN0IHRhc2s6IFRvdXJuYW1lbnRUYXNrID0ge1xuICAgICAgaWQ6IGAke21vZHVsZS5pZH06JHtzdGVwLmlkfWAsXG4gICAgICBnb2FsOiBzdGVwLmRlc2NyaXB0aW9uLFxuICAgICAgY29uc3RyYWludHM6IG1vZHVsZS5zY29wZSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIG1vZHVsZTogbW9kdWxlLmxhYmVsLFxuICAgICAgICBvYmplY3RpdmU6IHRoaXMub2JqZWN0aXZlLFxuICAgICAgICByZXBvUG9saWN5OiB0aGlzLnJlcG9Qb2xpY3ksXG4gICAgICAgIGludGVudDogc3RlcC5pbnRlbnQsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCBldmFsdWF0b3JDb25maWcgPSBidWlsZEV2YWx1YXRvckNvbmZpZyhtb2R1bGUsIFJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLnJlcG9UeXBlVGVsZW1ldHJ5KTtcblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gcnVuRHVhbFRvdXJuYW1lbnQodGFzaywgY2FuZGlkYXRlcywge1xuICAgICAgICByZXdhcmRXZWlnaHRzOiBldmFsdWF0b3JDb25maWcucmV3YXJkV2VpZ2h0cyxcbiAgICAgICAgZXZhbHVhdG9yczogZXZhbHVhdG9yQ29uZmlnLmV2YWx1YXRvcnMsXG4gICAgICAgIG1heENhbmRpZGF0ZXM6IDgsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRUb3VybmFtZW50Q2FuZGlkYXRlKFxuICAgIHZhcmlhbnQ6IFVwZ3JhZGVWYXJpYW50LFxuICAgIHJlc3VsdDogVXBncmFkZVN0ZXBSZXN1bHQsXG4gICAgbW9kZURlZmluaXRpb246IFJlcG9VcGdyYWRlTW9kZURlZmluaXRpb25cbiAgKTogVG91cm5hbWVudENhbmRpZGF0ZSB7XG4gICAgY29uc3Qgc2lnbmFscyA9IHJlc3VsdC5yZXdhcmRTaWduYWxzID8/IHt9O1xuICAgIGNvbnN0IHJhd1Jld2FyZCA9IHR5cGVvZiByZXN1bHQuc2NvcmUgPT09ICdudW1iZXInID8gY2xhbXBTY29yZShyZXN1bHQuc2NvcmUpIDogMDtcbiAgICBjb25zdCBhZGp1c3RlZFJld2FyZCA9XG4gICAgICB2YXJpYW50ID09PSAncmVmaW5lcicgPyBjbGFtcFNjb3JlKHJhd1Jld2FyZCArIChtb2RlRGVmaW5pdGlvbi5yZWZpbmVyQmlhcyA/PyAwKSkgOiByYXdSZXdhcmQ7XG5cbiAgICBjb25zdCBldmFsdWF0b3JTY29yZXM6IFRvdXJuYW1lbnRDYW5kaWRhdGVbJ2V2YWx1YXRvclNjb3JlcyddID0gW1xuICAgICAgeyBldmFsdWF0b3JJZDogJ3Jld2FyZC1zaWduYWwnLCBzY29yZTogYWRqdXN0ZWRSZXdhcmQsIHdlaWdodDogMSB9LFxuICAgICAgeyBldmFsdWF0b3JJZDogJ2hhcmQtbWV0cmljcycsIHNjb3JlOiBzaWduYWxzLmV4ZWN1dGlvblN1Y2Nlc3MgPz8gKHJlc3VsdC5zdWNjZXNzID8gMSA6IDApLCB3ZWlnaHQ6IDEuMSB9LFxuICAgIF07XG5cbiAgICBpZiAodHlwZW9mIHNpZ25hbHMudGVzdHNQYXNzZWQgPT09ICdudW1iZXInKSB7XG4gICAgICBldmFsdWF0b3JTY29yZXMucHVzaCh7IGV2YWx1YXRvcklkOiAndGVzdHMnLCBzY29yZTogc2lnbmFscy50ZXN0c1Bhc3NlZCwgd2VpZ2h0OiAwLjggfSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2lnbmFscy5zdGF0aWNBbmFseXNpcyA9PT0gJ251bWJlcicpIHtcbiAgICAgIGV2YWx1YXRvclNjb3Jlcy5wdXNoKHsgZXZhbHVhdG9ySWQ6ICdzdGF0aWMtYW5hbHlzaXMnLCBzY29yZTogc2lnbmFscy5zdGF0aWNBbmFseXNpcywgd2VpZ2h0OiAwLjYgfSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2lnbmFscy5jb2RlUXVhbGl0eSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHNpZ25hbHMuYmxhc3RSYWRpdXMgPT09ICdudW1iZXInKSB7XG4gICAgICBjb25zdCBxdWFsaXR5U2NvcmUgPSBhdmVyYWdlRGVmaW5lZChbXG4gICAgICAgIHNpZ25hbHMuY29kZVF1YWxpdHksXG4gICAgICAgIHNpZ25hbHMuYmxhc3RSYWRpdXMsXG4gICAgICAgIHNpZ25hbHMuc3RhdGljQW5hbHlzaXMsXG4gICAgICBdKTtcbiAgICAgIGlmICghTnVtYmVyLmlzTmFOKHF1YWxpdHlTY29yZSkpIHtcbiAgICAgICAgZXZhbHVhdG9yU2NvcmVzLnB1c2goeyBldmFsdWF0b3JJZDogJ3F1YWxpdHknLCBzY29yZTogcXVhbGl0eVNjb3JlLCB3ZWlnaHQ6IDAuOSB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IHZhcmlhbnQsXG4gICAgICBwb2xpY3lJZDogdmFyaWFudCxcbiAgICAgIHBhdGNoU3VtbWFyeTogcmVzdWx0LnN1bW1hcnksXG4gICAgICBtZXRyaWNzOiB7XG4gICAgICAgIGV4ZWN1dGlvblN1Y2Nlc3M6IHNpZ25hbHMuZXhlY3V0aW9uU3VjY2VzcyA/PyAocmVzdWx0LnN1Y2Nlc3MgPyAxIDogMCksXG4gICAgICAgIHRlc3RzUGFzc2VkOiBzaWduYWxzLnRlc3RzUGFzc2VkLFxuICAgICAgICBzdGF0aWNBbmFseXNpczogc2lnbmFscy5zdGF0aWNBbmFseXNpcyxcbiAgICAgICAgY29kZVF1YWxpdHk6IHNpZ25hbHMuY29kZVF1YWxpdHksXG4gICAgICAgIGJsYXN0UmFkaXVzOiBzaWduYWxzLmJsYXN0UmFkaXVzLFxuICAgICAgICBzcGVlZEJvbnVzOiBzaWduYWxzLnNwZWVkQm9udXMsXG4gICAgICB9LFxuICAgICAgc2lnbmFsczoge1xuICAgICAgICByZXdhcmRNb2RlbFNjb3JlOiBhZGp1c3RlZFJld2FyZCxcbiAgICAgICAgc2VsZkFzc2Vzc21lbnQ6IHNpZ25hbHMuc2VsZkFzc2Vzc21lbnQsXG4gICAgICB9LFxuICAgICAgZXZhbHVhdG9yU2NvcmVzOiBldmFsdWF0b3JTY29yZXMgPz8gW10sXG4gICAgICByYXdPdXRwdXQ6IHJlc3VsdC5kZXRhaWwsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXR0YWNoVG91cm5hbWVudEJyZWFrZG93bihcbiAgICB2YXJpYW50UmVzdWx0czogUGFydGlhbDxSZWNvcmQ8VXBncmFkZVZhcmlhbnQsIFVwZ3JhZGVTdGVwUmVzdWx0Pj4sXG4gICAgb3V0Y29tZTogVG91cm5hbWVudE91dGNvbWVcbiAgKTogdm9pZCB7XG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiBvdXRjb21lLnJhbmtlZCkge1xuICAgICAgY29uc3QgdmFyaWFudCA9IGVudHJ5LmNhbmRpZGF0ZUlkIGFzIFVwZ3JhZGVWYXJpYW50O1xuICAgICAgY29uc3QgdGFyZ2V0ID0gdmFyaWFudFJlc3VsdHNbdmFyaWFudF07XG4gICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgIHRhcmdldC50b3VybmFtZW50ID0gZW50cnk7XG4gICAgICAgIHRhcmdldC5odW1hbkFjY3VyYWN5ID0gZW50cnkuaHVtYW5BY2N1cmFjeTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gVXBkYXRlIHRlbGVtZXRyeSBiYXNlZCBvbiB3aW5uZXIgdG8gYXV0by10dW5lIHBlciByZXBvIHR5cGVcbiAgICBjb25zdCB0b3AgPSBvdXRjb21lLnJhbmtlZFswXTtcbiAgICBpZiAodG9wKSB7XG4gICAgICBjb25zdCByZXBvVHlwZSA9IGdldFJlcG9UeXBlRnJvbU91dGNvbWVNZXRhZGF0YShvdXRjb21lLnRhc2spO1xuICAgICAgdGhpcy51cGRhdGVSZXBvVHlwZVRlbGVtZXRyeShyZXBvVHlwZSwgdG9wLmNhbmRpZGF0ZUlkIGFzIFVwZ3JhZGVWYXJpYW50KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNhZmVFeGVjdXRlVmFyaWFudChpbnB1dDogVXBncmFkZVN0ZXBFeGVjdXRpb25JbnB1dCk6IFByb21pc2U8VXBncmFkZVN0ZXBSZXN1bHQ+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0b3IoaW5wdXQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHN1bW1hcnk6ICdFeGVjdXRpb24gZmFpbGVkJyxcbiAgICAgICAgZGV0YWlsOiBtZXNzYWdlLFxuICAgICAgICBzY29yZTogMCxcbiAgICAgICAgZHVyYXRpb25NczogMCxcbiAgICAgICAgZXhlY3V0aW9uOiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgb3V0cHV0OiAnRXhlY3V0aW9uIGZhaWxlZCcsXG4gICAgICAgICAgZHVyYXRpb246IDAsXG4gICAgICAgICAgY29tbWFuZDogYCR7aW5wdXQubW9kdWxlLmlkfS8ke2lucHV0LnN0ZXAuaWR9LyR7aW5wdXQudmFyaWFudH1gLFxuICAgICAgICAgIGVycm9yOiBtZXNzYWdlLFxuICAgICAgICB9LFxuICAgICAgICBub3RlczogWydFeGVjdXRvciB0aHJldyBhbiBlcnJvciddLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHBpY2tXaW5uZXIoXG4gICAgZGVmaW5pdGlvbjogUmVwb1VwZ3JhZGVNb2RlRGVmaW5pdGlvbixcbiAgICBwcmltYXJ5OiBVcGdyYWRlU3RlcFJlc3VsdCxcbiAgICByZWZpbmVyPzogVXBncmFkZVN0ZXBSZXN1bHRcbiAgKTogeyB3aW5uZXI6IFVwZ3JhZGVTdGVwUmVzdWx0OyB3aW5uZXJWYXJpYW50OiBVcGdyYWRlVmFyaWFudCB9IHtcbiAgICBpZiAoIXJlZmluZXIgfHwgIWRlZmluaXRpb24udmFyaWFudHMuaW5jbHVkZXMoJ3JlZmluZXInKSkge1xuICAgICAgcmV0dXJuIHsgd2lubmVyOiBwcmltYXJ5LCB3aW5uZXJWYXJpYW50OiAncHJpbWFyeScgfTtcbiAgICB9XG5cbiAgICBpZiAocmVmaW5lci5zdWNjZXNzICYmICFwcmltYXJ5LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiB7IHdpbm5lcjogcmVmaW5lciwgd2lubmVyVmFyaWFudDogJ3JlZmluZXInIH07XG4gICAgfVxuICAgIGlmIChwcmltYXJ5LnN1Y2Nlc3MgJiYgIXJlZmluZXIuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIHsgd2lubmVyOiBwcmltYXJ5LCB3aW5uZXJWYXJpYW50OiAncHJpbWFyeScgfTtcbiAgICB9XG5cbiAgICBjb25zdCBwcmltYXJ5U2NvcmUgPSB0eXBlb2YgcHJpbWFyeS5zY29yZSA9PT0gJ251bWJlcicgPyBwcmltYXJ5LnNjb3JlIDogMDtcbiAgICBjb25zdCByZWZpbmVyU2NvcmUgPSAodHlwZW9mIHJlZmluZXIuc2NvcmUgPT09ICdudW1iZXInID8gcmVmaW5lci5zY29yZSA6IDApICsgKGRlZmluaXRpb24ucmVmaW5lckJpYXMgPz8gMCk7XG4gICAgY29uc3QgcHJpbWFyeUFjY3VyYWN5ID0gdHlwZW9mIHByaW1hcnkuaHVtYW5BY2N1cmFjeSA9PT0gJ251bWJlcicgPyBwcmltYXJ5Lmh1bWFuQWNjdXJhY3kgOiAwO1xuICAgIGNvbnN0IHJlZmluZXJBY2N1cmFjeSA9IHR5cGVvZiByZWZpbmVyLmh1bWFuQWNjdXJhY3kgPT09ICdudW1iZXInID8gcmVmaW5lci5odW1hbkFjY3VyYWN5IDogMDtcblxuICAgIGlmIChyZWZpbmVyU2NvcmUgPiBwcmltYXJ5U2NvcmUpIHtcbiAgICAgIHJldHVybiB7IHdpbm5lcjogcmVmaW5lciwgd2lubmVyVmFyaWFudDogJ3JlZmluZXInIH07XG4gICAgfVxuICAgIGlmIChwcmltYXJ5U2NvcmUgPiByZWZpbmVyU2NvcmUpIHtcbiAgICAgIHJldHVybiB7IHdpbm5lcjogcHJpbWFyeSwgd2lubmVyVmFyaWFudDogJ3ByaW1hcnknIH07XG4gICAgfVxuXG4gICAgLy8gQWNjdXJhY3ktYXdhcmUgdGllIGJyZWFrXG4gICAgaWYgKHJlZmluZXJBY2N1cmFjeSA+IHByaW1hcnlBY2N1cmFjeSArIDFlLTYpIHtcbiAgICAgIHJldHVybiB7IHdpbm5lcjogcmVmaW5lciwgd2lubmVyVmFyaWFudDogJ3JlZmluZXInIH07XG4gICAgfVxuICAgIGlmIChwcmltYXJ5QWNjdXJhY3kgPiByZWZpbmVyQWNjdXJhY3kgKyAxZS02KSB7XG4gICAgICByZXR1cm4geyB3aW5uZXI6IHByaW1hcnksIHdpbm5lclZhcmlhbnQ6ICdwcmltYXJ5JyB9O1xuICAgIH1cblxuICAgIC8vIFRpZSBicmVha2VyOiBwcmVmZXIgcmVmaW5lciB0byBlbmNvdXJhZ2UgUkwgZXhwbG9yYXRpb25cbiAgICByZXR1cm4geyB3aW5uZXI6IHJlZmluZXIsIHdpbm5lclZhcmlhbnQ6ICdyZWZpbmVyJyB9O1xuICB9XG5cbiAgcHJpdmF0ZSByZWNvcmRPdXRjb21lQXJ0aWZhY3RzKFxuICAgIG1vZHVsZTogUmVwb1VwZ3JhZGVNb2R1bGUsXG4gICAgc3RlcDogUmVwb1VwZ3JhZGVTdGVwLFxuICAgIHJlc3VsdDogVXBncmFkZVN0ZXBSZXN1bHQsXG4gICAgdmFyaWFudDogJ3ByaW1hcnknIHwgJ3JlZmluZXInXG4gICk6IHZvaWQge1xuICAgIGlmIChyZXN1bHQuZmluZGluZ3M/Lmxlbmd0aCkge1xuICAgICAgdGhpcy5maW5kaW5ncy5wdXNoKC4uLnJlc3VsdC5maW5kaW5ncyk7XG4gICAgfVxuXG4gICAgY29uc3QgZXhlY3V0aW9uOiBFeGVjdXRpb25SZXN1bHQgPSByZXN1bHQuZXhlY3V0aW9uID8/IHtcbiAgICAgIHN1Y2Nlc3M6IHJlc3VsdC5zdWNjZXNzLFxuICAgICAgb3V0cHV0OiByZXN1bHQuc3VtbWFyeSxcbiAgICAgIGR1cmF0aW9uOiByZXN1bHQuZHVyYXRpb25NcyA/PyAwLFxuICAgICAgY29tbWFuZDogYCR7bW9kdWxlLmlkfS8ke3N0ZXAuaWR9LyR7dmFyaWFudH1gLFxuICAgICAgZXJyb3I6IHJlc3VsdC5zdWNjZXNzID8gdW5kZWZpbmVkIDogcmVzdWx0LmRldGFpbCA/PyByZXN1bHQuc3VtbWFyeSxcbiAgICB9O1xuXG4gICAgLy8gRW5zdXJlIHdlIG9ubHkgdHJhY2sgYSBzaW5nbGUgd2lubmVyIHJlY29yZCBwZXIgc3RlcCB0byBrZWVwIHJlcG9ydHMgY2xlYW5cbiAgICB0aGlzLnJlc3VsdHMucHVzaChleGVjdXRpb24pO1xuXG4gICAgLy8gVXBkYXRlIHRlbGVtZXRyeSBhZnRlciBlYWNoIHJlY29yZGVkIG91dGNvbWVcbiAgICBjb25zdCByZXBvVHlwZSA9IGdldFJlcG9UeXBlRnJvbU1vZHVsZShtb2R1bGUpO1xuICAgIHRoaXMudXBkYXRlUmVwb1R5cGVUZWxlbWV0cnkocmVwb1R5cGUsIHZhcmlhbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVSZXBvVHlwZVRlbGVtZXRyeShyZXBvVHlwZTogc3RyaW5nLCB3aW5uZXI6IFVwZ3JhZGVWYXJpYW50KTogdm9pZCB7XG4gICAgdXBkYXRlUmVwb1R5cGVUZWxlbWV0cnlNYXAocmVwb1R5cGUsIHdpbm5lcik7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVZhcmlhbnRTdGF0cyhcbiAgICBzdGF0czogVmFyaWFudFdpblN0YXRzLFxuICAgIG91dGNvbWU6IFVwZ3JhZGVTdGVwT3V0Y29tZSxcbiAgICBtb2RlRGVmaW5pdGlvbjogUmVwb1VwZ3JhZGVNb2RlRGVmaW5pdGlvblxuICApOiB2b2lkIHtcbiAgICBzdGF0cy50b3RhbFN0ZXBzICs9IDE7XG4gICAgaWYgKG91dGNvbWUud2lubmVyVmFyaWFudCA9PT0gJ3JlZmluZXInKSB7XG4gICAgICBzdGF0cy5yZWZpbmVyV2lucyArPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0cy5wcmltYXJ5V2lucyArPSAxO1xuICAgIH1cblxuICAgIGlmICghb3V0Y29tZS5yZWZpbmVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcHJpbWFyeVNjb3JlID0gdHlwZW9mIG91dGNvbWUucHJpbWFyeS5zY29yZSA9PT0gJ251bWJlcicgPyBvdXRjb21lLnByaW1hcnkuc2NvcmUgOiAwO1xuICAgIGNvbnN0IHByaW1hcnlUb3VybmFtZW50U2NvcmUgPVxuICAgICAgdHlwZW9mIG91dGNvbWUucHJpbWFyeS50b3VybmFtZW50Py5hZ2dyZWdhdGVTY29yZSA9PT0gJ251bWJlcidcbiAgICAgICAgPyBvdXRjb21lLnByaW1hcnkudG91cm5hbWVudC5hZ2dyZWdhdGVTY29yZVxuICAgICAgICA6IHByaW1hcnlTY29yZTtcbiAgICBjb25zdCByZWZpbmVyU2NvcmVSYXcgPSB0eXBlb2Ygb3V0Y29tZS5yZWZpbmVyLnRvdXJuYW1lbnQ/LmFnZ3JlZ2F0ZVNjb3JlID09PSAnbnVtYmVyJ1xuICAgICAgPyBvdXRjb21lLnJlZmluZXIudG91cm5hbWVudC5hZ2dyZWdhdGVTY29yZVxuICAgICAgOiB0eXBlb2Ygb3V0Y29tZS5yZWZpbmVyLnNjb3JlID09PSAnbnVtYmVyJ1xuICAgICAgICA/IG91dGNvbWUucmVmaW5lci5zY29yZVxuICAgICAgICA6IDA7XG4gICAgY29uc3QgcmVmaW5lclNjb3JlID0gcmVmaW5lclNjb3JlUmF3ICsgKG1vZGVEZWZpbml0aW9uLnJlZmluZXJCaWFzID8/IDApO1xuICAgIGNvbnN0IHNjb3Jlc0Nsb3NlID0gTWF0aC5hYnMocHJpbWFyeVRvdXJuYW1lbnRTY29yZSAtIHJlZmluZXJTY29yZSkgPCAxZS02O1xuICAgIGNvbnN0IGJvdGhTdWNjZWVkZWQgPSBvdXRjb21lLnByaW1hcnkuc3VjY2VzcyAmJiBvdXRjb21lLnJlZmluZXIuc3VjY2VzcztcbiAgICBpZiAoYm90aFN1Y2NlZWRlZCAmJiBzY29yZXNDbG9zZSkge1xuICAgICAgc3RhdHMudGllcyArPSAxO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xhbXBTY29yZSh2YWx1ZTogbnVtYmVyLCBtaW4gPSAwLCBtYXggPSAxKTogbnVtYmVyIHtcbiAgaWYgKCFOdW1iZXIuaXNGaW5pdGUodmFsdWUpKSByZXR1cm4gbWluO1xuICByZXR1cm4gTWF0aC5tYXgobWluLCBNYXRoLm1pbihtYXgsIHZhbHVlKSk7XG59XG5cbmZ1bmN0aW9uIGF2ZXJhZ2VEZWZpbmVkKHZhbHVlczogQXJyYXk8bnVtYmVyIHwgdW5kZWZpbmVkPik6IG51bWJlciB7XG4gIGNvbnN0IG51bXMgPSB2YWx1ZXMuZmlsdGVyKCh2KTogdiBpcyBudW1iZXIgPT4gdHlwZW9mIHYgPT09ICdudW1iZXInKTtcbiAgaWYgKCFudW1zLmxlbmd0aCkgcmV0dXJuIE5hTjtcbiAgY29uc3QgdG90YWwgPSBudW1zLnJlZHVjZSgoc3VtLCB2YWwpID0+IHN1bSArIHZhbCwgMCk7XG4gIHJldHVybiB0b3RhbCAvIG51bXMubGVuZ3RoO1xufVxuXG5mdW5jdGlvbiBnZXRSZXBvVHlwZUZyb21Nb2R1bGUobW9kdWxlOiBSZXBvVXBncmFkZU1vZHVsZSk6IHN0cmluZyB7XG4gIGNvbnN0IHNjb3BlID0gKG1vZHVsZS5zY29wZSB8fCBbXSkuam9pbignICcpLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGxhYmVsID0gKG1vZHVsZS5sYWJlbCB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgaWYgKC9cXGJ0ZXN0fF9fdGVzdHNfX3xzcGVjXFxiL2kudGVzdChzY29wZSkgfHwgL1xcYnRlc3RcXGIvaS50ZXN0KGxhYmVsKSkgcmV0dXJuICd0ZXN0cyc7XG4gIGlmICgvXFxiZG9jcz9cXGIvaS50ZXN0KHNjb3BlKSB8fCAvXFxiZG9jXFxiL2kudGVzdChsYWJlbCkpIHJldHVybiAnZG9jcyc7XG4gIGlmICgvXFxicmVmYWN0b3J8Y2xlYW51cHxzb3VyY2VcXGIvaS50ZXN0KHNjb3BlICsgJyAnICsgbGFiZWwpKSByZXR1cm4gJ3JlZmFjdG9yJztcbiAgcmV0dXJuICdnZW5lcmFsJztcbn1cblxuZnVuY3Rpb24gZ2V0UmVwb1R5cGVGcm9tT3V0Y29tZU1ldGFkYXRhKHRhc2s6IFRvdXJuYW1lbnRUYXNrKTogc3RyaW5nIHtcbiAgY29uc3Qgc2NvcGVUZXh0ID0gQXJyYXkuaXNBcnJheSh0YXNrLmNvbnN0cmFpbnRzKSA/IHRhc2suY29uc3RyYWludHMuam9pbignICcpLnRvTG93ZXJDYXNlKCkgOiAnJztcbiAgY29uc3QgaW50ZW50ID0gdHlwZW9mIHRhc2subWV0YWRhdGE/LmludGVudCA9PT0gJ3N0cmluZycgPyB0YXNrLm1ldGFkYXRhLmludGVudC50b0xvd2VyQ2FzZSgpIDogJyc7XG4gIGlmICgvXFxidGVzdHxfX3Rlc3RzX198c3BlY1xcYi9pLnRlc3Qoc2NvcGVUZXh0KSB8fCAvXFxidGVzdFxcYi9pLnRlc3QoaW50ZW50KSkgcmV0dXJuICd0ZXN0cyc7XG4gIGlmICgvXFxiZG9jXFxiL2kudGVzdChzY29wZVRleHQpIHx8IC9cXGJkb2NcXGIvaS50ZXN0KGludGVudCkpIHJldHVybiAnZG9jcyc7XG4gIGlmICgvXFxicmVmYWN0b3J8Y2xlYW51cFxcYi9pLnRlc3Qoc2NvcGVUZXh0ICsgJyAnICsgaW50ZW50KSkgcmV0dXJuICdyZWZhY3Rvcic7XG4gIHJldHVybiAnZ2VuZXJhbCc7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVJlcG9UeXBlVGVsZW1ldHJ5TWFwKHJlcG9UeXBlOiBzdHJpbmcsIHdpbm5lcjogVXBncmFkZVZhcmlhbnQpOiB2b2lkIHtcbiAgaWYgKFJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLmRpc2FibGVUZWxlbWV0cnlQZXJzaXN0ZW5jZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBlbnN1cmVUZWxlbWV0cnlMb2FkZWQoKTtcbiAgY29uc3QgY3VycmVudCA9IFJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLnJlcG9UeXBlVGVsZW1ldHJ5LmdldChyZXBvVHlwZSkgPz8geyB3aW5zUHJpbWFyeTogMCwgd2luc1JlZmluZXI6IDAgfTtcbiAgY29uc3QgdXBkYXRlZCA9XG4gICAgd2lubmVyID09PSAncHJpbWFyeSdcbiAgICAgID8geyAuLi5jdXJyZW50LCB3aW5zUHJpbWFyeTogY3VycmVudC53aW5zUHJpbWFyeSArIDEgfVxuICAgICAgOiB7IC4uLmN1cnJlbnQsIHdpbnNSZWZpbmVyOiBjdXJyZW50LndpbnNSZWZpbmVyICsgMSB9O1xuICBSZXBvVXBncmFkZU9yY2hlc3RyYXRvci5yZXBvVHlwZVRlbGVtZXRyeS5zZXQocmVwb1R5cGUsIHVwZGF0ZWQpO1xuICBwZXJzaXN0VGVsZW1ldHJ5KCk7XG59XG5cbi8vIFNpbXBsZSBwZXJzaXN0ZW5jZSBvZiByZXBvLXR5cGUgdGVsZW1ldHJ5IHRvIGluZm9ybSBmdXR1cmUgcnVuc1xuY29uc3QgVEVMRU1FVFJZX0RJUiA9IGpvaW4oaG9tZWRpcigpLCAnLmFnaScpO1xuY29uc3QgVEVMRU1FVFJZX0ZJTEUgPSBqb2luKFRFTEVNRVRSWV9ESVIsICdybC10ZWxlbWV0cnkuanNvbicpO1xubGV0IHRlbGVtZXRyeUxvYWRlZCA9IGZhbHNlO1xuXG5mdW5jdGlvbiBlbnN1cmVUZWxlbWV0cnlMb2FkZWQoKTogdm9pZCB7XG4gIGlmIChSZXBvVXBncmFkZU9yY2hlc3RyYXRvci5kaXNhYmxlVGVsZW1ldHJ5UGVyc2lzdGVuY2UpIHJldHVybjtcbiAgaWYgKHRlbGVtZXRyeUxvYWRlZCkgcmV0dXJuO1xuICB0ZWxlbWV0cnlMb2FkZWQgPSB0cnVlO1xuICB0cnkge1xuICAgIGlmICghZXhpc3RzU3luYyhURUxFTUVUUllfRklMRSkpIHJldHVybjtcbiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoVEVMRU1FVFJZX0ZJTEUsICd1dGYtOCcpKTtcbiAgICBpZiAoZGF0YSAmJiB0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICd3aW5zUHJpbWFyeScgaW4gdmFsdWUgJiYgJ3dpbnNSZWZpbmVyJyBpbiB2YWx1ZSkge1xuICAgICAgICAgIFJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLnJlcG9UeXBlVGVsZW1ldHJ5LnNldChrZXksIHtcbiAgICAgICAgICAgIHdpbnNQcmltYXJ5OiBOdW1iZXIoKHZhbHVlIGFzIGFueSkud2luc1ByaW1hcnkpIHx8IDAsXG4gICAgICAgICAgICB3aW5zUmVmaW5lcjogTnVtYmVyKCh2YWx1ZSBhcyBhbnkpLndpbnNSZWZpbmVyKSB8fCAwLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICAvLyBpZ25vcmUgbG9hZCBlcnJvcnNcbiAgfVxufVxuXG5mdW5jdGlvbiBwZXJzaXN0VGVsZW1ldHJ5KCk6IHZvaWQge1xuICBpZiAoUmVwb1VwZ3JhZGVPcmNoZXN0cmF0b3IuZGlzYWJsZVRlbGVtZXRyeVBlcnNpc3RlbmNlKSByZXR1cm47XG4gIHRyeSB7XG4gICAgbWtkaXJTeW5jKFRFTEVNRVRSWV9ESVIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIGNvbnN0IHBheWxvYWQ6IFJlY29yZDxzdHJpbmcsIHsgd2luc1ByaW1hcnk6IG51bWJlcjsgd2luc1JlZmluZXI6IG51bWJlciB9PiA9IHt9O1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIFJlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLnJlcG9UeXBlVGVsZW1ldHJ5LmVudHJpZXMoKSkge1xuICAgICAgcGF5bG9hZFtrZXldID0gdmFsdWU7XG4gICAgfVxuICAgIHdyaXRlRmlsZVN5bmMoVEVMRU1FVFJZX0ZJTEUsIEpTT04uc3RyaW5naWZ5KHBheWxvYWQsIG51bGwsIDIpLCAndXRmLTgnKTtcbiAgfSBjYXRjaCB7XG4gICAgLy8gaWdub3JlIHBlcnNpc3RlbmNlIGVycm9yc1xuICB9XG59XG5cblxuXG5mdW5jdGlvbiBnZXRNb2RlRGVmaW5pdGlvbihtb2RlOiBSZXBvVXBncmFkZU1vZGUpOiBSZXBvVXBncmFkZU1vZGVEZWZpbml0aW9uIHtcbiAgcmV0dXJuIFJFUE9fVVBHUkFERV9NT0RFX0RFRklOSVRJT05TW21vZGVdID8/IFJFUE9fVVBHUkFERV9NT0RFX0RFRklOSVRJT05TWydzaW5nbGUtY29udGludW91cyddO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxvQkFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksZUFBQSxHQUFBSixPQUFBO0FBT0EsSUFBQUssaUJBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLGVBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLG1CQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxvQkFBQSxHQUFBUixPQUFBO0FBQ0EsSUFBQVMsWUFBQSxHQUFBVCxPQUFBO0FBS0E7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
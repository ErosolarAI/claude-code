28ef0f256b5db89e4a1d7e37d3c6959a
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.clearDiscoveredModelsCache = clearDiscoveredModelsCache;
exports.discoverAllModels = discoverAllModels;
exports.getBestModel = getBestModel;
exports.getCachedDiscoveredModels = getCachedDiscoveredModels;
exports.getConfiguredProviders = getConfiguredProviders;
exports.getFirstAvailableProvider = getFirstAvailableProvider;
exports.getLatestModelForProvider = getLatestModelForProvider;
exports.getProvidersStatus = getProvidersStatus;
exports.getUnconfiguredProviders = getUnconfiguredProviders;
exports.inferProviderFromModelId = inferProviderFromModelId;
exports.isProviderConfigured = isProviderConfigured;
exports.quickCheckProviders = quickCheckProviders;
exports.sortModelsByPriority = sortModelsByPriority;
var _nodeFs = require("node:fs");
var _promises = require("node:fs/promises");
var _nodePath = require("node:path");
var _nodeOs = require("node:os");
var _secretStore = require("./secretStore.js");
var _debugLogger = require("../utils/debugLogger.js");
/**
 * Model discovery system for auto-detecting new models from providers.
 *
 * This module queries provider APIs to discover available models and caches
 * them for use alongside the static model schema. It never modifies the
 * static schema - discoveries are stored separately and merged at runtime.
 */

/**
 * Discovered model cache file location
 */
const CACHE_DIR = (0, _nodePath.join)((0, _nodeOs.homedir)(), '.agi');
const CACHE_FILE = (0, _nodePath.join)(CACHE_DIR, 'discovered-models.json');

/**
 * Cache expiration time (24 hours)
 */
const CACHE_EXPIRATION_MS = 24 * 60 * 60 * 1000;

/**
 * Discovered models cache structure
 */

/**
 * Model discovery result for a single provider
 */

/**
 * Complete discovery result
 */

/**
 * Infer a provider from a model ID (best-effort).
 * Used to auto-align provider/model pairs when users override models directly.
 */
function inferProviderFromModelId(model) {
  if (!model) return null;
  const normalized = model.trim().toLowerCase();
  const patterns = [[/^(gpt|o1|o3|codex)/, 'openai'], [/^(claude|opus|sonnet|haiku)/, 'anthropic'], [/^gemini/, 'google'], [/^deepseek/, 'deepseek'], [/^grok/, 'xai'], [/^(llama|mistral|qwen|phi)/, 'ollama'], [/:/, 'ollama'] // Ollama models often include colons (e.g., llama3.2:3b)
  ];
  for (const [pattern, provider] of patterns) {
    if (pattern.test(normalized)) {
      return provider;
    }
  }
  return null;
}

/**
 * Get cached discovered models
 */
function getCachedDiscoveredModels() {
  try {
    if (!(0, _nodeFs.existsSync)(CACHE_FILE)) {
      return [];
    }
    const raw = (0, _nodeFs.readFileSync)(CACHE_FILE, 'utf-8');
    const cache = JSON.parse(raw);

    // Check if cache is expired
    const lastUpdated = new Date(cache.lastUpdated).getTime();
    const now = Date.now();
    if (now - lastUpdated > CACHE_EXPIRATION_MS) {
      return [];
    }
    return cache.models;
  } catch (error) {
    (0, _debugLogger.logDebug)('Failed to read discovered models cache:', (0, _secretStore.safeErrorMessage)(error));
    return [];
  }
}

/**
 * Save discovered models to cache
 */
async function saveDiscoveredModels(models) {
  try {
    await (0, _promises.mkdir)(CACHE_DIR, {
      recursive: true
    });
    const cache = {
      version: '1.0.0',
      lastUpdated: new Date().toISOString(),
      models
    };
    (0, _nodeFs.writeFileSync)(CACHE_FILE, JSON.stringify(cache, null, 2), 'utf-8');
  } catch (error) {
    (0, _debugLogger.logDebug)('Failed to save discovered models cache:', (0, _secretStore.safeErrorMessage)(error));
  }
}

/**
 * Discover models from OpenAI
 */
async function discoverOpenAIModels(apiKey) {
  const provider = 'openai';
  try {
    const response = await fetch('https://api.openai.com/v1/models', {
      headers: {
        'Authorization': `Bearer ${apiKey}`
      }
    });
    if (!response.ok) {
      throw new Error(`API returned ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();

    // Filter for GPT models only and create ModelConfig objects
    const models = data.data.filter(model => {
      // Allow both dash and non-dash variants for newer reasoning SKUs (o1/o3)
      return model.id.startsWith('gpt-') || model.id.startsWith('o1') || model.id.startsWith('o3') || model.id.startsWith('codex-');
    }).map(model => ({
      id: model.id,
      label: model.id,
      provider,
      description: `OpenAI ${model.id} (auto-discovered)`,
      capabilities: ['chat', 'tools', 'streaming']
    }));
    return {
      provider,
      success: true,
      models
    };
  } catch (error) {
    return {
      provider,
      success: false,
      models: [],
      error: error instanceof Error ? error.message : String(error)
    };
  }
}

/**
 * Discover models from Anthropic
 */
async function discoverAnthropicModels(apiKey) {
  const provider = 'anthropic';
  try {
    const response = await fetch('https://api.anthropic.com/v1/models', {
      headers: {
        'x-api-key': apiKey,
        'anthropic-version': '2023-06-01'
      }
    });
    if (!response.ok) {
      throw new Error(`API returned ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    const models = data.data.filter(model => model.type === 'model').map(model => ({
      id: model.id,
      label: model.display_name || model.id,
      provider,
      description: `Anthropic ${model.display_name || model.id} (auto-discovered)`,
      capabilities: ['chat', 'reasoning', 'tools', 'streaming']
    }));
    return {
      provider,
      success: true,
      models
    };
  } catch (error) {
    return {
      provider,
      success: false,
      models: [],
      error: error instanceof Error ? error.message : String(error)
    };
  }
}

/**
 * Discover models from Google Gemini
 * Note: Google's models API often requires special permissions.
 * Falls back to known models if API access fails.
 */
async function discoverGoogleModels(apiKey) {
  const provider = 'google';

  // Known Google Gemini models (fallback if API doesn't work) - Updated Dec 2025
  const knownModels = [{
    id: 'gemini-3.0-pro',
    label: 'Gemini 3.0 Pro',
    provider,
    description: 'Latest Gemini with best reasoning and coding',
    capabilities: ['chat', 'reasoning', 'tools', 'streaming', 'multimodal']
  }, {
    id: 'gemini-3.0-flash',
    label: 'Gemini 3.0 Flash',
    provider,
    description: 'Fast Gemini 3.0 model',
    capabilities: ['chat', 'reasoning', 'tools', 'streaming', 'multimodal']
  }, {
    id: 'gemini-2.5-pro',
    label: 'Gemini 2.5 Pro',
    provider,
    description: 'Capable Gemini model with advanced reasoning',
    capabilities: ['chat', 'reasoning', 'tools', 'streaming', 'multimodal']
  }, {
    id: 'gemini-2.5-flash',
    label: 'Gemini 2.5 Flash',
    provider,
    description: 'Fast Gemini 2.5 with reasoning',
    capabilities: ['chat', 'reasoning', 'tools', 'streaming', 'multimodal']
  }, {
    id: 'gemini-2.0-flash',
    label: 'Gemini 2.0 Flash',
    provider,
    description: 'Gemini 2.0 with native tool use',
    capabilities: ['chat', 'tools', 'streaming', 'multimodal']
  }];
  try {
    // SECURITY: Use x-goog-api-key header instead of URL query parameter
    // to prevent API key leakage in logs, error messages, and browser history
    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models', {
      headers: {
        'x-goog-api-key': apiKey
      },
      signal: AbortSignal.timeout(5000)
    });
    if (!response.ok) {
      // API access restricted - return known models with warning
      return {
        provider,
        success: true,
        // Consider it success with fallback
        models: knownModels
      };
    }
    const data = await response.json();
    const models = data.models.filter(model => model.name.includes('gemini') && model.supportedGenerationMethods?.includes('generateContent')).map(model => {
      const id = model.name.replace('models/', '');
      return {
        id,
        label: id,
        provider,
        description: `${model.displayName} (auto-discovered)`,
        capabilities: ['chat', 'reasoning', 'tools', 'streaming', 'multimodal']
      };
    });
    return {
      provider,
      success: true,
      models: models.length > 0 ? models : knownModels
    };
  } catch {
    // Network error or timeout - return known models
    return {
      provider,
      success: true,
      models: knownModels
    };
  }
}

/**
 * Discover models from DeepSeek (OpenAI-compatible)
 */
async function discoverDeepSeekModels(apiKey) {
  const provider = 'deepseek';
  try {
    const response = await fetch('https://api.deepseek.com/v1/models', {
      headers: {
        'Authorization': `Bearer ${apiKey}`
      }
    });
    if (!response.ok) {
      throw new Error(`API returned ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    const models = data.data.map(model => ({
      id: model.id,
      label: model.id,
      provider,
      description: `DeepSeek ${model.id} (auto-discovered)`,
      capabilities: ['chat', 'reasoning', 'tools', 'streaming']
    }));
    return {
      provider,
      success: true,
      models
    };
  } catch (error) {
    return {
      provider,
      success: false,
      models: [],
      error: error instanceof Error ? error.message : String(error)
    };
  }
}

/**
 * Discover models from xAI (OpenAI-compatible)
 */
async function discoverXAIModels(apiKey) {
  const provider = 'xai';
  try {
    const response = await fetch('https://api.x.ai/v1/models', {
      headers: {
        'Authorization': `Bearer ${apiKey}`
      }
    });
    if (!response.ok) {
      throw new Error(`API returned ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    const models = data.data.map(model => ({
      id: model.id,
      label: model.id,
      provider,
      description: `xAI ${model.id} (auto-discovered)`,
      capabilities: ['chat', 'reasoning', 'tools', 'streaming']
    }));
    return {
      provider,
      success: true,
      models
    };
  } catch (error) {
    return {
      provider,
      success: false,
      models: [],
      error: error instanceof Error ? error.message : String(error)
    };
  }
}

/**
 * Discover models from Ollama (local)
 */
async function discoverOllamaModels() {
  const provider = 'ollama';
  const baseURL = process.env['OLLAMA_BASE_URL'] || 'http://localhost:11434';
  try {
    const response = await fetch(`${baseURL}/api/tags`, {
      signal: AbortSignal.timeout(2000) // 2 second timeout
    });
    if (!response.ok) {
      throw new Error(`API returned ${response.status}: ${response.statusText}`);
    }
    const data = await response.json();
    const models = (data.models || []).map(model => ({
      id: model.name,
      label: model.name,
      provider,
      description: `Local Ollama model: ${model.name} (auto-discovered)`,
      capabilities: ['chat', 'tools', 'streaming']
    }));
    return {
      provider,
      success: true,
      models
    };
  } catch (error) {
    return {
      provider,
      success: false,
      models: [],
      error: error instanceof Error ? error.message : String(error)
    };
  }
}

/**
 * Discover models from all configured providers
 *
 * PERF: Uses Promise.allSettled for parallel discovery - all providers queried
 * simultaneously. No single slow/failed provider blocks the others.
 */
async function discoverAllModels() {
  const errors = [];
  let totalModelsDiscovered = 0;

  // Discover from each provider if API key is available
  const providers = [{
    id: 'openai',
    envVar: 'OPENAI_API_KEY',
    discover: discoverOpenAIModels
  }, {
    id: 'anthropic',
    envVar: 'ANTHROPIC_API_KEY',
    discover: discoverAnthropicModels
  }, {
    id: 'google',
    envVar: 'GEMINI_API_KEY',
    discover: discoverGoogleModels
  }, {
    id: 'deepseek',
    envVar: 'DEEPSEEK_API_KEY',
    discover: discoverDeepSeekModels
  }, {
    id: 'xai',
    envVar: 'XAI_API_KEY',
    discover: discoverXAIModels
  }];

  // PERF: Build discovery promises in parallel
  const discoveryPromises = providers.map(async provider => {
    const apiKey = process.env[provider.envVar];
    if (!apiKey) {
      return {
        provider: provider.id,
        success: false,
        models: [],
        error: `API key not configured (${provider.envVar})`
      };
    }
    try {
      return await provider.discover(apiKey);
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      return {
        provider: provider.id,
        success: false,
        models: [],
        error: errorMessage
      };
    }
  });

  // Add Ollama discovery (no API key required)
  discoveryPromises.push(discoverOllamaModels().catch(() => ({
    provider: 'ollama',
    success: false,
    models: [],
    error: 'Connection failed'
  })));

  // PERF: Execute ALL provider discoveries in parallel using Promise.allSettled
  // This ensures one slow/failed provider doesn't block others
  const settledResults = await Promise.allSettled(discoveryPromises);

  // Process results
  const results = settledResults.map((settled, index) => {
    if (settled.status === 'fulfilled') {
      return settled.value;
    }
    // Promise rejected (shouldn't happen with our error handling, but be safe)
    const providerId = index < providers.length ? providers[index].id : 'ollama';
    return {
      provider: providerId,
      success: false,
      models: [],
      error: settled.reason instanceof Error ? settled.reason.message : String(settled.reason)
    };
  });

  // Collect errors and count models
  for (const result of results) {
    if (result.success) {
      totalModelsDiscovered += result.models.length;
    } else if (result.error) {
      // Don't add Ollama connection errors (it's often not running)
      if (result.provider === 'ollama' && (result.error.includes('ECONNREFUSED') || result.error.includes('fetch failed') || result.error.includes('Connection failed'))) {
        continue;
      }
      errors.push(`${result.provider}: ${result.error}`);
    }
  }

  // Collect all discovered models
  const allModels = results.filter(r => r.success).flatMap(r => r.models);

  // Save to cache
  if (allModels.length > 0) {
    await saveDiscoveredModels(allModels);
  }
  return {
    success: errors.length === 0,
    timestamp: new Date().toISOString(),
    results,
    totalModelsDiscovered,
    errors
  };
}

/**
 * Clear the discovered models cache
 */
function clearDiscoveredModelsCache() {
  try {
    if ((0, _nodeFs.existsSync)(CACHE_FILE)) {
      (0, _nodeFs.writeFileSync)(CACHE_FILE, JSON.stringify({
        version: '1.0.0',
        lastUpdated: new Date().toISOString(),
        models: []
      }, null, 2), 'utf-8');
    }
  } catch (error) {
    (0, _debugLogger.logDebug)('Failed to clear discovered models cache:', (0, _secretStore.safeErrorMessage)(error));
  }
}

// ============================================================================
// Provider Status Detection
// ============================================================================

/**
 * Provider configuration info
 */

/**
 * Supported providers with their environment variable requirements
 */
const PROVIDER_CONFIGS = [{
  id: 'anthropic',
  name: 'Anthropic',
  envVar: 'ANTHROPIC_API_KEY',
  defaultLatestModel: 'claude-3-5-sonnet-20241022'
}, {
  id: 'openai',
  name: 'OpenAI',
  envVar: 'OPENAI_API_KEY',
  defaultLatestModel: 'gpt-4o'
}, {
  id: 'google',
  name: 'Google',
  envVar: 'GEMINI_API_KEY',
  altEnvVars: ['GOOGLE_API_KEY'],
  defaultLatestModel: 'gemini-2.5-flash'
}, {
  id: 'deepseek',
  name: 'DeepSeek',
  envVar: 'DEEPSEEK_API_KEY',
  defaultLatestModel: 'deepseek-reasoner'
}, {
  id: 'xai',
  name: 'xAI',
  envVar: 'XAI_API_KEY',
  defaultLatestModel: 'grok-4-1-fast-reasoning'
}, {
  id: 'ollama',
  name: 'Ollama',
  envVar: 'OLLAMA_BASE_URL',
  defaultLatestModel: 'llama3.2:3b'
}];

/**
 * Model priority rankings for selecting the "best" model
 */
const MODEL_PRIORITIES = {
  openai: {
    'o3-pro': 120,
    'o3-mini': 114,
    'o3': 112,
    'o1-pro': 110,
    'o1': 108,
    'o1-mini': 104,
    'gpt-5.1-codex-max': 105,
    'codex-max': 105,
    'gpt-5.1-codex': 100,
    'gpt-5.1-codex-mini': 98,
    'gpt-5.1': 96,
    'gpt-5-pro': 94,
    'gpt-5-mini': 92,
    'gpt-5-nano': 90,
    'gpt-4.1': 99,
    'gpt-4o': 97,
    'gpt-4o-mini': 94
  },
  anthropic: {
    'claude-opus-4-5': 105,
    'claude-opus-4-5-20251101': 105,
    'claude-sonnet-4-5': 100,
    'claude-sonnet-4-5-20250929': 100,
    'claude-opus-4-20250514': 96,
    'claude-opus-4': 96,
    'claude-sonnet-4': 94,
    'claude-3-5-sonnet-20241022': 96,
    'claude-3-5-haiku-20241022': 92,
    'claude-3-opus-20240229': 90,
    'claude-3-sonnet-20240229': 86,
    'claude-3-haiku-20240307': 82
  },
  google: {
    'gemini-3.0-pro': 105,
    'gemini-3.0-flash': 100,
    'gemini-2.5-pro': 98,
    'gemini-2.5-flash': 96,
    'gemini-2.0-flash': 90,
    'gemini-2.0': 88,
    'gemini-1.5-pro': 85,
    'gemini-1.5-flash': 82
  },
  deepseek: {
    'deepseek-reasoner': 100,
    'deepseek-chat': 90,
    'deepseek-coder': 85
  },
  xai: {
    'grok-4-1-fast-reasoning': 100,
    'grok-4-1-fast-non-reasoning': 95,
    'grok-4-fast-reasoning': 93,
    'grok-4-fast-non-reasoning': 90,
    'grok-4': 88,
    'grok-code-fast-1': 86,
    'grok-3': 82,
    'grok-3-mini': 78,
    'grok-2-vision-1212': 75,
    'grok-2-1212': 72,
    'grok-beta': 60
  },
  ollama: {
    'llama3.1:8b': 90,
    'llama3.2:3b': 88,
    'qwen2.5:14b': 86,
    'qwen2.5:7b': 84,
    'mistral:7b': 80,
    'deepseek-coder:6.7b': 78,
    'codellama:7b': 70
  }
};

/**
 * Get model priority for sorting
 */
function getModelPriority(provider, modelId) {
  const priorities = MODEL_PRIORITIES[provider];
  if (!priorities) return 0;

  // Check for exact match first
  if (priorities[modelId] !== undefined) {
    return priorities[modelId];
  }

  // Check for prefix match
  for (const [prefix, priority] of Object.entries(priorities)) {
    if (modelId.startsWith(prefix)) {
      return priority;
    }
  }
  return 0;
}

/**
 * Sort models by priority (best first)
 */
function sortModelsByPriority(provider, models) {
  return [...models].sort((a, b) => {
    const priorityA = getModelPriority(provider, a);
    const priorityB = getModelPriority(provider, b);
    return priorityB - priorityA;
  });
}

/**
 * Get the best/latest model for a provider
 */
function getBestModel(provider, models) {
  if (models.length === 0) {
    const config = PROVIDER_CONFIGS.find(p => p.id === provider);
    return config?.defaultLatestModel || '';
  }
  const sorted = sortModelsByPriority(provider, models);
  return sorted[0] ?? models[0] ?? '';
}

/**
 * Check if a provider is configured (has API key or is accessible)
 */
function isProviderConfigured(providerId) {
  const config = PROVIDER_CONFIGS.find(p => p.id === providerId);
  if (!config) return false;

  // Ollama is special - it's available if the server is running (no API key needed)
  if (providerId === 'ollama') {
    // We'll check this via actual connection, return true for now
    // The actual check happens in getConfiguredProviders
    return true;
  }

  // Check main env var
  if (process.env[config.envVar]) {
    return true;
  }

  // Check alternative env vars
  if (config.altEnvVars) {
    for (const altVar of config.altEnvVars) {
      if (process.env[altVar]) {
        return true;
      }
    }
  }
  return false;
}

/**
 * Get all providers with their configuration status
 */
function getProvidersStatus() {
  return PROVIDER_CONFIGS.map(config => {
    let configured = false;
    if (config.id === 'ollama') {
      // For Ollama, we can't check synchronously if it's running
      // Mark as potentially available
      configured = !!process.env['OLLAMA_BASE_URL'] || true; // Always show Ollama as option
    } else {
      configured = !!process.env[config.envVar];
      if (!configured && config.altEnvVars) {
        configured = config.altEnvVars.some(v => !!process.env[v]);
      }
    }
    return {
      id: config.id,
      name: config.name,
      envVar: config.envVar,
      configured,
      latestModel: config.defaultLatestModel
    };
  });
}

/**
 * Get list of configured providers (with valid API keys)
 */
function getConfiguredProviders() {
  return getProvidersStatus().filter(p => p.configured);
}

/**
 * Get list of unconfigured providers
 */
function getUnconfiguredProviders() {
  return getProvidersStatus().filter(p => !p.configured);
}

/**
 * Get the first available provider (for auto-selection)
 */
function getFirstAvailableProvider() {
  const configured = getConfiguredProviders();

  // Prefer in this order: anthropic, openai, google, deepseek, xai, ollama
  const preferenceOrder = ['anthropic', 'openai', 'google', 'deepseek', 'xai', 'ollama'];
  for (const providerId of preferenceOrder) {
    const provider = configured.find(p => p.id === providerId);
    if (provider && provider.id !== 'ollama') {
      return provider;
    }
  }

  // Fall back to Ollama if nothing else is configured
  return configured.find(p => p.id === 'ollama') || null;
}

/**
 * Get latest model for a provider from cache or defaults
 */
function getLatestModelForProvider(providerId) {
  // Check cache first
  const cached = getCachedDiscoveredModels();
  const providerModels = cached.filter(m => m.provider === providerId);
  if (providerModels.length > 0) {
    const modelIds = providerModels.map(m => m.id);
    return getBestModel(providerId, modelIds);
  }

  // Fall back to default
  const config = PROVIDER_CONFIGS.find(p => p.id === providerId);
  return config?.defaultLatestModel || '';
}

/**
 * Quick provider availability check result
 */

/**
 * Quick API check for a single provider - returns best model or null
 */
async function quickFetchProviderModels(providerId, apiKey, timeoutMs = 3000) {
  try {
    switch (providerId) {
      case 'openai':
        {
          const response = await fetch('https://api.openai.com/v1/models', {
            headers: {
              'Authorization': `Bearer ${apiKey}`
            },
            signal: AbortSignal.timeout(timeoutMs)
          });
          if (!response.ok) return [];
          const data = await response.json();
          return data.data.filter(m => m.id.startsWith('gpt-') || m.id.startsWith('o1') || m.id.startsWith('o3') || m.id.startsWith('codex-')).map(m => m.id);
        }
      case 'anthropic':
        {
          const response = await fetch('https://api.anthropic.com/v1/models', {
            headers: {
              'x-api-key': apiKey,
              'anthropic-version': '2023-06-01'
            },
            signal: AbortSignal.timeout(timeoutMs)
          });
          if (!response.ok) return [];
          const data = await response.json();
          return data.data.filter(m => m.type === 'model').map(m => m.id);
        }
      case 'google':
        {
          // SECURITY: Use x-goog-api-key header instead of URL query parameter
          const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models', {
            headers: {
              'x-goog-api-key': apiKey
            },
            signal: AbortSignal.timeout(timeoutMs)
          });
          if (!response.ok) return [];
          const data = await response.json();
          return data.models.filter(m => m.name.includes('gemini') && m.supportedGenerationMethods?.includes('generateContent')).map(m => m.name.replace('models/', ''));
        }
      case 'deepseek':
        {
          const response = await fetch('https://api.deepseek.com/v1/models', {
            headers: {
              'Authorization': `Bearer ${apiKey}`
            },
            signal: AbortSignal.timeout(timeoutMs)
          });
          if (!response.ok) return [];
          const data = await response.json();
          return data.data.map(m => m.id);
        }
      case 'xai':
        {
          const response = await fetch('https://api.x.ai/v1/models', {
            headers: {
              'Authorization': `Bearer ${apiKey}`
            },
            signal: AbortSignal.timeout(timeoutMs)
          });
          if (!response.ok) return [];
          const data = await response.json();
          return data.data.map(m => m.id);
        }
      default:
        return [];
    }
  } catch {
    return [];
  }
}

/**
 * Quickly check if providers are available by querying their APIs
 * Returns actual latest models from each provider
 */
async function quickCheckProviders() {
  const checks = [];
  for (const config of PROVIDER_CONFIGS) {
    // Handle Ollama separately (no API key needed)
    if (config.id === 'ollama') {
      checks.push((async () => {
        try {
          const baseURL = process.env['OLLAMA_BASE_URL'] || 'http://localhost:11434';
          const response = await fetch(`${baseURL}/api/tags`, {
            signal: AbortSignal.timeout(1500)
          });
          if (response.ok) {
            const data = await response.json();
            const models = data.models?.map(m => m.name) || [];
            return {
              provider: 'ollama',
              available: models.length > 0,
              latestModel: models[0] || config.defaultLatestModel
            };
          }
        } catch {/* ignore */}
        return {
          provider: 'ollama',
          available: false,
          latestModel: config.defaultLatestModel,
          error: 'Not running'
        };
      })());
      continue;
    }

    // Check for API key
    let apiKey = process.env[config.envVar];
    if (!apiKey && config.altEnvVars) {
      for (const altVar of config.altEnvVars) {
        if (process.env[altVar]) {
          apiKey = process.env[altVar];
          break;
        }
      }
    }
    if (!apiKey) {
      checks.push(Promise.resolve({
        provider: config.id,
        available: false,
        latestModel: config.defaultLatestModel,
        error: `${config.envVar} not set`
      }));
      continue;
    }

    // Query the API for actual models
    checks.push((async () => {
      const models = await quickFetchProviderModels(config.id, apiKey, 3000);
      if (models.length > 0) {
        const bestModel = getBestModel(config.id, models);
        return {
          provider: config.id,
          available: true,
          latestModel: bestModel
        };
      }
      // API call failed or returned no models - still mark available if key exists
      return {
        provider: config.id,
        available: true,
        latestModel: config.defaultLatestModel,
        error: 'Could not fetch models'
      };
    })());
  }

  // Run all checks in parallel for speed
  return Promise.all(checks);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUZzIiwicmVxdWlyZSIsIl9wcm9taXNlcyIsIl9ub2RlUGF0aCIsIl9ub2RlT3MiLCJfc2VjcmV0U3RvcmUiLCJfZGVidWdMb2dnZXIiLCJDQUNIRV9ESVIiLCJqb2luIiwiaG9tZWRpciIsIkNBQ0hFX0ZJTEUiLCJDQUNIRV9FWFBJUkFUSU9OX01TIiwiaW5mZXJQcm92aWRlckZyb21Nb2RlbElkIiwibW9kZWwiLCJub3JtYWxpemVkIiwidHJpbSIsInRvTG93ZXJDYXNlIiwicGF0dGVybnMiLCJwYXR0ZXJuIiwicHJvdmlkZXIiLCJ0ZXN0IiwiZ2V0Q2FjaGVkRGlzY292ZXJlZE1vZGVscyIsImV4aXN0c1N5bmMiLCJyYXciLCJyZWFkRmlsZVN5bmMiLCJjYWNoZSIsIkpTT04iLCJwYXJzZSIsImxhc3RVcGRhdGVkIiwiRGF0ZSIsImdldFRpbWUiLCJub3ciLCJtb2RlbHMiLCJlcnJvciIsImxvZ0RlYnVnIiwic2FmZUVycm9yTWVzc2FnZSIsInNhdmVEaXNjb3ZlcmVkTW9kZWxzIiwibWtkaXIiLCJyZWN1cnNpdmUiLCJ2ZXJzaW9uIiwidG9JU09TdHJpbmciLCJ3cml0ZUZpbGVTeW5jIiwic3RyaW5naWZ5IiwiZGlzY292ZXJPcGVuQUlNb2RlbHMiLCJhcGlLZXkiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsIm9rIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZGF0YSIsImpzb24iLCJmaWx0ZXIiLCJpZCIsInN0YXJ0c1dpdGgiLCJtYXAiLCJsYWJlbCIsImRlc2NyaXB0aW9uIiwiY2FwYWJpbGl0aWVzIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJTdHJpbmciLCJkaXNjb3ZlckFudGhyb3BpY01vZGVscyIsInR5cGUiLCJkaXNwbGF5X25hbWUiLCJkaXNjb3Zlckdvb2dsZU1vZGVscyIsImtub3duTW9kZWxzIiwic2lnbmFsIiwiQWJvcnRTaWduYWwiLCJ0aW1lb3V0IiwibmFtZSIsImluY2x1ZGVzIiwic3VwcG9ydGVkR2VuZXJhdGlvbk1ldGhvZHMiLCJyZXBsYWNlIiwiZGlzcGxheU5hbWUiLCJsZW5ndGgiLCJkaXNjb3ZlckRlZXBTZWVrTW9kZWxzIiwiZGlzY292ZXJYQUlNb2RlbHMiLCJkaXNjb3Zlck9sbGFtYU1vZGVscyIsImJhc2VVUkwiLCJwcm9jZXNzIiwiZW52IiwiZGlzY292ZXJBbGxNb2RlbHMiLCJlcnJvcnMiLCJ0b3RhbE1vZGVsc0Rpc2NvdmVyZWQiLCJwcm92aWRlcnMiLCJlbnZWYXIiLCJkaXNjb3ZlciIsImRpc2NvdmVyeVByb21pc2VzIiwiZXJyb3JNZXNzYWdlIiwicHVzaCIsImNhdGNoIiwic2V0dGxlZFJlc3VsdHMiLCJQcm9taXNlIiwiYWxsU2V0dGxlZCIsInJlc3VsdHMiLCJzZXR0bGVkIiwiaW5kZXgiLCJ2YWx1ZSIsInByb3ZpZGVySWQiLCJyZWFzb24iLCJyZXN1bHQiLCJhbGxNb2RlbHMiLCJyIiwiZmxhdE1hcCIsInRpbWVzdGFtcCIsImNsZWFyRGlzY292ZXJlZE1vZGVsc0NhY2hlIiwiUFJPVklERVJfQ09ORklHUyIsImRlZmF1bHRMYXRlc3RNb2RlbCIsImFsdEVudlZhcnMiLCJNT0RFTF9QUklPUklUSUVTIiwib3BlbmFpIiwiYW50aHJvcGljIiwiZ29vZ2xlIiwiZGVlcHNlZWsiLCJ4YWkiLCJvbGxhbWEiLCJnZXRNb2RlbFByaW9yaXR5IiwibW9kZWxJZCIsInByaW9yaXRpZXMiLCJ1bmRlZmluZWQiLCJwcmVmaXgiLCJwcmlvcml0eSIsIk9iamVjdCIsImVudHJpZXMiLCJzb3J0TW9kZWxzQnlQcmlvcml0eSIsInNvcnQiLCJhIiwiYiIsInByaW9yaXR5QSIsInByaW9yaXR5QiIsImdldEJlc3RNb2RlbCIsImNvbmZpZyIsImZpbmQiLCJwIiwic29ydGVkIiwiaXNQcm92aWRlckNvbmZpZ3VyZWQiLCJhbHRWYXIiLCJnZXRQcm92aWRlcnNTdGF0dXMiLCJjb25maWd1cmVkIiwic29tZSIsInYiLCJsYXRlc3RNb2RlbCIsImdldENvbmZpZ3VyZWRQcm92aWRlcnMiLCJnZXRVbmNvbmZpZ3VyZWRQcm92aWRlcnMiLCJnZXRGaXJzdEF2YWlsYWJsZVByb3ZpZGVyIiwicHJlZmVyZW5jZU9yZGVyIiwiZ2V0TGF0ZXN0TW9kZWxGb3JQcm92aWRlciIsImNhY2hlZCIsInByb3ZpZGVyTW9kZWxzIiwibSIsIm1vZGVsSWRzIiwicXVpY2tGZXRjaFByb3ZpZGVyTW9kZWxzIiwidGltZW91dE1zIiwicXVpY2tDaGVja1Byb3ZpZGVycyIsImNoZWNrcyIsImF2YWlsYWJsZSIsInJlc29sdmUiLCJiZXN0TW9kZWwiLCJhbGwiXSwic291cmNlcyI6WyJtb2RlbERpc2NvdmVyeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE1vZGVsIGRpc2NvdmVyeSBzeXN0ZW0gZm9yIGF1dG8tZGV0ZWN0aW5nIG5ldyBtb2RlbHMgZnJvbSBwcm92aWRlcnMuXG4gKlxuICogVGhpcyBtb2R1bGUgcXVlcmllcyBwcm92aWRlciBBUElzIHRvIGRpc2NvdmVyIGF2YWlsYWJsZSBtb2RlbHMgYW5kIGNhY2hlc1xuICogdGhlbSBmb3IgdXNlIGFsb25nc2lkZSB0aGUgc3RhdGljIG1vZGVsIHNjaGVtYS4gSXQgbmV2ZXIgbW9kaWZpZXMgdGhlXG4gKiBzdGF0aWMgc2NoZW1hIC0gZGlzY292ZXJpZXMgYXJlIHN0b3JlZCBzZXBhcmF0ZWx5IGFuZCBtZXJnZWQgYXQgcnVudGltZS5cbiAqL1xuXG5pbXBvcnQgeyByZWFkRmlsZVN5bmMsIHdyaXRlRmlsZVN5bmMsIGV4aXN0c1N5bmMgfSBmcm9tICdub2RlOmZzJztcbmltcG9ydCB7IG1rZGlyIH0gZnJvbSAnbm9kZTpmcy9wcm9taXNlcyc7XG5pbXBvcnQgeyBqb2luIH0gZnJvbSAnbm9kZTpwYXRoJztcbmltcG9ydCB7IGhvbWVkaXIgfSBmcm9tICdub2RlOm9zJztcbmltcG9ydCB0eXBlIHsgUHJvdmlkZXJJZCB9IGZyb20gJy4vdHlwZXMuanMnO1xuaW1wb3J0IHR5cGUgeyBNb2RlbENvbmZpZyB9IGZyb20gJy4vYWdlbnRTY2hlbWFMb2FkZXIuanMnO1xuaW1wb3J0IHsgc2FmZUVycm9yTWVzc2FnZSB9IGZyb20gJy4vc2VjcmV0U3RvcmUuanMnO1xuaW1wb3J0IHsgbG9nRGVidWcgfSBmcm9tICcuLi91dGlscy9kZWJ1Z0xvZ2dlci5qcyc7XG5cbi8qKlxuICogRGlzY292ZXJlZCBtb2RlbCBjYWNoZSBmaWxlIGxvY2F0aW9uXG4gKi9cbmNvbnN0IENBQ0hFX0RJUiA9IGpvaW4oaG9tZWRpcigpLCAnLmFnaScpO1xuY29uc3QgQ0FDSEVfRklMRSA9IGpvaW4oQ0FDSEVfRElSLCAnZGlzY292ZXJlZC1tb2RlbHMuanNvbicpO1xuXG4vKipcbiAqIENhY2hlIGV4cGlyYXRpb24gdGltZSAoMjQgaG91cnMpXG4gKi9cbmNvbnN0IENBQ0hFX0VYUElSQVRJT05fTVMgPSAyNCAqIDYwICogNjAgKiAxMDAwO1xuXG4vKipcbiAqIERpc2NvdmVyZWQgbW9kZWxzIGNhY2hlIHN0cnVjdHVyZVxuICovXG5pbnRlcmZhY2UgRGlzY292ZXJlZE1vZGVsc0NhY2hlIHtcbiAgdmVyc2lvbjogc3RyaW5nO1xuICBsYXN0VXBkYXRlZDogc3RyaW5nO1xuICBtb2RlbHM6IE1vZGVsQ29uZmlnW107XG59XG5cbi8qKlxuICogTW9kZWwgZGlzY292ZXJ5IHJlc3VsdCBmb3IgYSBzaW5nbGUgcHJvdmlkZXJcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQcm92aWRlckRpc2NvdmVyeVJlc3VsdCB7XG4gIHByb3ZpZGVyOiBQcm92aWRlcklkO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBtb2RlbHM6IE1vZGVsQ29uZmlnW107XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIENvbXBsZXRlIGRpc2NvdmVyeSByZXN1bHRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEaXNjb3ZlcnlSZXN1bHQge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgcmVzdWx0czogUHJvdmlkZXJEaXNjb3ZlcnlSZXN1bHRbXTtcbiAgdG90YWxNb2RlbHNEaXNjb3ZlcmVkOiBudW1iZXI7XG4gIGVycm9yczogc3RyaW5nW107XG59XG5cbi8qKlxuICogSW5mZXIgYSBwcm92aWRlciBmcm9tIGEgbW9kZWwgSUQgKGJlc3QtZWZmb3J0KS5cbiAqIFVzZWQgdG8gYXV0by1hbGlnbiBwcm92aWRlci9tb2RlbCBwYWlycyB3aGVuIHVzZXJzIG92ZXJyaWRlIG1vZGVscyBkaXJlY3RseS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluZmVyUHJvdmlkZXJGcm9tTW9kZWxJZChtb2RlbDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFByb3ZpZGVySWQgfCBudWxsIHtcbiAgaWYgKCFtb2RlbCkgcmV0dXJuIG51bGw7XG5cbiAgY29uc3Qgbm9ybWFsaXplZCA9IG1vZGVsLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBwYXR0ZXJuczogQXJyYXk8W1JlZ0V4cCwgUHJvdmlkZXJJZF0+ID0gW1xuICAgIFsvXihncHR8bzF8bzN8Y29kZXgpLywgJ29wZW5haSddLFxuICAgIFsvXihjbGF1ZGV8b3B1c3xzb25uZXR8aGFpa3UpLywgJ2FudGhyb3BpYyddLFxuICAgIFsvXmdlbWluaS8sICdnb29nbGUnXSxcbiAgICBbL15kZWVwc2Vlay8sICdkZWVwc2VlayddLFxuICAgIFsvXmdyb2svLCAneGFpJ10sXG4gICAgWy9eKGxsYW1hfG1pc3RyYWx8cXdlbnxwaGkpLywgJ29sbGFtYSddLFxuICAgIFsvOi8sICdvbGxhbWEnXSwgLy8gT2xsYW1hIG1vZGVscyBvZnRlbiBpbmNsdWRlIGNvbG9ucyAoZS5nLiwgbGxhbWEzLjI6M2IpXG4gIF07XG5cbiAgZm9yIChjb25zdCBbcGF0dGVybiwgcHJvdmlkZXJdIG9mIHBhdHRlcm5zKSB7XG4gICAgaWYgKHBhdHRlcm4udGVzdChub3JtYWxpemVkKSkge1xuICAgICAgcmV0dXJuIHByb3ZpZGVyO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEdldCBjYWNoZWQgZGlzY292ZXJlZCBtb2RlbHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENhY2hlZERpc2NvdmVyZWRNb2RlbHMoKTogTW9kZWxDb25maWdbXSB7XG4gIHRyeSB7XG4gICAgaWYgKCFleGlzdHNTeW5jKENBQ0hFX0ZJTEUpKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgY29uc3QgcmF3ID0gcmVhZEZpbGVTeW5jKENBQ0hFX0ZJTEUsICd1dGYtOCcpO1xuICAgIGNvbnN0IGNhY2hlOiBEaXNjb3ZlcmVkTW9kZWxzQ2FjaGUgPSBKU09OLnBhcnNlKHJhdyk7XG5cbiAgICAvLyBDaGVjayBpZiBjYWNoZSBpcyBleHBpcmVkXG4gICAgY29uc3QgbGFzdFVwZGF0ZWQgPSBuZXcgRGF0ZShjYWNoZS5sYXN0VXBkYXRlZCkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgaWYgKG5vdyAtIGxhc3RVcGRhdGVkID4gQ0FDSEVfRVhQSVJBVElPTl9NUykge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIHJldHVybiBjYWNoZS5tb2RlbHM7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nRGVidWcoJ0ZhaWxlZCB0byByZWFkIGRpc2NvdmVyZWQgbW9kZWxzIGNhY2hlOicsIHNhZmVFcnJvck1lc3NhZ2UoZXJyb3IpKTtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuLyoqXG4gKiBTYXZlIGRpc2NvdmVyZWQgbW9kZWxzIHRvIGNhY2hlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNhdmVEaXNjb3ZlcmVkTW9kZWxzKG1vZGVsczogTW9kZWxDb25maWdbXSk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGF3YWl0IG1rZGlyKENBQ0hFX0RJUiwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG5cbiAgICBjb25zdCBjYWNoZTogRGlzY292ZXJlZE1vZGVsc0NhY2hlID0ge1xuICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBtb2RlbHMsXG4gICAgfTtcblxuICAgIHdyaXRlRmlsZVN5bmMoQ0FDSEVfRklMRSwgSlNPTi5zdHJpbmdpZnkoY2FjaGUsIG51bGwsIDIpLCAndXRmLTgnKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBsb2dEZWJ1ZygnRmFpbGVkIHRvIHNhdmUgZGlzY292ZXJlZCBtb2RlbHMgY2FjaGU6Jywgc2FmZUVycm9yTWVzc2FnZShlcnJvcikpO1xuICB9XG59XG5cbi8qKlxuICogRGlzY292ZXIgbW9kZWxzIGZyb20gT3BlbkFJXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRpc2NvdmVyT3BlbkFJTW9kZWxzKGFwaUtleTogc3RyaW5nKTogUHJvbWlzZTxQcm92aWRlckRpc2NvdmVyeVJlc3VsdD4ge1xuICBjb25zdCBwcm92aWRlcjogUHJvdmlkZXJJZCA9ICdvcGVuYWknO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9tb2RlbHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJldHVybmVkICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgeyBkYXRhOiBBcnJheTx7IGlkOiBzdHJpbmc7IG93bmVkX2J5OiBzdHJpbmcgfT4gfTtcblxuICAgIC8vIEZpbHRlciBmb3IgR1BUIG1vZGVscyBvbmx5IGFuZCBjcmVhdGUgTW9kZWxDb25maWcgb2JqZWN0c1xuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IGRhdGEuZGF0YVxuICAgICAgLmZpbHRlcihtb2RlbCA9PiB7XG4gICAgICAgIC8vIEFsbG93IGJvdGggZGFzaCBhbmQgbm9uLWRhc2ggdmFyaWFudHMgZm9yIG5ld2VyIHJlYXNvbmluZyBTS1VzIChvMS9vMylcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBtb2RlbC5pZC5zdGFydHNXaXRoKCdncHQtJykgfHxcbiAgICAgICAgICBtb2RlbC5pZC5zdGFydHNXaXRoKCdvMScpIHx8XG4gICAgICAgICAgbW9kZWwuaWQuc3RhcnRzV2l0aCgnbzMnKSB8fFxuICAgICAgICAgIG1vZGVsLmlkLnN0YXJ0c1dpdGgoJ2NvZGV4LScpXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICAgLm1hcChtb2RlbCA9PiAoe1xuICAgICAgICBpZDogbW9kZWwuaWQsXG4gICAgICAgIGxhYmVsOiBtb2RlbC5pZCxcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgT3BlbkFJICR7bW9kZWwuaWR9IChhdXRvLWRpc2NvdmVyZWQpYCxcbiAgICAgICAgY2FwYWJpbGl0aWVzOiBbJ2NoYXQnLCAndG9vbHMnLCAnc3RyZWFtaW5nJ10sXG4gICAgICB9KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXIsXG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbW9kZWxzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtb2RlbHM6IFtdLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRGlzY292ZXIgbW9kZWxzIGZyb20gQW50aHJvcGljXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRpc2NvdmVyQW50aHJvcGljTW9kZWxzKGFwaUtleTogc3RyaW5nKTogUHJvbWlzZTxQcm92aWRlckRpc2NvdmVyeVJlc3VsdD4ge1xuICBjb25zdCBwcm92aWRlcjogUHJvdmlkZXJJZCA9ICdhbnRocm9waWMnO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkuYW50aHJvcGljLmNvbS92MS9tb2RlbHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICd4LWFwaS1rZXknOiBhcGlLZXksXG4gICAgICAgICdhbnRocm9waWMtdmVyc2lvbic6ICcyMDIzLTA2LTAxJyxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXR1cm5lZCAke3Jlc3BvbnNlLnN0YXR1c306ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIHtcbiAgICAgIGRhdGE6IEFycmF5PHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgZGlzcGxheV9uYW1lOiBzdHJpbmc7XG4gICAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgIH0+XG4gICAgfTtcblxuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IGRhdGEuZGF0YVxuICAgICAgLmZpbHRlcihtb2RlbCA9PiBtb2RlbC50eXBlID09PSAnbW9kZWwnKVxuICAgICAgLm1hcChtb2RlbCA9PiAoe1xuICAgICAgICBpZDogbW9kZWwuaWQsXG4gICAgICAgIGxhYmVsOiBtb2RlbC5kaXNwbGF5X25hbWUgfHwgbW9kZWwuaWQsXG4gICAgICAgIHByb3ZpZGVyLFxuICAgICAgICBkZXNjcmlwdGlvbjogYEFudGhyb3BpYyAke21vZGVsLmRpc3BsYXlfbmFtZSB8fCBtb2RlbC5pZH0gKGF1dG8tZGlzY292ZXJlZClgLFxuICAgICAgICBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICdyZWFzb25pbmcnLCAndG9vbHMnLCAnc3RyZWFtaW5nJ10sXG4gICAgICB9KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXIsXG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbW9kZWxzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtb2RlbHM6IFtdLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRGlzY292ZXIgbW9kZWxzIGZyb20gR29vZ2xlIEdlbWluaVxuICogTm90ZTogR29vZ2xlJ3MgbW9kZWxzIEFQSSBvZnRlbiByZXF1aXJlcyBzcGVjaWFsIHBlcm1pc3Npb25zLlxuICogRmFsbHMgYmFjayB0byBrbm93biBtb2RlbHMgaWYgQVBJIGFjY2VzcyBmYWlscy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZGlzY292ZXJHb29nbGVNb2RlbHMoYXBpS2V5OiBzdHJpbmcpOiBQcm9taXNlPFByb3ZpZGVyRGlzY292ZXJ5UmVzdWx0PiB7XG4gIGNvbnN0IHByb3ZpZGVyOiBQcm92aWRlcklkID0gJ2dvb2dsZSc7XG5cbiAgLy8gS25vd24gR29vZ2xlIEdlbWluaSBtb2RlbHMgKGZhbGxiYWNrIGlmIEFQSSBkb2Vzbid0IHdvcmspIC0gVXBkYXRlZCBEZWMgMjAyNVxuICBjb25zdCBrbm93bk1vZGVsczogTW9kZWxDb25maWdbXSA9IFtcbiAgICB7IGlkOiAnZ2VtaW5pLTMuMC1wcm8nLCBsYWJlbDogJ0dlbWluaSAzLjAgUHJvJywgcHJvdmlkZXIsIGRlc2NyaXB0aW9uOiAnTGF0ZXN0IEdlbWluaSB3aXRoIGJlc3QgcmVhc29uaW5nIGFuZCBjb2RpbmcnLCBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICdyZWFzb25pbmcnLCAndG9vbHMnLCAnc3RyZWFtaW5nJywgJ211bHRpbW9kYWwnXSB9LFxuICAgIHsgaWQ6ICdnZW1pbmktMy4wLWZsYXNoJywgbGFiZWw6ICdHZW1pbmkgMy4wIEZsYXNoJywgcHJvdmlkZXIsIGRlc2NyaXB0aW9uOiAnRmFzdCBHZW1pbmkgMy4wIG1vZGVsJywgY2FwYWJpbGl0aWVzOiBbJ2NoYXQnLCAncmVhc29uaW5nJywgJ3Rvb2xzJywgJ3N0cmVhbWluZycsICdtdWx0aW1vZGFsJ10gfSxcbiAgICB7IGlkOiAnZ2VtaW5pLTIuNS1wcm8nLCBsYWJlbDogJ0dlbWluaSAyLjUgUHJvJywgcHJvdmlkZXIsIGRlc2NyaXB0aW9uOiAnQ2FwYWJsZSBHZW1pbmkgbW9kZWwgd2l0aCBhZHZhbmNlZCByZWFzb25pbmcnLCBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICdyZWFzb25pbmcnLCAndG9vbHMnLCAnc3RyZWFtaW5nJywgJ211bHRpbW9kYWwnXSB9LFxuICAgIHsgaWQ6ICdnZW1pbmktMi41LWZsYXNoJywgbGFiZWw6ICdHZW1pbmkgMi41IEZsYXNoJywgcHJvdmlkZXIsIGRlc2NyaXB0aW9uOiAnRmFzdCBHZW1pbmkgMi41IHdpdGggcmVhc29uaW5nJywgY2FwYWJpbGl0aWVzOiBbJ2NoYXQnLCAncmVhc29uaW5nJywgJ3Rvb2xzJywgJ3N0cmVhbWluZycsICdtdWx0aW1vZGFsJ10gfSxcbiAgICB7IGlkOiAnZ2VtaW5pLTIuMC1mbGFzaCcsIGxhYmVsOiAnR2VtaW5pIDIuMCBGbGFzaCcsIHByb3ZpZGVyLCBkZXNjcmlwdGlvbjogJ0dlbWluaSAyLjAgd2l0aCBuYXRpdmUgdG9vbCB1c2UnLCBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICd0b29scycsICdzdHJlYW1pbmcnLCAnbXVsdGltb2RhbCddIH0sXG4gIF07XG5cbiAgdHJ5IHtcbiAgICAvLyBTRUNVUklUWTogVXNlIHgtZ29vZy1hcGkta2V5IGhlYWRlciBpbnN0ZWFkIG9mIFVSTCBxdWVyeSBwYXJhbWV0ZXJcbiAgICAvLyB0byBwcmV2ZW50IEFQSSBrZXkgbGVha2FnZSBpbiBsb2dzLCBlcnJvciBtZXNzYWdlcywgYW5kIGJyb3dzZXIgaGlzdG9yeVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICd4LWdvb2ctYXBpLWtleSc6IGFwaUtleSxcbiAgICAgIH0sXG4gICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoNTAwMCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAvLyBBUEkgYWNjZXNzIHJlc3RyaWN0ZWQgLSByZXR1cm4ga25vd24gbW9kZWxzIHdpdGggd2FybmluZ1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIC8vIENvbnNpZGVyIGl0IHN1Y2Nlc3Mgd2l0aCBmYWxsYmFja1xuICAgICAgICBtb2RlbHM6IGtub3duTW9kZWxzLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIHtcbiAgICAgIG1vZGVsczogQXJyYXk8e1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG4gICAgICAgIHN1cHBvcnRlZEdlbmVyYXRpb25NZXRob2RzOiBzdHJpbmdbXTtcbiAgICAgIH0+XG4gICAgfTtcblxuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IGRhdGEubW9kZWxzXG4gICAgICAuZmlsdGVyKG1vZGVsID0+XG4gICAgICAgIG1vZGVsLm5hbWUuaW5jbHVkZXMoJ2dlbWluaScpICYmXG4gICAgICAgIG1vZGVsLnN1cHBvcnRlZEdlbmVyYXRpb25NZXRob2RzPy5pbmNsdWRlcygnZ2VuZXJhdGVDb250ZW50JylcbiAgICAgIClcbiAgICAgIC5tYXAobW9kZWwgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IG1vZGVsLm5hbWUucmVwbGFjZSgnbW9kZWxzLycsICcnKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBsYWJlbDogaWQsXG4gICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGAke21vZGVsLmRpc3BsYXlOYW1lfSAoYXV0by1kaXNjb3ZlcmVkKWAsXG4gICAgICAgICAgY2FwYWJpbGl0aWVzOiBbJ2NoYXQnLCAncmVhc29uaW5nJywgJ3Rvb2xzJywgJ3N0cmVhbWluZycsICdtdWx0aW1vZGFsJ10sXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtb2RlbHM6IG1vZGVscy5sZW5ndGggPiAwID8gbW9kZWxzIDoga25vd25Nb2RlbHMsXG4gICAgfTtcbiAgfSBjYXRjaCB7XG4gICAgLy8gTmV0d29yayBlcnJvciBvciB0aW1lb3V0IC0gcmV0dXJuIGtub3duIG1vZGVsc1xuICAgIHJldHVybiB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtb2RlbHM6IGtub3duTW9kZWxzLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNjb3ZlciBtb2RlbHMgZnJvbSBEZWVwU2VlayAoT3BlbkFJLWNvbXBhdGlibGUpXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRpc2NvdmVyRGVlcFNlZWtNb2RlbHMoYXBpS2V5OiBzdHJpbmcpOiBQcm9taXNlPFByb3ZpZGVyRGlzY292ZXJ5UmVzdWx0PiB7XG4gIGNvbnN0IHByb3ZpZGVyOiBQcm92aWRlcklkID0gJ2RlZXBzZWVrJztcblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbS92MS9tb2RlbHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJldHVybmVkICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgeyBkYXRhOiBBcnJheTx7IGlkOiBzdHJpbmcgfT4gfTtcblxuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IGRhdGEuZGF0YS5tYXAobW9kZWwgPT4gKHtcbiAgICAgIGlkOiBtb2RlbC5pZCxcbiAgICAgIGxhYmVsOiBtb2RlbC5pZCxcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgZGVzY3JpcHRpb246IGBEZWVwU2VlayAke21vZGVsLmlkfSAoYXV0by1kaXNjb3ZlcmVkKWAsXG4gICAgICBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICdyZWFzb25pbmcnLCAndG9vbHMnLCAnc3RyZWFtaW5nJ10sXG4gICAgfSkpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1vZGVscyxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgbW9kZWxzOiBbXSxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvciksXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIERpc2NvdmVyIG1vZGVscyBmcm9tIHhBSSAoT3BlbkFJLWNvbXBhdGlibGUpXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGRpc2NvdmVyWEFJTW9kZWxzKGFwaUtleTogc3RyaW5nKTogUHJvbWlzZTxQcm92aWRlckRpc2NvdmVyeVJlc3VsdD4ge1xuICBjb25zdCBwcm92aWRlcjogUHJvdmlkZXJJZCA9ICd4YWknO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkueC5haS92MS9tb2RlbHMnLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJldHVybmVkICR7cmVzcG9uc2Uuc3RhdHVzfTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgeyBkYXRhOiBBcnJheTx7IGlkOiBzdHJpbmcgfT4gfTtcblxuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IGRhdGEuZGF0YS5tYXAobW9kZWwgPT4gKHtcbiAgICAgIGlkOiBtb2RlbC5pZCxcbiAgICAgIGxhYmVsOiBtb2RlbC5pZCxcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgZGVzY3JpcHRpb246IGB4QUkgJHttb2RlbC5pZH0gKGF1dG8tZGlzY292ZXJlZClgLFxuICAgICAgY2FwYWJpbGl0aWVzOiBbJ2NoYXQnLCAncmVhc29uaW5nJywgJ3Rvb2xzJywgJ3N0cmVhbWluZyddLFxuICAgIH0pKTtcblxuICAgIHJldHVybiB7XG4gICAgICBwcm92aWRlcixcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtb2RlbHMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXIsXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1vZGVsczogW10sXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNjb3ZlciBtb2RlbHMgZnJvbSBPbGxhbWEgKGxvY2FsKVxuICovXG5hc3luYyBmdW5jdGlvbiBkaXNjb3Zlck9sbGFtYU1vZGVscygpOiBQcm9taXNlPFByb3ZpZGVyRGlzY292ZXJ5UmVzdWx0PiB7XG4gIGNvbnN0IHByb3ZpZGVyOiBQcm92aWRlcklkID0gJ29sbGFtYSc7XG4gIGNvbnN0IGJhc2VVUkwgPSBwcm9jZXNzLmVudlsnT0xMQU1BX0JBU0VfVVJMJ10gfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVVJMfS9hcGkvdGFnc2AsIHtcbiAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgyMDAwKSwgLy8gMiBzZWNvbmQgdGltZW91dFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBUEkgcmV0dXJuZWQgJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgfVxuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyB7IG1vZGVscz86IEFycmF5PHsgbmFtZTogc3RyaW5nOyBzaXplOiBudW1iZXIgfT4gfTtcblxuICAgIGNvbnN0IG1vZGVsczogTW9kZWxDb25maWdbXSA9IChkYXRhLm1vZGVscyB8fCBbXSkubWFwKG1vZGVsID0+ICh7XG4gICAgICBpZDogbW9kZWwubmFtZSxcbiAgICAgIGxhYmVsOiBtb2RlbC5uYW1lLFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBkZXNjcmlwdGlvbjogYExvY2FsIE9sbGFtYSBtb2RlbDogJHttb2RlbC5uYW1lfSAoYXV0by1kaXNjb3ZlcmVkKWAsXG4gICAgICBjYXBhYmlsaXRpZXM6IFsnY2hhdCcsICd0b29scycsICdzdHJlYW1pbmcnXSxcbiAgICB9KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXIsXG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbW9kZWxzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtb2RlbHM6IFtdLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRGlzY292ZXIgbW9kZWxzIGZyb20gYWxsIGNvbmZpZ3VyZWQgcHJvdmlkZXJzXG4gKlxuICogUEVSRjogVXNlcyBQcm9taXNlLmFsbFNldHRsZWQgZm9yIHBhcmFsbGVsIGRpc2NvdmVyeSAtIGFsbCBwcm92aWRlcnMgcXVlcmllZFxuICogc2ltdWx0YW5lb3VzbHkuIE5vIHNpbmdsZSBzbG93L2ZhaWxlZCBwcm92aWRlciBibG9ja3MgdGhlIG90aGVycy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc2NvdmVyQWxsTW9kZWxzKCk6IFByb21pc2U8RGlzY292ZXJ5UmVzdWx0PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgbGV0IHRvdGFsTW9kZWxzRGlzY292ZXJlZCA9IDA7XG5cbiAgLy8gRGlzY292ZXIgZnJvbSBlYWNoIHByb3ZpZGVyIGlmIEFQSSBrZXkgaXMgYXZhaWxhYmxlXG4gIGNvbnN0IHByb3ZpZGVyczogQXJyYXk8e1xuICAgIGlkOiBQcm92aWRlcklkO1xuICAgIGVudlZhcjogc3RyaW5nO1xuICAgIGRpc2NvdmVyOiAoYXBpS2V5OiBzdHJpbmcpID0+IFByb21pc2U8UHJvdmlkZXJEaXNjb3ZlcnlSZXN1bHQ+O1xuICB9PiA9IFtcbiAgICB7IGlkOiAnb3BlbmFpJywgZW52VmFyOiAnT1BFTkFJX0FQSV9LRVknLCBkaXNjb3ZlcjogZGlzY292ZXJPcGVuQUlNb2RlbHMgfSxcbiAgICB7IGlkOiAnYW50aHJvcGljJywgZW52VmFyOiAnQU5USFJPUElDX0FQSV9LRVknLCBkaXNjb3ZlcjogZGlzY292ZXJBbnRocm9waWNNb2RlbHMgfSxcbiAgICB7IGlkOiAnZ29vZ2xlJywgZW52VmFyOiAnR0VNSU5JX0FQSV9LRVknLCBkaXNjb3ZlcjogZGlzY292ZXJHb29nbGVNb2RlbHMgfSxcbiAgICB7IGlkOiAnZGVlcHNlZWsnLCBlbnZWYXI6ICdERUVQU0VFS19BUElfS0VZJywgZGlzY292ZXI6IGRpc2NvdmVyRGVlcFNlZWtNb2RlbHMgfSxcbiAgICB7IGlkOiAneGFpJywgZW52VmFyOiAnWEFJX0FQSV9LRVknLCBkaXNjb3ZlcjogZGlzY292ZXJYQUlNb2RlbHMgfSxcbiAgXTtcblxuICAvLyBQRVJGOiBCdWlsZCBkaXNjb3ZlcnkgcHJvbWlzZXMgaW4gcGFyYWxsZWxcbiAgY29uc3QgZGlzY292ZXJ5UHJvbWlzZXM6IFByb21pc2U8UHJvdmlkZXJEaXNjb3ZlcnlSZXN1bHQ+W10gPSBwcm92aWRlcnMubWFwKGFzeW5jIChwcm92aWRlcikgPT4ge1xuICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52W3Byb3ZpZGVyLmVudlZhcl07XG5cbiAgICBpZiAoIWFwaUtleSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLmlkLFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgbW9kZWxzOiBbXSxcbiAgICAgICAgZXJyb3I6IGBBUEkga2V5IG5vdCBjb25maWd1cmVkICgke3Byb3ZpZGVyLmVudlZhcn0pYCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCBwcm92aWRlci5kaXNjb3ZlcihhcGlLZXkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcm92aWRlcjogcHJvdmlkZXIuaWQsXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtb2RlbHM6IFtdIGFzIE1vZGVsQ29uZmlnW10sXG4gICAgICAgIGVycm9yOiBlcnJvck1lc3NhZ2UsXG4gICAgICB9O1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gQWRkIE9sbGFtYSBkaXNjb3ZlcnkgKG5vIEFQSSBrZXkgcmVxdWlyZWQpXG4gIGRpc2NvdmVyeVByb21pc2VzLnB1c2goXG4gICAgZGlzY292ZXJPbGxhbWFNb2RlbHMoKS5jYXRjaCgoKSA9PiAoe1xuICAgICAgcHJvdmlkZXI6ICdvbGxhbWEnIGFzIFByb3ZpZGVySWQsXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1vZGVsczogW10gYXMgTW9kZWxDb25maWdbXSxcbiAgICAgIGVycm9yOiAnQ29ubmVjdGlvbiBmYWlsZWQnLFxuICAgIH0pKVxuICApO1xuXG4gIC8vIFBFUkY6IEV4ZWN1dGUgQUxMIHByb3ZpZGVyIGRpc2NvdmVyaWVzIGluIHBhcmFsbGVsIHVzaW5nIFByb21pc2UuYWxsU2V0dGxlZFxuICAvLyBUaGlzIGVuc3VyZXMgb25lIHNsb3cvZmFpbGVkIHByb3ZpZGVyIGRvZXNuJ3QgYmxvY2sgb3RoZXJzXG4gIGNvbnN0IHNldHRsZWRSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGRpc2NvdmVyeVByb21pc2VzKTtcblxuICAvLyBQcm9jZXNzIHJlc3VsdHNcbiAgY29uc3QgcmVzdWx0czogUHJvdmlkZXJEaXNjb3ZlcnlSZXN1bHRbXSA9IHNldHRsZWRSZXN1bHRzLm1hcCgoc2V0dGxlZCwgaW5kZXgpID0+IHtcbiAgICBpZiAoc2V0dGxlZC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnKSB7XG4gICAgICByZXR1cm4gc2V0dGxlZC52YWx1ZTtcbiAgICB9XG4gICAgLy8gUHJvbWlzZSByZWplY3RlZCAoc2hvdWxkbid0IGhhcHBlbiB3aXRoIG91ciBlcnJvciBoYW5kbGluZywgYnV0IGJlIHNhZmUpXG4gICAgY29uc3QgcHJvdmlkZXJJZCA9IGluZGV4IDwgcHJvdmlkZXJzLmxlbmd0aFxuICAgICAgPyBwcm92aWRlcnNbaW5kZXhdIS5pZFxuICAgICAgOiAnb2xsYW1hJztcbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXI6IHByb3ZpZGVySWQsXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1vZGVsczogW10sXG4gICAgICBlcnJvcjogc2V0dGxlZC5yZWFzb24gaW5zdGFuY2VvZiBFcnJvciA/IHNldHRsZWQucmVhc29uLm1lc3NhZ2UgOiBTdHJpbmcoc2V0dGxlZC5yZWFzb24pLFxuICAgIH07XG4gIH0pO1xuXG4gIC8vIENvbGxlY3QgZXJyb3JzIGFuZCBjb3VudCBtb2RlbHNcbiAgZm9yIChjb25zdCByZXN1bHQgb2YgcmVzdWx0cykge1xuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgdG90YWxNb2RlbHNEaXNjb3ZlcmVkICs9IHJlc3VsdC5tb2RlbHMubGVuZ3RoO1xuICAgIH0gZWxzZSBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICAvLyBEb24ndCBhZGQgT2xsYW1hIGNvbm5lY3Rpb24gZXJyb3JzIChpdCdzIG9mdGVuIG5vdCBydW5uaW5nKVxuICAgICAgaWYgKHJlc3VsdC5wcm92aWRlciA9PT0gJ29sbGFtYScgJiZcbiAgICAgICAgICAocmVzdWx0LmVycm9yLmluY2x1ZGVzKCdFQ09OTlJFRlVTRUQnKSB8fFxuICAgICAgICAgICByZXN1bHQuZXJyb3IuaW5jbHVkZXMoJ2ZldGNoIGZhaWxlZCcpIHx8XG4gICAgICAgICAgIHJlc3VsdC5lcnJvci5pbmNsdWRlcygnQ29ubmVjdGlvbiBmYWlsZWQnKSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBlcnJvcnMucHVzaChgJHtyZXN1bHQucHJvdmlkZXJ9OiAke3Jlc3VsdC5lcnJvcn1gKTtcbiAgICB9XG4gIH1cblxuICAvLyBDb2xsZWN0IGFsbCBkaXNjb3ZlcmVkIG1vZGVsc1xuICBjb25zdCBhbGxNb2RlbHMgPSByZXN1bHRzXG4gICAgLmZpbHRlcihyID0+IHIuc3VjY2VzcylcbiAgICAuZmxhdE1hcChyID0+IHIubW9kZWxzKTtcblxuICAvLyBTYXZlIHRvIGNhY2hlXG4gIGlmIChhbGxNb2RlbHMubGVuZ3RoID4gMCkge1xuICAgIGF3YWl0IHNhdmVEaXNjb3ZlcmVkTW9kZWxzKGFsbE1vZGVscyk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN1Y2Nlc3M6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgcmVzdWx0cyxcbiAgICB0b3RhbE1vZGVsc0Rpc2NvdmVyZWQsXG4gICAgZXJyb3JzLFxuICB9O1xufVxuXG4vKipcbiAqIENsZWFyIHRoZSBkaXNjb3ZlcmVkIG1vZGVscyBjYWNoZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJEaXNjb3ZlcmVkTW9kZWxzQ2FjaGUoKTogdm9pZCB7XG4gIHRyeSB7XG4gICAgaWYgKGV4aXN0c1N5bmMoQ0FDSEVfRklMRSkpIHtcbiAgICAgIHdyaXRlRmlsZVN5bmMoQ0FDSEVfRklMRSwgSlNPTi5zdHJpbmdpZnkoeyB2ZXJzaW9uOiAnMS4wLjAnLCBsYXN0VXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCBtb2RlbHM6IFtdIH0sIG51bGwsIDIpLCAndXRmLTgnKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nRGVidWcoJ0ZhaWxlZCB0byBjbGVhciBkaXNjb3ZlcmVkIG1vZGVscyBjYWNoZTonLCBzYWZlRXJyb3JNZXNzYWdlKGVycm9yKSk7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUHJvdmlkZXIgU3RhdHVzIERldGVjdGlvblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFByb3ZpZGVyIGNvbmZpZ3VyYXRpb24gaW5mb1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZpZGVySW5mbyB7XG4gIGlkOiBQcm92aWRlcklkO1xuICBuYW1lOiBzdHJpbmc7XG4gIGVudlZhcjogc3RyaW5nO1xuICBjb25maWd1cmVkOiBib29sZWFuO1xuICBsYXRlc3RNb2RlbDogc3RyaW5nO1xuICBtb2RlbHM/OiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBTdXBwb3J0ZWQgcHJvdmlkZXJzIHdpdGggdGhlaXIgZW52aXJvbm1lbnQgdmFyaWFibGUgcmVxdWlyZW1lbnRzXG4gKi9cbmNvbnN0IFBST1ZJREVSX0NPTkZJR1M6IEFycmF5PHtcbiAgaWQ6IFByb3ZpZGVySWQ7XG4gIG5hbWU6IHN0cmluZztcbiAgZW52VmFyOiBzdHJpbmc7XG4gIGFsdEVudlZhcnM/OiBzdHJpbmdbXTtcbiAgZGVmYXVsdExhdGVzdE1vZGVsOiBzdHJpbmc7XG59PiA9IFtcbiAgeyBpZDogJ2FudGhyb3BpYycsIG5hbWU6ICdBbnRocm9waWMnLCBlbnZWYXI6ICdBTlRIUk9QSUNfQVBJX0tFWScsIGRlZmF1bHRMYXRlc3RNb2RlbDogJ2NsYXVkZS0zLTUtc29ubmV0LTIwMjQxMDIyJyB9LFxuICB7IGlkOiAnb3BlbmFpJywgbmFtZTogJ09wZW5BSScsIGVudlZhcjogJ09QRU5BSV9BUElfS0VZJywgZGVmYXVsdExhdGVzdE1vZGVsOiAnZ3B0LTRvJyB9LFxuICB7IGlkOiAnZ29vZ2xlJywgbmFtZTogJ0dvb2dsZScsIGVudlZhcjogJ0dFTUlOSV9BUElfS0VZJywgYWx0RW52VmFyczogWydHT09HTEVfQVBJX0tFWSddLCBkZWZhdWx0TGF0ZXN0TW9kZWw6ICdnZW1pbmktMi41LWZsYXNoJyB9LFxuICB7IGlkOiAnZGVlcHNlZWsnLCBuYW1lOiAnRGVlcFNlZWsnLCBlbnZWYXI6ICdERUVQU0VFS19BUElfS0VZJywgZGVmYXVsdExhdGVzdE1vZGVsOiAnZGVlcHNlZWstcmVhc29uZXInIH0sXG4gIHsgaWQ6ICd4YWknLCBuYW1lOiAneEFJJywgZW52VmFyOiAnWEFJX0FQSV9LRVknLCBkZWZhdWx0TGF0ZXN0TW9kZWw6ICdncm9rLTQtMS1mYXN0LXJlYXNvbmluZycgfSxcbiB7IGlkOiAnb2xsYW1hJywgbmFtZTogJ09sbGFtYScsIGVudlZhcjogJ09MTEFNQV9CQVNFX1VSTCcsIGRlZmF1bHRMYXRlc3RNb2RlbDogJ2xsYW1hMy4yOjNiJyB9LFxuXTtcblxuLyoqXG4gKiBNb2RlbCBwcmlvcml0eSByYW5raW5ncyBmb3Igc2VsZWN0aW5nIHRoZSBcImJlc3RcIiBtb2RlbFxuICovXG5jb25zdCBNT0RFTF9QUklPUklUSUVTOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+PiA9IHtcbiAgb3BlbmFpOiB7XG4gICAgJ28zLXBybyc6IDEyMCxcbiAgICAnbzMtbWluaSc6IDExNCxcbiAgICAnbzMnOiAxMTIsXG4gICAgJ28xLXBybyc6IDExMCxcbiAgICAnbzEnOiAxMDgsXG4gICAgJ28xLW1pbmknOiAxMDQsXG4gICAgJ2dwdC01LjEtY29kZXgtbWF4JzogMTA1LFxuICAgICdjb2RleC1tYXgnOiAxMDUsXG4gICAgJ2dwdC01LjEtY29kZXgnOiAxMDAsXG4gICAgJ2dwdC01LjEtY29kZXgtbWluaSc6IDk4LFxuICAgICdncHQtNS4xJzogOTYsXG4gICAgJ2dwdC01LXBybyc6IDk0LFxuICAgICdncHQtNS1taW5pJzogOTIsXG4gICAgJ2dwdC01LW5hbm8nOiA5MCxcbiAgICAnZ3B0LTQuMSc6IDk5LFxuICAgICdncHQtNG8nOiA5NyxcbiAgICAnZ3B0LTRvLW1pbmknOiA5NCxcbiAgfSxcbiAgYW50aHJvcGljOiB7XG4gICAgJ2NsYXVkZS1vcHVzLTQtNSc6IDEwNSxcbiAgICAnY2xhdWRlLW9wdXMtNC01LTIwMjUxMTAxJzogMTA1LFxuICAgICdjbGF1ZGUtc29ubmV0LTQtNSc6IDEwMCxcbiAgICAnY2xhdWRlLXNvbm5ldC00LTUtMjAyNTA5MjknOiAxMDAsXG4gICAgJ2NsYXVkZS1vcHVzLTQtMjAyNTA1MTQnOiA5NixcbiAgICAnY2xhdWRlLW9wdXMtNCc6IDk2LFxuICAgICdjbGF1ZGUtc29ubmV0LTQnOiA5NCxcbiAgICAnY2xhdWRlLTMtNS1zb25uZXQtMjAyNDEwMjInOiA5NixcbiAgICAnY2xhdWRlLTMtNS1oYWlrdS0yMDI0MTAyMic6IDkyLFxuICAgICdjbGF1ZGUtMy1vcHVzLTIwMjQwMjI5JzogOTAsXG4gICAgJ2NsYXVkZS0zLXNvbm5ldC0yMDI0MDIyOSc6IDg2LFxuICAgICdjbGF1ZGUtMy1oYWlrdS0yMDI0MDMwNyc6IDgyLFxuICB9LFxuICBnb29nbGU6IHtcbiAgICAnZ2VtaW5pLTMuMC1wcm8nOiAxMDUsXG4gICAgJ2dlbWluaS0zLjAtZmxhc2gnOiAxMDAsXG4gICAgJ2dlbWluaS0yLjUtcHJvJzogOTgsXG4gICAgJ2dlbWluaS0yLjUtZmxhc2gnOiA5NixcbiAgICAnZ2VtaW5pLTIuMC1mbGFzaCc6IDkwLFxuICAgICdnZW1pbmktMi4wJzogODgsXG4gICAgJ2dlbWluaS0xLjUtcHJvJzogODUsXG4gICAgJ2dlbWluaS0xLjUtZmxhc2gnOiA4MixcbiAgfSxcbiAgZGVlcHNlZWs6IHtcbiAgICAnZGVlcHNlZWstcmVhc29uZXInOiAxMDAsXG4gICAgJ2RlZXBzZWVrLWNoYXQnOiA5MCxcbiAgICAnZGVlcHNlZWstY29kZXInOiA4NSxcbiAgfSxcbiAgeGFpOiB7XG4gICAgJ2dyb2stNC0xLWZhc3QtcmVhc29uaW5nJzogMTAwLFxuICAgICdncm9rLTQtMS1mYXN0LW5vbi1yZWFzb25pbmcnOiA5NSxcbiAgICAnZ3Jvay00LWZhc3QtcmVhc29uaW5nJzogOTMsXG4gICAgJ2dyb2stNC1mYXN0LW5vbi1yZWFzb25pbmcnOiA5MCxcbiAgICAnZ3Jvay00JzogODgsXG4gICAgJ2dyb2stY29kZS1mYXN0LTEnOiA4NixcbiAgICAnZ3Jvay0zJzogODIsXG4gICAgJ2dyb2stMy1taW5pJzogNzgsXG4gICAgJ2dyb2stMi12aXNpb24tMTIxMic6IDc1LFxuICAgICdncm9rLTItMTIxMic6IDcyLFxuICAgICdncm9rLWJldGEnOiA2MCxcbiAgfSxcbiAgb2xsYW1hOiB7XG4gICAgJ2xsYW1hMy4xOjhiJzogOTAsXG4gICAgJ2xsYW1hMy4yOjNiJzogODgsXG4gICAgJ3F3ZW4yLjU6MTRiJzogODYsXG4gICAgJ3F3ZW4yLjU6N2InOiA4NCxcbiAgICAnbWlzdHJhbDo3Yic6IDgwLFxuICAgICdkZWVwc2Vlay1jb2Rlcjo2LjdiJzogNzgsXG4gICAgJ2NvZGVsbGFtYTo3Yic6IDcwLFxuICB9LFxufTtcblxuLyoqXG4gKiBHZXQgbW9kZWwgcHJpb3JpdHkgZm9yIHNvcnRpbmdcbiAqL1xuZnVuY3Rpb24gZ2V0TW9kZWxQcmlvcml0eShwcm92aWRlcjogUHJvdmlkZXJJZCwgbW9kZWxJZDogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgcHJpb3JpdGllcyA9IE1PREVMX1BSSU9SSVRJRVNbcHJvdmlkZXJdO1xuICBpZiAoIXByaW9yaXRpZXMpIHJldHVybiAwO1xuXG4gIC8vIENoZWNrIGZvciBleGFjdCBtYXRjaCBmaXJzdFxuICBpZiAocHJpb3JpdGllc1ttb2RlbElkXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuIHByaW9yaXRpZXNbbW9kZWxJZF07XG4gIH1cblxuICAvLyBDaGVjayBmb3IgcHJlZml4IG1hdGNoXG4gIGZvciAoY29uc3QgW3ByZWZpeCwgcHJpb3JpdHldIG9mIE9iamVjdC5lbnRyaWVzKHByaW9yaXRpZXMpKSB7XG4gICAgaWYgKG1vZGVsSWQuc3RhcnRzV2l0aChwcmVmaXgpKSB7XG4gICAgICByZXR1cm4gcHJpb3JpdHk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIDA7XG59XG5cbi8qKlxuICogU29ydCBtb2RlbHMgYnkgcHJpb3JpdHkgKGJlc3QgZmlyc3QpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb3J0TW9kZWxzQnlQcmlvcml0eShwcm92aWRlcjogUHJvdmlkZXJJZCwgbW9kZWxzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIFsuLi5tb2RlbHNdLnNvcnQoKGEsIGIpID0+IHtcbiAgICBjb25zdCBwcmlvcml0eUEgPSBnZXRNb2RlbFByaW9yaXR5KHByb3ZpZGVyLCBhKTtcbiAgICBjb25zdCBwcmlvcml0eUIgPSBnZXRNb2RlbFByaW9yaXR5KHByb3ZpZGVyLCBiKTtcbiAgICByZXR1cm4gcHJpb3JpdHlCIC0gcHJpb3JpdHlBO1xuICB9KTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGJlc3QvbGF0ZXN0IG1vZGVsIGZvciBhIHByb3ZpZGVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCZXN0TW9kZWwocHJvdmlkZXI6IFByb3ZpZGVySWQsIG1vZGVsczogc3RyaW5nW10pOiBzdHJpbmcge1xuICBpZiAobW9kZWxzLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IGNvbmZpZyA9IFBST1ZJREVSX0NPTkZJR1MuZmluZChwID0+IHAuaWQgPT09IHByb3ZpZGVyKTtcbiAgICByZXR1cm4gY29uZmlnPy5kZWZhdWx0TGF0ZXN0TW9kZWwgfHwgJyc7XG4gIH1cblxuICBjb25zdCBzb3J0ZWQgPSBzb3J0TW9kZWxzQnlQcmlvcml0eShwcm92aWRlciwgbW9kZWxzKTtcbiAgcmV0dXJuIHNvcnRlZFswXSA/PyBtb2RlbHNbMF0gPz8gJyc7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBwcm92aWRlciBpcyBjb25maWd1cmVkIChoYXMgQVBJIGtleSBvciBpcyBhY2Nlc3NpYmxlKVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNQcm92aWRlckNvbmZpZ3VyZWQocHJvdmlkZXJJZDogUHJvdmlkZXJJZCk6IGJvb2xlYW4ge1xuICBjb25zdCBjb25maWcgPSBQUk9WSURFUl9DT05GSUdTLmZpbmQocCA9PiBwLmlkID09PSBwcm92aWRlcklkKTtcbiAgaWYgKCFjb25maWcpIHJldHVybiBmYWxzZTtcblxuICAvLyBPbGxhbWEgaXMgc3BlY2lhbCAtIGl0J3MgYXZhaWxhYmxlIGlmIHRoZSBzZXJ2ZXIgaXMgcnVubmluZyAobm8gQVBJIGtleSBuZWVkZWQpXG4gIGlmIChwcm92aWRlcklkID09PSAnb2xsYW1hJykge1xuICAgIC8vIFdlJ2xsIGNoZWNrIHRoaXMgdmlhIGFjdHVhbCBjb25uZWN0aW9uLCByZXR1cm4gdHJ1ZSBmb3Igbm93XG4gICAgLy8gVGhlIGFjdHVhbCBjaGVjayBoYXBwZW5zIGluIGdldENvbmZpZ3VyZWRQcm92aWRlcnNcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIENoZWNrIG1haW4gZW52IHZhclxuICBpZiAocHJvY2Vzcy5lbnZbY29uZmlnLmVudlZhcl0pIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIENoZWNrIGFsdGVybmF0aXZlIGVudiB2YXJzXG4gIGlmIChjb25maWcuYWx0RW52VmFycykge1xuICAgIGZvciAoY29uc3QgYWx0VmFyIG9mIGNvbmZpZy5hbHRFbnZWYXJzKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnZbYWx0VmFyXSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogR2V0IGFsbCBwcm92aWRlcnMgd2l0aCB0aGVpciBjb25maWd1cmF0aW9uIHN0YXR1c1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvdmlkZXJzU3RhdHVzKCk6IFByb3ZpZGVySW5mb1tdIHtcbiAgcmV0dXJuIFBST1ZJREVSX0NPTkZJR1MubWFwKGNvbmZpZyA9PiB7XG4gICAgbGV0IGNvbmZpZ3VyZWQgPSBmYWxzZTtcblxuICAgIGlmIChjb25maWcuaWQgPT09ICdvbGxhbWEnKSB7XG4gICAgICAvLyBGb3IgT2xsYW1hLCB3ZSBjYW4ndCBjaGVjayBzeW5jaHJvbm91c2x5IGlmIGl0J3MgcnVubmluZ1xuICAgICAgLy8gTWFyayBhcyBwb3RlbnRpYWxseSBhdmFpbGFibGVcbiAgICAgIGNvbmZpZ3VyZWQgPSAhIXByb2Nlc3MuZW52WydPTExBTUFfQkFTRV9VUkwnXSB8fCB0cnVlOyAvLyBBbHdheXMgc2hvdyBPbGxhbWEgYXMgb3B0aW9uXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbmZpZ3VyZWQgPSAhIXByb2Nlc3MuZW52W2NvbmZpZy5lbnZWYXJdO1xuICAgICAgaWYgKCFjb25maWd1cmVkICYmIGNvbmZpZy5hbHRFbnZWYXJzKSB7XG4gICAgICAgIGNvbmZpZ3VyZWQgPSBjb25maWcuYWx0RW52VmFycy5zb21lKHYgPT4gISFwcm9jZXNzLmVudlt2XSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBjb25maWcuaWQsXG4gICAgICBuYW1lOiBjb25maWcubmFtZSxcbiAgICAgIGVudlZhcjogY29uZmlnLmVudlZhcixcbiAgICAgIGNvbmZpZ3VyZWQsXG4gICAgICBsYXRlc3RNb2RlbDogY29uZmlnLmRlZmF1bHRMYXRlc3RNb2RlbCxcbiAgICB9O1xuICB9KTtcbn1cblxuLyoqXG4gKiBHZXQgbGlzdCBvZiBjb25maWd1cmVkIHByb3ZpZGVycyAod2l0aCB2YWxpZCBBUEkga2V5cylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbmZpZ3VyZWRQcm92aWRlcnMoKTogUHJvdmlkZXJJbmZvW10ge1xuICByZXR1cm4gZ2V0UHJvdmlkZXJzU3RhdHVzKCkuZmlsdGVyKHAgPT4gcC5jb25maWd1cmVkKTtcbn1cblxuLyoqXG4gKiBHZXQgbGlzdCBvZiB1bmNvbmZpZ3VyZWQgcHJvdmlkZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRVbmNvbmZpZ3VyZWRQcm92aWRlcnMoKTogUHJvdmlkZXJJbmZvW10ge1xuICByZXR1cm4gZ2V0UHJvdmlkZXJzU3RhdHVzKCkuZmlsdGVyKHAgPT4gIXAuY29uZmlndXJlZCk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBhdmFpbGFibGUgcHJvdmlkZXIgKGZvciBhdXRvLXNlbGVjdGlvbilcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcnN0QXZhaWxhYmxlUHJvdmlkZXIoKTogUHJvdmlkZXJJbmZvIHwgbnVsbCB7XG4gIGNvbnN0IGNvbmZpZ3VyZWQgPSBnZXRDb25maWd1cmVkUHJvdmlkZXJzKCk7XG5cbiAgLy8gUHJlZmVyIGluIHRoaXMgb3JkZXI6IGFudGhyb3BpYywgb3BlbmFpLCBnb29nbGUsIGRlZXBzZWVrLCB4YWksIG9sbGFtYVxuICBjb25zdCBwcmVmZXJlbmNlT3JkZXIgPSBbJ2FudGhyb3BpYycsICdvcGVuYWknLCAnZ29vZ2xlJywgJ2RlZXBzZWVrJywgJ3hhaScsICdvbGxhbWEnXTtcblxuICBmb3IgKGNvbnN0IHByb3ZpZGVySWQgb2YgcHJlZmVyZW5jZU9yZGVyKSB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjb25maWd1cmVkLmZpbmQocCA9PiBwLmlkID09PSBwcm92aWRlcklkKTtcbiAgICBpZiAocHJvdmlkZXIgJiYgcHJvdmlkZXIuaWQgIT09ICdvbGxhbWEnKSB7XG4gICAgICByZXR1cm4gcHJvdmlkZXI7XG4gICAgfVxuICB9XG5cbiAgLy8gRmFsbCBiYWNrIHRvIE9sbGFtYSBpZiBub3RoaW5nIGVsc2UgaXMgY29uZmlndXJlZFxuICByZXR1cm4gY29uZmlndXJlZC5maW5kKHAgPT4gcC5pZCA9PT0gJ29sbGFtYScpIHx8IG51bGw7XG59XG5cbi8qKlxuICogR2V0IGxhdGVzdCBtb2RlbCBmb3IgYSBwcm92aWRlciBmcm9tIGNhY2hlIG9yIGRlZmF1bHRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMYXRlc3RNb2RlbEZvclByb3ZpZGVyKHByb3ZpZGVySWQ6IFByb3ZpZGVySWQpOiBzdHJpbmcge1xuICAvLyBDaGVjayBjYWNoZSBmaXJzdFxuICBjb25zdCBjYWNoZWQgPSBnZXRDYWNoZWREaXNjb3ZlcmVkTW9kZWxzKCk7XG4gIGNvbnN0IHByb3ZpZGVyTW9kZWxzID0gY2FjaGVkLmZpbHRlcihtID0+IG0ucHJvdmlkZXIgPT09IHByb3ZpZGVySWQpO1xuXG4gIGlmIChwcm92aWRlck1vZGVscy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgbW9kZWxJZHMgPSBwcm92aWRlck1vZGVscy5tYXAobSA9PiBtLmlkKTtcbiAgICByZXR1cm4gZ2V0QmVzdE1vZGVsKHByb3ZpZGVySWQsIG1vZGVsSWRzKTtcbiAgfVxuXG4gIC8vIEZhbGwgYmFjayB0byBkZWZhdWx0XG4gIGNvbnN0IGNvbmZpZyA9IFBST1ZJREVSX0NPTkZJR1MuZmluZChwID0+IHAuaWQgPT09IHByb3ZpZGVySWQpO1xuICByZXR1cm4gY29uZmlnPy5kZWZhdWx0TGF0ZXN0TW9kZWwgfHwgJyc7XG59XG5cbi8qKlxuICogUXVpY2sgcHJvdmlkZXIgYXZhaWxhYmlsaXR5IGNoZWNrIHJlc3VsdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFF1aWNrUHJvdmlkZXJTdGF0dXMge1xuICBwcm92aWRlcjogUHJvdmlkZXJJZDtcbiAgYXZhaWxhYmxlOiBib29sZWFuO1xuICBsYXRlc3RNb2RlbDogc3RyaW5nO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuLyoqXG4gKiBRdWljayBBUEkgY2hlY2sgZm9yIGEgc2luZ2xlIHByb3ZpZGVyIC0gcmV0dXJucyBiZXN0IG1vZGVsIG9yIG51bGxcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcXVpY2tGZXRjaFByb3ZpZGVyTW9kZWxzKFxuICBwcm92aWRlcklkOiBQcm92aWRlcklkLFxuICBhcGlLZXk6IHN0cmluZyxcbiAgdGltZW91dE1zOiBudW1iZXIgPSAzMDAwXG4pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gIHRyeSB7XG4gICAgc3dpdGNoIChwcm92aWRlcklkKSB7XG4gICAgICBjYXNlICdvcGVuYWknOiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvbW9kZWxzJywge1xuICAgICAgICAgIGhlYWRlcnM6IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7YXBpS2V5fWAgfSxcbiAgICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQodGltZW91dE1zKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBbXTtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyB7IGRhdGE6IEFycmF5PHsgaWQ6IHN0cmluZyB9PiB9O1xuICAgICAgICByZXR1cm4gZGF0YS5kYXRhXG4gICAgICAgICAgLmZpbHRlcihtID0+XG4gICAgICAgICAgICBtLmlkLnN0YXJ0c1dpdGgoJ2dwdC0nKSB8fFxuICAgICAgICAgICAgbS5pZC5zdGFydHNXaXRoKCdvMScpIHx8XG4gICAgICAgICAgICBtLmlkLnN0YXJ0c1dpdGgoJ28zJykgfHxcbiAgICAgICAgICAgIG0uaWQuc3RhcnRzV2l0aCgnY29kZXgtJylcbiAgICAgICAgICApXG4gICAgICAgICAgLm1hcChtID0+IG0uaWQpO1xuICAgICAgfVxuXG4gICAgICBjYXNlICdhbnRocm9waWMnOiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmFudGhyb3BpYy5jb20vdjEvbW9kZWxzJywge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICd4LWFwaS1rZXknOiBhcGlLZXksXG4gICAgICAgICAgICAnYW50aHJvcGljLXZlcnNpb24nOiAnMjAyMy0wNi0wMScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQodGltZW91dE1zKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBbXTtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyB7IGRhdGE6IEFycmF5PHsgaWQ6IHN0cmluZzsgdHlwZTogc3RyaW5nIH0+IH07XG4gICAgICAgIHJldHVybiBkYXRhLmRhdGEuZmlsdGVyKG0gPT4gbS50eXBlID09PSAnbW9kZWwnKS5tYXAobSA9PiBtLmlkKTtcbiAgICAgIH1cblxuICAgICAgY2FzZSAnZ29vZ2xlJzoge1xuICAgICAgICAvLyBTRUNVUklUWTogVXNlIHgtZ29vZy1hcGkta2V5IGhlYWRlciBpbnN0ZWFkIG9mIFVSTCBxdWVyeSBwYXJhbWV0ZXJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscycsIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAneC1nb29nLWFwaS1rZXknOiBhcGlLZXksXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQodGltZW91dE1zKSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBbXTtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyB7XG4gICAgICAgICAgbW9kZWxzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgc3VwcG9ydGVkR2VuZXJhdGlvbk1ldGhvZHM/OiBzdHJpbmdbXSB9PlxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGF0YS5tb2RlbHNcbiAgICAgICAgICAuZmlsdGVyKG0gPT4gbS5uYW1lLmluY2x1ZGVzKCdnZW1pbmknKSAmJiBtLnN1cHBvcnRlZEdlbmVyYXRpb25NZXRob2RzPy5pbmNsdWRlcygnZ2VuZXJhdGVDb250ZW50JykpXG4gICAgICAgICAgLm1hcChtID0+IG0ubmFtZS5yZXBsYWNlKCdtb2RlbHMvJywgJycpKTtcbiAgICAgIH1cblxuICAgICAgY2FzZSAnZGVlcHNlZWsnOiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbS92MS9tb2RlbHMnLCB7XG4gICAgICAgICAgaGVhZGVyczogeyAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthcGlLZXl9YCB9LFxuICAgICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCh0aW1lb3V0TXMpLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgcmV0dXJuIFtdO1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIHsgZGF0YTogQXJyYXk8eyBpZDogc3RyaW5nIH0+IH07XG4gICAgICAgIHJldHVybiBkYXRhLmRhdGEubWFwKG0gPT4gbS5pZCk7XG4gICAgICB9XG5cbiAgICAgIGNhc2UgJ3hhaSc6IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkueC5haS92MS9tb2RlbHMnLCB7XG4gICAgICAgICAgaGVhZGVyczogeyAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthcGlLZXl9YCB9LFxuICAgICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCh0aW1lb3V0TXMpLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgcmV0dXJuIFtdO1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpIGFzIHsgZGF0YTogQXJyYXk8eyBpZDogc3RyaW5nIH0+IH07XG4gICAgICAgIHJldHVybiBkYXRhLmRhdGEubWFwKG0gPT4gbS5pZCk7XG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIFF1aWNrbHkgY2hlY2sgaWYgcHJvdmlkZXJzIGFyZSBhdmFpbGFibGUgYnkgcXVlcnlpbmcgdGhlaXIgQVBJc1xuICogUmV0dXJucyBhY3R1YWwgbGF0ZXN0IG1vZGVscyBmcm9tIGVhY2ggcHJvdmlkZXJcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1aWNrQ2hlY2tQcm92aWRlcnMoKTogUHJvbWlzZTxRdWlja1Byb3ZpZGVyU3RhdHVzW10+IHtcbiAgY29uc3QgY2hlY2tzOiBQcm9taXNlPFF1aWNrUHJvdmlkZXJTdGF0dXM+W10gPSBbXTtcblxuICBmb3IgKGNvbnN0IGNvbmZpZyBvZiBQUk9WSURFUl9DT05GSUdTKSB7XG4gICAgLy8gSGFuZGxlIE9sbGFtYSBzZXBhcmF0ZWx5IChubyBBUEkga2V5IG5lZWRlZClcbiAgICBpZiAoY29uZmlnLmlkID09PSAnb2xsYW1hJykge1xuICAgICAgY2hlY2tzLnB1c2goKGFzeW5jICgpOiBQcm9taXNlPFF1aWNrUHJvdmlkZXJTdGF0dXM+ID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBiYXNlVVJMID0gcHJvY2Vzcy5lbnZbJ09MTEFNQV9CQVNFX1VSTCddIHx8ICdodHRwOi8vbG9jYWxob3N0OjExNDM0JztcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke2Jhc2VVUkx9L2FwaS90YWdzYCwge1xuICAgICAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDE1MDApLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKSBhcyB7IG1vZGVscz86IEFycmF5PHsgbmFtZTogc3RyaW5nIH0+IH07XG4gICAgICAgICAgICBjb25zdCBtb2RlbHMgPSBkYXRhLm1vZGVscz8ubWFwKG0gPT4gbS5uYW1lKSB8fCBbXTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHByb3ZpZGVyOiAnb2xsYW1hJyxcbiAgICAgICAgICAgICAgYXZhaWxhYmxlOiBtb2RlbHMubGVuZ3RoID4gMCxcbiAgICAgICAgICAgICAgbGF0ZXN0TW9kZWw6IG1vZGVsc1swXSB8fCBjb25maWcuZGVmYXVsdExhdGVzdE1vZGVsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggeyAvKiBpZ25vcmUgKi8gfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHByb3ZpZGVyOiAnb2xsYW1hJyxcbiAgICAgICAgICBhdmFpbGFibGU6IGZhbHNlLFxuICAgICAgICAgIGxhdGVzdE1vZGVsOiBjb25maWcuZGVmYXVsdExhdGVzdE1vZGVsLFxuICAgICAgICAgIGVycm9yOiAnTm90IHJ1bm5pbmcnLFxuICAgICAgICB9O1xuICAgICAgfSkoKSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgQVBJIGtleVxuICAgIGxldCBhcGlLZXkgPSBwcm9jZXNzLmVudltjb25maWcuZW52VmFyXTtcbiAgICBpZiAoIWFwaUtleSAmJiBjb25maWcuYWx0RW52VmFycykge1xuICAgICAgZm9yIChjb25zdCBhbHRWYXIgb2YgY29uZmlnLmFsdEVudlZhcnMpIHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52W2FsdFZhcl0pIHtcbiAgICAgICAgICBhcGlLZXkgPSBwcm9jZXNzLmVudlthbHRWYXJdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgIGNoZWNrcy5wdXNoKFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgIHByb3ZpZGVyOiBjb25maWcuaWQsXG4gICAgICAgIGF2YWlsYWJsZTogZmFsc2UsXG4gICAgICAgIGxhdGVzdE1vZGVsOiBjb25maWcuZGVmYXVsdExhdGVzdE1vZGVsLFxuICAgICAgICBlcnJvcjogYCR7Y29uZmlnLmVudlZhcn0gbm90IHNldGAsXG4gICAgICB9KSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBRdWVyeSB0aGUgQVBJIGZvciBhY3R1YWwgbW9kZWxzXG4gICAgY2hlY2tzLnB1c2goKGFzeW5jICgpOiBQcm9taXNlPFF1aWNrUHJvdmlkZXJTdGF0dXM+ID0+IHtcbiAgICAgIGNvbnN0IG1vZGVscyA9IGF3YWl0IHF1aWNrRmV0Y2hQcm92aWRlck1vZGVscyhjb25maWcuaWQsIGFwaUtleSwgMzAwMCk7XG4gICAgICBpZiAobW9kZWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgYmVzdE1vZGVsID0gZ2V0QmVzdE1vZGVsKGNvbmZpZy5pZCwgbW9kZWxzKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwcm92aWRlcjogY29uZmlnLmlkLFxuICAgICAgICAgIGF2YWlsYWJsZTogdHJ1ZSxcbiAgICAgICAgICBsYXRlc3RNb2RlbDogYmVzdE1vZGVsLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgLy8gQVBJIGNhbGwgZmFpbGVkIG9yIHJldHVybmVkIG5vIG1vZGVscyAtIHN0aWxsIG1hcmsgYXZhaWxhYmxlIGlmIGtleSBleGlzdHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHByb3ZpZGVyOiBjb25maWcuaWQsXG4gICAgICAgIGF2YWlsYWJsZTogdHJ1ZSxcbiAgICAgICAgbGF0ZXN0TW9kZWw6IGNvbmZpZy5kZWZhdWx0TGF0ZXN0TW9kZWwsXG4gICAgICAgIGVycm9yOiAnQ291bGQgbm90IGZldGNoIG1vZGVscycsXG4gICAgICB9O1xuICAgIH0pKCkpO1xuICB9XG5cbiAgLy8gUnVuIGFsbCBjaGVja3MgaW4gcGFyYWxsZWwgZm9yIHNwZWVkXG4gIHJldHVybiBQcm9taXNlLmFsbChjaGVja3MpO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFRQSxJQUFBQSxPQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFILE9BQUE7QUFHQSxJQUFBSSxZQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxZQUFBLEdBQUFMLE9BQUE7QUFmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFXQTtB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QUFHc0MsT0FBTyxDQUFDQyxHQUFHLENBQUNtRCxNQUFNLENBQUM5QyxNQUFNLENBQUM7SUFDdkMsSUFBSSxDQUFDNUMsTUFBTSxJQUFJMEYsTUFBTSxDQUFDdkIsVUFBVSxFQUFFO01BQ2hDLEtBQUssTUFBTTRCLE1BQU0sSUFBSUwsTUFBTSxDQUFDdkIsVUFBVSxFQUFFO1FBQ3RDLElBQUk3QixPQUFPLENBQUNDLEdBQUcsQ0FBQ3dELE1BQU0sQ0FBQyxFQUFFO1VBQ3ZCL0YsTUFBTSxHQUFHc0MsT0FBTyxDQUFDQyxHQUFHLENBQUN3RCxNQUFNLENBQUM7VUFDNUI7UUFDRjtNQUNGO0lBQ0Y7SUFFQSxJQUFJLENBQUMvRixNQUFNLEVBQUU7TUFDWGlILE1BQU0sQ0FBQ2pFLElBQUksQ0FBQ0csT0FBTyxDQUFDZ0UsT0FBTyxDQUFDO1FBQzFCNUksUUFBUSxFQUFFbUgsTUFBTSxDQUFDL0UsRUFBRTtRQUNuQnVHLFNBQVMsRUFBRSxLQUFLO1FBQ2hCZCxXQUFXLEVBQUVWLE1BQU0sQ0FBQ3hCLGtCQUFrQjtRQUN0QzdFLEtBQUssRUFBRSxHQUFHcUcsTUFBTSxDQUFDOUMsTUFBTTtNQUN6QixDQUFDLENBQUMsQ0FBQztNQUNIO0lBQ0Y7O0lBRUE7SUFDQXFFLE1BQU0sQ0FBQ2pFLElBQUksQ0FBQyxDQUFDLFlBQTBDO01BQ3JELE1BQU01RCxNQUFNLEdBQUcsTUFBTTBILHdCQUF3QixDQUFDcEIsTUFBTSxDQUFDL0UsRUFBRSxFQUFFWCxNQUFNLEVBQUUsSUFBSSxDQUFDO01BQ3RFLElBQUlaLE1BQU0sQ0FBQzZDLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDckIsTUFBTW1GLFNBQVMsR0FBRzNCLFlBQVksQ0FBQ0MsTUFBTSxDQUFDL0UsRUFBRSxFQUFFdkIsTUFBTSxDQUFDO1FBQ2pELE9BQU87VUFDTGIsUUFBUSxFQUFFbUgsTUFBTSxDQUFDL0UsRUFBRTtVQUNuQnVHLFNBQVMsRUFBRSxJQUFJO1VBQ2ZkLFdBQVcsRUFBRWdCO1FBQ2YsQ0FBQztNQUNIO01BQ0E7TUFDQSxPQUFPO1FBQ0w3SSxRQUFRLEVBQUVtSCxNQUFNLENBQUMvRSxFQUFFO1FBQ25CdUcsU0FBUyxFQUFFLElBQUk7UUFDZmQsV0FBVyxFQUFFVixNQUFNLENBQUN4QixrQkFBa0I7UUFDdEM3RSxLQUFLLEVBQUU7TUFDVCxDQUFDO0lBQ0gsQ0FBQyxFQUFFLENBQUMsQ0FBQztFQUNQOztFQUVBO0VBQ0EsT0FBTzhELE9BQU8sQ0FBQ2tFLEdBQUcsQ0FBQ0osTUFBTSxDQUFDO0FBQzVCIiwiaWdub3JlTGlzdCI6W119
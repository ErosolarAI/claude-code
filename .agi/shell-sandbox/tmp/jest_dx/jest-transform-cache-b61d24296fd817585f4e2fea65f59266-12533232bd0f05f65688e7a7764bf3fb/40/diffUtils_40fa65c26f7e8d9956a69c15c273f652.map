{"version":3,"names":["_nodeChild_process","require","_nodeFs","_nodeOs","_nodePath","buildDiffSegments","previous","next","before","normalizeNewlines","after","gitSegments","tryBuildWithGit","buildNaiveDiff","buildDiffSegmentsFast","oldLines","splitLines","newLines","segments","MAX_DIFF_SEGMENTS","MAX_LINE_LENGTH","i","j","length","remaining","Math","max","push","type","lineNumber","content","oldLine","newLine","lookAhead","foundOld","foundNew","k","slice","ANSI_RESET","ANSI_RED","ANSI_GREEN","ANSI_DIM","formatDiffLines","diff","useColors","width","map","entry","toString","body","paddedNumber","padStart","prefix","formatDiffClaudeStyle","maxLineWidth","wrapWidth","normalizeWrapWidth","INDENT","result","continuationPad","repeat","continuationPrefix","wrappedLines","wrapDiffLine","lineContent","isFirstLine","linePrefix","Number","isFinite","floor","terminalWidth","process","stdout","columns","baseWidth","min","line","maxWidth","breakPoint","lastIndexOf","substring","trimStart","tempDir","mkdtempSync","join","tmpdir","originalPath","updatedPath","writeFileSync","spawnSync","encoding","error","code","status","parseUnifiedDiff","rmSync","recursive","force","output","trim","lines","split","rawLine","replace","startsWith","match","exec","parseInt","a","b","index","left","right","value","normalized","buildDiffWithContext","contextLines","additions","removals","changes","foundInNew","foundInOld","newLineIndex","oldLineIndex","filter","c","changeIndices","Set","removedIndices","change","undefined","add","linesToShow","idx","lastLineShown","sortedLines","Array","from","sort","lineIdx","has","finalSegments","changeIdx","seg","removedOldIdx","matchingAdd","find","abs"],"sources":["diffUtils.ts"],"sourcesContent":["import { spawnSync } from 'node:child_process';\nimport { mkdtempSync, rmSync, writeFileSync } from 'node:fs';\nimport { tmpdir } from 'node:os';\nimport { join } from 'node:path';\n\nexport interface DiffSegment {\n  type: 'added' | 'removed' | 'context';\n  lineNumber: number;\n  content: string;\n}\n\n/**\n * Result from building a diff with context lines\n */\nexport interface DiffWithContext {\n  segments: DiffSegment[];\n  additions: number;\n  removals: number;\n}\n\nexport function buildDiffSegments(previous: string, next: string): DiffSegment[] {\n  const before = normalizeNewlines(previous);\n  const after = normalizeNewlines(next);\n\n  if (before === after) {\n    return [];\n  }\n\n  const gitSegments = tryBuildWithGit(before, after);\n  if (gitSegments) {\n    return gitSegments;\n  }\n\n  return buildNaiveDiff(before, after);\n}\n\n/**\n * Fast in-memory diff algorithm - no git spawning, no temp files.\n * Uses efficient line-by-line comparison with context tracking.\n * ~10x faster than git-based diff for typical edits.\n */\nexport function buildDiffSegmentsFast(previous: string, next: string): DiffSegment[] {\n  const before = normalizeNewlines(previous);\n  const after = normalizeNewlines(next);\n\n  if (before === after) {\n    return [];\n  }\n\n  const oldLines = splitLines(before);\n  const newLines = splitLines(after);\n  const segments: DiffSegment[] = [];\n\n  // Limit output for very large files\n  const MAX_DIFF_SEGMENTS = 200;\n  const MAX_LINE_LENGTH = 500;\n\n  // Use simple LCS-based approach optimized for typical code edits\n  // Most edits are small, so we use a fast path for detecting changed regions\n  let i = 0;\n  let j = 0;\n\n  while (i < oldLines.length || j < newLines.length) {\n    if (segments.length >= MAX_DIFF_SEGMENTS) {\n      const remaining = Math.max(oldLines.length - i, newLines.length - j);\n      if (remaining > 0) {\n        segments.push({\n          type: 'added',\n          lineNumber: 0,\n          content: `[Diff truncated - ${remaining} more lines not shown]`\n        });\n      }\n      break;\n    }\n\n    const oldLine = oldLines[i];\n    const newLine = newLines[j];\n\n    // Both lines exist and match - skip\n    if (oldLine === newLine) {\n      i++;\n      j++;\n      continue;\n    }\n\n    // Look ahead to find matching lines (handles insertions/deletions)\n    const lookAhead = 10;\n    let foundOld = -1;\n    let foundNew = -1;\n\n    // Check if current old line appears later in new (deletion followed by same content)\n    for (let k = 1; k <= lookAhead && j + k < newLines.length; k++) {\n      if (oldLine === newLines[j + k]) {\n        foundNew = j + k;\n        break;\n      }\n    }\n\n    // Check if current new line appears later in old (insertion)\n    for (let k = 1; k <= lookAhead && i + k < oldLines.length; k++) {\n      if (newLine === oldLines[i + k]) {\n        foundOld = i + k;\n        break;\n      }\n    }\n\n    // Insertion: new lines were added\n    if (foundOld > 0 && (foundNew < 0 || foundNew > foundOld)) {\n      while (j < newLines.length && newLines[j] !== oldLines[i]) {\n        if (segments.length >= MAX_DIFF_SEGMENTS) break;\n        const content = newLines[j] || '';\n        segments.push({\n          type: 'added',\n          lineNumber: j + 1,\n          content: content.length > MAX_LINE_LENGTH ? `${content.slice(0, MAX_LINE_LENGTH)  }...` : content\n        });\n        j++;\n      }\n      continue;\n    }\n\n    // Deletion: old lines were removed\n    if (foundNew > 0) {\n      while (i < oldLines.length && oldLines[i] !== newLines[j]) {\n        if (segments.length >= MAX_DIFF_SEGMENTS) break;\n        const content = oldLines[i] || '';\n        segments.push({\n          type: 'removed',\n          lineNumber: i + 1,\n          content: content.length > MAX_LINE_LENGTH ? `${content.slice(0, MAX_LINE_LENGTH)  }...` : content\n        });\n        i++;\n      }\n      continue;\n    }\n\n    // Modification: line changed\n    if (typeof oldLine === 'string') {\n      const content = oldLine.length > MAX_LINE_LENGTH ? `${oldLine.slice(0, MAX_LINE_LENGTH)  }...` : oldLine;\n      segments.push({ type: 'removed', lineNumber: i + 1, content });\n      i++;\n    }\n    if (typeof newLine === 'string') {\n      const content = newLine.length > MAX_LINE_LENGTH ? `${newLine.slice(0, MAX_LINE_LENGTH)  }...` : newLine;\n      segments.push({ type: 'added', lineNumber: j + 1, content });\n      j++;\n    }\n\n    // Handle end of one array\n    if (i >= oldLines.length && j < newLines.length) {\n      j++;\n    } else if (j >= newLines.length && i < oldLines.length) {\n      i++;\n    }\n  }\n\n  return segments;\n}\n\n// ANSI color codes for terminal output\nconst ANSI_RESET = '\\x1b[0m';\nconst ANSI_RED = '\\x1b[31m';\nconst ANSI_GREEN = '\\x1b[32m';\nconst ANSI_DIM = '\\x1b[2m';\n// Background colors for Claude Code style highlighting\n\n/**\n * Format diff lines with + and - prefixes for added/removed lines.\n * Supports context lines (unchanged lines around changes).\n */\nexport function formatDiffLines(diff: DiffSegment[], useColors = true): string[] {\n  if (!diff.length) {\n    return [];\n  }\n  const width = Math.max(\n    1,\n    ...diff.map((entry) => Math.max(1, entry.lineNumber).toString().length)\n  );\n\n  return diff.map((entry) => {\n    const lineNumber = Math.max(1, entry.lineNumber);\n    const body = entry.content.length > 0 ? entry.content : '[empty line]';\n    const paddedNumber = lineNumber.toString().padStart(width, ' ');\n\n    if (entry.type === 'added') {\n      const prefix = '+';\n      if (useColors) {\n        return `${ANSI_GREEN}${prefix} L${paddedNumber} | ${body}${ANSI_RESET}`;\n      }\n      return `${prefix} L${paddedNumber} | ${body}`;\n    } else if (entry.type === 'removed') {\n      const prefix = '-';\n      if (useColors) {\n        return `${ANSI_RED}${prefix} L${paddedNumber} | ${body}${ANSI_RESET}`;\n      }\n      return `${prefix} L${paddedNumber} | ${body}`;\n    } else {\n      // context line\n      if (useColors) {\n        return `${ANSI_DIM}  L${paddedNumber} | ${body}${ANSI_RESET}`;\n      }\n      return `  L${paddedNumber} | ${body}`;\n    }\n  });\n}\n\n/**\n * Format diff in Claude Code style with proper indentation and line wrapping.\n * Shows line numbers in margin with +/- symbols for changes.\n * Long lines are wrapped with continuation markers, but the default width is\n * deliberately generous so single logical lines don't look like multiple edits.\n *\n * Example output:\n *   1832 +    /**\n *        +     * Show a compacting\n *        + status with animated\n */\nexport function formatDiffClaudeStyle(\n  diff: DiffSegment[],\n  useColors = true,\n  maxLineWidth?: number\n): string[] {\n  if (!diff.length) {\n    return [];\n  }\n\n  // Use terminal-aware width so single logical lines don't appear split.\n  const wrapWidth = normalizeWrapWidth(maxLineWidth);\n\n  const INDENT = '      '; // 6 spaces for line number column\n  const width = Math.max(\n    1,\n    ...diff.map((entry) => Math.max(1, entry.lineNumber).toString().length)\n  );\n\n  const result: string[] = [];\n\n  for (const entry of diff) {\n    const lineNumber = Math.max(1, entry.lineNumber);\n    const paddedNumber = lineNumber.toString().padStart(width, ' ');\n    const continuationPad = ' '.repeat(width); // Same width as line number for continuation\n\n    if (entry.type === 'added') {\n      const prefix = ` ${paddedNumber} +`;\n      const continuationPrefix = `${continuationPad}    +`; // Align + with first line\n      const body = entry.content;\n\n      // Wrap long lines using terminal-aware width\n      const wrappedLines = wrapDiffLine(body, wrapWidth);\n\n      for (let i = 0; i < wrappedLines.length; i++) {\n        const lineContent = wrappedLines[i];\n        const isFirstLine = i === 0;\n        const linePrefix = isFirstLine ? prefix : continuationPrefix;\n\n        if (useColors) {\n          result.push(`${ANSI_GREEN}${INDENT}${linePrefix}   ${lineContent}${ANSI_RESET}`);\n        } else {\n          result.push(`${INDENT}${linePrefix}   ${lineContent}`);\n        }\n      }\n    } else if (entry.type === 'removed') {\n      const prefix = ` ${paddedNumber} -`;\n      const continuationPrefix = `${continuationPad}    -`; // Align - with first line\n      const body = entry.content;\n\n      // Wrap long lines using terminal-aware width\n      const wrappedLines = wrapDiffLine(body, wrapWidth);\n\n      for (let i = 0; i < wrappedLines.length; i++) {\n        const lineContent = wrappedLines[i];\n        const isFirstLine = i === 0;\n        const linePrefix = isFirstLine ? prefix : continuationPrefix;\n\n        if (useColors) {\n          result.push(`${ANSI_RED}${INDENT}${linePrefix}   ${lineContent}${ANSI_RESET}`);\n        } else {\n          result.push(`${INDENT}${linePrefix}   ${lineContent}`);\n        }\n      }\n    } else {\n      // context line - no wrapping for context\n      const prefix = ` ${paddedNumber}  `;\n      const body = entry.content;\n      if (useColors) {\n        result.push(`${ANSI_DIM}${INDENT}${prefix}  ${body}${ANSI_RESET}`);\n      } else {\n        result.push(`${INDENT}${prefix}  ${body}`);\n      }\n    }\n  }\n\n  return result;\n}\n\nfunction normalizeWrapWidth(maxLineWidth?: number): number {\n  // Honor explicit width when provided\n  if (typeof maxLineWidth === 'number' && Number.isFinite(maxLineWidth) && maxLineWidth > 0) {\n    return Math.max(40, Math.floor(maxLineWidth));\n  }\n\n  const terminalWidth = typeof process.stdout?.columns === 'number' && process.stdout.columns > 0\n    ? process.stdout.columns\n    : null;\n\n  // Default to a generous width so single logical lines don't render as multiple edits.\n  // We intentionally avoid shrinking to the terminal width; the terminal can wrap naturally\n  // without adding extra +/- prefixes that look like new lines.\n  const baseWidth = terminalWidth ? Math.max(terminalWidth - 8, 120) : 240;\n\n  // Cap to avoid runaway wrapping for extremely long lines while keeping most code unwrapped.\n  return Math.max(200, Math.min(baseWidth, 500));\n}\n\n/**\n * Wrap a diff line at word boundaries if it exceeds maxWidth.\n * Preserves leading whitespace on first line.\n */\nfunction wrapDiffLine(line: string, maxWidth: number): string[] {\n  const width = Math.max(1, Math.floor(maxWidth));\n\n  if (line.length <= width) {\n    return [line];\n  }\n\n  const result: string[] = [];\n  let remaining = line;\n\n  while (remaining.length > width) {\n    // Find a good break point (space, or force break at maxWidth)\n    let breakPoint = remaining.lastIndexOf(' ', width);\n    if (breakPoint <= 0) {\n      // No space found, force break\n      breakPoint = width;\n    }\n\n    result.push(remaining.substring(0, breakPoint));\n    remaining = remaining.substring(breakPoint).trimStart();\n  }\n\n  if (remaining.length > 0) {\n    result.push(remaining);\n  }\n\n  return result.length > 0 ? result : [''];\n}\n\nfunction tryBuildWithGit(before: string, after: string): DiffSegment[] | null {\n  let tempDir: string | null = null;\n  try {\n    tempDir = mkdtempSync(join(tmpdir(), 'agi-diff-'));\n    const originalPath = join(tempDir, 'before.txt');\n    const updatedPath = join(tempDir, 'after.txt');\n    writeFileSync(originalPath, before, 'utf8');\n    writeFileSync(updatedPath, after, 'utf8');\n\n    const result = spawnSync(\n      'git',\n      ['--no-pager', 'diff', '--no-index', '--unified=0', '--color=never', '--', originalPath, updatedPath],\n      { encoding: 'utf8' }\n    );\n\n    if (result.error) {\n      const code = (result.error as NodeJS.ErrnoException).code;\n      if (code === 'ENOENT') {\n        return null;\n      }\n      return null;\n    }\n\n    if (typeof result.status === 'number' && result.status > 1) {\n      return null;\n    }\n\n    return parseUnifiedDiff(result.stdout);\n  } catch {\n    return null;\n  } finally {\n    if (tempDir) {\n      rmSync(tempDir, { recursive: true, force: true });\n    }\n  }\n}\n\nfunction parseUnifiedDiff(output: string): DiffSegment[] {\n  if (!output.trim()) {\n    return [];\n  }\n\n  const lines = output.split('\\n');\n  const segments: DiffSegment[] = [];\n  let oldLine = 0;\n  let newLine = 0;\n\n  for (const rawLine of lines) {\n    const line = rawLine.replace(/\\r$/, '');\n    if (!line) {\n      continue;\n    }\n    if (line.startsWith('@@')) {\n      const match = /@@ -(\\d+)(?:,\\d+)? \\+(\\d+)(?:,\\d+)? @@/.exec(line);\n      if (match?.[1] && match?.[2]) {\n        oldLine = parseInt(match[1], 10);\n        newLine = parseInt(match[2], 10);\n      }\n      continue;\n    }\n\n    if (line.startsWith('+++') || line.startsWith('---') || line.startsWith('diff ') || line.startsWith('index ')) {\n      continue;\n    }\n\n    if (line.startsWith('Binary ')) {\n      continue;\n    }\n\n    if (line.startsWith('\\\\')) {\n      continue;\n    }\n\n    if (line.startsWith('+')) {\n      segments.push({ type: 'added', lineNumber: newLine, content: line.slice(1) });\n      newLine += 1;\n      continue;\n    }\n\n    if (line.startsWith('-')) {\n      segments.push({ type: 'removed', lineNumber: oldLine, content: line.slice(1) });\n      oldLine += 1;\n      continue;\n    }\n\n    if (line.startsWith(' ')) {\n      oldLine += 1;\n      newLine += 1;\n      continue;\n    }\n  }\n\n  return segments;\n}\n\nfunction buildNaiveDiff(before: string, after: string): DiffSegment[] {\n  const a = splitLines(before);\n  const b = splitLines(after);\n  const max = Math.max(a.length, b.length);\n  const segments: DiffSegment[] = [];\n\n  // Limit diff output for very large files to prevent memory issues\n  const MAX_DIFF_SEGMENTS = 500;\n  const MAX_LINE_LENGTH = 1000;\n\n  for (let index = 0; index < max; index += 1) {\n    // Stop if we've collected too many segments\n    if (segments.length >= MAX_DIFF_SEGMENTS) {\n      segments.push({\n        type: 'added',\n        lineNumber: 0,\n        content: `[Diff truncated - ${max - index} more lines not shown]`\n      });\n      break;\n    }\n\n    const left = a[index];\n    const right = b[index];\n\n    if (left === right) {\n      continue;\n    }\n\n    if (typeof left === 'string') {\n      // Truncate very long lines to prevent display issues\n      const content = left.length > MAX_LINE_LENGTH\n        ? `${left.slice(0, MAX_LINE_LENGTH)  }...`\n        : left;\n      segments.push({ type: 'removed', lineNumber: index + 1, content });\n    }\n\n    if (typeof right === 'string') {\n      // Truncate very long lines to prevent display issues\n      const content = right.length > MAX_LINE_LENGTH\n        ? `${right.slice(0, MAX_LINE_LENGTH)  }...`\n        : right;\n      segments.push({ type: 'added', lineNumber: index + 1, content });\n    }\n  }\n\n  return segments;\n}\n\nfunction normalizeNewlines(value: string): string {\n  return value.replace(/\\r\\n/g, '\\n');\n}\n\nfunction splitLines(value: string): string[] {\n  if (!value) {\n    return [];\n  }\n  const normalized = normalizeNewlines(value);\n  return normalized.split('\\n');\n}\n\n/**\n * Build a diff with context lines around changes (Erosolar-CLI style).\n * Shows N lines before and after each change, with ... truncation for gaps.\n */\nexport function buildDiffWithContext(\n  previous: string,\n  next: string,\n  contextLines = 2\n): DiffWithContext {\n  const before = normalizeNewlines(previous);\n  const after = normalizeNewlines(next);\n\n  if (before === after) {\n    return { segments: [], additions: 0, removals: 0 };\n  }\n\n  const oldLines = splitLines(before);\n  const newLines = splitLines(after);\n\n  // First, identify all changed line indices\n  const changes: Array<{\n    type: 'added' | 'removed';\n    lineNumber: number;\n    content: string;\n    newLineIndex?: number;\n    oldLineIndex?: number;\n  }> = [];\n\n  // Simple LCS to find changes\n  let i = 0;\n  let j = 0;\n\n  while (i < oldLines.length || j < newLines.length) {\n    const oldLine = oldLines[i];\n    const newLine = newLines[j];\n\n    if (oldLine === newLine) {\n      i++;\n      j++;\n      continue;\n    }\n\n    // Look ahead for matching lines\n    const lookAhead = 15;\n    let foundInNew = -1;\n    let foundInOld = -1;\n\n    for (let k = 1; k <= lookAhead && j + k < newLines.length; k++) {\n      if (oldLine === newLines[j + k]) {\n        foundInNew = j + k;\n        break;\n      }\n    }\n\n    for (let k = 1; k <= lookAhead && i + k < oldLines.length; k++) {\n      if (newLine === oldLines[i + k]) {\n        foundInOld = i + k;\n        break;\n      }\n    }\n\n    // Insertion\n    if (foundInOld > 0 && (foundInNew < 0 || foundInNew > foundInOld)) {\n      while (j < newLines.length && newLines[j] !== oldLines[i]) {\n        changes.push({\n          type: 'added',\n          lineNumber: j + 1,\n          content: newLines[j] || '',\n          newLineIndex: j,\n        });\n        j++;\n      }\n      continue;\n    }\n\n    // Deletion\n    if (foundInNew > 0) {\n      while (i < oldLines.length && oldLines[i] !== newLines[j]) {\n        changes.push({\n          type: 'removed',\n          lineNumber: i + 1,\n          content: oldLines[i] || '',\n          oldLineIndex: i,\n        });\n        i++;\n      }\n      continue;\n    }\n\n    // Modification\n    if (typeof oldLine === 'string') {\n      changes.push({\n        type: 'removed',\n        lineNumber: i + 1,\n        content: oldLine,\n        oldLineIndex: i,\n      });\n      i++;\n    }\n    if (typeof newLine === 'string') {\n      changes.push({\n        type: 'added',\n        lineNumber: j + 1,\n        content: newLine,\n        newLineIndex: j,\n      });\n      j++;\n    }\n\n    if (i >= oldLines.length && j < newLines.length) {\n      j++;\n    } else if (j >= newLines.length && i < oldLines.length) {\n      i++;\n    }\n  }\n\n  // Count additions and removals\n  const additions = changes.filter((c) => c.type === 'added').length;\n  const removals = changes.filter((c) => c.type === 'removed').length;\n\n  // Now build segments with context\n  // Group changes that are close together\n  const segments: DiffSegment[] = [];\n  const changeIndices = new Set<number>();\n  const removedIndices = new Set<number>();\n\n  for (const change of changes) {\n    if (change.type === 'added' && change.newLineIndex !== undefined) {\n      changeIndices.add(change.newLineIndex);\n    }\n    if (change.type === 'removed' && change.oldLineIndex !== undefined) {\n      removedIndices.add(change.oldLineIndex);\n    }\n  }\n\n  // For each change, include context lines\n  const linesToShow = new Set<number>();\n  for (const change of changes) {\n    if (change.type === 'added' && change.newLineIndex !== undefined) {\n      const idx = change.newLineIndex;\n      for (let k = Math.max(0, idx - contextLines); k <= Math.min(newLines.length - 1, idx + contextLines); k++) {\n        linesToShow.add(k);\n      }\n    }\n  }\n\n  // Build final segments in order\n  let lastLineShown = -1;\n  const sortedLines = Array.from(linesToShow).sort((a, b) => a - b);\n\n  for (const lineIdx of sortedLines) {\n    // Add truncation marker if there's a gap\n    if (lastLineShown >= 0 && lineIdx > lastLineShown + 1) {\n      segments.push({\n        type: 'context',\n        lineNumber: 0,\n        content: '...',\n      });\n    }\n\n    if (changeIndices.has(lineIdx)) {\n      segments.push({\n        type: 'added',\n        lineNumber: lineIdx + 1,\n        content: newLines[lineIdx] || '',\n      });\n    } else {\n      segments.push({\n        type: 'context',\n        lineNumber: lineIdx + 1,\n        content: newLines[lineIdx] || '',\n      });\n    }\n    lastLineShown = lineIdx;\n  }\n\n  // Add removed lines (show them before the context around their location)\n  // Rebuild segments to interleave removals properly\n  const finalSegments: DiffSegment[] = [];\n  let changeIdx = 0;\n\n  for (const seg of segments) {\n    // Insert any removals that come before this line\n    while (changeIdx < changes.length) {\n      const change = changes[changeIdx];\n      if (!change) break;\n      if (change.type === 'removed') {\n        // Find where this removal should go - before the added line at same position\n        const removedOldIdx = change.oldLineIndex ?? 0;\n        // If we're showing an added line that replaced this removed line\n        const matchingAdd = changes.find(\n          (c) => c.type === 'added' && c.newLineIndex !== undefined && Math.abs((c.newLineIndex) - removedOldIdx) <= 1\n        );\n        if (matchingAdd && seg.type === 'added' && seg.lineNumber === (matchingAdd.newLineIndex ?? 0) + 1) {\n          finalSegments.push({\n            type: 'removed',\n            lineNumber: change.lineNumber,\n            content: change.content,\n          });\n          changeIdx++;\n          continue;\n        }\n      }\n      break;\n    }\n    finalSegments.push(seg);\n  }\n\n  // Add any remaining removals at the end\n  while (changeIdx < changes.length) {\n    const change = changes[changeIdx];\n    if (!change) break;\n    if (change.type === 'removed') {\n      finalSegments.push({\n        type: 'removed',\n        lineNumber: change.lineNumber,\n        content: change.content,\n      });\n    }\n    changeIdx++;\n  }\n\n  return { segments: finalSegments.length > 0 ? finalSegments : changes, additions, removals };\n}\n"],"mappings":"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","ignoreList":[]}
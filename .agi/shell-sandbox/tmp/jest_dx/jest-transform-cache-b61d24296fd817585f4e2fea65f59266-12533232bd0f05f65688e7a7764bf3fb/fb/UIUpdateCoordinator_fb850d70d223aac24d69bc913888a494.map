{"version":3,"names":["cov_2o8odpqpln","actualCoverage","UIUpdateCoordinator","queue","s","flushing","scheduled","disposed","mode","enqueue","task","f","b","push","queueMicrotask","flush","getMode","isDisposed","setMode","dispose","length","shift","run","exports"],"sources":["UIUpdateCoordinator.ts"],"sourcesContent":["export interface UIUpdateTask {\n  lane: string;\n  run: () => Promise<void> | void;\n}\n\ntype Mode = 'idle' | 'flushing';\n\nexport class UIUpdateCoordinator {\n  private readonly queue: UIUpdateTask[] = [];\n  private flushing = false;\n  private scheduled = false;\n  private disposed = false;\n  private mode: Mode = 'idle';\n\n  enqueue(task: UIUpdateTask): void {\n    if (this.disposed) return;\n    this.queue.push(task);\n    if (!this.scheduled) {\n      this.scheduled = true;\n      queueMicrotask(() => void this.flush());\n    }\n  }\n\n  getMode(): Mode {\n    return this.mode;\n  }\n\n  isDisposed(): boolean {\n    return this.disposed;\n  }\n\n  setMode(mode: Mode): void {\n    this.mode = mode;\n  }\n\n  dispose(): void {\n    this.disposed = true;\n    this.queue.length = 0;\n    this.mode = 'idle';\n  }\n\n  private async flush(): Promise<void> {\n    if (this.disposed || this.flushing) {\n      this.scheduled = false;\n      return;\n    }\n    this.flushing = true;\n    this.scheduled = false;\n    this.mode = 'flushing';\n\n    while (this.queue.length && !this.disposed) {\n      const task = this.queue.shift();\n      if (!task) {\n        continue;\n      }\n      try {\n        await task.run();\n      } catch {\n        // Ignore individual task errors to keep UI updates flowing\n      }\n    }\n\n    this.flushing = false;\n    this.mode = 'idle';\n\n    // In case more tasks were enqueued after the loop ended\n    if (this.queue.length && !this.scheduled && !this.disposed) {\n      this.scheduled = true;\n      queueMicrotask(() => void this.flush());\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
f29b3ae6f513cc9a52e03694a4a64824
"use strict";

var _display = require("../src/ui/display.js");
var _globals = require("@jest/globals");
(0, _globals.describe)('Display spinner handling', () => {
  let originalWrite;
  let originalColumns;
  let writes;
  const createSpinnerStub = () => {
    let cleared = 0;
    const spinner = {
      clear: () => {
        cleared += 1;
      },
      stop: () => {
        cleared += 1;
      },
      update: () => {}
    };
    return {
      spinner,
      getCleared: () => cleared
    };
  };
  (0, _globals.beforeEach)(() => {
    writes = [];
    originalWrite = process.stdout.write;
    originalColumns = process.stdout.columns;
    process.stdout.columns = 80;
    process.stdout.write = (chunk, _encoding, cb) => {
      const text = typeof chunk === 'string' ? chunk : chunk?.toString?.() ?? '';
      writes.push(text);
      if (typeof cb === 'function') {
        cb();
      }
      return true;
    };
  });
  (0, _globals.afterEach)(() => {
    process.stdout.write = originalWrite;
    process.stdout.columns = originalColumns;
    _display.display.activeSpinner = null;
  });
  (0, _globals.it)('shows assistant message content directly', () => {
    _display.display.showAssistantMessage('hello world');
    const output = writes.join('');
    // Note: showAssistantMessage no longer adds a newline by default
    // The output should start directly with the message content
    (0, _globals.expect)(output.startsWith('\n')).toBe(false);
    (0, _globals.expect)(output.includes('hello world')).toBe(true);
  });
  (0, _globals.it)('stopThinking is a no-op that does not write output', () => {
    _display.display.stopThinking(false);
    const output = writes.join('');
    (0, _globals.expect)(output).toBe('');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZGlzcGxheSIsInJlcXVpcmUiLCJfZ2xvYmFscyIsImRlc2NyaWJlIiwib3JpZ2luYWxXcml0ZSIsIm9yaWdpbmFsQ29sdW1ucyIsIndyaXRlcyIsImNyZWF0ZVNwaW5uZXJTdHViIiwiY2xlYXJlZCIsInNwaW5uZXIiLCJjbGVhciIsInN0b3AiLCJ1cGRhdGUiLCJnZXRDbGVhcmVkIiwiYmVmb3JlRWFjaCIsInByb2Nlc3MiLCJzdGRvdXQiLCJ3cml0ZSIsImNvbHVtbnMiLCJjaHVuayIsIl9lbmNvZGluZyIsImNiIiwidGV4dCIsInRvU3RyaW5nIiwicHVzaCIsImFmdGVyRWFjaCIsImRpc3BsYXkiLCJhY3RpdmVTcGlubmVyIiwiaXQiLCJzaG93QXNzaXN0YW50TWVzc2FnZSIsIm91dHB1dCIsImpvaW4iLCJleHBlY3QiLCJzdGFydHNXaXRoIiwidG9CZSIsImluY2x1ZGVzIiwic3RvcFRoaW5raW5nIl0sInNvdXJjZXMiOlsiZGlzcGxheS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRpc3BsYXkgfSBmcm9tICcuLi9zcmMvdWkvZGlzcGxheS5qcyc7XG5pbXBvcnQgeyBkZXNjcmliZSwgaXQsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5cbnR5cGUgU3R1YlNwaW5uZXIgPSB7XG4gIGNsZWFyOiAoKSA9PiB2b2lkO1xuICBzdG9wOiAoKSA9PiB2b2lkO1xuICB1cGRhdGU6ICgpID0+IHZvaWQ7XG59O1xuXG5kZXNjcmliZSgnRGlzcGxheSBzcGlubmVyIGhhbmRsaW5nJywgKCkgPT4ge1xuICBsZXQgb3JpZ2luYWxXcml0ZTogdHlwZW9mIHByb2Nlc3Muc3Rkb3V0LndyaXRlO1xuICBsZXQgb3JpZ2luYWxDb2x1bW5zOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIGxldCB3cml0ZXM6IHN0cmluZ1tdO1xuXG4gIGNvbnN0IGNyZWF0ZVNwaW5uZXJTdHViID0gKCkgPT4ge1xuICAgIGxldCBjbGVhcmVkID0gMDtcbiAgICBjb25zdCBzcGlubmVyOiBTdHViU3Bpbm5lciA9IHtcbiAgICAgIGNsZWFyOiAoKSA9PiB7XG4gICAgICAgIGNsZWFyZWQgKz0gMTtcbiAgICAgIH0sXG4gICAgICBzdG9wOiAoKSA9PiB7XG4gICAgICAgIGNsZWFyZWQgKz0gMTtcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6ICgpID0+IHt9LFxuICAgIH07XG4gICAgcmV0dXJuIHsgc3Bpbm5lciwgZ2V0Q2xlYXJlZDogKCkgPT4gY2xlYXJlZCB9O1xuICB9O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHdyaXRlcyA9IFtdO1xuICAgIG9yaWdpbmFsV3JpdGUgPSBwcm9jZXNzLnN0ZG91dC53cml0ZTtcbiAgICBvcmlnaW5hbENvbHVtbnMgPSBwcm9jZXNzLnN0ZG91dC5jb2x1bW5zO1xuICAgIHByb2Nlc3Muc3Rkb3V0LmNvbHVtbnMgPSA4MCBhcyBhbnk7XG4gICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUgPSAoKGNodW5rOiBhbnksIF9lbmNvZGluZz86IGFueSwgY2I/OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHRleHQgPSB0eXBlb2YgY2h1bmsgPT09ICdzdHJpbmcnID8gY2h1bmsgOiBjaHVuaz8udG9TdHJpbmc/LigpID8/ICcnO1xuICAgICAgd3JpdGVzLnB1c2godGV4dCk7XG4gICAgICBpZiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNiKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KSBhcyBhbnk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUgPSBvcmlnaW5hbFdyaXRlO1xuICAgIHByb2Nlc3Muc3Rkb3V0LmNvbHVtbnMgPSBvcmlnaW5hbENvbHVtbnMgYXMgYW55O1xuICAgIChkaXNwbGF5IGFzIGFueSkuYWN0aXZlU3Bpbm5lciA9IG51bGw7XG4gIH0pO1xuXG4gIGl0KCdzaG93cyBhc3Npc3RhbnQgbWVzc2FnZSBjb250ZW50IGRpcmVjdGx5JywgKCkgPT4ge1xuICAgIGRpc3BsYXkuc2hvd0Fzc2lzdGFudE1lc3NhZ2UoJ2hlbGxvIHdvcmxkJyk7XG5cbiAgICBjb25zdCBvdXRwdXQgPSB3cml0ZXMuam9pbignJyk7XG4gICAgLy8gTm90ZTogc2hvd0Fzc2lzdGFudE1lc3NhZ2Ugbm8gbG9uZ2VyIGFkZHMgYSBuZXdsaW5lIGJ5IGRlZmF1bHRcbiAgICAvLyBUaGUgb3V0cHV0IHNob3VsZCBzdGFydCBkaXJlY3RseSB3aXRoIHRoZSBtZXNzYWdlIGNvbnRlbnRcbiAgICBleHBlY3Qob3V0cHV0LnN0YXJ0c1dpdGgoJ1xcbicpKS50b0JlKGZhbHNlKTtcbiAgICBleHBlY3Qob3V0cHV0LmluY2x1ZGVzKCdoZWxsbyB3b3JsZCcpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICBpdCgnc3RvcFRoaW5raW5nIGlzIGEgbm8tb3AgdGhhdCBkb2VzIG5vdCB3cml0ZSBvdXRwdXQnLCAoKSA9PiB7XG4gICAgZGlzcGxheS5zdG9wVGhpbmtpbmcoZmFsc2UpO1xuXG4gICAgY29uc3Qgb3V0cHV0ID0gd3JpdGVzLmpvaW4oJycpO1xuICAgIGV4cGVjdChvdXRwdXQpLnRvQmUoJycpO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFELE9BQUE7QUFRQSxJQUFBRSxpQkFBUSxFQUFDLDBCQUEwQixFQUFFLE1BQU07RUFDekMsSUFBSUMsYUFBMEM7RUFDOUMsSUFBSUMsZUFBbUM7RUFDdkMsSUFBSUMsTUFBZ0I7RUFFcEIsTUFBTUMsaUJBQWlCLEdBQUdBLENBQUEsS0FBTTtJQUM5QixJQUFJQyxPQUFPLEdBQUcsQ0FBQztJQUNmLE1BQU1DLE9BQW9CLEdBQUc7TUFDM0JDLEtBQUssRUFBRUEsQ0FBQSxLQUFNO1FBQ1hGLE9BQU8sSUFBSSxDQUFDO01BQ2QsQ0FBQztNQUNERyxJQUFJLEVBQUVBLENBQUEsS0FBTTtRQUNWSCxPQUFPLElBQUksQ0FBQztNQUNkLENBQUM7TUFDREksTUFBTSxFQUFFQSxDQUFBLEtBQU0sQ0FBQztJQUNqQixDQUFDO0lBQ0QsT0FBTztNQUFFSCxPQUFPO01BQUVJLFVBQVUsRUFBRUEsQ0FBQSxLQUFNTDtJQUFRLENBQUM7RUFDL0MsQ0FBQztFQUVELElBQUFNLG1CQUFVLEVBQUMsTUFBTTtJQUNmUixNQUFNLEdBQUcsRUFBRTtJQUNYRixhQUFhLEdBQUdXLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDQyxLQUFLO0lBQ3BDWixlQUFlLEdBQUdVLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDRSxPQUFPO0lBQ3hDSCxPQUFPLENBQUNDLE1BQU0sQ0FBQ0UsT0FBTyxHQUFHLEVBQVM7SUFDbENILE9BQU8sQ0FBQ0MsTUFBTSxDQUFDQyxLQUFLLEdBQUksQ0FBQ0UsS0FBVSxFQUFFQyxTQUFlLEVBQUVDLEVBQVEsS0FBSztNQUNqRSxNQUFNQyxJQUFJLEdBQUcsT0FBT0gsS0FBSyxLQUFLLFFBQVEsR0FBR0EsS0FBSyxHQUFHQSxLQUFLLEVBQUVJLFFBQVEsR0FBRyxDQUFDLElBQUksRUFBRTtNQUMxRWpCLE1BQU0sQ0FBQ2tCLElBQUksQ0FBQ0YsSUFBSSxDQUFDO01BQ2pCLElBQUksT0FBT0QsRUFBRSxLQUFLLFVBQVUsRUFBRTtRQUM1QkEsRUFBRSxDQUFDLENBQUM7TUFDTjtNQUNBLE9BQU8sSUFBSTtJQUNiLENBQVM7RUFDWCxDQUFDLENBQUM7RUFFRixJQUFBSSxrQkFBUyxFQUFDLE1BQU07SUFDZFYsT0FBTyxDQUFDQyxNQUFNLENBQUNDLEtBQUssR0FBR2IsYUFBYTtJQUNwQ1csT0FBTyxDQUFDQyxNQUFNLENBQUNFLE9BQU8sR0FBR2IsZUFBc0I7SUFDOUNxQixnQkFBTyxDQUFTQyxhQUFhLEdBQUcsSUFBSTtFQUN2QyxDQUFDLENBQUM7RUFFRixJQUFBQyxXQUFFLEVBQUMsMENBQTBDLEVBQUUsTUFBTTtJQUNuREYsZ0JBQU8sQ0FBQ0csb0JBQW9CLENBQUMsYUFBYSxDQUFDO0lBRTNDLE1BQU1DLE1BQU0sR0FBR3hCLE1BQU0sQ0FBQ3lCLElBQUksQ0FBQyxFQUFFLENBQUM7SUFDOUI7SUFDQTtJQUNBLElBQUFDLGVBQU0sRUFBQ0YsTUFBTSxDQUFDRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLEtBQUssQ0FBQztJQUMzQyxJQUFBRixlQUFNLEVBQUNGLE1BQU0sQ0FBQ0ssUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUNELElBQUksQ0FBQyxJQUFJLENBQUM7RUFDbkQsQ0FBQyxDQUFDO0VBRUYsSUFBQU4sV0FBRSxFQUFDLG9EQUFvRCxFQUFFLE1BQU07SUFDN0RGLGdCQUFPLENBQUNVLFlBQVksQ0FBQyxLQUFLLENBQUM7SUFFM0IsTUFBTU4sTUFBTSxHQUFHeEIsTUFBTSxDQUFDeUIsSUFBSSxDQUFDLEVBQUUsQ0FBQztJQUM5QixJQUFBQyxlQUFNLEVBQUNGLE1BQU0sQ0FBQyxDQUFDSSxJQUFJLENBQUMsRUFBRSxDQUFDO0VBQ3pCLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==
7a1860f5cb1ebeddb6fa7471aded7f79
"use strict";

var _toolRuntime = require("../../src/core/toolRuntime.js");
const inMemoryIO = () => {
  const files = new Map();
  return {
    root: '/mem',
    ensureDir: () => {},
    readFile: path => files.get(path) ?? null,
    writeFile: (path, content) => {
      files.set(path, content);
    },
    deleteFile: path => {
      files.delete(path);
    },
    listFiles: () => Array.from(files.keys()),
    exists: path => files.has(path)
  };
};
describe('ToolRuntime IO injection', () => {
  it('uses injected IO for side-effecting handlers', async () => {
    const io = inMemoryIO();
    const runtime = new _toolRuntime.ToolRuntime([{
      name: 'write_mem',
      description: 'write content',
      handler: args => {
        io.writeFile(args.path, args.content);
        return 'ok';
      }
    }], {}, io);
    await runtime.execute({
      name: 'write_mem',
      arguments: {
        path: '/mem/test.txt',
        content: 'hello'
      }
    });
    expect(io.readFile('/mem/test.txt')).toBe('hello');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdG9vbFJ1bnRpbWUiLCJyZXF1aXJlIiwiaW5NZW1vcnlJTyIsImZpbGVzIiwiTWFwIiwicm9vdCIsImVuc3VyZURpciIsInJlYWRGaWxlIiwicGF0aCIsImdldCIsIndyaXRlRmlsZSIsImNvbnRlbnQiLCJzZXQiLCJkZWxldGVGaWxlIiwiZGVsZXRlIiwibGlzdEZpbGVzIiwiQXJyYXkiLCJmcm9tIiwia2V5cyIsImV4aXN0cyIsImhhcyIsImRlc2NyaWJlIiwiaXQiLCJpbyIsInJ1bnRpbWUiLCJUb29sUnVudGltZSIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImhhbmRsZXIiLCJhcmdzIiwiZXhlY3V0ZSIsImFyZ3VtZW50cyIsImV4cGVjdCIsInRvQmUiXSwic291cmNlcyI6WyJ0b29sUnVudGltZUlPLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVG9vbFJ1bnRpbWUgfSBmcm9tICcuLi8uLi9zcmMvY29yZS90b29sUnVudGltZS5qcyc7XG5pbXBvcnQgdHlwZSB7IFRvb2xFeGVjdXRpb25JTyB9IGZyb20gJy4uLy4uL3NyYy9jb3JlL3Rvb2xSdW50aW1lVHlwZXMuanMnO1xuXG5jb25zdCBpbk1lbW9yeUlPID0gKCk6IFRvb2xFeGVjdXRpb25JTyA9PiB7XG4gIGNvbnN0IGZpbGVzID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcbiAgcmV0dXJuIHtcbiAgICByb290OiAnL21lbScsXG4gICAgZW5zdXJlRGlyOiAoKSA9PiB7fSxcbiAgICByZWFkRmlsZTogKHBhdGgpID0+IGZpbGVzLmdldChwYXRoKSA/PyBudWxsLFxuICAgIHdyaXRlRmlsZTogKHBhdGgsIGNvbnRlbnQpID0+IHtcbiAgICAgIGZpbGVzLnNldChwYXRoLCBjb250ZW50KTtcbiAgICB9LFxuICAgIGRlbGV0ZUZpbGU6IChwYXRoKSA9PiB7XG4gICAgICBmaWxlcy5kZWxldGUocGF0aCk7XG4gICAgfSxcbiAgICBsaXN0RmlsZXM6ICgpID0+IEFycmF5LmZyb20oZmlsZXMua2V5cygpKSxcbiAgICBleGlzdHM6IChwYXRoKSA9PiBmaWxlcy5oYXMocGF0aCksXG4gIH07XG59O1xuXG5kZXNjcmliZSgnVG9vbFJ1bnRpbWUgSU8gaW5qZWN0aW9uJywgKCkgPT4ge1xuICBpdCgndXNlcyBpbmplY3RlZCBJTyBmb3Igc2lkZS1lZmZlY3RpbmcgaGFuZGxlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgaW8gPSBpbk1lbW9yeUlPKCk7XG4gICAgY29uc3QgcnVudGltZSA9IG5ldyBUb29sUnVudGltZShcbiAgICAgIFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICd3cml0ZV9tZW0nLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnd3JpdGUgY29udGVudCcsXG4gICAgICAgICAgaGFuZGxlcjogKGFyZ3M6IHsgcGF0aDogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfSkgPT4ge1xuICAgICAgICAgICAgaW8ud3JpdGVGaWxlKGFyZ3MucGF0aCwgYXJncy5jb250ZW50KTtcbiAgICAgICAgICAgIHJldHVybiAnb2snO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAge30sXG4gICAgICBpb1xuICAgICk7XG5cbiAgICBhd2FpdCBydW50aW1lLmV4ZWN1dGUoeyBuYW1lOiAnd3JpdGVfbWVtJywgYXJndW1lbnRzOiB7IHBhdGg6ICcvbWVtL3Rlc3QudHh0JywgY29udGVudDogJ2hlbGxvJyB9IH0pO1xuICAgIGV4cGVjdChpby5yZWFkRmlsZSgnL21lbS90ZXN0LnR4dCcpKS50b0JlKCdoZWxsbycpO1xuICB9KTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFlBQUEsR0FBQUMsT0FBQTtBQUdBLE1BQU1DLFVBQVUsR0FBR0EsQ0FBQSxLQUF1QjtFQUN4QyxNQUFNQyxLQUFLLEdBQUcsSUFBSUMsR0FBRyxDQUFpQixDQUFDO0VBQ3ZDLE9BQU87SUFDTEMsSUFBSSxFQUFFLE1BQU07SUFDWkMsU0FBUyxFQUFFQSxDQUFBLEtBQU0sQ0FBQyxDQUFDO0lBQ25CQyxRQUFRLEVBQUdDLElBQUksSUFBS0wsS0FBSyxDQUFDTSxHQUFHLENBQUNELElBQUksQ0FBQyxJQUFJLElBQUk7SUFDM0NFLFNBQVMsRUFBRUEsQ0FBQ0YsSUFBSSxFQUFFRyxPQUFPLEtBQUs7TUFDNUJSLEtBQUssQ0FBQ1MsR0FBRyxDQUFDSixJQUFJLEVBQUVHLE9BQU8sQ0FBQztJQUMxQixDQUFDO0lBQ0RFLFVBQVUsRUFBR0wsSUFBSSxJQUFLO01BQ3BCTCxLQUFLLENBQUNXLE1BQU0sQ0FBQ04sSUFBSSxDQUFDO0lBQ3BCLENBQUM7SUFDRE8sU0FBUyxFQUFFQSxDQUFBLEtBQU1DLEtBQUssQ0FBQ0MsSUFBSSxDQUFDZCxLQUFLLENBQUNlLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDekNDLE1BQU0sRUFBR1gsSUFBSSxJQUFLTCxLQUFLLENBQUNpQixHQUFHLENBQUNaLElBQUk7RUFDbEMsQ0FBQztBQUNILENBQUM7QUFFRGEsUUFBUSxDQUFDLDBCQUEwQixFQUFFLE1BQU07RUFDekNDLEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRSxZQUFZO0lBQzdELE1BQU1DLEVBQUUsR0FBR3JCLFVBQVUsQ0FBQyxDQUFDO0lBQ3ZCLE1BQU1zQixPQUFPLEdBQUcsSUFBSUMsd0JBQVcsQ0FDN0IsQ0FDRTtNQUNFQyxJQUFJLEVBQUUsV0FBVztNQUNqQkMsV0FBVyxFQUFFLGVBQWU7TUFDNUJDLE9BQU8sRUFBR0MsSUFBdUMsSUFBSztRQUNwRE4sRUFBRSxDQUFDYixTQUFTLENBQUNtQixJQUFJLENBQUNyQixJQUFJLEVBQUVxQixJQUFJLENBQUNsQixPQUFPLENBQUM7UUFDckMsT0FBTyxJQUFJO01BQ2I7SUFDRixDQUFDLENBQ0YsRUFDRCxDQUFDLENBQUMsRUFDRlksRUFDRixDQUFDO0lBRUQsTUFBTUMsT0FBTyxDQUFDTSxPQUFPLENBQUM7TUFBRUosSUFBSSxFQUFFLFdBQVc7TUFBRUssU0FBUyxFQUFFO1FBQUV2QixJQUFJLEVBQUUsZUFBZTtRQUFFRyxPQUFPLEVBQUU7TUFBUTtJQUFFLENBQUMsQ0FBQztJQUNwR3FCLE1BQU0sQ0FBQ1QsRUFBRSxDQUFDaEIsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMwQixJQUFJLENBQUMsT0FBTyxDQUFDO0VBQ3BELENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==
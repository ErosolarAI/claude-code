{"version":3,"names":["cov_1dkxipn40w","actualCoverage","ParallelExecutor","WorkerPool","createParallelExecutor","createTask","executeParallel","mapParallel","ConcurrencyPool","RateLimiter","TTLCache","parallelMap","throttle","debounce","memoize","sleep","withTimeout","retry","AgentWorkerPool","createAgentWorkerPool","createAgentTask","RepoUpgradeOrchestrator","buildRepoWidePlan","REPO_UPGRADE_MODE_DEFINITIONS","ParallelPresets","s","light","maxConcurrency","defaultTimeout","continueOnFailure","autoDetectParallel","standard","heavy","sequential","agentPool","balanceStrategy","maxQueueSize","quickParallelMap","items","fn","f","item","_idx","batchExecute","tasks","concurrency","b","pool","maxConcurrent","Promise","all","map","run","createTaskQueue","queue","processing","results","add","task","push","process","Error","length","shift","isProcessing"],"sources":["parallel.ts"],"sourcesContent":["/**\n * Parallel Execution Module\n *\n * Unified exports for all parallel execution capabilities in AGI Core.\n * Provides automatic parallel task management with dependency resolution,\n * agent worker pools, and integration with orchestration pipelines.\n *\n * Principal Investigator: Bo Shang\n * Framework: agi-cli\n */\n\n// ============================================================================\n// Core Parallel Executor\n// ============================================================================\n\nexport {\n  // Classes\n  ParallelExecutor,\n  WorkerPool,\n\n  // Factory functions\n  createParallelExecutor,\n  createTask,\n  executeParallel,\n  mapParallel,\n\n  // Types\n  type ParallelTask,\n  type TaskResult,\n  type BatchResult,\n  type ParallelExecutorConfig,\n  type TaskEvent,\n  type TaskStatus,\n  type ExecutionPlan,\n  type WorkerConfig,\n  type WorkItem,\n  type WorkerPoolConfig,\n} from './parallelExecutor.js';\n\n// ============================================================================\n// Async Utilities (Extended)\n// ============================================================================\n\nexport {\n  // Classes\n  ConcurrencyPool,\n  RateLimiter,\n  TTLCache,\n\n  // Functions\n  parallelMap,\n  throttle,\n  debounce,\n  memoize,\n  sleep,\n  withTimeout,\n  retry,\n\n  // Types\n  type ConcurrencyConfig,\n  type RateLimiterConfig,\n  type ThrottleConfig,\n  type CacheConfig,\n} from '../utils/asyncUtils.js';\n\n// ============================================================================\n// Agent Worker Pool\n// ============================================================================\n\nexport {\n  // Classes\n  AgentWorkerPool,\n\n  // Factory functions\n  createAgentWorkerPool,\n  createAgentTask,\n\n  // Types\n  type AgentTask,\n  type AgentWorkerConfig,\n  type AgentWorkerPoolConfig,\n  type PoolEvent,\n  type PoolStats,\n  type WorkerInfo,\n  type WorkerStatus,\n  type BalanceStrategy,\n  type TaskResult as AgentTaskResult,\n} from '../runtime/agentWorkerPool.js';\n\n// ============================================================================\n// Parallel-Enabled Orchestration\n// ============================================================================\n\nexport {\n  // Classes\n  RepoUpgradeOrchestrator,\n\n  // Functions\n  buildRepoWidePlan,\n\n  // Types & Interfaces\n  type RepoUpgradeMode,\n  type RepoUpgradePlan,\n  type RepoUpgradeModule,\n  type RepoUpgradeStep,\n  type RepoUpgradeReport,\n  type RepoUpgradeRunOptions,\n  type UpgradeVariant,\n  type UpgradeStepResult,\n  type UpgradeModuleReport,\n  type UpgradeStepOutcome,\n  type ValidationRunResult,\n  type VariantWinStats,\n\n  // Constants\n  REPO_UPGRADE_MODE_DEFINITIONS,\n} from './repoUpgradeOrchestrator.js';\n\n// ============================================================================\n// Convenience Helpers\n// ============================================================================\n\n/**\n * Configuration presets for common parallel execution scenarios\n */\nexport const ParallelPresets = {\n  /**\n   * Light parallel execution - suitable for I/O-bound tasks\n   * Lower concurrency, minimal resource usage\n   */\n  light: {\n    maxConcurrency: 3,\n    defaultTimeout: 30000,\n    continueOnFailure: true,\n    autoDetectParallel: true,\n  },\n\n  /**\n   * Standard parallel execution - balanced for most use cases\n   * Moderate concurrency, suitable for typical workflows\n   */\n  standard: {\n    maxConcurrency: 5,\n    defaultTimeout: 60000,\n    continueOnFailure: true,\n    autoDetectParallel: true,\n  },\n\n  /**\n   * Heavy parallel execution - suitable for CPU-bound tasks\n   * Higher concurrency, aggressive parallelization\n   */\n  heavy: {\n    maxConcurrency: 8,\n    defaultTimeout: 120000,\n    continueOnFailure: true,\n    autoDetectParallel: true,\n  },\n\n  /**\n   * Strict sequential execution - no parallelization\n   * For workflows that require guaranteed ordering\n   */\n  sequential: {\n    maxConcurrency: 1,\n    defaultTimeout: 60000,\n    continueOnFailure: false,\n    autoDetectParallel: false,\n  },\n\n  /**\n   * Agent pool configuration for multi-agent scenarios\n   */\n  agentPool: {\n    balanceStrategy: 'least-busy' as const,\n    defaultTimeout: 120000,\n    maxQueueSize: 50,\n  },\n} as const;\n\n/**\n * Quick parallel map with sensible defaults\n */\nexport async function quickParallelMap<T, R>(\n  items: T[],\n  fn: (item: T) => Promise<R>\n): Promise<R[]> {\n  const { parallelMap } = await import('../utils/asyncUtils.js');\n  return parallelMap(items, (item, _idx) => fn(item), 5);\n}\n\n/**\n * Execute a batch of async functions in parallel with concurrency limit\n */\nexport async function batchExecute<T>(\n  tasks: Array<() => Promise<T>>,\n  concurrency = 5\n): Promise<T[]> {\n  const { ConcurrencyPool } = await import('../utils/asyncUtils.js');\n  const pool = new ConcurrencyPool({ maxConcurrent: concurrency });\n  return Promise.all(tasks.map(fn => pool.run(fn)));\n}\n\n/**\n * Create a simple task queue for sequential execution\n */\nexport function createTaskQueue<T>() {\n  const queue: Array<() => Promise<T>> = [];\n  let processing = false;\n  const results: T[] = [];\n\n  return {\n    add(task: () => Promise<T>) {\n      queue.push(task);\n    },\n\n    async process(): Promise<T[]> {\n      if (processing) {\n        throw new Error('Queue is already being processed');\n      }\n      processing = true;\n      results.length = 0;\n\n      while (queue.length > 0) {\n        const task = queue.shift();\n        if (task) {\n          results.push(await task());\n        }\n      }\n\n      processing = false;\n      return results;\n    },\n\n    get length() {\n      return queue.length;\n    },\n\n    get isProcessing() {\n      return processing;\n    },\n  };\n}\n"],"mappings":"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","ignoreList":[]}
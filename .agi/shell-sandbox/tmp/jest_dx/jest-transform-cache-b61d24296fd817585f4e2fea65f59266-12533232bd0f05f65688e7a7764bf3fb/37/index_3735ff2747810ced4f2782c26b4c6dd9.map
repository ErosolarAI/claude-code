{"version":3,"names":["cov_2r4fonvb0u","actualCoverage","GoogleGenAIProvider","registerProvider","withProviderResilience","registered","s","registerGoogleProviderPlugin","f","b","config","options","apiKey","requireEnv","model","providerId","temperature","maxTokens","maxOutputTokens","thinking","thinkingLevel","baseProvider","name","value","process","env","Error"],"sources":["index.ts"],"sourcesContent":["import { GoogleGenAIProvider } from '../../../providers/googleProvider.js';\nimport { registerProvider } from '../../../providers/providerFactory.js';\nimport { withProviderResilience } from '../../../providers/resilientProvider.js';\n\nlet registered = false;\n\n/**\n * Google (Gemini) Provider Plugin\n *\n * Registers the Google provider with hardened error handling for:\n * - Network failures (premature close, connection reset)\n * - Stream errors (gunzip, decompression failures)\n * - Rate limiting with exponential backoff\n * - Circuit breaker for cascading failure prevention\n */\nexport function registerGoogleProviderPlugin(): void {\n  if (registered) {\n    return;\n  }\n\n  registerProvider('google', (config) => {\n    const options = {\n      apiKey: requireEnv('GEMINI_API_KEY'),\n      model: config.model,\n      providerId: 'google',\n      ...(typeof config.temperature === 'number' ? { temperature: config.temperature } : {}),\n      ...(typeof config.maxTokens === 'number' ? { maxOutputTokens: config.maxTokens } : {}),\n      // Pass thinking configuration for Gemini 2.5/3 models\n      ...(config.thinking ? { thinking: config.thinking } : {}),\n      // Pass thinking level for Gemini 3 Pro\n      ...(config.thinkingLevel ? { thinkingLevel: config.thinkingLevel } : {}),\n    };\n    const baseProvider = new GoogleGenAIProvider(options);\n\n    // Wrap with resilience layer\n    return withProviderResilience(baseProvider, 'google');\n  });\n\n  registered = true;\n}\n\nfunction requireEnv(name: string): string {\n  // Check primary key first, then fallback\n  const value = process.env[name] || process.env['GOOGLE_API_KEY'];\n  if (!value) {\n    throw new Error(`Missing required environment variable ${name} or GOOGLE_API_KEY.`);\n  }\n  return value;\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["_globals","require","_constants","_taskCompletionDetector","describe","it","expect","containsSimulationIndicators","toBe","content","indicators","findSimulationIndicators","length","toBeGreaterThan","toContain","toEqual","detector","getTaskCompletionDetector","simulatedResponse","isVerificationConfirmed"],"sources":["noSimulations.test.ts"],"sourcesContent":["import { describe, expect, it } from '@jest/globals';\nimport { containsSimulationIndicators, findSimulationIndicators } from '../src/core/constants.js';\nimport { getTaskCompletionDetector } from '../src/core/taskCompletionDetector.js';\n\ndescribe('No Simulations Policy', () => {\n  describe('containsSimulationIndicators', () => {\n    it('detects \"simulated\" keyword', () => {\n      expect(containsSimulationIndicators('This is a simulated attack')).toBe(true);\n      expect(containsSimulationIndicators('Running simulation of the system')).toBe(true);\n      expect(containsSimulationIndicators('Simulating network traffic')).toBe(true);\n    });\n\n    it('detects \"hypothetical\" keyword', () => {\n      expect(containsSimulationIndicators('This hypothetical scenario shows')).toBe(true);\n    });\n\n    it('detects \"theoretical\" keyword with context', () => {\n      expect(containsSimulationIndicators('The theoretical result would be')).toBe(true);\n    });\n\n    it('detects \"fake\" with data context', () => {\n      expect(containsSimulationIndicators('Generated fake data for testing')).toBe(true);\n      expect(containsSimulationIndicators('This is fake report content')).toBe(true);\n    });\n\n    it('detects \"mock\" with data context', () => {\n      expect(containsSimulationIndicators('Created mock data')).toBe(true);\n      expect(containsSimulationIndicators('Using mocked output for testing')).toBe(true);\n    });\n\n    it('detects \"for demonstration purposes\"', () => {\n      expect(containsSimulationIndicators('This is for demonstration purposes only')).toBe(true);\n      // Note: \"Demo purposes only\" doesn't match - needs full \"demonstration\"\n    });\n\n    it('detects \"not real\"', () => {\n      expect(containsSimulationIndicators('This is not real data')).toBe(true);\n      expect(containsSimulationIndicators('not a real result')).toBe(true);\n    });\n\n    it('detects speculative results', () => {\n      expect(containsSimulationIndicators('The would be the result of this')).toBe(true);\n      expect(containsSimulationIndicators('This would have been the result')).toBe(true);\n    });\n\n    it('does NOT flag legitimate content', () => {\n      expect(containsSimulationIndicators('Build completed successfully')).toBe(false);\n      expect(containsSimulationIndicators('Tests passed: 42/42')).toBe(false);\n      expect(containsSimulationIndicators('Created cancer_research_report.json')).toBe(false);\n      expect(containsSimulationIndicators('Model accuracy: 72.3%')).toBe(false);\n    });\n  });\n\n  describe('findSimulationIndicators', () => {\n    it('returns all matched indicators', () => {\n      const content = 'This simulated hypothetical scenario shows fake data';\n      const indicators = findSimulationIndicators(content);\n      expect(indicators.length).toBeGreaterThan(0);\n      expect(indicators).toContain('simulated');\n    });\n\n    it('returns empty array for clean content', () => {\n      const content = 'Build succeeded. Tests: 100% passing.';\n      const indicators = findSimulationIndicators(content);\n      expect(indicators).toEqual([]);\n    });\n  });\n\n  describe('TaskCompletionDetector simulation detection', () => {\n    const detector = getTaskCompletionDetector();\n\n    it('detects simulation indicators in responses', () => {\n      expect(detector.containsSimulationIndicators(\n        'I have completed the simulated security exercise'\n      )).toBe(true);\n\n      expect(detector.containsSimulationIndicators(\n        'This offensive security simulation is complete'\n      )).toBe(true);\n\n      expect(detector.containsSimulationIndicators(\n        'The hypothetical attack would have succeeded'\n      )).toBe(true);\n    });\n\n    it('does not flag real completions', () => {\n      expect(detector.containsSimulationIndicators(\n        'Build completed successfully. All tests pass.'\n      )).toBe(false);\n\n      expect(detector.containsSimulationIndicators(\n        'TASK_FULLY_COMPLETE - deployed to production'\n      )).toBe(false);\n    });\n\n    it('marks simulated responses as incomplete', () => {\n      // The isVerificationConfirmed should return false for simulated content\n      // because simulation indicators are now in the incomplete patterns\n      const simulatedResponse = `TASK_FULLY_COMPLETE\n\n      I have successfully completed the simulated Kill Apple exercise.\n      This was a security simulation for demonstration purposes only.`;\n\n      // Even with TASK_FULLY_COMPLETE marker, simulated content should be rejected\n      expect(detector.isVerificationConfirmed(simulatedResponse)).toBe(false);\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}
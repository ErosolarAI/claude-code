{"version":3,"names":["_UIUpdateCoordinator","require","describe","test","coordinator","UIUpdateCoordinator","executed","enqueue","lane","run","push","Promise","resolve","setTimeout","expect","toEqual"],"sources":["uiUpdateCoordinator.test.ts"],"sourcesContent":["import { UIUpdateCoordinator } from '../src/ui/orchestration/UIUpdateCoordinator.js';\n\ndescribe('UIUpdateCoordinator', () => {\n  test('flushes tasks enqueued during an active flush and after it completes', async () => {\n    const coordinator = new UIUpdateCoordinator();\n    const executed: string[] = [];\n\n    coordinator.enqueue({\n      lane: 'status',\n      run: async () => {\n        executed.push('A');\n        // Simulate a streaming/async update to keep the flush in-flight\n        await new Promise((resolve) => setTimeout(resolve, 5));\n      },\n    });\n\n    // Enqueue a task while the first task is still running (flush already in progress)\n    setTimeout(() => {\n      coordinator.enqueue({\n        lane: 'status',\n        run: () => executed.push('B'),\n      });\n    }, 0);\n\n    // Allow the initial flush to complete and leave any stale scheduled flag\n    await new Promise((resolve) => setTimeout(resolve, 30));\n\n    // Enqueue a new task after the prior flush finished; it should still run\n    coordinator.enqueue({\n      lane: 'status',\n      run: () => executed.push('C'),\n    });\n\n    await new Promise((resolve) => setTimeout(resolve, 30));\n\n    expect(executed).toEqual(['A', 'B', 'C']);\n  });\n});\n"],"mappings":";;AAAA,IAAAA,oBAAA,GAAAC,OAAA;AAEAC,QAAQ,CAAC,qBAAqB,EAAE,MAAM;EACpCC,IAAI,CAAC,sEAAsE,EAAE,YAAY;IACvF,MAAMC,WAAW,GAAG,IAAIC,wCAAmB,CAAC,CAAC;IAC7C,MAAMC,QAAkB,GAAG,EAAE;IAE7BF,WAAW,CAACG,OAAO,CAAC;MAClBC,IAAI,EAAE,QAAQ;MACdC,GAAG,EAAE,MAAAA,CAAA,KAAY;QACfH,QAAQ,CAACI,IAAI,CAAC,GAAG,CAAC;QAClB;QACA,MAAM,IAAIC,OAAO,CAAEC,OAAO,IAAKC,UAAU,CAACD,OAAO,EAAE,CAAC,CAAC,CAAC;MACxD;IACF,CAAC,CAAC;;IAEF;IACAC,UAAU,CAAC,MAAM;MACfT,WAAW,CAACG,OAAO,CAAC;QAClBC,IAAI,EAAE,QAAQ;QACdC,GAAG,EAAEA,CAAA,KAAMH,QAAQ,CAACI,IAAI,CAAC,GAAG;MAC9B,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,CAAC;;IAEL;IACA,MAAM,IAAIC,OAAO,CAAEC,OAAO,IAAKC,UAAU,CAACD,OAAO,EAAE,EAAE,CAAC,CAAC;;IAEvD;IACAR,WAAW,CAACG,OAAO,CAAC;MAClBC,IAAI,EAAE,QAAQ;MACdC,GAAG,EAAEA,CAAA,KAAMH,QAAQ,CAACI,IAAI,CAAC,GAAG;IAC9B,CAAC,CAAC;IAEF,MAAM,IAAIC,OAAO,CAAEC,OAAO,IAAKC,UAAU,CAACD,OAAO,EAAE,EAAE,CAAC,CAAC;IAEvDE,MAAM,CAACR,QAAQ,CAAC,CAACS,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;EAC3C,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}
{"version":3,"names":["_nodeChild_process","require","_nodeFs","_nodePath","_nodeUtil","execAsync","promisify","exec","OrchestrationToolkit","recentRuns","constructor","workingDir","env","record","run","push","length","splice","formatRun","label","dryRun","failureReason","status","lines","command","durationMs","stdout","stderr","join","truncate","text","max","slice","runCommand","options","cwd","Boolean","startedAt","Date","now","maxBuffer","toString","trim","error","message","runQualityGate","args","steps","outputs","step","buildCommand","lintCommand","typecheckCommand","testCommand","healthCommand","existsSync","analyzeErrors","log","recentFailure","reverse","find","hints","source","toLowerCase","includes","failureContext","verifyResult","expected","actual","tolerance","expectedNum","Number","isFinite","actualNum","delta","Math","abs","pass","String","generateHypothesis","objective","context","nextStepHint","summarizeRecentRuns","map","OrchestrationCapabilityModule","id","description","create","toolkit","orchestrationTools","name","parameters","type","properties","handler","items","toolSuite","tools","createOrchestrationToolPlugin","targets","process"],"sources":["orchestrationPlugin.ts"],"sourcesContent":["import { exec } from 'node:child_process';\nimport { existsSync } from 'node:fs';\nimport { join } from 'node:path';\nimport { promisify } from 'node:util';\nimport type { ToolDefinition, ToolSuite } from '../../../core/toolRuntime.js';\nimport type { CapabilityContribution, CapabilityModule, CapabilityContext } from '../../../runtime/agentHost.js';\nimport type { ToolPlugin } from '../registry.js';\n\nconst execAsync = promisify(exec);\n\ntype CommandStatus = 'success' | 'failure' | 'skipped';\n\ninterface CommandRunRecord {\n  command: string;\n  status: CommandStatus;\n  durationMs: number;\n  stdout: string;\n  stderr: string;\n  startedAt: number;\n}\n\ninterface CommandToolArgs {\n  command?: string;\n  cwd?: string;\n  dryRun?: boolean;\n}\n\ninterface QualityGateArgs extends CommandToolArgs {\n  buildCommand?: string;\n  lintCommand?: string;\n  typecheckCommand?: string;\n  testCommand?: string;\n  healthCommand?: string;\n  steps?: Array<'build' | 'lint' | 'type-check' | 'test' | 'health'>;\n}\n\ninterface AnalyzeErrorsArgs {\n  error?: string;\n  log?: string;\n}\n\ninterface VerifyResultArgs {\n  expected?: string;\n  actual?: string;\n  tolerance?: number;\n}\n\ninterface HypothesisArgs {\n  objective?: string;\n  context?: string;\n  nextStepHint?: string;\n}\n\nclass OrchestrationToolkit {\n  private recentRuns: CommandRunRecord[] = [];\n\n  constructor(\n    private readonly workingDir: string,\n    private readonly env: NodeJS.ProcessEnv\n  ) {}\n\n  private record(run: CommandRunRecord): void {\n    this.recentRuns.push(run);\n    // Keep a short history to avoid unbounded growth\n    if (this.recentRuns.length > 10) {\n      this.recentRuns.splice(0, this.recentRuns.length - 10);\n    }\n  }\n\n  private formatRun(run: CommandRunRecord, label?: string, dryRun = false, failureReason?: string): string {\n    const status = dryRun ? 'SKIPPED (dry-run)' : run.status === 'success' ? 'OK' : 'FAILED';\n    const lines = [\n      `[${status}] ${label ?? run.command}`,\n      `cmd: ${run.command}`,\n      `time: ${run.durationMs}ms`,\n    ];\n\n    if (run.stdout) {\n      lines.push('stdout:', run.stdout);\n    } else {\n      lines.push('stdout: (empty)');\n    }\n\n    if (run.stderr) {\n      lines.push('stderr:', run.stderr);\n    } else {\n      lines.push('stderr: (empty)');\n    }\n\n    if (failureReason && !run.stderr) {\n      lines.push(`reason: ${failureReason}`);\n    }\n\n    return lines.join('\\n');\n  }\n\n  private truncate(text: string, max = 4000): string {\n    if (text.length <= max) return text;\n    return `${text.slice(0, max)}\\n...[truncated ${text.length - max} chars]`;\n  }\n\n  async runCommand(command: string, options: CommandToolArgs = {}, label?: string): Promise<string> {\n    const cwd = options.cwd ?? this.workingDir;\n    const dryRun = Boolean(options.dryRun);\n    const startedAt = Date.now();\n\n    if (dryRun) {\n      const run: CommandRunRecord = {\n        command,\n        status: 'skipped',\n        durationMs: 0,\n        stdout: '',\n        stderr: 'dry-run',\n        startedAt,\n      };\n      this.record(run);\n      return this.formatRun(run, label, true);\n    }\n\n    try {\n      const { stdout, stderr } = await execAsync(command, {\n        cwd,\n        env: this.env,\n        maxBuffer: 8 * 1024 * 1024,\n      });\n      const run: CommandRunRecord = {\n        command,\n        status: 'success',\n        durationMs: Date.now() - startedAt,\n        stdout: this.truncate(stdout?.toString().trim() ?? ''),\n        stderr: this.truncate(stderr?.toString().trim() ?? ''),\n        startedAt,\n      };\n      this.record(run);\n      return this.formatRun(run, label);\n    } catch (error: any) {\n      const run: CommandRunRecord = {\n        command,\n        status: 'failure',\n        durationMs: Date.now() - startedAt,\n        stdout: this.truncate(error?.stdout?.toString().trim?.() ?? ''),\n        stderr: this.truncate(error?.stderr?.toString().trim?.() ?? error?.message ?? ''),\n        startedAt,\n      };\n      this.record(run);\n      return this.formatRun(run, label, false, error?.message);\n    }\n  }\n\n  async runQualityGate(args: QualityGateArgs = {}): Promise<string> {\n    const steps = args.steps?.length ? args.steps : ['build', 'lint', 'type-check', 'test', 'health'];\n    const outputs: string[] = [];\n\n    for (const step of steps) {\n      switch (step) {\n        case 'build':\n          outputs.push(await this.runCommand(args.buildCommand ?? 'npm run build', args, 'build'));\n          break;\n        case 'lint':\n          outputs.push(await this.runCommand(args.lintCommand ?? 'npm run lint', args, 'lint'));\n          break;\n        case 'type-check':\n          outputs.push(await this.runCommand(args.typecheckCommand ?? 'npm run type-check', args, 'type-check'));\n          break;\n        case 'test':\n          outputs.push(await this.runCommand(args.testCommand ?? 'npm test -- --runInBand', args, 'test'));\n          break;\n        case 'health': {\n          const command = args.healthCommand\n            ?? (existsSync(join(this.workingDir, 'scripts', 'health-check.mjs')) ? 'node scripts/health-check.mjs' : null);\n          outputs.push(\n            command\n              ? await this.runCommand(command, args, 'health-check')\n              : '[SKIPPED] health-check\\nreason: scripts/health-check.mjs not found'\n          );\n          break;\n        }\n        default:\n          outputs.push(`[SKIPPED] ${step}\\nreason: unknown step`);\n      }\n    }\n\n    return outputs.join('\\n\\n');\n  }\n\n  analyzeErrors({ error, log }: AnalyzeErrorsArgs = {}): string {\n    const recentFailure = [...this.recentRuns].reverse().find((run) => run.status === 'failure');\n    const hints: string[] = [];\n    const source = [error ?? '', log ?? '', recentFailure?.stderr ?? '', recentFailure?.stdout ?? ''].join(' ').toLowerCase();\n\n    if (source.includes('tsc') || source.includes('type')) {\n      hints.push('Re-run type checks locally: npm run type-check');\n    }\n    if (source.includes('eslint') || source.includes('lint')) {\n      hints.push('Fix lint failures or run npm run lint -- --fix');\n    }\n    if (source.includes('test')) {\n      hints.push('Inspect failing test output and rerun with npm test -- --runInBand');\n    }\n    if (!hints.length) {\n      hints.push('Review recent command output; retry with --verbose or enable debug logging.');\n    }\n\n    const failureContext = recentFailure\n      ? `Last failure: ${recentFailure.command} (${recentFailure.durationMs}ms)`\n      : 'No previous failures recorded.';\n\n    return [\n      'Orchestration Error Analysis',\n      failureContext,\n      `Error: ${error ?? 'n/a'}`,\n      `Hints: ${hints.join(' | ')}`,\n    ].join('\\n');\n  }\n\n  verifyResult({ expected, actual, tolerance = 0 }: VerifyResultArgs = {}): string {\n    if (expected == null && actual == null) {\n      return 'verification: no inputs provided';\n    }\n\n    const expectedNum = typeof expected === 'number' ? expected : Number.isFinite(Number(expected)) ? Number(expected) : null;\n    const actualNum = typeof actual === 'number' ? actual : Number.isFinite(Number(actual)) ? Number(actual) : null;\n\n    if (expectedNum !== null && actualNum !== null) {\n      const delta = Math.abs(expectedNum - actualNum);\n      const pass = delta <= tolerance;\n      return `verification: ${pass ? 'pass' : 'fail'} (${actualNum} vs ${expectedNum}, tolerance ${tolerance})`;\n    }\n\n    if (expected && actual) {\n      const pass = String(actual).toLowerCase().includes(String(expected).toLowerCase());\n      return `verification: ${pass ? 'pass' : 'fail'} (expected to find \"${expected}\" in \"${actual}\")`;\n    }\n\n    return `verification: incomplete (expected=${expected ?? 'n/a'}, actual=${actual ?? 'n/a'})`;\n  }\n\n  generateHypothesis({ objective, context, nextStepHint }: HypothesisArgs = {}): string {\n    const lines = [\n      'Hypothesis',\n      `Objective: ${objective ?? 'unspecified'}`,\n      context ? `Context: ${context}` : 'Context: n/a',\n      `Next step: ${nextStepHint ?? 'Run quality gate then iterate on failures.'}`,\n    ];\n    return lines.join('\\n');\n  }\n\n  summarizeRecentRuns(): string {\n    if (!this.recentRuns.length) {\n      return 'No orchestration runs recorded yet. Execute run_build/run_tests/quality_gate to capture telemetry.';\n    }\n    const lines = this.recentRuns.slice(-5).map((run) => {\n      const status = run.status === 'success' ? 'ok' : run.status === 'failure' ? 'fail' : 'skip';\n      return `[${status}] ${run.command} (${run.durationMs}ms)`;\n    });\n    return ['Recent orchestration runs:', ...lines].join('\\n');\n  }\n}\n\nclass OrchestrationCapabilityModule implements CapabilityModule {\n  id = 'orchestration.tools.unified';\n  description = 'Unified orchestration toolkit';\n\n  constructor(\n    private readonly workingDir: string,\n    private readonly env: NodeJS.ProcessEnv\n  ) {}\n\n  async create(context: CapabilityContext): Promise<CapabilityContribution> {\n    const toolkit = new OrchestrationToolkit(\n      context.workingDir ?? this.workingDir,\n      { ...this.env, ...context.env },\n    );\n\n    const orchestrationTools: ToolDefinition[] = [\n      {\n        name: 'run_build',\n        description: 'Run project build (default: npm run build).',\n        parameters: {\n          type: 'object',\n          properties: {\n            command: { type: 'string', description: 'Override build command' },\n            cwd: { type: 'string', description: 'Working directory to use' },\n            dryRun: { type: 'boolean', description: 'Skip execution and report intent only' },\n          },\n        },\n        handler: async (args: CommandToolArgs = {}) =>\n          toolkit.runCommand(args.command ?? 'npm run build', args, 'build'),\n      },\n      {\n        name: 'run_lint',\n        description: 'Run linting (default: npm run lint).',\n        parameters: {\n          type: 'object',\n          properties: {\n            command: { type: 'string', description: 'Override lint command' },\n            cwd: { type: 'string' },\n            dryRun: { type: 'boolean' },\n          },\n        },\n        handler: async (args: CommandToolArgs = {}) =>\n          toolkit.runCommand(args.command ?? 'npm run lint', args, 'lint'),\n      },\n      {\n        name: 'run_type_check',\n        description: 'Run type checks (default: npm run type-check).',\n        parameters: {\n          type: 'object',\n          properties: {\n            command: { type: 'string', description: 'Override type-check command' },\n            cwd: { type: 'string' },\n            dryRun: { type: 'boolean' },\n          },\n        },\n        handler: async (args: CommandToolArgs = {}) =>\n          toolkit.runCommand(args.command ?? 'npm run type-check', args, 'type-check'),\n      },\n      {\n        name: 'run_tests',\n        description: 'Run tests (default: npm test -- --runInBand).',\n        parameters: {\n          type: 'object',\n          properties: {\n            command: { type: 'string', description: 'Override test command' },\n            cwd: { type: 'string' },\n            dryRun: { type: 'boolean' },\n          },\n        },\n        handler: async (args: CommandToolArgs = {}) =>\n          toolkit.runCommand(args.command ?? 'npm test -- --runInBand', args, 'tests'),\n      },\n      {\n        name: 'quality_gate',\n        description: 'Run build + lint + type-check + tests (+ optional health check).',\n        parameters: {\n          type: 'object',\n          properties: {\n            steps: {\n              type: 'array',\n              description: 'Ordered steps to run',\n              items: { type: 'string' },\n            },\n            buildCommand: { type: 'string' },\n            lintCommand: { type: 'string' },\n            typecheckCommand: { type: 'string' },\n            testCommand: { type: 'string' },\n            healthCommand: { type: 'string' },\n            cwd: { type: 'string' },\n            dryRun: { type: 'boolean' },\n          },\n        },\n        handler: async (args: QualityGateArgs = {}) => toolkit.runQualityGate(args),\n      },\n      {\n        name: 'analyze_errors',\n        description: 'Analyze execution errors and suggest remediations.',\n        parameters: {\n          type: 'object',\n          properties: {\n            error: { type: 'string' },\n            log: { type: 'string' },\n          },\n        },\n        handler: async (args: AnalyzeErrorsArgs = {}) => toolkit.analyzeErrors(args),\n      },\n      {\n        name: 'verify_result',\n        description: 'Verify a result for correctness or tolerance.',\n        parameters: {\n          type: 'object',\n          properties: {\n            expected: { type: 'string', description: 'Expected value (text or number as text)' },\n            actual: { type: 'string', description: 'Actual value (text or number as text)' },\n            tolerance: { type: 'number', description: 'Numeric delta tolerance' },\n          },\n        },\n        handler: async (args: VerifyResultArgs = {}) => toolkit.verifyResult(args),\n      },\n      {\n        name: 'hypothesis',\n        description: 'Generate and test a hypothesis.',\n        parameters: {\n          type: 'object',\n          properties: {\n            objective: { type: 'string' },\n            context: { type: 'string' },\n            nextStepHint: { type: 'string' },\n          },\n        },\n        handler: async (args: HypothesisArgs = {}) => toolkit.generateHypothesis(args),\n      },\n      {\n        name: 'summarize_orchestration',\n        description: 'Summarize the most recent orchestration runs.',\n        handler: async () => toolkit.summarizeRecentRuns(),\n      },\n    ];\n\n    const toolSuite: ToolSuite = {\n      id: 'orchestration.tools.unified',\n      description: 'Core orchestration helpers for build/test/quality flows.',\n      tools: orchestrationTools,\n    };\n\n    return {\n      id: this.id,\n      description: this.description,\n      toolSuite,\n    };\n  }\n}\n\nexport function createOrchestrationToolPlugin(): ToolPlugin {\n  return {\n    id: 'tool.orchestration.unified',\n    description: 'Unified orchestration toolkit (build, test, quality, telemetry).',\n    targets: ['universal'],\n    create: (context) =>\n      new OrchestrationCapabilityModule(\n        context.workingDir,\n        { ...process.env, ...context.env },\n      ),\n  };\n}\n"],"mappings":"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","ignoreList":[]}
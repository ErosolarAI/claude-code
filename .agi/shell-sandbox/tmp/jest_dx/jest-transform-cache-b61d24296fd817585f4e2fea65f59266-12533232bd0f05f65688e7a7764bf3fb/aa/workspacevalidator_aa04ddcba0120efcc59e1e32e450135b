703c6f6885e9a3ae66996e6020ce5162
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.safeWorkspaceContext = safeWorkspaceContext;
exports.truncateWorkspaceContext = truncateWorkspaceContext;
exports.validateWorkspaceContext = validateWorkspaceContext;
exports.validateWorkspaceOptions = validateWorkspaceOptions;
var _errorTypes = require("./core/errors/errorTypes.js");
var _debugLogger = require("./utils/debugLogger.js");
/**
 * Workspace Context Validator - Enforces strict safety limits
 *
 * CRITICAL: Prevents context explosion by validating all workspace context
 * before it's sent to the LLM. Multiple safety layers ensure we never
 * exceed token limits.
 */

// ABSOLUTE MAXIMUM LIMITS - Never exceed these under any circumstances
const ABSOLUTE_MAX_CHARS = 5000; // ~1,250 tokens (4 chars per token)
const ABSOLUTE_MAX_LINES = 100; // Maximum lines in any context
const ABSOLUTE_MAX_FILE_ENTRIES = 50; // Maximum files in tree
const ABSOLUTE_MAX_DOC_CHARS = 300; // Maximum chars per priority doc
const WARNING_THRESHOLD = 0.7; // Warn at 70% of max

/**
 * Estimate token count (rough: 1 token â‰ˆ 4 characters)
 */
function estimateTokens(text) {
  return Math.ceil(text.length / 4);
}

/**
 * Validate workspace context options BEFORE building context
 */
function validateWorkspaceOptions(options) {
  const errors = [];
  const warnings = [];

  // Validate tree depth
  if (options.treeDepth !== undefined) {
    if (options.treeDepth < 0) {
      errors.push('treeDepth cannot be negative');
    }
    if (options.treeDepth > 2) {
      errors.push(`treeDepth ${options.treeDepth} exceeds maximum of 2`);
    }
    if (options.treeDepth > 1) {
      warnings.push('treeDepth > 1 can significantly increase context size');
    }
  }

  // Validate max entries
  if (options.maxEntries !== undefined) {
    if (options.maxEntries < 0) {
      errors.push('maxEntries cannot be negative');
    }
    if (options.maxEntries > ABSOLUTE_MAX_FILE_ENTRIES) {
      errors.push(`maxEntries ${options.maxEntries} exceeds maximum of ${ABSOLUTE_MAX_FILE_ENTRIES}`);
    }
    if (options.maxEntries > 40) {
      warnings.push('maxEntries > 40 may use significant context');
    }
  }

  // Validate doc excerpt limit
  if (options.docExcerptLimit !== undefined) {
    if (options.docExcerptLimit < 0) {
      errors.push('docExcerptLimit cannot be negative');
    }
    if (options.docExcerptLimit > ABSOLUTE_MAX_DOC_CHARS) {
      errors.push(`docExcerptLimit ${options.docExcerptLimit} exceeds maximum of ${ABSOLUTE_MAX_DOC_CHARS}`);
    }
    if (options.docExcerptLimit > 250) {
      warnings.push('docExcerptLimit > 250 may use significant context');
    }
  }
  return {
    valid: errors.length === 0,
    errors,
    warnings,
    stats: {
      totalChars: 0,
      totalLines: 0,
      estimatedTokens: 0,
      fileEntries: options.maxEntries ?? 0,
      docChars: options.docExcerptLimit ?? 0
    }
  };
}

/**
 * Validate workspace context AFTER building - CRITICAL SAFETY CHECK
 * This is the final line of defense against context explosion
 */
function validateWorkspaceContext(content) {
  const errors = [];
  const warnings = [];

  // Count basic metrics
  const totalChars = content.length;
  const lines = content.split('\n');
  const totalLines = lines.length;
  const estimatedTokens = estimateTokens(content);

  // Count file entries (lines that look like file paths)
  const fileEntries = lines.filter(line => line.trim() && !line.startsWith('---') && !line.startsWith('cwd:')).length;

  // Count chars in priority docs section
  const docMatch = content.match(/--- .* ---[\s\S]*?(?=\n\n|$)/g);
  const docChars = docMatch ? docMatch.join('').length : 0;
  const stats = {
    totalChars,
    totalLines,
    estimatedTokens,
    fileEntries,
    docChars
  };

  // CRITICAL: Check absolute maximum character limit
  if (totalChars > ABSOLUTE_MAX_CHARS) {
    const error = new _errorTypes.ContextOverflowError(totalChars, ABSOLUTE_MAX_CHARS, 'chars', true);
    errors.push(`Context exceeds ABSOLUTE maximum: ${error.message}`);
  }

  // CRITICAL: Check absolute maximum line limit
  if (totalLines > ABSOLUTE_MAX_LINES) {
    const error = new _errorTypes.ContextOverflowError(totalLines, ABSOLUTE_MAX_LINES, 'lines', true);
    errors.push(`Context exceeds ABSOLUTE maximum: ${error.message}`);
  }

  // CRITICAL: Check absolute maximum file entries
  if (fileEntries > ABSOLUTE_MAX_FILE_ENTRIES) {
    const error = new _errorTypes.ResourceLimitError('file entries', fileEntries, ABSOLUTE_MAX_FILE_ENTRIES, false);
    errors.push(`Context exceeds ABSOLUTE maximum: ${error.message}`);
  }

  // WARNING: Approaching limits
  if (totalChars > ABSOLUTE_MAX_CHARS * WARNING_THRESHOLD) {
    warnings.push(`Context size ${totalChars} chars is ${Math.round(totalChars / ABSOLUTE_MAX_CHARS * 100)}% of maximum. ` + `Consider reducing treeDepth, maxEntries, or docExcerptLimit.`);
  }
  if (estimatedTokens > 1000) {
    warnings.push(`Estimated ${estimatedTokens} tokens in workspace context. This is high and may impact performance.`);
  }
  return {
    valid: errors.length === 0,
    errors,
    warnings,
    stats
  };
}

/**
 * Safe truncation - if content exceeds limits, truncate intelligently
 */
function truncateWorkspaceContext(content) {
  const validation = validateWorkspaceContext(content);

  // If valid, return as-is
  if (validation.valid) {
    return {
      content,
      stats: validation.stats
    };
  }

  // CRITICAL: Content exceeds limits, must truncate
  const lines = content.split('\n');
  const truncatedLines = [];
  let charCount = 0;

  // Keep up to absolute maximums
  for (const line of lines) {
    if (truncatedLines.length >= ABSOLUTE_MAX_LINES) {
      break;
    }
    if (charCount + line.length > ABSOLUTE_MAX_CHARS) {
      break;
    }
    truncatedLines.push(line);
    charCount += line.length + 1; // +1 for newline
  }

  // Add truncation notice
  if (truncatedLines.length < lines.length) {
    truncatedLines.push('');
    truncatedLines.push('[Workspace context truncated to prevent context overflow]');
    truncatedLines.push(`[Showing ${truncatedLines.length} of ${lines.length} lines]`);
  }
  const truncatedContent = truncatedLines.join('\n');
  const stats = validateWorkspaceContext(truncatedContent).stats;
  return {
    content: truncatedContent,
    stats
  };
}

/**
 * Validate and enforce limits in a single call - RECOMMENDED USAGE
 */
function safeWorkspaceContext(content, options) {
  const {
    truncate = true,
    throwOnError = false
  } = options ?? {};
  if (!content) {
    return {
      content: '',
      stats: {
        totalChars: 0,
        totalLines: 0,
        estimatedTokens: 0,
        fileEntries: 0,
        docChars: 0
      }
    };
  }
  const validation = validateWorkspaceContext(content);

  // Log warnings to debug
  if (validation.warnings.length > 0) {
    (0, _debugLogger.logDebug)('[Workspace Context Validator] Warnings:');
    for (const warning of validation.warnings) {
      (0, _debugLogger.logDebug)(`  - ${warning}`);
    }
  }

  // Handle errors
  if (!validation.valid) {
    (0, _debugLogger.logDebug)('[Workspace Context Validator] CRITICAL ERRORS:');
    for (const error of validation.errors) {
      (0, _debugLogger.logDebug)(`  - ${error}`);
    }
    if (throwOnError) {
      throw new Error(`Workspace context validation failed:\n${validation.errors.join('\n')}`);
    }
    if (truncate) {
      (0, _debugLogger.logDebug)('[Workspace Context Validator] Auto-truncating to safe limits...');
      return truncateWorkspaceContext(content);
    }
  }
  return {
    content,
    stats: validation.stats
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXJyb3JUeXBlcyIsInJlcXVpcmUiLCJfZGVidWdMb2dnZXIiLCJBQlNPTFVURV9NQVhfQ0hBUlMiLCJBQlNPTFVURV9NQVhfTElORVMiLCJBQlNPTFVURV9NQVhfRklMRV9FTlRSSUVTIiwiQUJTT0xVVEVfTUFYX0RPQ19DSEFSUyIsIldBUk5JTkdfVEhSRVNIT0xEIiwiZXN0aW1hdGVUb2tlbnMiLCJ0ZXh0IiwiTWF0aCIsImNlaWwiLCJsZW5ndGgiLCJ2YWxpZGF0ZVdvcmtzcGFjZU9wdGlvbnMiLCJvcHRpb25zIiwiZXJyb3JzIiwid2FybmluZ3MiLCJ0cmVlRGVwdGgiLCJ1bmRlZmluZWQiLCJwdXNoIiwibWF4RW50cmllcyIsImRvY0V4Y2VycHRMaW1pdCIsInZhbGlkIiwic3RhdHMiLCJ0b3RhbENoYXJzIiwidG90YWxMaW5lcyIsImVzdGltYXRlZFRva2VucyIsImZpbGVFbnRyaWVzIiwiZG9jQ2hhcnMiLCJ2YWxpZGF0ZVdvcmtzcGFjZUNvbnRleHQiLCJjb250ZW50IiwibGluZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJ0cmltIiwic3RhcnRzV2l0aCIsImRvY01hdGNoIiwibWF0Y2giLCJqb2luIiwiZXJyb3IiLCJDb250ZXh0T3ZlcmZsb3dFcnJvciIsIm1lc3NhZ2UiLCJSZXNvdXJjZUxpbWl0RXJyb3IiLCJyb3VuZCIsInRydW5jYXRlV29ya3NwYWNlQ29udGV4dCIsInZhbGlkYXRpb24iLCJ0cnVuY2F0ZWRMaW5lcyIsImNoYXJDb3VudCIsInRydW5jYXRlZENvbnRlbnQiLCJzYWZlV29ya3NwYWNlQ29udGV4dCIsInRydW5jYXRlIiwidGhyb3dPbkVycm9yIiwibG9nRGVidWciLCJ3YXJuaW5nIiwiRXJyb3IiXSwic291cmNlcyI6WyJ3b3Jrc3BhY2UudmFsaWRhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogV29ya3NwYWNlIENvbnRleHQgVmFsaWRhdG9yIC0gRW5mb3JjZXMgc3RyaWN0IHNhZmV0eSBsaW1pdHNcbiAqXG4gKiBDUklUSUNBTDogUHJldmVudHMgY29udGV4dCBleHBsb3Npb24gYnkgdmFsaWRhdGluZyBhbGwgd29ya3NwYWNlIGNvbnRleHRcbiAqIGJlZm9yZSBpdCdzIHNlbnQgdG8gdGhlIExMTS4gTXVsdGlwbGUgc2FmZXR5IGxheWVycyBlbnN1cmUgd2UgbmV2ZXJcbiAqIGV4Y2VlZCB0b2tlbiBsaW1pdHMuXG4gKi9cblxuaW1wb3J0IHsgQ29udGV4dE92ZXJmbG93RXJyb3IsIFJlc291cmNlTGltaXRFcnJvciB9IGZyb20gJy4vY29yZS9lcnJvcnMvZXJyb3JUeXBlcy5qcyc7XG5pbXBvcnQgeyBsb2dEZWJ1ZyB9IGZyb20gJy4vdXRpbHMvZGVidWdMb2dnZXIuanMnO1xuXG4vLyBBQlNPTFVURSBNQVhJTVVNIExJTUlUUyAtIE5ldmVyIGV4Y2VlZCB0aGVzZSB1bmRlciBhbnkgY2lyY3Vtc3RhbmNlc1xuY29uc3QgQUJTT0xVVEVfTUFYX0NIQVJTID0gNTAwMDsgICAgICAgIC8vIH4xLDI1MCB0b2tlbnMgKDQgY2hhcnMgcGVyIHRva2VuKVxuY29uc3QgQUJTT0xVVEVfTUFYX0xJTkVTID0gMTAwOyAgICAgICAgIC8vIE1heGltdW0gbGluZXMgaW4gYW55IGNvbnRleHRcbmNvbnN0IEFCU09MVVRFX01BWF9GSUxFX0VOVFJJRVMgPSA1MDsgICAvLyBNYXhpbXVtIGZpbGVzIGluIHRyZWVcbmNvbnN0IEFCU09MVVRFX01BWF9ET0NfQ0hBUlMgPSAzMDA7ICAgICAvLyBNYXhpbXVtIGNoYXJzIHBlciBwcmlvcml0eSBkb2NcbmNvbnN0IFdBUk5JTkdfVEhSRVNIT0xEID0gMC43OyAgICAgICAgICAvLyBXYXJuIGF0IDcwJSBvZiBtYXhcblxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgdmFsaWQ6IGJvb2xlYW47XG4gIGVycm9yczogc3RyaW5nW107XG4gIHdhcm5pbmdzOiBzdHJpbmdbXTtcbiAgc3RhdHM6IENvbnRleHRTdGF0cztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb250ZXh0U3RhdHMge1xuICB0b3RhbENoYXJzOiBudW1iZXI7XG4gIHRvdGFsTGluZXM6IG51bWJlcjtcbiAgZXN0aW1hdGVkVG9rZW5zOiBudW1iZXI7XG4gIGZpbGVFbnRyaWVzOiBudW1iZXI7XG4gIGRvY0NoYXJzOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV29ya3NwYWNlQ29udGV4dFNhZmUge1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHN0YXRzOiBDb250ZXh0U3RhdHM7XG59XG5cbi8qKlxuICogRXN0aW1hdGUgdG9rZW4gY291bnQgKHJvdWdoOiAxIHRva2VuIOKJiCA0IGNoYXJhY3RlcnMpXG4gKi9cbmZ1bmN0aW9uIGVzdGltYXRlVG9rZW5zKHRleHQ6IHN0cmluZyk6IG51bWJlciB7XG4gIHJldHVybiBNYXRoLmNlaWwodGV4dC5sZW5ndGggLyA0KTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSB3b3Jrc3BhY2UgY29udGV4dCBvcHRpb25zIEJFRk9SRSBidWlsZGluZyBjb250ZXh0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVdvcmtzcGFjZU9wdGlvbnMob3B0aW9uczoge1xuICB0cmVlRGVwdGg/OiBudW1iZXI7XG4gIG1heEVudHJpZXM/OiBudW1iZXI7XG4gIGRvY0V4Y2VycHRMaW1pdD86IG51bWJlcjtcbn0pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAvLyBWYWxpZGF0ZSB0cmVlIGRlcHRoXG4gIGlmIChvcHRpb25zLnRyZWVEZXB0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKG9wdGlvbnMudHJlZURlcHRoIDwgMCkge1xuICAgICAgZXJyb3JzLnB1c2goJ3RyZWVEZXB0aCBjYW5ub3QgYmUgbmVnYXRpdmUnKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMudHJlZURlcHRoID4gMikge1xuICAgICAgZXJyb3JzLnB1c2goYHRyZWVEZXB0aCAke29wdGlvbnMudHJlZURlcHRofSBleGNlZWRzIG1heGltdW0gb2YgMmApO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy50cmVlRGVwdGggPiAxKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKCd0cmVlRGVwdGggPiAxIGNhbiBzaWduaWZpY2FudGx5IGluY3JlYXNlIGNvbnRleHQgc2l6ZScpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIG1heCBlbnRyaWVzXG4gIGlmIChvcHRpb25zLm1heEVudHJpZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChvcHRpb25zLm1heEVudHJpZXMgPCAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnbWF4RW50cmllcyBjYW5ub3QgYmUgbmVnYXRpdmUnKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMubWF4RW50cmllcyA+IEFCU09MVVRFX01BWF9GSUxFX0VOVFJJRVMpIHtcbiAgICAgIGVycm9ycy5wdXNoKGBtYXhFbnRyaWVzICR7b3B0aW9ucy5tYXhFbnRyaWVzfSBleGNlZWRzIG1heGltdW0gb2YgJHtBQlNPTFVURV9NQVhfRklMRV9FTlRSSUVTfWApO1xuICAgIH1cbiAgICBpZiAob3B0aW9ucy5tYXhFbnRyaWVzID4gNDApIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goJ21heEVudHJpZXMgPiA0MCBtYXkgdXNlIHNpZ25pZmljYW50IGNvbnRleHQnKTtcbiAgICB9XG4gIH1cblxuICAvLyBWYWxpZGF0ZSBkb2MgZXhjZXJwdCBsaW1pdFxuICBpZiAob3B0aW9ucy5kb2NFeGNlcnB0TGltaXQgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChvcHRpb25zLmRvY0V4Y2VycHRMaW1pdCA8IDApIHtcbiAgICAgIGVycm9ycy5wdXNoKCdkb2NFeGNlcnB0TGltaXQgY2Fubm90IGJlIG5lZ2F0aXZlJyk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmRvY0V4Y2VycHRMaW1pdCA+IEFCU09MVVRFX01BWF9ET0NfQ0hBUlMpIHtcbiAgICAgIGVycm9ycy5wdXNoKGBkb2NFeGNlcnB0TGltaXQgJHtvcHRpb25zLmRvY0V4Y2VycHRMaW1pdH0gZXhjZWVkcyBtYXhpbXVtIG9mICR7QUJTT0xVVEVfTUFYX0RPQ19DSEFSU31gKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMuZG9jRXhjZXJwdExpbWl0ID4gMjUwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKCdkb2NFeGNlcnB0TGltaXQgPiAyNTAgbWF5IHVzZSBzaWduaWZpY2FudCBjb250ZXh0Jyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnMsXG4gICAgd2FybmluZ3MsXG4gICAgc3RhdHM6IHtcbiAgICAgIHRvdGFsQ2hhcnM6IDAsXG4gICAgICB0b3RhbExpbmVzOiAwLFxuICAgICAgZXN0aW1hdGVkVG9rZW5zOiAwLFxuICAgICAgZmlsZUVudHJpZXM6IG9wdGlvbnMubWF4RW50cmllcyA/PyAwLFxuICAgICAgZG9jQ2hhcnM6IG9wdGlvbnMuZG9jRXhjZXJwdExpbWl0ID8/IDAsXG4gICAgfSxcbiAgfTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSB3b3Jrc3BhY2UgY29udGV4dCBBRlRFUiBidWlsZGluZyAtIENSSVRJQ0FMIFNBRkVUWSBDSEVDS1xuICogVGhpcyBpcyB0aGUgZmluYWwgbGluZSBvZiBkZWZlbnNlIGFnYWluc3QgY29udGV4dCBleHBsb3Npb25cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlV29ya3NwYWNlQ29udGV4dChjb250ZW50OiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAvLyBDb3VudCBiYXNpYyBtZXRyaWNzXG4gIGNvbnN0IHRvdGFsQ2hhcnMgPSBjb250ZW50Lmxlbmd0aDtcbiAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgY29uc3QgdG90YWxMaW5lcyA9IGxpbmVzLmxlbmd0aDtcbiAgY29uc3QgZXN0aW1hdGVkVG9rZW5zID0gZXN0aW1hdGVUb2tlbnMoY29udGVudCk7XG5cbiAgLy8gQ291bnQgZmlsZSBlbnRyaWVzIChsaW5lcyB0aGF0IGxvb2sgbGlrZSBmaWxlIHBhdGhzKVxuICBjb25zdCBmaWxlRW50cmllcyA9IGxpbmVzLmZpbHRlcihsaW5lID0+XG4gICAgbGluZS50cmltKCkgJiYgIWxpbmUuc3RhcnRzV2l0aCgnLS0tJykgJiYgIWxpbmUuc3RhcnRzV2l0aCgnY3dkOicpXG4gICkubGVuZ3RoO1xuXG4gIC8vIENvdW50IGNoYXJzIGluIHByaW9yaXR5IGRvY3Mgc2VjdGlvblxuICBjb25zdCBkb2NNYXRjaCA9IGNvbnRlbnQubWF0Y2goLy0tLSAuKiAtLS1bXFxzXFxTXSo/KD89XFxuXFxufCQpL2cpO1xuICBjb25zdCBkb2NDaGFycyA9IGRvY01hdGNoID8gZG9jTWF0Y2guam9pbignJykubGVuZ3RoIDogMDtcblxuICBjb25zdCBzdGF0czogQ29udGV4dFN0YXRzID0ge1xuICAgIHRvdGFsQ2hhcnMsXG4gICAgdG90YWxMaW5lcyxcbiAgICBlc3RpbWF0ZWRUb2tlbnMsXG4gICAgZmlsZUVudHJpZXMsXG4gICAgZG9jQ2hhcnMsXG4gIH07XG5cbiAgLy8gQ1JJVElDQUw6IENoZWNrIGFic29sdXRlIG1heGltdW0gY2hhcmFjdGVyIGxpbWl0XG4gIGlmICh0b3RhbENoYXJzID4gQUJTT0xVVEVfTUFYX0NIQVJTKSB7XG4gICAgY29uc3QgZXJyb3IgPSBuZXcgQ29udGV4dE92ZXJmbG93RXJyb3IodG90YWxDaGFycywgQUJTT0xVVEVfTUFYX0NIQVJTLCAnY2hhcnMnLCB0cnVlKTtcbiAgICBlcnJvcnMucHVzaChcbiAgICAgIGBDb250ZXh0IGV4Y2VlZHMgQUJTT0xVVEUgbWF4aW11bTogJHtlcnJvci5tZXNzYWdlfWBcbiAgICApO1xuICB9XG5cbiAgLy8gQ1JJVElDQUw6IENoZWNrIGFic29sdXRlIG1heGltdW0gbGluZSBsaW1pdFxuICBpZiAodG90YWxMaW5lcyA+IEFCU09MVVRFX01BWF9MSU5FUykge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IENvbnRleHRPdmVyZmxvd0Vycm9yKHRvdGFsTGluZXMsIEFCU09MVVRFX01BWF9MSU5FUywgJ2xpbmVzJywgdHJ1ZSk7XG4gICAgZXJyb3JzLnB1c2goXG4gICAgICBgQ29udGV4dCBleGNlZWRzIEFCU09MVVRFIG1heGltdW06ICR7ZXJyb3IubWVzc2FnZX1gXG4gICAgKTtcbiAgfVxuXG4gIC8vIENSSVRJQ0FMOiBDaGVjayBhYnNvbHV0ZSBtYXhpbXVtIGZpbGUgZW50cmllc1xuICBpZiAoZmlsZUVudHJpZXMgPiBBQlNPTFVURV9NQVhfRklMRV9FTlRSSUVTKSB7XG4gICAgY29uc3QgZXJyb3IgPSBuZXcgUmVzb3VyY2VMaW1pdEVycm9yKCdmaWxlIGVudHJpZXMnLCBmaWxlRW50cmllcywgQUJTT0xVVEVfTUFYX0ZJTEVfRU5UUklFUywgZmFsc2UpO1xuICAgIGVycm9ycy5wdXNoKFxuICAgICAgYENvbnRleHQgZXhjZWVkcyBBQlNPTFVURSBtYXhpbXVtOiAke2Vycm9yLm1lc3NhZ2V9YFxuICAgICk7XG4gIH1cblxuICAvLyBXQVJOSU5HOiBBcHByb2FjaGluZyBsaW1pdHNcbiAgaWYgKHRvdGFsQ2hhcnMgPiBBQlNPTFVURV9NQVhfQ0hBUlMgKiBXQVJOSU5HX1RIUkVTSE9MRCkge1xuICAgIHdhcm5pbmdzLnB1c2goXG4gICAgICBgQ29udGV4dCBzaXplICR7dG90YWxDaGFyc30gY2hhcnMgaXMgJHtNYXRoLnJvdW5kKHRvdGFsQ2hhcnMgLyBBQlNPTFVURV9NQVhfQ0hBUlMgKiAxMDApfSUgb2YgbWF4aW11bS4gYCArXG4gICAgICBgQ29uc2lkZXIgcmVkdWNpbmcgdHJlZURlcHRoLCBtYXhFbnRyaWVzLCBvciBkb2NFeGNlcnB0TGltaXQuYFxuICAgICk7XG4gIH1cblxuICBpZiAoZXN0aW1hdGVkVG9rZW5zID4gMTAwMCkge1xuICAgIHdhcm5pbmdzLnB1c2goXG4gICAgICBgRXN0aW1hdGVkICR7ZXN0aW1hdGVkVG9rZW5zfSB0b2tlbnMgaW4gd29ya3NwYWNlIGNvbnRleHQuIFRoaXMgaXMgaGlnaCBhbmQgbWF5IGltcGFjdCBwZXJmb3JtYW5jZS5gXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHdhcm5pbmdzLFxuICAgIHN0YXRzLFxuICB9O1xufVxuXG4vKipcbiAqIFNhZmUgdHJ1bmNhdGlvbiAtIGlmIGNvbnRlbnQgZXhjZWVkcyBsaW1pdHMsIHRydW5jYXRlIGludGVsbGlnZW50bHlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRydW5jYXRlV29ya3NwYWNlQ29udGV4dChjb250ZW50OiBzdHJpbmcpOiBXb3Jrc3BhY2VDb250ZXh0U2FmZSB7XG4gIGNvbnN0IHZhbGlkYXRpb24gPSB2YWxpZGF0ZVdvcmtzcGFjZUNvbnRleHQoY29udGVudCk7XG5cbiAgLy8gSWYgdmFsaWQsIHJldHVybiBhcy1pc1xuICBpZiAodmFsaWRhdGlvbi52YWxpZCkge1xuICAgIHJldHVybiB7XG4gICAgICBjb250ZW50LFxuICAgICAgc3RhdHM6IHZhbGlkYXRpb24uc3RhdHMsXG4gICAgfTtcbiAgfVxuXG4gIC8vIENSSVRJQ0FMOiBDb250ZW50IGV4Y2VlZHMgbGltaXRzLCBtdXN0IHRydW5jYXRlXG4gIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG4gIGNvbnN0IHRydW5jYXRlZExpbmVzOiBzdHJpbmdbXSA9IFtdO1xuICBsZXQgY2hhckNvdW50ID0gMDtcblxuICAvLyBLZWVwIHVwIHRvIGFic29sdXRlIG1heGltdW1zXG4gIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgIGlmICh0cnVuY2F0ZWRMaW5lcy5sZW5ndGggPj0gQUJTT0xVVEVfTUFYX0xJTkVTKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGNoYXJDb3VudCArIGxpbmUubGVuZ3RoID4gQUJTT0xVVEVfTUFYX0NIQVJTKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICB0cnVuY2F0ZWRMaW5lcy5wdXNoKGxpbmUpO1xuICAgIGNoYXJDb3VudCArPSBsaW5lLmxlbmd0aCArIDE7IC8vICsxIGZvciBuZXdsaW5lXG4gIH1cblxuICAvLyBBZGQgdHJ1bmNhdGlvbiBub3RpY2VcbiAgaWYgKHRydW5jYXRlZExpbmVzLmxlbmd0aCA8IGxpbmVzLmxlbmd0aCkge1xuICAgIHRydW5jYXRlZExpbmVzLnB1c2goJycpO1xuICAgIHRydW5jYXRlZExpbmVzLnB1c2goJ1tXb3Jrc3BhY2UgY29udGV4dCB0cnVuY2F0ZWQgdG8gcHJldmVudCBjb250ZXh0IG92ZXJmbG93XScpO1xuICAgIHRydW5jYXRlZExpbmVzLnB1c2goYFtTaG93aW5nICR7dHJ1bmNhdGVkTGluZXMubGVuZ3RofSBvZiAke2xpbmVzLmxlbmd0aH0gbGluZXNdYCk7XG4gIH1cblxuICBjb25zdCB0cnVuY2F0ZWRDb250ZW50ID0gdHJ1bmNhdGVkTGluZXMuam9pbignXFxuJyk7XG4gIGNvbnN0IHN0YXRzID0gdmFsaWRhdGVXb3Jrc3BhY2VDb250ZXh0KHRydW5jYXRlZENvbnRlbnQpLnN0YXRzO1xuXG4gIHJldHVybiB7XG4gICAgY29udGVudDogdHJ1bmNhdGVkQ29udGVudCxcbiAgICBzdGF0cyxcbiAgfTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBhbmQgZW5mb3JjZSBsaW1pdHMgaW4gYSBzaW5nbGUgY2FsbCAtIFJFQ09NTUVOREVEIFVTQUdFXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYWZlV29ya3NwYWNlQ29udGV4dChcbiAgY29udGVudDogc3RyaW5nIHwgbnVsbCxcbiAgb3B0aW9ucz86IHsgdHJ1bmNhdGU/OiBib29sZWFuOyB0aHJvd09uRXJyb3I/OiBib29sZWFuIH1cbik6IFdvcmtzcGFjZUNvbnRleHRTYWZlIHtcbiAgY29uc3QgeyB0cnVuY2F0ZSA9IHRydWUsIHRocm93T25FcnJvciA9IGZhbHNlIH0gPSBvcHRpb25zID8/IHt9O1xuXG4gIGlmICghY29udGVudCkge1xuICAgIHJldHVybiB7XG4gICAgICBjb250ZW50OiAnJyxcbiAgICAgIHN0YXRzOiB7XG4gICAgICAgIHRvdGFsQ2hhcnM6IDAsXG4gICAgICAgIHRvdGFsTGluZXM6IDAsXG4gICAgICAgIGVzdGltYXRlZFRva2VuczogMCxcbiAgICAgICAgZmlsZUVudHJpZXM6IDAsXG4gICAgICAgIGRvY0NoYXJzOiAwLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgdmFsaWRhdGlvbiA9IHZhbGlkYXRlV29ya3NwYWNlQ29udGV4dChjb250ZW50KTtcblxuICAvLyBMb2cgd2FybmluZ3MgdG8gZGVidWdcbiAgaWYgKHZhbGlkYXRpb24ud2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgIGxvZ0RlYnVnKCdbV29ya3NwYWNlIENvbnRleHQgVmFsaWRhdG9yXSBXYXJuaW5nczonKTtcbiAgICBmb3IgKGNvbnN0IHdhcm5pbmcgb2YgdmFsaWRhdGlvbi53YXJuaW5ncykge1xuICAgICAgbG9nRGVidWcoYCAgLSAke3dhcm5pbmd9YCk7XG4gICAgfVxuICB9XG5cbiAgLy8gSGFuZGxlIGVycm9yc1xuICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICBsb2dEZWJ1ZygnW1dvcmtzcGFjZSBDb250ZXh0IFZhbGlkYXRvcl0gQ1JJVElDQUwgRVJST1JTOicpO1xuICAgIGZvciAoY29uc3QgZXJyb3Igb2YgdmFsaWRhdGlvbi5lcnJvcnMpIHtcbiAgICAgIGxvZ0RlYnVnKGAgIC0gJHtlcnJvcn1gKTtcbiAgICB9XG5cbiAgICBpZiAodGhyb3dPbkVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBXb3Jrc3BhY2UgY29udGV4dCB2YWxpZGF0aW9uIGZhaWxlZDpcXG4ke3ZhbGlkYXRpb24uZXJyb3JzLmpvaW4oJ1xcbicpfWBcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHRydW5jYXRlKSB7XG4gICAgICBsb2dEZWJ1ZygnW1dvcmtzcGFjZSBDb250ZXh0IFZhbGlkYXRvcl0gQXV0by10cnVuY2F0aW5nIHRvIHNhZmUgbGltaXRzLi4uJyk7XG4gICAgICByZXR1cm4gdHJ1bmNhdGVXb3Jrc3BhY2VDb250ZXh0KGNvbnRlbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgY29udGVudCxcbiAgICBzdGF0czogdmFsaWRhdGlvbi5zdGF0cyxcbiAgfTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBUUEsSUFBQUEsV0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBRCxPQUFBO0FBVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBS0E7QUFDQSxNQUFNRSxrQkFBa0IsR0FBRyxJQUFJLENBQUMsQ0FBUTtBQUN4QyxNQUFNQyxrQkFBa0IsR0FBRyxHQUFHLENBQUMsQ0FBUztBQUN4QyxNQUFNQyx5QkFBeUIsR0FBRyxFQUFFLENBQUMsQ0FBRztBQUN4QyxNQUFNQyxzQkFBc0IsR0FBRyxHQUFHLENBQUMsQ0FBSztBQUN4QyxNQUFNQyxpQkFBaUIsR0FBRyxHQUFHLENBQUMsQ0FBVTs7QUFzQnhDO0FBQ0E7QUFDQTtBQUNBLFNBQVNDLGNBQWNBLENBQUNDLElBQVksRUFBVTtFQUM1QyxPQUFPQyxJQUFJLENBQUNDLElBQUksQ0FBQ0YsSUFBSSxDQUFDRyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTtBQUNPLFNBQVNDLHdCQUF3QkEsQ0FBQ0MsT0FJeEMsRUFBb0I7RUFDbkIsTUFBTUMsTUFBZ0IsR0FBRyxFQUFFO0VBQzNCLE1BQU1DLFFBQWtCLEdBQUcsRUFBRTs7RUFFN0I7RUFDQSxJQUFJRixPQUFPLENBQUNHLFNBQVMsS0FBS0MsU0FBUyxFQUFFO0lBQ25DLElBQUlKLE9BQU8sQ0FBQ0csU0FBUyxHQUFHLENBQUMsRUFBRTtNQUN6QkYsTUFBTSxDQUFDSSxJ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
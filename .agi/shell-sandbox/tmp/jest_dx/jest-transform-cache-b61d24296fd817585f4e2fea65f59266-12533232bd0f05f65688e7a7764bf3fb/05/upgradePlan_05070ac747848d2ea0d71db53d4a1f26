9072456ae6a3691638446a83dfdfbba8
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.buildDefaultSteps = buildDefaultSteps;
exports.buildRepoWidePlan = buildRepoWidePlan;
exports.detectWorkspaceModules = detectWorkspaceModules;
exports.expandWorkspacePattern = expandWorkspacePattern;
exports.parseWorkspaceField = parseWorkspaceField;
var _nodeFs = require("node:fs");
var _nodePath = require("node:path");
/**
 * Build a repo-wide upgrade plan using common directories. Falls back to a single
 * catch-all module when no known scopes are found.
 */
function buildRepoWidePlan(workspaceRoot, additionalScopes = []) {
  const normalizedScopes = normalizeScopes(additionalScopes);
  const areas = [{
    id: 'source',
    label: 'Source',
    description: 'Core application and library code.',
    scope: ['src/**/*', 'lib/**/*'],
    candidates: ['src', 'lib'],
    codemodCommands: ['npx jscodeshift -t <transform> src'],
    validationCommands: ['npm run build', 'npm test']
  }, {
    id: 'tests',
    label: 'Tests',
    description: 'Unit, integration, and smoke tests.',
    scope: ['test/**/*', '__tests__/**/*'],
    candidates: ['test', '__tests__'],
    validationCommands: ['npm test -- --runInBand', 'npm run lint']
  }, {
    id: 'docs',
    label: 'Docs',
    description: 'Documentation and guides.',
    scope: ['docs/**/*', 'README.md'],
    candidates: ['docs', 'README.md']
  }, {
    id: 'scripts',
    label: 'Tooling Scripts',
    description: 'Build, migration, and maintenance scripts.',
    scope: ['scripts/**/*'],
    candidates: ['scripts'],
    validationCommands: ['npm run lint -- scripts/**/*.ts']
  }, {
    id: 'agents',
    label: 'Agents',
    description: 'Agent rules and behaviors.',
    scope: ['agents/**/*'],
    candidates: ['agents'],
    validationCommands: ['npm run build']
  }, {
    id: 'skills',
    label: 'Skills',
    description: 'Skill packs and reusable automation.',
    scope: ['skills/**/*'],
    candidates: ['skills'],
    validationCommands: ['npm run build']
  }, {
    id: 'examples',
    label: 'Examples',
    description: 'Example flows and templates.',
    scope: ['examples/**/*'],
    candidates: ['examples']
  }, {
    id: 'configs',
    label: 'Configuration',
    description: 'Configuration and deployment settings.',
    scope: ['config/**/*', '*.config.*', '*.rc', '*.json'],
    candidates: ['config']
  }];
  const modules = [];
  const workspaceModules = detectWorkspaceModules(workspaceRoot);

  // When scopes are provided, build a targeted plan instead of sweeping the repo.
  if (normalizedScopes.length) {
    for (const scope of normalizedScopes) {
      modules.push(buildCustomScopeModule(scope));
    }
    for (const module of workspaceModules) {
      if (moduleMatchesRequestedScopes(module.scope, normalizedScopes)) {
        modules.push(module);
      }
    }
    const deduped = dedupeModules(modules);
    if (deduped.length === 0) {
      deduped.push(buildCustomScopeModule(normalizedScopes[0] ?? 'repo'));
    }
    return {
      modules: deduped
    };
  }
  modules.push(...workspaceModules);
  for (const area of areas) {
    const matches = area.candidates.some(candidate => (0, _nodeFs.existsSync)((0, _nodePath.join)(workspaceRoot, candidate)));
    if (!matches) {
      continue;
    }
    modules.push({
      id: area.id,
      label: area.label,
      description: area.description,
      scope: area.scope,
      codemodCommands: area.codemodCommands,
      validationCommands: area.validationCommands,
      steps: buildDefaultSteps(area.id)
    });
  }
  if (modules.length === 0) {
    modules.push({
      id: 'repo-wide',
      label: 'Repository',
      description: 'Fallback repo-wide upgrade module.',
      scope: ['**/*'],
      steps: buildDefaultSteps('repo')
    });
  }
  return {
    modules
  };
}
function detectWorkspaceModules(workspaceRoot) {
  const pkgPath = (0, _nodePath.join)(workspaceRoot, 'package.json');
  if (!(0, _nodeFs.existsSync)(pkgPath)) {
    return [];
  }
  let workspaces = [];
  try {
    const pkg = JSON.parse((0, _nodeFs.readFileSync)(pkgPath, 'utf8'));
    workspaces = parseWorkspaceField(pkg?.workspaces);
  } catch {
    return [];
  }
  if (!workspaces.length) {
    return [];
  }
  const modules = [];
  const seen = new Set();
  for (const pattern of workspaces) {
    const paths = expandWorkspacePattern(workspaceRoot, pattern);
    for (const relPath of paths) {
      if (seen.has(relPath)) {
        continue;
      }
      seen.add(relPath);
      const cleanPath = relPath.replace(/\/+$/, '');
      const name = cleanPath.split('/').filter(Boolean).pop() ?? cleanPath;
      const normalizedPath = cleanPath.replace(/[/\\]+/g, '-');
      const slug = `workspace-${normalizedPath.replace(/[^\w-]+/g, '-').replace(/-+/g, '-').toLowerCase() || 'default'}`;
      modules.push({
        id: slug,
        label: `Workspace: ${name}`,
        description: `Upgrade tasks scoped to workspace "${name}" (${cleanPath}).`,
        scope: [`${cleanPath}/**/*`],
        validationCommands: [`npm test --workspace ${name} --if-present`, `npm run lint --workspace ${name} --if-present`],
        steps: buildDefaultSteps(slug)
      });
    }
  }
  return modules;
}
function parseWorkspaceField(value) {
  if (Array.isArray(value)) {
    return value.map(entry => typeof entry === 'string' ? entry.trim() : '').filter(Boolean);
  }
  if (value && typeof value === 'object') {
    const record = value;
    if (Array.isArray(record.packages)) {
      return record.packages.map(entry => typeof entry === 'string' ? entry.trim() : '').filter(Boolean);
    }
  }
  return [];
}
function expandWorkspacePattern(workspaceRoot, pattern) {
  const normalized = pattern.trim();
  if (!normalized) return [];
  if (!normalized.includes('*')) {
    const target = (0, _nodePath.join)(workspaceRoot, normalized);
    return (0, _nodeFs.existsSync)(target) ? [normalized] : [];
  }
  const base = normalized.split('*')[0]?.replace(/\/+$/, '') ?? '';
  if (!base) return [];
  const baseDir = (0, _nodePath.join)(workspaceRoot, base);
  if (!(0, _nodeFs.existsSync)(baseDir)) return [];
  try {
    const entries = (0, _nodeFs.readdirSync)(baseDir, {
      withFileTypes: true
    });
    return entries.filter(entry => entry.isDirectory()).map(entry => `${base}/${entry.name}`);
  } catch {
    return [];
  }
}
function buildDefaultSteps(moduleId) {
  return [{
    id: `${moduleId}-analyze`,
    intent: 'analyze',
    description: `Map the upgrade surface for ${moduleId}. Identify risky files and coupling.`,
    prompt: 'Inventory core runtime/orchestration/session/tool IO paths first. DO NOT run any build/test/lint/package/dependency tooling (tsc, npm/yarn/pnpm, gradle, maven, go test, cargo, make, bazel, etc.) during analyze; read code and trace critical flows instead. Defer typing/import/build/toolchain hygiene until the verify step.'
  }, {
    id: `${moduleId}-upgrade`,
    intent: 'upgrade',
    description: `Apply modular upgrades for ${moduleId} with minimal blast radius.`,
    prompt: 'Execute targeted edits starting with core architectural logic. Forbidden during upgrade: build/test/lint/dependency installs or language-toolchain commands of any stack (tsc, npm/yarn/pnpm, gradle, maven, go test/build, cargo, make, bazel, etc.). Only touch typing/import/build/lint when it unblocks core logic. Keep edits small, atomic, and scoped.'
  }, {
    id: `${moduleId}-verify`,
    intent: 'verify',
    description: `Validate ${moduleId} after the upgrade.`,
    prompt: 'Only now run validation: TypeScript checks, tests, lint, and package validation relevant to this scope. Summarize residual risks.'
  }];
}
function normalizeScopeValue(scope) {
  return scope.replace(/^[./\\]+/, '').replace(/[/\\]+$/, '').trim();
}
function normalizeScopes(scopes) {
  return scopes.map(normalizeScopeValue).filter(Boolean);
}
function stripGlob(scope) {
  return scope.replace(/\*\*/g, '').replace(/\*/g, '').replace(/\[[^\]]*]/g, '').replace(/[/\\]+$/, '');
}
function moduleMatchesRequestedScopes(moduleScope, requestedScopes) {
  if (!requestedScopes.length) return true;
  const normalizedModuleScopes = moduleScope.map(scope => normalizeScopeValue(stripGlob(scope))).filter(Boolean);
  return requestedScopes.some(requested => normalizedModuleScopes.some(modulePath => modulePath === requested || modulePath.startsWith(`${requested}/`) || requested.startsWith(`${modulePath}/`)));
}
function buildCustomScopeModule(scope) {
  const slug = scope.replace(/[^\w]/g, '-').toLowerCase() || 'custom';
  return {
    id: `custom-${slug}`,
    label: `Custom: ${scope}`,
    description: `User-specified scope: ${scope}`,
    scope: [`${scope}/**/*`],
    validationCommands: ['npm run build', 'npm test'],
    steps: buildDefaultSteps(`custom-${slug}`)
  };
}
function dedupeModules(modules) {
  const seen = new Set();
  const result = [];
  for (const module of modules) {
    if (seen.has(module.id)) continue;
    seen.add(module.id);
    result.push(module);
  }
  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUZzIiwicmVxdWlyZSIsIl9ub2RlUGF0aCIsImJ1aWxkUmVwb1dpZGVQbGFuIiwid29ya3NwYWNlUm9vdCIsImFkZGl0aW9uYWxTY29wZXMiLCJub3JtYWxpemVkU2NvcGVzIiwibm9ybWFsaXplU2NvcGVzIiwiYXJlYXMiLCJpZCIsImxhYmVsIiwiZGVzY3JpcHRpb24iLCJzY29wZSIsImNhbmRpZGF0ZXMiLCJjb2RlbW9kQ29tbWFuZHMiLCJ2YWxpZGF0aW9uQ29tbWFuZHMiLCJtb2R1bGVzIiwid29ya3NwYWNlTW9kdWxlcyIsImRldGVjdFdvcmtzcGFjZU1vZHVsZXMiLCJsZW5ndGgiLCJwdXNoIiwiYnVpbGRDdXN0b21TY29wZU1vZHVsZSIsIm1vZHVsZSIsIm1vZHVsZU1hdGNoZXNSZXF1ZXN0ZWRTY29wZXMiLCJkZWR1cGVkIiwiZGVkdXBlTW9kdWxlcyIsImFyZWEiLCJtYXRjaGVzIiwic29tZSIsImNhbmRpZGF0ZSIsImV4aXN0c1N5bmMiLCJqb2luIiwic3RlcHMiLCJidWlsZERlZmF1bHRTdGVwcyIsInBrZ1BhdGgiLCJ3b3Jrc3BhY2VzIiwicGtnIiwiSlNPTiIsInBhcnNlIiwicmVhZEZpbGVTeW5jIiwicGFyc2VXb3Jrc3BhY2VGaWVsZCIsInNlZW4iLCJTZXQiLCJwYXR0ZXJuIiwicGF0aHMiLCJleHBhbmRXb3Jrc3BhY2VQYXR0ZXJuIiwicmVsUGF0aCIsImhhcyIsImFkZCIsImNsZWFuUGF0aCIsInJlcGxhY2UiLCJuYW1lIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwicG9wIiwibm9ybWFsaXplZFBhdGgiLCJzbHVnIiwidG9Mb3dlckNhc2UiLCJ2YWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImVudHJ5IiwidHJpbSIsInJlY29yZCIsInBhY2thZ2VzIiwibm9ybWFsaXplZCIsImluY2x1ZGVzIiwidGFyZ2V0IiwiYmFzZSIsImJhc2VEaXIiLCJlbnRyaWVzIiwicmVhZGRpclN5bmMiLCJ3aXRoRmlsZVR5cGVzIiwiaXNEaXJlY3RvcnkiLCJtb2R1bGVJZCIsImludGVudCIsInByb21wdCIsIm5vcm1hbGl6ZVNjb3BlVmFsdWUiLCJzY29wZXMiLCJzdHJpcEdsb2IiLCJtb2R1bGVTY29wZSIsInJlcXVlc3RlZFNjb3BlcyIsIm5vcm1hbGl6ZWRNb2R1bGVTY29wZXMiLCJyZXF1ZXN0ZWQiLCJtb2R1bGVQYXRoIiwic3RhcnRzV2l0aCIsInJlc3VsdCJdLCJzb3VyY2VzIjpbInVwZ3JhZGVQbGFuLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYywgcmVhZGRpclN5bmMgfSBmcm9tICdub2RlOmZzJztcbmltcG9ydCB7IGpvaW4gfSBmcm9tICdub2RlOnBhdGgnO1xuaW1wb3J0IHR5cGUgeyBSZXBvVXBncmFkZU1vZHVsZSwgUmVwb1VwZ3JhZGVQbGFuLCBSZXBvVXBncmFkZVN0ZXAgfSBmcm9tICcuL3JlcG9VcGdyYWRlT3JjaGVzdHJhdG9yLmpzJztcblxuLyoqXG4gKiBCdWlsZCBhIHJlcG8td2lkZSB1cGdyYWRlIHBsYW4gdXNpbmcgY29tbW9uIGRpcmVjdG9yaWVzLiBGYWxscyBiYWNrIHRvIGEgc2luZ2xlXG4gKiBjYXRjaC1hbGwgbW9kdWxlIHdoZW4gbm8ga25vd24gc2NvcGVzIGFyZSBmb3VuZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkUmVwb1dpZGVQbGFuKHdvcmtzcGFjZVJvb3Q6IHN0cmluZywgYWRkaXRpb25hbFNjb3Blczogc3RyaW5nW10gPSBbXSk6IFJlcG9VcGdyYWRlUGxhbiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRTY29wZXMgPSBub3JtYWxpemVTY29wZXMoYWRkaXRpb25hbFNjb3Blcyk7XG4gIGNvbnN0IGFyZWFzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBsYWJlbDogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgc2NvcGU6IHN0cmluZ1tdO1xuICAgIGNhbmRpZGF0ZXM6IHN0cmluZ1tdO1xuICAgIGNvZGVtb2RDb21tYW5kcz86IHN0cmluZ1tdO1xuICAgIHZhbGlkYXRpb25Db21tYW5kcz86IHN0cmluZ1tdO1xuICB9PiA9IFtcbiAgICB7XG4gICAgICBpZDogJ3NvdXJjZScsXG4gICAgICBsYWJlbDogJ1NvdXJjZScsXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvcmUgYXBwbGljYXRpb24gYW5kIGxpYnJhcnkgY29kZS4nLFxuICAgICAgc2NvcGU6IFsnc3JjLyoqLyonLCAnbGliLyoqLyonXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsnc3JjJywgJ2xpYiddLFxuICAgICAgY29kZW1vZENvbW1hbmRzOiBbJ25weCBqc2NvZGVzaGlmdCAtdCA8dHJhbnNmb3JtPiBzcmMnXSxcbiAgICAgIHZhbGlkYXRpb25Db21tYW5kczogWyducG0gcnVuIGJ1aWxkJywgJ25wbSB0ZXN0J10sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ3Rlc3RzJyxcbiAgICAgIGxhYmVsOiAnVGVzdHMnLFxuICAgICAgZGVzY3JpcHRpb246ICdVbml0LCBpbnRlZ3JhdGlvbiwgYW5kIHNtb2tlIHRlc3RzLicsXG4gICAgICBzY29wZTogWyd0ZXN0LyoqLyonLCAnX190ZXN0c19fLyoqLyonXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsndGVzdCcsICdfX3Rlc3RzX18nXSxcbiAgICAgIHZhbGlkYXRpb25Db21tYW5kczogWyducG0gdGVzdCAtLSAtLXJ1bkluQmFuZCcsICducG0gcnVuIGxpbnQnXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZG9jcycsXG4gICAgICBsYWJlbDogJ0RvY3MnLFxuICAgICAgZGVzY3JpcHRpb246ICdEb2N1bWVudGF0aW9uIGFuZCBndWlkZXMuJyxcbiAgICAgIHNjb3BlOiBbJ2RvY3MvKiovKicsICdSRUFETUUubWQnXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsnZG9jcycsICdSRUFETUUubWQnXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnc2NyaXB0cycsXG4gICAgICBsYWJlbDogJ1Rvb2xpbmcgU2NyaXB0cycsXG4gICAgICBkZXNjcmlwdGlvbjogJ0J1aWxkLCBtaWdyYXRpb24sIGFuZCBtYWludGVuYW5jZSBzY3JpcHRzLicsXG4gICAgICBzY29wZTogWydzY3JpcHRzLyoqLyonXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsnc2NyaXB0cyddLFxuICAgICAgdmFsaWRhdGlvbkNvbW1hbmRzOiBbJ25wbSBydW4gbGludCAtLSBzY3JpcHRzLyoqLyoudHMnXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnYWdlbnRzJyxcbiAgICAgIGxhYmVsOiAnQWdlbnRzJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQWdlbnQgcnVsZXMgYW5kIGJlaGF2aW9ycy4nLFxuICAgICAgc2NvcGU6IFsnYWdlbnRzLyoqLyonXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsnYWdlbnRzJ10sXG4gICAgICB2YWxpZGF0aW9uQ29tbWFuZHM6IFsnbnBtIHJ1biBidWlsZCddLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdza2lsbHMnLFxuICAgICAgbGFiZWw6ICdTa2lsbHMnLFxuICAgICAgZGVzY3JpcHRpb246ICdTa2lsbCBwYWNrcyBhbmQgcmV1c2FibGUgYXV0b21hdGlvbi4nLFxuICAgICAgc2NvcGU6IFsnc2tpbGxzLyoqLyonXSxcbiAgICAgIGNhbmRpZGF0ZXM6IFsnc2tpbGxzJ10sXG4gICAgICB2YWxpZGF0aW9uQ29tbWFuZHM6IFsnbnBtIHJ1biBidWlsZCddLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdleGFtcGxlcycsXG4gICAgICBsYWJlbDogJ0V4YW1wbGVzJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnRXhhbXBsZSBmbG93cyBhbmQgdGVtcGxhdGVzLicsXG4gICAgICBzY29wZTogWydleGFtcGxlcy8qKi8qJ10sXG4gICAgICBjYW5kaWRhdGVzOiBbJ2V4YW1wbGVzJ10sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ2NvbmZpZ3MnLFxuICAgICAgbGFiZWw6ICdDb25maWd1cmF0aW9uJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnQ29uZmlndXJhdGlvbiBhbmQgZGVwbG95bWVudCBzZXR0aW5ncy4nLFxuICAgICAgc2NvcGU6IFsnY29uZmlnLyoqLyonLCAnKi5jb25maWcuKicsICcqLnJjJywgJyouanNvbiddLFxuICAgICAgY2FuZGlkYXRlczogWydjb25maWcnXSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IG1vZHVsZXM6IFJlcG9VcGdyYWRlTW9kdWxlW10gPSBbXTtcbiAgY29uc3Qgd29ya3NwYWNlTW9kdWxlcyA9IGRldGVjdFdvcmtzcGFjZU1vZHVsZXMod29ya3NwYWNlUm9vdCk7XG5cbiAgLy8gV2hlbiBzY29wZXMgYXJlIHByb3ZpZGVkLCBidWlsZCBhIHRhcmdldGVkIHBsYW4gaW5zdGVhZCBvZiBzd2VlcGluZyB0aGUgcmVwby5cbiAgaWYgKG5vcm1hbGl6ZWRTY29wZXMubGVuZ3RoKSB7XG4gICAgZm9yIChjb25zdCBzY29wZSBvZiBub3JtYWxpemVkU2NvcGVzKSB7XG4gICAgICBtb2R1bGVzLnB1c2goYnVpbGRDdXN0b21TY29wZU1vZHVsZShzY29wZSkpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgbW9kdWxlIG9mIHdvcmtzcGFjZU1vZHVsZXMpIHtcbiAgICAgIGlmIChtb2R1bGVNYXRjaGVzUmVxdWVzdGVkU2NvcGVzKG1vZHVsZS5zY29wZSwgbm9ybWFsaXplZFNjb3BlcykpIHtcbiAgICAgICAgbW9kdWxlcy5wdXNoKG1vZHVsZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZGVkdXBlZCA9IGRlZHVwZU1vZHVsZXMobW9kdWxlcyk7XG4gICAgaWYgKGRlZHVwZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICBkZWR1cGVkLnB1c2goYnVpbGRDdXN0b21TY29wZU1vZHVsZShub3JtYWxpemVkU2NvcGVzWzBdID8/ICdyZXBvJykpO1xuICAgIH1cblxuICAgIHJldHVybiB7IG1vZHVsZXM6IGRlZHVwZWQgfTtcbiAgfVxuXG4gIG1vZHVsZXMucHVzaCguLi53b3Jrc3BhY2VNb2R1bGVzKTtcblxuICBmb3IgKGNvbnN0IGFyZWEgb2YgYXJlYXMpIHtcbiAgICBjb25zdCBtYXRjaGVzID0gYXJlYS5jYW5kaWRhdGVzLnNvbWUoKGNhbmRpZGF0ZSkgPT4gZXhpc3RzU3luYyhqb2luKHdvcmtzcGFjZVJvb3QsIGNhbmRpZGF0ZSkpKTtcbiAgICBpZiAoIW1hdGNoZXMpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBtb2R1bGVzLnB1c2goe1xuICAgICAgaWQ6IGFyZWEuaWQsXG4gICAgICBsYWJlbDogYXJlYS5sYWJlbCxcbiAgICAgIGRlc2NyaXB0aW9uOiBhcmVhLmRlc2NyaXB0aW9uLFxuICAgICAgc2NvcGU6IGFyZWEuc2NvcGUsXG4gICAgICBjb2RlbW9kQ29tbWFuZHM6IGFyZWEuY29kZW1vZENvbW1hbmRzLFxuICAgICAgdmFsaWRhdGlvbkNvbW1hbmRzOiBhcmVhLnZhbGlkYXRpb25Db21tYW5kcyxcbiAgICAgIHN0ZXBzOiBidWlsZERlZmF1bHRTdGVwcyhhcmVhLmlkKSxcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChtb2R1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICBpZDogJ3JlcG8td2lkZScsXG4gICAgICBsYWJlbDogJ1JlcG9zaXRvcnknLFxuICAgICAgZGVzY3JpcHRpb246ICdGYWxsYmFjayByZXBvLXdpZGUgdXBncmFkZSBtb2R1bGUuJyxcbiAgICAgIHNjb3BlOiBbJyoqLyonXSxcbiAgICAgIHN0ZXBzOiBidWlsZERlZmF1bHRTdGVwcygncmVwbycpLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHsgbW9kdWxlcyB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0V29ya3NwYWNlTW9kdWxlcyh3b3Jrc3BhY2VSb290OiBzdHJpbmcpOiBSZXBvVXBncmFkZU1vZHVsZVtdIHtcbiAgY29uc3QgcGtnUGF0aCA9IGpvaW4od29ya3NwYWNlUm9vdCwgJ3BhY2thZ2UuanNvbicpO1xuICBpZiAoIWV4aXN0c1N5bmMocGtnUGF0aCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBsZXQgd29ya3NwYWNlczogc3RyaW5nW10gPSBbXTtcbiAgdHJ5IHtcbiAgICBjb25zdCBwa2cgPSBKU09OLnBhcnNlKHJlYWRGaWxlU3luYyhwa2dQYXRoLCAndXRmOCcpKTtcbiAgICB3b3Jrc3BhY2VzID0gcGFyc2VXb3Jrc3BhY2VGaWVsZChwa2c/LndvcmtzcGFjZXMpO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBpZiAoIXdvcmtzcGFjZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgbW9kdWxlczogUmVwb1VwZ3JhZGVNb2R1bGVbXSA9IFtdO1xuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHdvcmtzcGFjZXMpIHtcbiAgICBjb25zdCBwYXRocyA9IGV4cGFuZFdvcmtzcGFjZVBhdHRlcm4od29ya3NwYWNlUm9vdCwgcGF0dGVybik7XG4gICAgZm9yIChjb25zdCByZWxQYXRoIG9mIHBhdGhzKSB7XG4gICAgICBpZiAoc2Vlbi5oYXMocmVsUGF0aCkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBzZWVuLmFkZChyZWxQYXRoKTtcblxuICAgICAgY29uc3QgY2xlYW5QYXRoID0gcmVsUGF0aC5yZXBsYWNlKC9cXC8rJC8sICcnKTtcbiAgICAgIGNvbnN0IG5hbWUgPSBjbGVhblBhdGguc3BsaXQoJy8nKS5maWx0ZXIoQm9vbGVhbikucG9wKCkgPz8gY2xlYW5QYXRoO1xuICAgICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSBjbGVhblBhdGgucmVwbGFjZSgvWy9cXFxcXSsvZywgJy0nKTtcbiAgICAgIGNvbnN0IHNsdWcgPSBgd29ya3NwYWNlLSR7bm9ybWFsaXplZFBhdGgucmVwbGFjZSgvW15cXHctXSsvZywgJy0nKS5yZXBsYWNlKC8tKy9nLCAnLScpLnRvTG93ZXJDYXNlKCkgfHwgJ2RlZmF1bHQnfWA7XG5cbiAgICAgIG1vZHVsZXMucHVzaCh7XG4gICAgICAgIGlkOiBzbHVnLFxuICAgICAgICBsYWJlbDogYFdvcmtzcGFjZTogJHtuYW1lfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgVXBncmFkZSB0YXNrcyBzY29wZWQgdG8gd29ya3NwYWNlIFwiJHtuYW1lfVwiICgke2NsZWFuUGF0aH0pLmAsXG4gICAgICAgIHNjb3BlOiBbYCR7Y2xlYW5QYXRofS8qKi8qYF0sXG4gICAgICAgIHZhbGlkYXRpb25Db21tYW5kczogW1xuICAgICAgICAgIGBucG0gdGVzdCAtLXdvcmtzcGFjZSAke25hbWV9IC0taWYtcHJlc2VudGAsXG4gICAgICAgICAgYG5wbSBydW4gbGludCAtLXdvcmtzcGFjZSAke25hbWV9IC0taWYtcHJlc2VudGAsXG4gICAgICAgIF0sXG4gICAgICAgIHN0ZXBzOiBidWlsZERlZmF1bHRTdGVwcyhzbHVnKSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBtb2R1bGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VXb3Jrc3BhY2VGaWVsZCh2YWx1ZTogdW5rbm93bik6IHN0cmluZ1tdIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLm1hcCgoZW50cnkpID0+ICh0eXBlb2YgZW50cnkgPT09ICdzdHJpbmcnID8gZW50cnkudHJpbSgpIDogJycpKS5maWx0ZXIoQm9vbGVhbik7XG4gIH1cbiAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCByZWNvcmQgPSB2YWx1ZSBhcyB7IHBhY2thZ2VzPzogdW5rbm93biB9O1xuICAgIGlmIChBcnJheS5pc0FycmF5KHJlY29yZC5wYWNrYWdlcykpIHtcbiAgICAgIHJldHVybiByZWNvcmQucGFja2FnZXMubWFwKChlbnRyeSkgPT4gKHR5cGVvZiBlbnRyeSA9PT0gJ3N0cmluZycgPyBlbnRyeS50cmltKCkgOiAnJykpLmZpbHRlcihCb29sZWFuKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXhwYW5kV29ya3NwYWNlUGF0dGVybih3b3Jrc3BhY2VSb290OiBzdHJpbmcsIHBhdHRlcm46IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IHBhdHRlcm4udHJpbSgpO1xuICBpZiAoIW5vcm1hbGl6ZWQpIHJldHVybiBbXTtcblxuICBpZiAoIW5vcm1hbGl6ZWQuaW5jbHVkZXMoJyonKSkge1xuICAgIGNvbnN0IHRhcmdldCA9IGpvaW4od29ya3NwYWNlUm9vdCwgbm9ybWFsaXplZCk7XG4gICAgcmV0dXJuIGV4aXN0c1N5bmModGFyZ2V0KSA/IFtub3JtYWxpemVkXSA6IFtdO1xuICB9XG5cbiAgY29uc3QgYmFzZSA9IG5vcm1hbGl6ZWQuc3BsaXQoJyonKVswXT8ucmVwbGFjZSgvXFwvKyQvLCAnJykgPz8gJyc7XG4gIGlmICghYmFzZSkgcmV0dXJuIFtdO1xuXG4gIGNvbnN0IGJhc2VEaXIgPSBqb2luKHdvcmtzcGFjZVJvb3QsIGJhc2UpO1xuICBpZiAoIWV4aXN0c1N5bmMoYmFzZURpcikpIHJldHVybiBbXTtcblxuICB0cnkge1xuICAgIGNvbnN0IGVudHJpZXMgPSByZWFkZGlyU3luYyhiYXNlRGlyLCB7IHdpdGhGaWxlVHlwZXM6IHRydWUgfSk7XG4gICAgcmV0dXJuIGVudHJpZXMuZmlsdGVyKChlbnRyeSkgPT4gZW50cnkuaXNEaXJlY3RvcnkoKSkubWFwKChlbnRyeSkgPT4gYCR7YmFzZX0vJHtlbnRyeS5uYW1lfWApO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gW107XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkRGVmYXVsdFN0ZXBzKG1vZHVsZUlkOiBzdHJpbmcpOiBSZXBvVXBncmFkZVN0ZXBbXSB7XG4gIHJldHVybiBbXG4gICAge1xuICAgICAgaWQ6IGAke21vZHVsZUlkfS1hbmFseXplYCxcbiAgICAgIGludGVudDogJ2FuYWx5emUnLFxuICAgICAgZGVzY3JpcHRpb246IGBNYXAgdGhlIHVwZ3JhZGUgc3VyZmFjZSBmb3IgJHttb2R1bGVJZH0uIElkZW50aWZ5IHJpc2t5IGZpbGVzIGFuZCBjb3VwbGluZy5gLFxuICAgICAgcHJvbXB0OlxuICAgICAgICAnSW52ZW50b3J5IGNvcmUgcnVudGltZS9vcmNoZXN0cmF0aW9uL3Nlc3Npb24vdG9vbCBJTyBwYXRocyBmaXJzdC4gRE8gTk9UIHJ1biBhbnkgYnVpbGQvdGVzdC9saW50L3BhY2thZ2UvZGVwZW5kZW5jeSB0b29saW5nICh0c2MsIG5wbS95YXJuL3BucG0sIGdyYWRsZSwgbWF2ZW4sIGdvIHRlc3QsIGNhcmdvLCBtYWtlLCBiYXplbCwgZXRjLikgZHVyaW5nIGFuYWx5emU7IHJlYWQgY29kZSBhbmQgdHJhY2UgY3JpdGljYWwgZmxvd3MgaW5zdGVhZC4gRGVmZXIgdHlwaW5nL2ltcG9ydC9idWlsZC90b29sY2hhaW4gaHlnaWVuZSB1bnRpbCB0aGUgdmVyaWZ5IHN0ZXAuJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiBgJHttb2R1bGVJZH0tdXBncmFkZWAsXG4gICAgICBpbnRlbnQ6ICd1cGdyYWRlJyxcbiAgICAgIGRlc2NyaXB0aW9uOiBgQXBwbHkgbW9kdWxhciB1cGdyYWRlcyBmb3IgJHttb2R1bGVJZH0gd2l0aCBtaW5pbWFsIGJsYXN0IHJhZGl1cy5gLFxuICAgICAgcHJvbXB0OlxuICAgICAgICAnRXhlY3V0ZSB0YXJnZXRlZCBlZGl0cyBzdGFydGluZyB3aXRoIGNvcmUgYXJjaGl0ZWN0dXJhbCBsb2dpYy4gRm9yYmlkZGVuIGR1cmluZyB1cGdyYWRlOiBidWlsZC90ZXN0L2xpbnQvZGVwZW5kZW5jeSBpbnN0YWxscyBvciBsYW5ndWFnZS10b29sY2hhaW4gY29tbWFuZHMgb2YgYW55IHN0YWNrICh0c2MsIG5wbS95YXJuL3BucG0sIGdyYWRsZSwgbWF2ZW4sIGdvIHRlc3QvYnVpbGQsIGNhcmdvLCBtYWtlLCBiYXplbCwgZXRjLikuIE9ubHkgdG91Y2ggdHlwaW5nL2ltcG9ydC9idWlsZC9saW50IHdoZW4gaXQgdW5ibG9ja3MgY29yZSBsb2dpYy4gS2VlcCBlZGl0cyBzbWFsbCwgYXRvbWljLCBhbmQgc2NvcGVkLicsXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogYCR7bW9kdWxlSWR9LXZlcmlmeWAsXG4gICAgICBpbnRlbnQ6ICd2ZXJpZnknLFxuICAgICAgZGVzY3JpcHRpb246IGBWYWxpZGF0ZSAke21vZHVsZUlkfSBhZnRlciB0aGUgdXBncmFkZS5gLFxuICAgICAgcHJvbXB0OlxuICAgICAgICAnT25seSBub3cgcnVuIHZhbGlkYXRpb246IFR5cGVTY3JpcHQgY2hlY2tzLCB0ZXN0cywgbGludCwgYW5kIHBhY2thZ2UgdmFsaWRhdGlvbiByZWxldmFudCB0byB0aGlzIHNjb3BlLiBTdW1tYXJpemUgcmVzaWR1YWwgcmlza3MuJyxcbiAgICB9LFxuICBdO1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVTY29wZVZhbHVlKHNjb3BlOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gc2NvcGUucmVwbGFjZSgvXlsuL1xcXFxdKy8sICcnKS5yZXBsYWNlKC9bL1xcXFxdKyQvLCAnJykudHJpbSgpO1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVTY29wZXMoc2NvcGVzOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIHNjb3Blcy5tYXAobm9ybWFsaXplU2NvcGVWYWx1ZSkuZmlsdGVyKEJvb2xlYW4pO1xufVxuXG5mdW5jdGlvbiBzdHJpcEdsb2Ioc2NvcGU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBzY29wZS5yZXBsYWNlKC9cXCpcXCovZywgJycpLnJlcGxhY2UoL1xcKi9nLCAnJykucmVwbGFjZSgvXFxbW15cXF1dKl0vZywgJycpLnJlcGxhY2UoL1svXFxcXF0rJC8sICcnKTtcbn1cblxuZnVuY3Rpb24gbW9kdWxlTWF0Y2hlc1JlcXVlc3RlZFNjb3Blcyhtb2R1bGVTY29wZTogc3RyaW5nW10sIHJlcXVlc3RlZFNjb3Blczogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgaWYgKCFyZXF1ZXN0ZWRTY29wZXMubGVuZ3RoKSByZXR1cm4gdHJ1ZTtcbiAgY29uc3Qgbm9ybWFsaXplZE1vZHVsZVNjb3BlcyA9IG1vZHVsZVNjb3BlXG4gICAgLm1hcCgoc2NvcGUpID0+IG5vcm1hbGl6ZVNjb3BlVmFsdWUoc3RyaXBHbG9iKHNjb3BlKSkpXG4gICAgLmZpbHRlcihCb29sZWFuKTtcblxuICByZXR1cm4gcmVxdWVzdGVkU2NvcGVzLnNvbWUoKHJlcXVlc3RlZCkgPT5cbiAgICBub3JtYWxpemVkTW9kdWxlU2NvcGVzLnNvbWUoXG4gICAgICAobW9kdWxlUGF0aCkgPT5cbiAgICAgICAgbW9kdWxlUGF0aCA9PT0gcmVxdWVzdGVkIHx8XG4gICAgICAgIG1vZHVsZVBhdGguc3RhcnRzV2l0aChgJHtyZXF1ZXN0ZWR9L2ApIHx8XG4gICAgICAgIHJlcXVlc3RlZC5zdGFydHNXaXRoKGAke21vZHVsZVBhdGh9L2ApXG4gICAgKVxuICApO1xufVxuXG5mdW5jdGlvbiBidWlsZEN1c3RvbVNjb3BlTW9kdWxlKHNjb3BlOiBzdHJpbmcpOiBSZXBvVXBncmFkZU1vZHVsZSB7XG4gIGNvbnN0IHNsdWcgPSBzY29wZS5yZXBsYWNlKC9bXlxcd10vZywgJy0nKS50b0xvd2VyQ2FzZSgpIHx8ICdjdXN0b20nO1xuICByZXR1cm4ge1xuICAgIGlkOiBgY3VzdG9tLSR7c2x1Z31gLFxuICAgIGxhYmVsOiBgQ3VzdG9tOiAke3Njb3BlfWAsXG4gICAgZGVzY3JpcHRpb246IGBVc2VyLXNwZWNpZmllZCBzY29wZTogJHtzY29wZX1gLFxuICAgIHNjb3BlOiBbYCR7c2NvcGV9LyoqLypgXSxcbiAgICB2YWxpZGF0aW9uQ29tbWFuZHM6IFsnbnBtIHJ1biBidWlsZCcsICducG0gdGVzdCddLFxuICAgIHN0ZXBzOiBidWlsZERlZmF1bHRTdGVwcyhgY3VzdG9tLSR7c2x1Z31gKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZGVkdXBlTW9kdWxlcyhtb2R1bGVzOiBSZXBvVXBncmFkZU1vZHVsZVtdKTogUmVwb1VwZ3JhZGVNb2R1bGVbXSB7XG4gIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgY29uc3QgcmVzdWx0OiBSZXBvVXBncmFkZU1vZHVsZVtdID0gW107XG4gIGZvciAoY29uc3QgbW9kdWxlIG9mIG1vZHVsZXMpIHtcbiAgICBpZiAoc2Vlbi5oYXMobW9kdWxlLmlkKSkgY29udGludWU7XG4gICAgc2Vlbi5hZGQobW9kdWxlLmlkKTtcbiAgICByZXN1bHQucHVzaChtb2R1bGUpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFELE9BQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLFNBQVNFLGlCQUFpQkEsQ0FBQ0MsYUFBcUIsRUFBRUMsZ0JBQTBCLEdBQUcsRUFBRSxFQUFtQjtFQUN6RyxNQUFNQyxnQkFBZ0IsR0FBR0MsZUFBZSxDQUFDRixnQkFBZ0IsQ0FBQztFQUMxRCxNQUFNRyxLQVFKLEdBQUcsQ0FDSDtJQUNFQyxFQUFFLEVBQUUsUUFBUTtJQUNaQyxLQUFLLEVBQUUsUUFBUTtJQUNmQyxXQUFXLEVBQUUsb0NBQW9DO0lBQ2pEQyxLQUFLLEVBQUUsQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFDO0lBQy9CQyxVQUFVLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDO0lBQzFCQyxlQUFlLEVBQUUsQ0FBQyxvQ0FBb0MsQ0FBQztJQUN2REMsa0JBQWtCLEVBQUUsQ0FBQyxlQUFlLEVBQUUsVUFBVTtFQUNsRCxDQUFDLEVBQ0Q7SUFDRU4sRUFBRSxFQUFFLE9BQU87SUFDWEMsS0FBSyxFQUFFLE9BQU87SUFDZEMsV0FBVyxFQUFFLHFDQUFxQztJQUNsREMsS0FBSyxFQUFFLENBQUMsV0FBVyxFQUFFLGdCQUFnQixDQUFDO0lBQ3RDQyxVQUFVLEVBQUUsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDO0lBQ2pDRSxrQkFBa0IsRUFBRSxDQUFDLHlCQUF5QixFQUFFLGNBQWM7RUFDaEUsQ0FBQyxFQUNEO0lBQ0VOLEVBQUUsRUFBRSxNQUFNO0lBQ1ZDLEtBQUssRUFBRSxNQUFNO0lBQ2JDLFdBQVcsRUFBRSwyQkFBMkI7SUFDeENDLEtBQUssRUFBRSxDQUFDLFdBQVcsRUFBRSxXQUFXLENBQUM7SUFDakNDLFVBQVUsRUFBRSxDQUFDLE1BQU0sRUFBRSxXQUFXO0VBQ2xDLENBQUMsRUFDRDtJQUNFSixFQUFFLEVBQUUsU0FBUztJQUNiQyxLQUFLLEVBQUUsaUJBQWlCO0lBQ3hCQyxXQUFXLEVBQUUsNENBQTRDO0lBQ3pEQyxLQUFLLEVBQUUsQ0FBQyxjQUFjLENBQUM7SUFDdkJDLFVBQVUsRUFBRSxDQUFDLFNBQVMsQ0FBQztJQUN2QkUsa0JBQWtCLEVBQUUsQ0FBQyxpQ0FBaUM7RUFDeEQsQ0FBQyxFQUNEO0lBQ0VOLEVBQUUsRUFBRSxRQUFRO0lBQ1pDLEtBQUssRUFBRSxRQUFRO0lBQ2ZDLFdBQVcsRUFBRSw0QkFBNEI7SUFDekNDLEtBQUssRUFBRSxDQUFDLGFBQWEsQ0FBQztJQUN0QkMsVUFBVSxFQUFFLENBQUMsUUFBUSxDQUFDO0lBQ3RCRSxrQkFBa0IsRUFBRSxDQUFDLGVBQWU7RUFDdEMsQ0FBQyxFQUNEO0lBQ0VOLEVBQUUsRUFBRSxRQUFRO0lBQ1pDLEtBQUssRUFBRSxRQUFRO0lBQ2ZDLFdBQVcsRUFBRSxzQ0FBc0M7SUFDbkRDLEtBQUssRUFBRSxDQUFDLGFBQWEsQ0FBQztJQUN0QkMsVUFBVSxFQUFFLENBQUMsUUFBUSxDQUFDO0lBQ3RCRSxrQkFBa0IsRUFBRSxDQUFDLGVBQWU7RUFDdEMsQ0FBQyxFQUNEO0lBQ0VOLEVBQUUsRUFBRSxVQUFVO0lBQ2RDLEtBQUssRUFBRSxVQUFVO0lBQ2pCQyxXQUFXLEVBQUUsOEJBQThCO0lBQzNDQyxLQUFLLEVBQUUsQ0FBQyxlQUFlLENBQUM7SUFDeEJDLFVBQVUsRUFBRSxDQUFDLFVBQVU7RUFDekIsQ0FBQyxFQUNEO0lBQ0VKLEVBQUUsRUFBRSxTQUFTO0lBQ2JDLEtBQUssRUFBRSxlQUFlO0lBQ3RCQyxXQUFXLEVBQUUsd0NBQXdDO0lBQ3JEQyxLQUFLLEVBQUUsQ0FBQyxhQUFhLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUM7SUFDdERDLFVBQVUsRUFBRSxDQUFDLFFBQVE7RUFDdkIsQ0FBQyxDQUNGO0VBRUQsTUFBTUcsT0FBNEIsR0FBRyxFQUFFO0VBQ3ZDLE1BQU1DLGdCQUFnQixHQUFHQyxzQkFBc0IsQ0FBQ2QsYUFBYSxDQUFDOztFQUU5RDtFQUNBLElBQUlFLGdCQUFnQixDQUFDYSxNQUFNLEVBQUU7SUFDM0IsS0FBSyxNQUFNUCxLQUFLLElBQUlOLGdCQUFnQixFQUFFO01BQ3BDVSxPQUFPLENBQUNJLElBQUksQ0FBQ0Msc0JBQXNCLENBQUNULEtBQUssQ0FBQyxDQUFDO0lBQzdDO0lBRUEsS0FBSyxNQUFNVSxNQUFNLElBQUlMLGdCQUFnQixFQUFFO01BQ3JDLElBQUlNLDRCQUE0QixDQUFDRCxNQUFNLENBQUNWLEtBQUssRUFBRU4sZ0JBQWdCLENBQUMsRUFBRTtRQUNoRVUsT0FBTyxDQUFDSSxJQUFJLENBQUNFLE1BQU0sQ0FBQztNQUN0QjtJQUNGO0lBRUEsTUFBTUUsT0FBTyxHQUFHQyxhQUFhLENBQUNULE9BQU8sQ0FBQztJQUN0QyxJQUFJUSxPQUFPLENBQUNMLE1BQU0sS0FBSyxDQUFDLEVBQUU7TUFDeEJLLE9BQU8sQ0FBQ0osSUFBSSxDQUFDQyxzQkFBc0IsQ0FBQ2YsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksTUFBTSxDQUFDLENBQUM7SUFDckU7SUFFQSxPQUFPO01BQUVVLE9BQU8sRUFBRVE7SUFBUSxDQUFDO0VBQzdCO0VBRUFSLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDLEdBQUdILGdCQUFnQixDQUFDO0VBRWpDLEtBQUssTUFBTVMsSUFBSSxJQUFJbEIsS0FBSyxFQUFFO0lBQ3hCLE1BQU1tQixPQUFPLEdBQUdELElBQUksQ0FBQ2IsVUFBVSxDQUFDZSxJQUFJLENBQUVDLFNBQVMsSUFBSyxJQUFBQyxrQkFBVSxFQUFDLElBQUFDLGNBQUksRUFBQzNCLGFBQWEsRUFBRXlCLFNBQVMsQ0FBQyxDQUFDLENBQUM7SUFDL0YsSUFBSSxDQUFDRixPQUFPLEVBQUU7TUFDWjtJQUNGO0lBQ0FYLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDO01BQ1hYLEVBQUUsRUFBRWlCLElBQUksQ0FBQ2pCLEVBQUU7TUFDWEMsS0FBSyxFQUFFZ0IsSUFBSSxDQUFDaEIsS0FBSztNQUNqQkMsV0FBVyxFQUFFZSxJQUFJLENBQUNmLFdBQVc7TUFDN0JDLEtBQUssRUFBRWMsSUFBSSxDQUFDZCxLQUFLO01BQ2pCRSxlQUFlLEVBQUVZLElBQUksQ0FBQ1osZUFBZTtNQUNyQ0Msa0JBQWtCLEVBQUVXLElBQUksQ0FBQ1gsa0JBQWtCO01BQzNDaUIsS0FBSyxFQUFFQyxpQkFBaUIsQ0FBQ1AsSUFBSSxDQUFDakIsRUFBRTtJQUNsQyxDQUFDLENBQUM7RUFDSjtFQUVBLElBQUlPLE9BQU8sQ0FBQ0csTUFBTSxLQUFLLENBQUMsRUFBRTtJQUN4QkgsT0FBTyxDQUFDSSxJQUFJLENBQUM7TUFDWFgsRUFBRSxFQUFFLFdBQVc7TUFDZkMsS0FBSyxFQUFFLFlBQVk7TUFDbkJDLFdBQVcsRUFBRSxvQ0FBb0M7TUFDakRDLEtBQUssRUFBRSxDQUFDLE1BQU0sQ0FBQztNQUNmb0IsS0FBSyxFQUFFQyxpQkFBaUIsQ0FBQyxNQUFNO0lBQ2pDLENBQUMsQ0FBQztFQUNKO0VBRUEsT0FBTztJQUFFakI7RUFBUSxDQUFDO0FBQ3BCO0FBRU8sU0FBU0Usc0JBQXNCQSxDQUFDZCxhQUFxQixFQUF1QjtFQUNqRixNQUFNOEIsT0FBTyxHQUFHLElBQUFILGNBQUksRUFBQzNCLGFBQWEsRUFBRSxjQUFjLENBQUM7RUFDbkQsSUFBSSxDQUFDLElBQUEwQixrQkFBVSxFQUFDSSxPQUFPLENBQUMsRUFBRTtJQUN4QixPQUFPLEVBQUU7RUFDWDtFQUVBLElBQUlDLFVBQW9CLEdBQUcsRUFBRTtFQUM3QixJQUFJO0lBQ0YsTUFBTUMsR0FBRyxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQyxJQUFBQyxvQkFBWSxFQUFDTCxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDckRDLFVBQVUsR0FBR0ssbUJBQW1CLENBQUNKLEdBQUcsRUFBRUQsVUFBVSxDQUFDO0VBQ25ELENBQUMsQ0FBQyxNQUFNO0lBQ04sT0FBTyxFQUFFO0VBQ1g7RUFFQSxJQUFJLENBQUNBLFVBQVUsQ0FBQ2hCLE1BQU0sRUFBRTtJQUN0QixPQUFPLEVBQUU7RUFDWDtFQUVBLE1BQU1ILE9BQTRCLEdBQUcsRUFBRTtFQUN2QyxNQUFNeUIsSUFBSSxHQUFHLElBQUlDLEdBQUcsQ0FBUyxDQUFDO0VBRTlCLEtBQUssTUFBTUMsT0FBTyxJQUFJUixVQUFVLEVBQUU7SUFDaEMsTUFBTVMsS0FBSyxHQUFHQyxzQkFBc0IsQ0FBQ3pDLGFBQWEsRUFBRXVDLE9BQU8sQ0FBQztJQUM1RCxLQUFLLE1BQU1HLE9BQU8sSUFBSUYsS0FBSyxFQUFFO01BQzNCLElBQUlILElBQUksQ0FBQ00sR0FBRyxDQUFDRCxPQUFPLENBQUMsRUFBRTtRQUNyQjtNQUNGO01BQ0FMLElBQUksQ0FBQ08sR0FBRyxDQUFDRixPQUFPLENBQUM7TUFFakIsTUFBTUcsU0FBUyxHQUFHSCxPQUFPLENBQUNJLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDO01BQzdDLE1BQU1DLElBQUksR0FBR0YsU0FBUyxDQUFDRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUNDLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDLElBQUlOLFNBQVM7TUFDcEUsTUFBTU8sY0FBYyxHQUFHUCxTQUFTLENBQUNDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsR0FBRyxDQUFDO01BQ3hELE1BQU1PLElBQUksR0FBRyxhQUFhRCxjQUFjLENBQUNOLE9BQU8sQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLENBQUNBLE9BQU8sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUNRLFdBQVcsQ0FBQyxDQUFDLElBQUksU0FBUyxFQUFFO01BRWxIMUMsT0FBTyxDQUFDSSxJQUFJLENBQUM7UUFDWFgsRUFBRSxFQUFFZ0QsSUFBSTtRQUNSL0MsS0FBSyxFQUFFLGNBQWN5QyxJQUFJLEVBQUU7UUFDM0J4QyxXQUFXLEVBQUUsc0NBQXNDd0MsSUFBSSxNQUFNRixTQUFTLElBQUk7UUFDMUVyQyxLQUFLLEVBQUUsQ0FBQyxHQUFHcUMsU0FBUyxPQUFPLENBQUM7UUFDNUJsQyxrQkFBa0IsRUFBRSxDQUNsQix3QkFBd0JvQyxJQUFJLGVBQWUsRUFDM0MsNEJBQTRCQSxJQUFJLGVBQWUsQ0FDaEQ7UUFDRG5CLEtBQUssRUFBRUMsaUJBQWlCLENBQUN3QixJQUFJO01BQy9CLENBQUMsQ0FBQztJQUNKO0VBQ0Y7RUFFQSxPQUFPekMsT0FBTztBQUNoQjtBQUVPLFNBQVN3QixtQkFBbUJBLENBQUNtQixLQUFjLEVBQVk7RUFDNUQsSUFBSUMsS0FBSyxDQUFDQyxPQUFPLENBQUNGLEtBQUssQ0FBQyxFQUFFO0lBQ3hCLE9BQU9BLEtBQUssQ0FBQ0csR0FBRyxDQUFFQyxLQUFLLElBQU0sT0FBT0EsS0FBSyxLQUFLLFFBQVEsR0FBR0EsS0FBSyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUcsQ0FBQyxDQUFDWCxNQUFNLENBQUNDLE9BQU8sQ0FBQztFQUM5RjtFQUNBLElBQUlLLEtBQUssSUFBSSxPQUFPQSxLQUFLLEtBQUssUUFBUSxFQUFFO0lBQ3RDLE1BQU1NLE1BQU0sR0FBR04sS0FBK0I7SUFDOUMsSUFBSUMsS0FBSyxDQUFDQyxPQUFPLENBQUNJLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLEVBQUU7TUFDbEMsT0FBT0QsTUFBTSxDQUFDQyxRQUFRLENBQUNKLEdBQUcsQ0FBRUMsS0FBSyxJQUFNLE9BQU9BLEtBQUssS0FBSyxRQUFRLEdBQUdBLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFHLENBQUMsQ0FBQ1gsTUFBTSxDQUFDQyxPQUFPLENBQUM7SUFDeEc7RUFDRjtFQUNBLE9BQU8sRUFBRTtBQUNYO0FBRU8sU0FBU1Qsc0JBQXNCQSxDQUFDekMsYUFBcUIsRUFBRXVDLE9BQWUsRUFBWTtFQUN2RixNQUFNd0IsVUFBVSxHQUFHeEIsT0FBTyxDQUFDcUIsSUFBSSxDQUFDLENBQUM7RUFDakMsSUFBSSxDQUFDRyxVQUFVLEVBQUUsT0FBTyxFQUFFO0VBRTFCLElBQUksQ0FBQ0EsVUFBVSxDQUFDQyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7SUFDN0IsTUFBTUMsTUFBTSxHQUFHLElBQUF0QyxjQUFJLEVBQUMzQixhQUFhLEVBQUUrRCxVQUFVLENBQUM7SUFDOUMsT0FBTyxJQUFBckMsa0JBQVUsRUFBQ3VDLE1BQU0sQ0FBQyxHQUFHLENBQUNGLFVBQVUsQ0FBQyxHQUFHLEVBQUU7RUFDL0M7RUFFQSxNQUFNRyxJQUFJLEdBQUdILFVBQVUsQ0FBQ2YsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFRixPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxJQUFJLEVBQUU7RUFDaEUsSUFBSSxDQUFDb0IsSUFBSSxFQUFFLE9BQU8sRUFBRTtFQUVwQixNQUFNQyxPQUFPLEdBQUcsSUFBQXhDLGNBQUksRUFBQzNCLGFBQWEsRUFBRWtFLElBQUksQ0FBQztFQUN6QyxJQUFJLENBQUMsSUFBQXhDLGtCQUFVLEVBQUN5QyxPQUFPLENBQUMsRUFBRSxPQUFPLEVBQUU7RUFFbkMsSUFBSTtJQUNGLE1BQU1DLE9BQU8sR0FBRyxJQUFBQyxtQkFBVyxFQUFDRixPQUFPLEVBQUU7TUFBRUcsYUFBYSxFQUFFO0lBQUssQ0FBQyxDQUFDO0lBQzdELE9BQU9GLE9BQU8sQ0FBQ25CLE1BQU0sQ0FBRVUsS0FBSyxJQUFLQSxLQUFLLENBQUNZLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQ2IsR0FBRyxDQUFFQyxLQUFLLElBQUssR0FBR08sSUFBSSxJQUFJUCxLQUFLLENBQUNaLElBQUksRUFBRSxDQUFDO0VBQy9GLENBQUMsQ0FBQyxNQUFNO0lBQ04sT0FBTyxFQUFFO0VBQ1g7QUFDRjtBQUVPLFNBQVNsQixpQkFBaUJBLENBQUMyQyxRQUFnQixFQUFxQjtFQUNyRSxPQUFPLENBQ0w7SUFDRW5FLEVBQUUsRUFBRSxHQUFHbUUsUUFBUSxVQUFVO0lBQ3pCQyxNQUFNLEVBQUUsU0FBUztJQUNqQmxFLFdBQVcsRUFBRSwrQkFBK0JpRSxRQUFRLHNDQUFzQztJQUMxRkUsTUFBTSxFQUNKO0VBQ0osQ0FBQyxFQUNEO0lBQ0VyRSxFQUFFLEVBQUUsR0FBR21FLFFBQVEsVUFBVTtJQUN6QkMsTUFBTSxFQUFFLFNBQVM7SUFDakJsRSxXQUFXLEVBQUUsOEJBQThCaUUsUUFBUSw2QkFBNkI7SUFDaEZFLE1BQU0sRUFDSjtFQUNKLENBQUMsRUFDRDtJQUNFckUsRUFBRSxFQUFFLEdBQUdtRSxRQUFRLFNBQVM7SUFDeEJDLE1BQU0sRUFBRSxRQUFRO0lBQ2hCbEUsV0FBVyxFQUFFLFlBQVlpRSxRQUFRLHFCQUFxQjtJQUN0REUsTUFBTSxFQUNKO0VBQ0osQ0FBQyxDQUNGO0FBQ0g7QUFFQSxTQUFTQyxtQkFBbUJBLENBQUNuRSxLQUFhLEVBQVU7RUFDbEQsT0FBT0EsS0FBSyxDQUFDc0MsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQ0EsT0FBTyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQ2MsSUFBSSxDQUFDLENBQUM7QUFDcEU7QUFFQSxTQUFTekQsZUFBZUEsQ0FBQ3lFLE1BQWdCLEVBQVk7RUFDbkQsT0FBT0EsTUFBTSxDQUFDbEIsR0FBRyxDQUFDaUIsbUJBQW1CLENBQUMsQ0FBQzFCLE1BQU0sQ0FBQ0MsT0FBTyxDQUFDO0FBQ3hEO0FBRUEsU0FBUzJCLFNBQVNBLENBQUNyRSxLQUFhLEVBQVU7RUFDeEMsT0FBT0EsS0FBSyxDQUFDc0MsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQ0EsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQ0EsT0FBTyxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQ0EsT0FBTyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUM7QUFDdkc7QUFFQSxTQUFTM0IsNEJBQTRCQSxDQUFDMkQsV0FBcUIsRUFBRUMsZUFBeUIsRUFBVztFQUMvRixJQUFJLENBQUNBLGVBQWUsQ0FBQ2hFLE1BQU0sRUFBRSxPQUFPLElBQUk7RUFDeEMsTUFBTWlFLHNCQUFzQixHQUFHRixXQUFXLENBQ3ZDcEIsR0FBRyxDQUFFbEQsS0FBSyxJQUFLbUUsbUJBQW1CLENBQUNFLFNBQVMsQ0FBQ3JFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FDckR5QyxNQUFNLENBQUNDLE9BQU8sQ0FBQztFQUVsQixPQUFPNkIsZUFBZSxDQUFDdkQsSUFBSSxDQUFFeUQsU0FBUyxJQUNwQ0Qsc0JBQXNCLENBQUN4RCxJQUFJLENBQ3hCMEQsVUFBVSxJQUNUQSxVQUFVLEtBQUtELFNBQVMsSUFDeEJDLFVBQVUsQ0FBQ0MsVUFBVSxDQUFDLEdBQUdGLFNBQVMsR0FBRyxDQUFDLElBQ3RDQSxTQUFTLENBQUNFLFVBQVUsQ0FBQyxHQUFHRCxVQUFVLEdBQUcsQ0FDekMsQ0FDRixDQUFDO0FBQ0g7QUFFQSxTQUFTakUsc0JBQXNCQSxDQUFDVCxLQUFhLEVBQXFCO0VBQ2hFLE1BQU02QyxJQUFJLEdBQUc3QyxLQUFLLENBQUNzQyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDUSxXQUFXLENBQUMsQ0FBQyxJQUFJLFFBQVE7RUFDbkUsT0FBTztJQUNMakQsRUFBRSxFQUFFLFVBQVVnRCxJQUFJLEVBQUU7SUFDcEIvQyxLQUFLLEVBQUUsV0FBV0UsS0FBSyxFQUFFO0lBQ3pCRCxXQUFXLEVBQUUseUJBQXlCQyxLQUFLLEVBQUU7SUFDN0NBLEtBQUssRUFBRSxDQUFDLEdBQUdBLEtBQUssT0FBTyxDQUFDO0lBQ3hCRyxrQkFBa0IsRUFBRSxDQUFDLGVBQWUsRUFBRSxVQUFVLENBQUM7SUFDakRpQixLQUFLLEVBQUVDLGlCQUFpQixDQUFDLFVBQVV3QixJQUFJLEVBQUU7RUFDM0MsQ0FBQztBQUNIO0FBRUEsU0FBU2hDLGFBQWFBLENBQUNULE9BQTRCLEVBQXVCO0VBQ3hFLE1BQU15QixJQUFJLEdBQUcsSUFBSUMsR0FBRyxDQUFTLENBQUM7RUFDOUIsTUFBTThDLE1BQTJCLEdBQUcsRUFBRTtFQUN0QyxLQUFLLE1BQU1sRSxNQUFNLElBQUlOLE9BQU8sRUFBRTtJQUM1QixJQUFJeUIsSUFBSSxDQUFDTSxHQUFHLENBQUN6QixNQUFNLENBQUNiLEVBQUUsQ0FBQyxFQUFFO0lBQ3pCZ0MsSUFBSSxDQUFDTyxHQUFHLENBQUMxQixNQUFNLENBQUNiLEVBQUUsQ0FBQztJQUNuQitFLE1BQU0sQ0FBQ3BFLElBQUksQ0FBQ0UsTUFBTSxDQUFDO0VBQ3JCO0VBQ0EsT0FBT2tFLE1BQU07QUFDZiIsImlnbm9yZUxpc3QiOltdfQ==
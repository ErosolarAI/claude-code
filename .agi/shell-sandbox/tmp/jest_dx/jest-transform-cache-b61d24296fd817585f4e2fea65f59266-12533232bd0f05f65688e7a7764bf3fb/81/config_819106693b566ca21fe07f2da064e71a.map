{"version":3,"names":["cov_1le2me12v6","actualCoverage","dirname","resolve","fileURLToPath","registerAgentProfile","hasAgentProfile","getAgentProfile","buildAgentRulebookPrompt","loadAgentRulebook","getAgentProfileManifest","inferProviderFromModelId","PACKAGE_ROOT","s","import","meta","url","PROFILE_MANIFEST","DEFAULT_PROFILES","profiles","map","entry","f","normalizeProfileFromManifest","profile","name","b","resolveProfileConfig","workspaceContext","blueprint","envPrefix","toEnvPrefix","modelEnv","process","env","modelLocked","trim","length","model","defaultModel","inferredProvider","systemPrompt","defaultSystemPrompt","providerEnv","providerCandidate","isProviderValue","providerLocked","Boolean","provider","defaultProvider","rulebook","loadRulebookMetadata","contextBlock","resolved","label","temperature","maxTokens","toUpperCase","replace","value","rulebookRef","manifest","inline","root","file","version","contractVersion","description","fallback","buildDefaultSystemPrompt","systemPromptConfig","manifestVersion","manifestContractVersion","promptConfig","type","content","template","rulebookPrompt","replacements","profile_name","rendered","_match","token","key","toLowerCase","test","merged","suffix","error","message","Error","String"],"sources":["config.ts"],"sourcesContent":["import { dirname, resolve } from 'node:path';\nimport { fileURLToPath } from 'node:url';\nimport type { AgentProfileEntry, AgentProfileManifest } from './contracts/v1/agentProfileManifest.js';\nimport type { ProviderId } from './core/types.js';\nimport {\n  registerAgentProfile,\n  hasAgentProfile,\n  getAgentProfile,\n  type AgentProfileBlueprint,\n  type ProfileName,\n} from './core/agentProfiles.js';\nimport { buildAgentRulebookPrompt, loadAgentRulebook } from './core/agentRulebook.js';\nimport { getAgentProfileManifest } from './core/agentProfileManifest.js';\nimport { inferProviderFromModelId } from './core/modelDiscovery.js';\n\nexport type { ProfileName } from './core/agentProfiles.js';\n\nexport interface ResolvedProfileConfig {\n  profile: ProfileName;\n  label: string;\n  provider: ProviderId;\n  model: string;\n  systemPrompt: string;\n  temperature?: number;\n  maxTokens?: number;\n  modelLocked: boolean;\n  providerLocked: boolean;\n  rulebook: ProfileRulebookMetadata | null;\n}\n\nexport interface ProfileRulebookMetadata {\n  profile: ProfileName;\n  label: string;\n  version: string;\n  contractVersion: string;\n  description?: string;\n  file: string;\n}\n\nconst PACKAGE_ROOT = resolve(dirname(fileURLToPath(import.meta.url)), '..');\n\nconst PROFILE_MANIFEST = getAgentProfileManifest();\n\nconst DEFAULT_PROFILES: AgentProfileBlueprint[] = PROFILE_MANIFEST.profiles.map((entry) =>\n  normalizeProfileFromManifest(entry, PROFILE_MANIFEST, PACKAGE_ROOT)\n);\n\nfor (const profile of DEFAULT_PROFILES) {\n  if (!hasAgentProfile(profile.name)) {\n    registerAgentProfile(profile);\n  }\n}\n\nexport function resolveProfileConfig(profile: ProfileName, workspaceContext: string | null): ResolvedProfileConfig {\n  const blueprint = getAgentProfile(profile);\n\n  const envPrefix = toEnvPrefix(blueprint.name);\n\n  const modelEnv = process.env[`${envPrefix}_MODEL`];\n  const modelLocked = typeof modelEnv === 'string' && modelEnv.trim().length > 0;\n  const model = modelLocked ? modelEnv!.trim() : blueprint.defaultModel;\n  const inferredProvider = inferProviderFromModelId(model);\n\n  const systemPrompt = process.env[`${envPrefix}_SYSTEM_PROMPT`] ?? blueprint.defaultSystemPrompt;\n\n  const providerEnv = process.env[`${envPrefix}_PROVIDER`];\n  const providerCandidate = isProviderValue(providerEnv) ? (providerEnv!.trim() as ProviderId) : null;\n  const providerLocked = Boolean(providerCandidate) && (!inferredProvider || providerCandidate === inferredProvider);\n  const provider: ProviderId = ((): ProviderId => {\n    if (providerCandidate && inferredProvider && providerCandidate !== inferredProvider) {\n      // Prefer the model-aligned provider over a mismatched env override\n      return inferredProvider;\n    }\n    if (providerCandidate) {\n      return providerCandidate;\n    }\n    if (inferredProvider) {\n      return inferredProvider;\n    }\n    return blueprint.defaultProvider;\n  })();\n  const rulebook = loadRulebookMetadata(blueprint);\n\n  const contextBlock = workspaceContext?.trim()\n    ? `\\n\\nWorkspace context (auto-detected):\\n${workspaceContext.trim()}`\n    : '';\n\n  const resolved: ResolvedProfileConfig = {\n    profile,\n    label: blueprint.label,\n    provider,\n    model,\n    systemPrompt: `${systemPrompt.trim()}${contextBlock}`,\n    modelLocked,\n    providerLocked,\n    rulebook,\n  };\n\n  if (typeof blueprint.temperature === 'number') {\n    resolved.temperature = blueprint.temperature;\n  }\n  if (typeof blueprint.maxTokens === 'number') {\n    resolved.maxTokens = blueprint.maxTokens;\n  }\n\n  return resolved;\n}\n\nfunction toEnvPrefix(profile: ProfileName): string {\n  return profile\n    .trim()\n    .toUpperCase()\n    .replace(/[^A-Z0-9]/g, '_');\n}\n\nfunction isProviderValue(value: unknown): value is ProviderId {\n  return typeof value === 'string' && value.trim().length > 0;\n}\n\nfunction loadRulebookMetadata(profile: AgentProfileBlueprint): ProfileRulebookMetadata | null {\n  try {\n    // Check if rulebook is inline\n    const rulebookRef = profile.rulebook as any; // eslint-disable-line @typescript-eslint/no-explicit-any\n    const manifest = rulebookRef.inline\n      ? loadAgentRulebook(profile.name, { inline: rulebookRef.inline })\n      : loadAgentRulebook(profile.name, {\n          root: PACKAGE_ROOT,\n          file: rulebookRef.file,\n        });\n\n    return {\n      profile: manifest.profile,\n      label: manifest.label ?? manifest.profile,\n      version: manifest.version,\n      contractVersion: manifest.contractVersion,\n      description: manifest.description ?? profile.rulebook.description,\n      file: rulebookRef.file ?? '[inline]',\n    };\n  } catch {\n    if (!profile.rulebook) {\n      return null;\n    }\n\n    const rulebookRef = profile.rulebook as any; // eslint-disable-line @typescript-eslint/no-explicit-any\n    const fallback: ProfileRulebookMetadata = {\n      profile: profile.name,\n      label: profile.label,\n      version: rulebookRef.version ?? 'unknown',\n      contractVersion: rulebookRef.contractVersion ?? 'unknown',\n      description: rulebookRef.description,\n      file: rulebookRef.file ?? '[inline]',\n    };\n\n    return fallback;\n  }\n}\n\nfunction normalizeProfileFromManifest(\n  entry: AgentProfileEntry,\n  manifest: AgentProfileManifest,\n  root: string\n): AgentProfileBlueprint {\n  const defaultSystemPrompt = buildDefaultSystemPrompt(entry, root);\n\n  return {\n    name: entry.name,\n    label: entry.label,\n    description: entry.description,\n    defaultProvider: entry.defaultProvider,\n    defaultModel: entry.defaultModel,\n    systemPromptConfig: entry.systemPrompt,\n    defaultSystemPrompt,\n    temperature: entry.temperature,\n    maxTokens: entry.maxTokens,\n    rulebook: entry.rulebook,\n    manifestVersion: manifest.version,\n    manifestContractVersion: manifest.contractVersion,\n  };\n}\n\nfunction buildDefaultSystemPrompt(entry: AgentProfileEntry, root: string): string {\n  try {\n    const promptConfig = entry.systemPrompt;\n    if (promptConfig.type === 'literal') {\n      return promptConfig.content.trim();\n    }\n\n    const template = promptConfig.template?.trim() || '{{rulebook}}';\n    // Check if rulebook is inline\n    const rulebookRef = entry.rulebook as any; // eslint-disable-line @typescript-eslint/no-explicit-any\n    const rulebookPrompt = rulebookRef.inline\n      ? buildAgentRulebookPrompt(entry.name, { inline: rulebookRef.inline }).trim()\n      : buildAgentRulebookPrompt(entry.name, { root, file: rulebookRef.file }).trim();\n    const replacements: Record<string, string> = {\n      rulebook: rulebookPrompt,\n      profile: entry.label || entry.name,\n      profile_name: entry.name,\n    };\n\n    const rendered = template.replace(\n      /\\{\\{\\s*(rulebook|profile|profile_name)\\s*\\}\\}/gi,\n      (_match, token: string) => {\n        const key = token.toLowerCase() as keyof typeof replacements;\n        return replacements[key] ?? '';\n      }\n    );\n\n    if (/\\{\\{\\s*rulebook\\s*\\}\\}/i.test(template)) {\n      return rendered.trim();\n    }\n\n    const merged = rendered.trim();\n    const suffix = merged ? `\\n\\n${rulebookPrompt}` : rulebookPrompt;\n    return `${merged}${suffix}`.trim();\n  } catch (error) {\n    const message = error instanceof Error ? error.message : String(error);\n    throw new Error(`Failed to build system prompt for profile \"${entry.name}\": ${message}`);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}
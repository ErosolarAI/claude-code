3ba7c6bc34a88e4f156b3ad7c80647d0
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.MissingSecretError = void 0;
exports.ensureSecretForProvider = ensureSecretForProvider;
exports.getSecretDefinition = getSecretDefinition;
exports.getSecretDefinitionForProvider = getSecretDefinitionForProvider;
exports.getSecretValue = getSecretValue;
exports.listSecretDefinitions = listSecretDefinitions;
exports.loadAllSecrets = loadAllSecrets;
exports.maskSecret = maskSecret;
exports.safeErrorMessage = safeErrorMessage;
exports.sanitizeError = sanitizeError;
exports.sanitizeErrorMessage = sanitizeErrorMessage;
exports.setSecretValue = setSecretValue;
var _nodeFs = require("node:fs");
var _nodeOs = require("node:os");
var _nodePath = require("node:path");
const SECRET_DEFINITIONS = [{
  id: 'OPENAI_API_KEY',
  label: 'OpenAI API Key',
  description: 'Required to run OpenAI GPT and AGI Code models.',
  envVar: 'OPENAI_API_KEY',
  providers: ['openai']
}, {
  id: 'ANTHROPIC_API_KEY',
  label: 'Anthropic API Key',
  description: 'Required to run Anthropic Sonnet, Opus, or Haiku models.',
  envVar: 'ANTHROPIC_API_KEY',
  providers: ['anthropic']
}, {
  id: 'DEEPSEEK_API_KEY',
  label: 'DeepSeek API Key',
  description: 'Required to run DeepSeek Reasoner or Chat models.',
  envVar: 'DEEPSEEK_API_KEY',
  providers: ['deepseek']
}, {
  id: 'XAI_API_KEY',
  label: 'xAI API Key',
  description: 'Required to run Grok models from xAI.',
  envVar: 'XAI_API_KEY',
  providers: ['xai']
}, {
  id: 'GEMINI_API_KEY',
  label: 'Google Gemini API Key',
  description: 'Required to run Gemini 2.5 Pro or Flash models.',
  envVar: 'GEMINI_API_KEY',
  providers: ['google']
}, {
  id: 'TAVILY_API_KEY',
  label: 'Tavily API Key',
  description: 'Required: WebSearch and WebExtract provider. Get yours at https://tavily.com',
  envVar: 'TAVILY_API_KEY',
  providers: []
}, {
  id: 'SMTP_USER',
  label: 'Email Address',
  description: 'Your email address for sending emails (e.g., you@gmail.com).',
  envVar: 'SMTP_USER',
  providers: []
}, {
  id: 'SMTP_PASSWORD',
  label: 'Email App Password',
  description: 'App password for your email (NOT your regular password). For Gmail: https://myaccount.google.com/apppasswords',
  envVar: 'SMTP_PASSWORD',
  providers: []
}, {
  id: 'SMTP_PROVIDER',
  label: 'Email Provider',
  description: 'Email provider: gmail, outlook, yahoo, icloud, zoho (default: gmail).',
  envVar: 'SMTP_PROVIDER',
  providers: []
}, {
  id: 'SMTP_FROM_NAME',
  label: 'Email Display Name',
  description: 'Optional: Display name shown in sent emails (e.g., "John Doe").',
  envVar: 'SMTP_FROM_NAME',
  providers: []
}, {
  id: 'SMTP_HOST',
  label: 'Custom SMTP Host',
  description: 'Optional: Custom SMTP server hostname (only for non-standard providers).',
  envVar: 'SMTP_HOST',
  providers: []
}, {
  id: 'SMTP_PORT',
  label: 'Custom SMTP Port',
  description: 'Optional: Custom SMTP port (only for non-standard providers, default: 587).',
  envVar: 'SMTP_PORT',
  providers: []
}];
const envAgiHome = process.env['AGI_HOME'];
const SECRET_DIR = envAgiHome ? (0, _nodePath.resolve)(envAgiHome) : (0, _nodePath.join)((0, _nodeOs.homedir)(), '.agi');
const SECRET_FILE = (0, _nodePath.join)(SECRET_DIR, 'secrets.json');
class MissingSecretError extends Error {
  constructor(secret) {
    super(`${secret.label} is not configured.`);
    this.secret = secret;
    this.name = 'MissingSecretError';
  }
}
exports.MissingSecretError = MissingSecretError;
function listSecretDefinitions() {
  return [...SECRET_DEFINITIONS];
}
function getSecretDefinition(id) {
  return SECRET_DEFINITIONS.find(entry => entry.id === id) ?? null;
}
function getSecretValue(id) {
  const envValue = sanitize(process.env[id]);
  if (envValue) {
    return envValue;
  }
  const store = readSecretStore();
  const storedValue = sanitize(store[id]);
  if (!storedValue) {
    return null;
  }
  process.env[id] = storedValue;
  return storedValue;
}

/**
 * Load all stored secrets into process.env at startup.
 * This ensures secrets are available before any provider checks.
 *
 * IMPORTANT: Stored secrets always take precedence over environment variables
 * for provider API keys. This ensures keys set via /secrets are used even if
 * the user has old/stale keys exported in their shell environment.
 */
function loadAllSecrets() {
  const store = readSecretStore();
  for (const definition of SECRET_DEFINITIONS) {
    const storedValue = sanitize(store[definition.id]);
    if (storedValue) {
      // Always use stored value for API keys to ensure /secrets takes precedence
      // over potentially stale environment variables
      process.env[definition.id] = storedValue;
    }
  }

  // Sync GEMINI_API_KEY and GOOGLE_API_KEY for Google SDK compatibility
  // The Google SDK checks both vars and warns if both are set
  // We standardize on GEMINI_API_KEY as the canonical key
  syncGoogleApiKeys();
}

/**
 * Sync GEMINI_API_KEY and GOOGLE_API_KEY environment variables.
 * The Google SDK prefers GOOGLE_API_KEY if both are set, but we use GEMINI_API_KEY
 * as the canonical stored key. This function ensures consistency.
 */
function syncGoogleApiKeys() {
  const geminiKey = process.env['GEMINI_API_KEY'];
  const googleKey = process.env['GOOGLE_API_KEY'];
  if (geminiKey && !googleKey) {
    // Only GEMINI_API_KEY set - also set GOOGLE_API_KEY to avoid SDK confusion
    process.env['GOOGLE_API_KEY'] = geminiKey;
  } else if (googleKey && !geminiKey) {
    // Only GOOGLE_API_KEY set (from env export) - copy to GEMINI_API_KEY
    process.env['GEMINI_API_KEY'] = googleKey;
  } else if (geminiKey && googleKey && geminiKey !== googleKey) {
    // Both set with different values - prefer GEMINI_API_KEY (the stored one)
    // and sync GOOGLE_API_KEY to match
    process.env['GOOGLE_API_KEY'] = geminiKey;
  }
  // If both are set and equal, no action needed
}
function setSecretValue(id, rawValue) {
  const value = sanitize(rawValue);
  if (!value) {
    throw new Error('Secret value cannot be blank.');
  }
  const store = readSecretStore();
  store[id] = value;
  writeSecretStore(store);
  process.env[id] = value;

  // If setting GEMINI_API_KEY, also sync GOOGLE_API_KEY for SDK compatibility
  if (id === 'GEMINI_API_KEY') {
    process.env['GOOGLE_API_KEY'] = value;
  }
}
function maskSecret(value) {
  if (!value) {
    return '';
  }
  if (value.length <= 4) {
    return '*'.repeat(value.length);
  }
  const suffix = value.slice(-4);
  const prefix = '*'.repeat(Math.max(0, value.length - 4));
  return `${prefix}${suffix}`;
}
function ensureSecretForProvider(provider) {
  const definition = findDefinitionForProvider(provider);
  const value = getSecretValue(definition.id);
  if (!value) {
    throw new MissingSecretError(definition);
  }
  process.env[definition.envVar] = value;
  return value;
}
function getSecretDefinitionForProvider(provider) {
  return SECRET_DEFINITIONS.find(entry => entry.providers.includes(provider)) ?? null;
}
function readSecretStore() {
  if (!(0, _nodeFs.existsSync)(SECRET_FILE)) {
    return {};
  }
  try {
    const content = (0, _nodeFs.readFileSync)(SECRET_FILE, 'utf8');
    const parsed = JSON.parse(content);
    if (parsed && typeof parsed === 'object') {
      return parsed;
    }
  } catch {
    return {};
  }
  return {};
}
function writeSecretStore(store) {
  const directory = (0, _nodePath.dirname)(SECRET_FILE);
  (0, _nodeFs.mkdirSync)(directory, {
    recursive: true
  });
  const payload = JSON.stringify(store, null, 2);
  (0, _nodeFs.writeFileSync)(SECRET_FILE, `${payload}
`);
}
function findDefinitionForProvider(provider) {
  const definition = getSecretDefinitionForProvider(provider);
  if (!definition) {
    throw new Error(`No secret configuration for provider "${provider}".`);
  }
  return definition;
}
function sanitize(value) {
  if (typeof value !== 'string') {
    return null;
  }
  const trimmed = value.trim();
  return trimmed.length ? trimmed : null;
}

// ============================================================================
// Secret Sanitization for Error Messages
// ============================================================================

/**
 * Known API key patterns to detect and sanitize in error messages.
 * These patterns match common API key formats from various providers.
 */
const API_KEY_PATTERNS = [
// Anthropic API keys: sk-ant-api03-...
/sk-ant-api\d{2}-[A-Za-z0-9_-]{20,}/g,
// OpenAI API keys: sk-proj-... or sk-...
/sk-(?:proj-)?[A-Za-z0-9_-]{20,}/g,
// Generic Bearer tokens in headers
/Bearer\s+[A-Za-z0-9_.-]{20,}/gi,
// x-api-key header values
/x-api-key['":\s]+[A-Za-z0-9_.-]{20,}/gi,
// API keys in URLs (key=value pattern)
/[?&](?:key|api_key|apiKey|api-key|token|access_token)=([A-Za-z0-9_.-]{16,})/gi,
// DeepSeek keys
/sk-[a-f0-9]{32,}/gi,
// xAI/Grok keys
/xai-[A-Za-z0-9_-]{20,}/gi,
// Google/Gemini API keys (AIza...)
/AIza[A-Za-z0-9_-]{30,}/g,
// Generic long alphanumeric tokens that look like API keys
/(?:api[_-]?key|token|secret|password|credential)['"]?\s*[:=]\s*['"]?([A-Za-z0-9_.-]{20,})['"]?/gi];

/**
 * Sanitize error messages to remove potential API keys and secrets.
 * This prevents accidental token leakage in logs, error reports, and console output.
 *
 * @param message - The error message or string to sanitize
 * @returns The sanitized string with secrets replaced by [REDACTED]
 */
function sanitizeErrorMessage(message) {
  if (!message || typeof message !== 'string') {
    return message;
  }
  let sanitized = message;

  // Apply all API key patterns
  for (const pattern of API_KEY_PATTERNS) {
    // Reset lastIndex for global patterns
    pattern.lastIndex = 0;
    sanitized = sanitized.replace(pattern, match => {
      // For patterns with capture groups, try to preserve context
      if (match.includes('=') || match.includes(':')) {
        const separator = match.includes('=') ? '=' : ':';
        const parts = match.split(separator);
        if (parts.length === 2) {
          return `${parts[0]}${separator}[REDACTED]`;
        }
      }
      return '[REDACTED]';
    });
  }

  // Additionally sanitize any env var values that are currently loaded
  sanitized = sanitizeAgainstLoadedSecrets(sanitized);
  return sanitized;
}

/**
 * Sanitize a string against currently loaded secret values.
 * This catches any secrets that might not match the pattern-based detection.
 */
function sanitizeAgainstLoadedSecrets(message) {
  const secretNames = ['OPENAI_API_KEY', 'ANTHROPIC_API_KEY', 'DEEPSEEK_API_KEY', 'XAI_API_KEY', 'GEMINI_API_KEY', 'TAVILY_API_KEY', 'SMTP_PASSWORD'];
  let sanitized = message;
  for (const name of secretNames) {
    const value = process.env[name];
    if (value && value.length >= 4) {
      // Reduced from 8 to catch shorter keys
      // Only sanitize if the value appears in the message
      // Use a case-sensitive exact match to avoid false positives
      if (sanitized.includes(value)) {
        sanitized = sanitized.split(value).join('[REDACTED]');
      }

      // Also sanitize partial matches (first 8 chars + last 4 chars pattern)
      if (value.length >= 12) {
        const partialPattern = `${value.substring(0, 8)}...${value.substring(value.length - 4)}`;
        if (sanitized.includes(partialPattern)) {
          sanitized = sanitized.split(partialPattern).join('[REDACTED_PARTIAL]');
        }
      }
    }
  }

  // Additional OpenAI-specific key patterns
  // OpenAI keys: sk-proj-..., sk-..., org-...
  const openaiKeyPattern = /sk-(proj-)?[a-zA-Z0-9]{20,}/g;
  sanitized = sanitized.replace(openaiKeyPattern, '[REDACTED_OPENAI_KEY]');
  const openaiOrgPattern = /org-[a-zA-Z0-9]{20,}/g;
  sanitized = sanitized.replace(openaiOrgPattern, '[REDACTED_OPENAI_ORG]');
  return sanitized;
}

/**
 * Sanitize an Error object's message and stack trace.
 * Returns a new error message string with secrets removed.
 */
function sanitizeError(error) {
  const message = sanitizeErrorMessage(error.message);
  const stack = error.stack ? sanitizeErrorMessage(error.stack) : '';
  if (stack && stack !== message) {
    return `${message}\n${stack}`;
  }
  return message;
}

/**
 * Create a safe error message from an unknown error value.
 * Ensures no secrets are leaked regardless of error type.
 */
function safeErrorMessage(error) {
  if (error instanceof Error) {
    return sanitizeErrorMessage(error.message);
  }
  if (typeof error === 'string') {
    return sanitizeErrorMessage(error);
  }
  return 'Unknown error occurred';
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUZzIiwicmVxdWlyZSIsIl9ub2RlT3MiLCJfbm9kZVBhdGgiLCJTRUNSRVRfREVGSU5JVElPTlMiLCJpZCIsImxhYmVsIiwiZGVzY3JpcHRpb24iLCJlbnZWYXIiLCJwcm92aWRlcnMiLCJlbnZBZ2lIb21lIiwicHJvY2VzcyIsImVudiIsIlNFQ1JFVF9ESVIiLCJyZXNvbHZlIiwiam9pbiIsImhvbWVkaXIiLCJTRUNSRVRfRklMRSIsIk1pc3NpbmdTZWNyZXRFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJzZWNyZXQiLCJuYW1lIiwiZXhwb3J0cyIsImxpc3RTZWNyZXREZWZpbml0aW9ucyIsImdldFNlY3JldERlZmluaXRpb24iLCJmaW5kIiwiZW50cnkiLCJnZXRTZWNyZXRWYWx1ZSIsImVudlZhbHVlIiwic2FuaXRpemUiLCJzdG9yZSIsInJlYWRTZWNyZXRTdG9yZSIsInN0b3JlZFZhbHVlIiwibG9hZEFsbFNlY3JldHMiLCJkZWZpbml0aW9uIiwic3luY0dvb2dsZUFwaUtleXMiLCJnZW1pbmlLZXkiLCJnb29nbGVLZXkiLCJzZXRTZWNyZXRWYWx1ZSIsInJhd1ZhbHVlIiwidmFsdWUiLCJ3cml0ZVNlY3JldFN0b3JlIiwibWFza1NlY3JldCIsImxlbmd0aCIsInJlcGVhdCIsInN1ZmZpeCIsInNsaWNlIiwicHJlZml4IiwiTWF0aCIsIm1heCIsImVuc3VyZVNlY3JldEZvclByb3ZpZGVyIiwicHJvdmlkZXIiLCJmaW5kRGVmaW5pdGlvbkZvclByb3ZpZGVyIiwiZ2V0U2VjcmV0RGVmaW5pdGlvbkZvclByb3ZpZGVyIiwiaW5jbHVkZXMiLCJleGlzdHNTeW5jIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsInBhcnNlZCIsIkpTT04iLCJwYXJzZSIsImRpcmVjdG9yeSIsImRpcm5hbWUiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJwYXlsb2FkIiwic3RyaW5naWZ5Iiwid3JpdGVGaWxlU3luYyIsInRyaW1tZWQiLCJ0cmltIiwiQVBJX0tFWV9QQVRURVJOUyIsInNhbml0aXplRXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsInNhbml0aXplZCIsInBhdHRlcm4iLCJsYXN0SW5kZXgiLCJyZXBsYWNlIiwibWF0Y2giLCJzZXBhcmF0b3IiLCJwYXJ0cyIsInNwbGl0Iiwic2FuaXRpemVBZ2FpbnN0TG9hZGVkU2VjcmV0cyIsInNlY3JldE5hbWVzIiwicGFydGlhbFBhdHRlcm4iLCJzdWJzdHJpbmciLCJvcGVuYWlLZXlQYXR0ZXJuIiwib3BlbmFpT3JnUGF0dGVybiIsInNhbml0aXplRXJyb3IiLCJlcnJvciIsInN0YWNrIiwic2FmZUVycm9yTWVzc2FnZSJdLCJzb3VyY2VzIjpbInNlY3JldFN0b3JlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMsIG1rZGlyU3luYywgcmVhZEZpbGVTeW5jLCB3cml0ZUZpbGVTeW5jIH0gZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQgeyBob21lZGlyIH0gZnJvbSAnbm9kZTpvcyc7XG5pbXBvcnQgeyBkaXJuYW1lLCBqb2luLCByZXNvbHZlIH0gZnJvbSAnbm9kZTpwYXRoJztcbmltcG9ydCB0eXBlIHsgUHJvdmlkZXJJZCB9IGZyb20gJy4vdHlwZXMuanMnO1xuXG5leHBvcnQgdHlwZSBTZWNyZXROYW1lID1cbiAgfCAnT1BFTkFJX0FQSV9LRVknXG4gIHwgJ0FOVEhST1BJQ19BUElfS0VZJ1xuICB8ICdERUVQU0VFS19BUElfS0VZJ1xuICB8ICdYQUlfQVBJX0tFWSdcbiAgfCAnR0VNSU5JX0FQSV9LRVknXG4gIHwgJ1RBVklMWV9BUElfS0VZJ1xuICB8ICdTTVRQX1VTRVInXG4gIHwgJ1NNVFBfUEFTU1dPUkQnXG4gIHwgJ1NNVFBfUFJPVklERVInXG4gIHwgJ1NNVFBfRlJPTV9OQU1FJ1xuICB8ICdTTVRQX0hPU1QnXG4gIHwgJ1NNVFBfUE9SVCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VjcmV0RGVmaW5pdGlvbiB7XG4gIGlkOiBTZWNyZXROYW1lO1xuICBsYWJlbDogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBlbnZWYXI6IFNlY3JldE5hbWU7XG4gIHByb3ZpZGVyczogUHJvdmlkZXJJZFtdO1xufVxuXG5pbnRlcmZhY2UgU2VjcmV0U3RvcmVEYXRhIHtcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgdW5kZWZpbmVkO1xufVxuXG5jb25zdCBTRUNSRVRfREVGSU5JVElPTlM6IFNlY3JldERlZmluaXRpb25bXSA9IFtcbiAge1xuICAgIGlkOiAnT1BFTkFJX0FQSV9LRVknLFxuICAgIGxhYmVsOiAnT3BlbkFJIEFQSSBLZXknLFxuICAgIGRlc2NyaXB0aW9uOiAnUmVxdWlyZWQgdG8gcnVuIE9wZW5BSSBHUFQgYW5kIEFHSSBDb2RlIG1vZGVscy4nLFxuICAgIGVudlZhcjogJ09QRU5BSV9BUElfS0VZJyxcbiAgICBwcm92aWRlcnM6IFsnb3BlbmFpJ10sXG4gIH0sXG4gIHtcbiAgICBpZDogJ0FOVEhST1BJQ19BUElfS0VZJyxcbiAgICBsYWJlbDogJ0FudGhyb3BpYyBBUEkgS2V5JyxcbiAgICBkZXNjcmlwdGlvbjogJ1JlcXVpcmVkIHRvIHJ1biBBbnRocm9waWMgU29ubmV0LCBPcHVzLCBvciBIYWlrdSBtb2RlbHMuJyxcbiAgICBlbnZWYXI6ICdBTlRIUk9QSUNfQVBJX0tFWScsXG4gICAgcHJvdmlkZXJzOiBbJ2FudGhyb3BpYyddLFxuICB9LFxuICB7XG4gICAgaWQ6ICdERUVQU0VFS19BUElfS0VZJyxcbiAgICBsYWJlbDogJ0RlZXBTZWVrIEFQSSBLZXknLFxuICAgIGRlc2NyaXB0aW9uOiAnUmVxdWlyZWQgdG8gcnVuIERlZXBTZWVrIFJlYXNvbmVyIG9yIENoYXQgbW9kZWxzLicsXG4gICAgZW52VmFyOiAnREVFUFNFRUtfQVBJX0tFWScsXG4gICAgcHJvdmlkZXJzOiBbJ2RlZXBzZWVrJ10sXG4gIH0sXG4gIHtcbiAgICBpZDogJ1hBSV9BUElfS0VZJyxcbiAgICBsYWJlbDogJ3hBSSBBUEkgS2V5JyxcbiAgICBkZXNjcmlwdGlvbjogJ1JlcXVpcmVkIHRvIHJ1biBHcm9rIG1vZGVscyBmcm9tIHhBSS4nLFxuICAgIGVudlZhcjogJ1hBSV9BUElfS0VZJyxcbiAgICBwcm92aWRlcnM6IFsneGFpJ10sXG4gIH0sXG4gIHtcbiAgICBpZDogJ0dFTUlOSV9BUElfS0VZJyxcbiAgICBsYWJlbDogJ0dvb2dsZSBHZW1pbmkgQVBJIEtleScsXG4gICAgZGVzY3JpcHRpb246ICdSZXF1aXJlZCB0byBydW4gR2VtaW5pIDIuNSBQcm8gb3IgRmxhc2ggbW9kZWxzLicsXG4gICAgZW52VmFyOiAnR0VNSU5JX0FQSV9LRVknLFxuICAgIHByb3ZpZGVyczogWydnb29nbGUnXSxcbiAgfSxcbiAge1xuICAgIGlkOiAnVEFWSUxZX0FQSV9LRVknLFxuICAgIGxhYmVsOiAnVGF2aWx5IEFQSSBLZXknLFxuICAgIGRlc2NyaXB0aW9uOiAnUmVxdWlyZWQ6IFdlYlNlYXJjaCBhbmQgV2ViRXh0cmFjdCBwcm92aWRlci4gR2V0IHlvdXJzIGF0IGh0dHBzOi8vdGF2aWx5LmNvbScsXG4gICAgZW52VmFyOiAnVEFWSUxZX0FQSV9LRVknLFxuICAgIHByb3ZpZGVyczogW10sXG4gIH0sXG4gIHtcbiAgICBpZDogJ1NNVFBfVVNFUicsXG4gICAgbGFiZWw6ICdFbWFpbCBBZGRyZXNzJyxcbiAgICBkZXNjcmlwdGlvbjogJ1lvdXIgZW1haWwgYWRkcmVzcyBmb3Igc2VuZGluZyBlbWFpbHMgKGUuZy4sIHlvdUBnbWFpbC5jb20pLicsXG4gICAgZW52VmFyOiAnU01UUF9VU0VSJyxcbiAgICBwcm92aWRlcnM6IFtdLFxuICB9LFxuICB7XG4gICAgaWQ6ICdTTVRQX1BBU1NXT1JEJyxcbiAgICBsYWJlbDogJ0VtYWlsIEFwcCBQYXNzd29yZCcsXG4gICAgZGVzY3JpcHRpb246ICdBcHAgcGFzc3dvcmQgZm9yIHlvdXIgZW1haWwgKE5PVCB5b3VyIHJlZ3VsYXIgcGFzc3dvcmQpLiBGb3IgR21haWw6IGh0dHBzOi8vbXlhY2NvdW50Lmdvb2dsZS5jb20vYXBwcGFzc3dvcmRzJyxcbiAgICBlbnZWYXI6ICdTTVRQX1BBU1NXT1JEJyxcbiAgICBwcm92aWRlcnM6IFtdLFxuICB9LFxuICB7XG4gICAgaWQ6ICdTTVRQX1BST1ZJREVSJyxcbiAgICBsYWJlbDogJ0VtYWlsIFByb3ZpZGVyJyxcbiAgICBkZXNjcmlwdGlvbjogJ0VtYWlsIHByb3ZpZGVyOiBnbWFpbCwgb3V0bG9vaywgeWFob28sIGljbG91ZCwgem9obyAoZGVmYXVsdDogZ21haWwpLicsXG4gICAgZW52VmFyOiAnU01UUF9QUk9WSURFUicsXG4gICAgcHJvdmlkZXJzOiBbXSxcbiAgfSxcbiAge1xuICAgIGlkOiAnU01UUF9GUk9NX05BTUUnLFxuICAgIGxhYmVsOiAnRW1haWwgRGlzcGxheSBOYW1lJyxcbiAgICBkZXNjcmlwdGlvbjogJ09wdGlvbmFsOiBEaXNwbGF5IG5hbWUgc2hvd24gaW4gc2VudCBlbWFpbHMgKGUuZy4sIFwiSm9obiBEb2VcIikuJyxcbiAgICBlbnZWYXI6ICdTTVRQX0ZST01fTkFNRScsXG4gICAgcHJvdmlkZXJzOiBbXSxcbiAgfSxcbiAge1xuICAgIGlkOiAnU01UUF9IT1NUJyxcbiAgICBsYWJlbDogJ0N1c3RvbSBTTVRQIEhvc3QnLFxuICAgIGRlc2NyaXB0aW9uOiAnT3B0aW9uYWw6IEN1c3RvbSBTTVRQIHNlcnZlciBob3N0bmFtZSAob25seSBmb3Igbm9uLXN0YW5kYXJkIHByb3ZpZGVycykuJyxcbiAgICBlbnZWYXI6ICdTTVRQX0hPU1QnLFxuICAgIHByb3ZpZGVyczogW10sXG4gIH0sXG4gIHtcbiAgICBpZDogJ1NNVFBfUE9SVCcsXG4gICAgbGFiZWw6ICdDdXN0b20gU01UUCBQb3J0JyxcbiAgICBkZXNjcmlwdGlvbjogJ09wdGlvbmFsOiBDdXN0b20gU01UUCBwb3J0IChvbmx5IGZvciBub24tc3RhbmRhcmQgcHJvdmlkZXJzLCBkZWZhdWx0OiA1ODcpLicsXG4gICAgZW52VmFyOiAnU01UUF9QT1JUJyxcbiAgICBwcm92aWRlcnM6IFtdLFxuICB9LFxuXTtcblxuY29uc3QgZW52QWdpSG9tZSA9IHByb2Nlc3MuZW52WydBR0lfSE9NRSddO1xuY29uc3QgU0VDUkVUX0RJUiA9IGVudkFnaUhvbWUgPyByZXNvbHZlKGVudkFnaUhvbWUpIDogam9pbihob21lZGlyKCksICcuYWdpJyk7XG5jb25zdCBTRUNSRVRfRklMRSA9IGpvaW4oU0VDUkVUX0RJUiwgJ3NlY3JldHMuanNvbicpO1xuXG5leHBvcnQgY2xhc3MgTWlzc2luZ1NlY3JldEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgc2VjcmV0OiBTZWNyZXREZWZpbml0aW9uKSB7XG4gICAgc3VwZXIoYCR7c2VjcmV0LmxhYmVsfSBpcyBub3QgY29uZmlndXJlZC5gKTtcbiAgICB0aGlzLm5hbWUgPSAnTWlzc2luZ1NlY3JldEVycm9yJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdFNlY3JldERlZmluaXRpb25zKCk6IFNlY3JldERlZmluaXRpb25bXSB7XG4gIHJldHVybiBbLi4uU0VDUkVUX0RFRklOSVRJT05TXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlY3JldERlZmluaXRpb24oaWQ6IFNlY3JldE5hbWUpOiBTZWNyZXREZWZpbml0aW9uIHwgbnVsbCB7XG4gIHJldHVybiBTRUNSRVRfREVGSU5JVElPTlMuZmluZCgoZW50cnkpID0+IGVudHJ5LmlkID09PSBpZCkgPz8gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlY3JldFZhbHVlKGlkOiBTZWNyZXROYW1lKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IGVudlZhbHVlID0gc2FuaXRpemUocHJvY2Vzcy5lbnZbaWRdKTtcbiAgaWYgKGVudlZhbHVlKSB7XG4gICAgcmV0dXJuIGVudlZhbHVlO1xuICB9XG5cbiAgY29uc3Qgc3RvcmUgPSByZWFkU2VjcmV0U3RvcmUoKTtcbiAgY29uc3Qgc3RvcmVkVmFsdWUgPSBzYW5pdGl6ZShzdG9yZVtpZF0pO1xuICBpZiAoIXN0b3JlZFZhbHVlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwcm9jZXNzLmVudltpZF0gPSBzdG9yZWRWYWx1ZTtcbiAgcmV0dXJuIHN0b3JlZFZhbHVlO1xufVxuXG4vKipcbiAqIExvYWQgYWxsIHN0b3JlZCBzZWNyZXRzIGludG8gcHJvY2Vzcy5lbnYgYXQgc3RhcnR1cC5cbiAqIFRoaXMgZW5zdXJlcyBzZWNyZXRzIGFyZSBhdmFpbGFibGUgYmVmb3JlIGFueSBwcm92aWRlciBjaGVja3MuXG4gKlxuICogSU1QT1JUQU5UOiBTdG9yZWQgc2VjcmV0cyBhbHdheXMgdGFrZSBwcmVjZWRlbmNlIG92ZXIgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gKiBmb3IgcHJvdmlkZXIgQVBJIGtleXMuIFRoaXMgZW5zdXJlcyBrZXlzIHNldCB2aWEgL3NlY3JldHMgYXJlIHVzZWQgZXZlbiBpZlxuICogdGhlIHVzZXIgaGFzIG9sZC9zdGFsZSBrZXlzIGV4cG9ydGVkIGluIHRoZWlyIHNoZWxsIGVudmlyb25tZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZEFsbFNlY3JldHMoKTogdm9pZCB7XG4gIGNvbnN0IHN0b3JlID0gcmVhZFNlY3JldFN0b3JlKCk7XG4gIGZvciAoY29uc3QgZGVmaW5pdGlvbiBvZiBTRUNSRVRfREVGSU5JVElPTlMpIHtcbiAgICBjb25zdCBzdG9yZWRWYWx1ZSA9IHNhbml0aXplKHN0b3JlW2RlZmluaXRpb24uaWRdKTtcbiAgICBpZiAoc3RvcmVkVmFsdWUpIHtcbiAgICAgIC8vIEFsd2F5cyB1c2Ugc3RvcmVkIHZhbHVlIGZvciBBUEkga2V5cyB0byBlbnN1cmUgL3NlY3JldHMgdGFrZXMgcHJlY2VkZW5jZVxuICAgICAgLy8gb3ZlciBwb3RlbnRpYWxseSBzdGFsZSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgICAgIHByb2Nlc3MuZW52W2RlZmluaXRpb24uaWRdID0gc3RvcmVkVmFsdWU7XG4gICAgfVxuICB9XG5cbiAgLy8gU3luYyBHRU1JTklfQVBJX0tFWSBhbmQgR09PR0xFX0FQSV9LRVkgZm9yIEdvb2dsZSBTREsgY29tcGF0aWJpbGl0eVxuICAvLyBUaGUgR29vZ2xlIFNESyBjaGVja3MgYm90aCB2YXJzIGFuZCB3YXJucyBpZiBib3RoIGFyZSBzZXRcbiAgLy8gV2Ugc3RhbmRhcmRpemUgb24gR0VNSU5JX0FQSV9LRVkgYXMgdGhlIGNhbm9uaWNhbCBrZXlcbiAgc3luY0dvb2dsZUFwaUtleXMoKTtcbn1cblxuLyoqXG4gKiBTeW5jIEdFTUlOSV9BUElfS0VZIGFuZCBHT09HTEVfQVBJX0tFWSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuXG4gKiBUaGUgR29vZ2xlIFNESyBwcmVmZXJzIEdPT0dMRV9BUElfS0VZIGlmIGJvdGggYXJlIHNldCwgYnV0IHdlIHVzZSBHRU1JTklfQVBJX0tFWVxuICogYXMgdGhlIGNhbm9uaWNhbCBzdG9yZWQga2V5LiBUaGlzIGZ1bmN0aW9uIGVuc3VyZXMgY29uc2lzdGVuY3kuXG4gKi9cbmZ1bmN0aW9uIHN5bmNHb29nbGVBcGlLZXlzKCk6IHZvaWQge1xuICBjb25zdCBnZW1pbmlLZXkgPSBwcm9jZXNzLmVudlsnR0VNSU5JX0FQSV9LRVknXTtcbiAgY29uc3QgZ29vZ2xlS2V5ID0gcHJvY2Vzcy5lbnZbJ0dPT0dMRV9BUElfS0VZJ107XG5cbiAgaWYgKGdlbWluaUtleSAmJiAhZ29vZ2xlS2V5KSB7XG4gICAgLy8gT25seSBHRU1JTklfQVBJX0tFWSBzZXQgLSBhbHNvIHNldCBHT09HTEVfQVBJX0tFWSB0byBhdm9pZCBTREsgY29uZnVzaW9uXG4gICAgcHJvY2Vzcy5lbnZbJ0dPT0dMRV9BUElfS0VZJ10gPSBnZW1pbmlLZXk7XG4gIH0gZWxzZSBpZiAoZ29vZ2xlS2V5ICYmICFnZW1pbmlLZXkpIHtcbiAgICAvLyBPbmx5IEdPT0dMRV9BUElfS0VZIHNldCAoZnJvbSBlbnYgZXhwb3J0KSAtIGNvcHkgdG8gR0VNSU5JX0FQSV9LRVlcbiAgICBwcm9jZXNzLmVudlsnR0VNSU5JX0FQSV9LRVknXSA9IGdvb2dsZUtleTtcbiAgfSBlbHNlIGlmIChnZW1pbmlLZXkgJiYgZ29vZ2xlS2V5ICYmIGdlbWluaUtleSAhPT0gZ29vZ2xlS2V5KSB7XG4gICAgLy8gQm90aCBzZXQgd2l0aCBkaWZmZXJlbnQgdmFsdWVzIC0gcHJlZmVyIEdFTUlOSV9BUElfS0VZICh0aGUgc3RvcmVkIG9uZSlcbiAgICAvLyBhbmQgc3luYyBHT09HTEVfQVBJX0tFWSB0byBtYXRjaFxuICAgIHByb2Nlc3MuZW52WydHT09HTEVfQVBJX0tFWSddID0gZ2VtaW5pS2V5O1xuICB9XG4gIC8vIElmIGJvdGggYXJlIHNldCBhbmQgZXF1YWwsIG5vIGFjdGlvbiBuZWVkZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFNlY3JldFZhbHVlKGlkOiBTZWNyZXROYW1lLCByYXdWYWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gIGNvbnN0IHZhbHVlID0gc2FuaXRpemUocmF3VmFsdWUpO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTZWNyZXQgdmFsdWUgY2Fubm90IGJlIGJsYW5rLicpO1xuICB9XG5cbiAgY29uc3Qgc3RvcmUgPSByZWFkU2VjcmV0U3RvcmUoKTtcbiAgc3RvcmVbaWRdID0gdmFsdWU7XG4gIHdyaXRlU2VjcmV0U3RvcmUoc3RvcmUpO1xuICBwcm9jZXNzLmVudltpZF0gPSB2YWx1ZTtcblxuICAvLyBJZiBzZXR0aW5nIEdFTUlOSV9BUElfS0VZLCBhbHNvIHN5bmMgR09PR0xFX0FQSV9LRVkgZm9yIFNESyBjb21wYXRpYmlsaXR5XG4gIGlmIChpZCA9PT0gJ0dFTUlOSV9BUElfS0VZJykge1xuICAgIHByb2Nlc3MuZW52WydHT09HTEVfQVBJX0tFWSddID0gdmFsdWU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hc2tTZWNyZXQodmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIGlmICghdmFsdWUpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgaWYgKHZhbHVlLmxlbmd0aCA8PSA0KSB7XG4gICAgcmV0dXJuICcqJy5yZXBlYXQodmFsdWUubGVuZ3RoKTtcbiAgfVxuICBjb25zdCBzdWZmaXggPSB2YWx1ZS5zbGljZSgtNCk7XG4gIGNvbnN0IHByZWZpeCA9ICcqJy5yZXBlYXQoTWF0aC5tYXgoMCwgdmFsdWUubGVuZ3RoIC0gNCkpO1xuICByZXR1cm4gYCR7cHJlZml4fSR7c3VmZml4fWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVTZWNyZXRGb3JQcm92aWRlcihwcm92aWRlcjogUHJvdmlkZXJJZCk6IHN0cmluZyB7XG4gIGNvbnN0IGRlZmluaXRpb24gPSBmaW5kRGVmaW5pdGlvbkZvclByb3ZpZGVyKHByb3ZpZGVyKTtcbiAgY29uc3QgdmFsdWUgPSBnZXRTZWNyZXRWYWx1ZShkZWZpbml0aW9uLmlkKTtcbiAgaWYgKCF2YWx1ZSkge1xuICAgIHRocm93IG5ldyBNaXNzaW5nU2VjcmV0RXJyb3IoZGVmaW5pdGlvbik7XG4gIH1cbiAgcHJvY2Vzcy5lbnZbZGVmaW5pdGlvbi5lbnZWYXJdID0gdmFsdWU7XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlY3JldERlZmluaXRpb25Gb3JQcm92aWRlcihwcm92aWRlcjogUHJvdmlkZXJJZCk6IFNlY3JldERlZmluaXRpb24gfCBudWxsIHtcbiAgcmV0dXJuIFNFQ1JFVF9ERUZJTklUSU9OUy5maW5kKChlbnRyeSkgPT4gZW50cnkucHJvdmlkZXJzLmluY2x1ZGVzKHByb3ZpZGVyKSkgPz8gbnVsbDtcbn1cblxuZnVuY3Rpb24gcmVhZFNlY3JldFN0b3JlKCk6IFNlY3JldFN0b3JlRGF0YSB7XG4gIGlmICghZXhpc3RzU3luYyhTRUNSRVRfRklMRSkpIHtcbiAgICByZXR1cm4ge307XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGNvbnRlbnQgPSByZWFkRmlsZVN5bmMoU0VDUkVUX0ZJTEUsICd1dGY4Jyk7XG4gICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgICBpZiAocGFyc2VkICYmIHR5cGVvZiBwYXJzZWQgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm4gcGFyc2VkIGFzIFNlY3JldFN0b3JlRGF0YTtcbiAgICB9XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiB7fTtcbiAgfVxuICByZXR1cm4ge307XG59XG5cbmZ1bmN0aW9uIHdyaXRlU2VjcmV0U3RvcmUoc3RvcmU6IFNlY3JldFN0b3JlRGF0YSk6IHZvaWQge1xuICBjb25zdCBkaXJlY3RvcnkgPSBkaXJuYW1lKFNFQ1JFVF9GSUxFKTtcbiAgbWtkaXJTeW5jKGRpcmVjdG9yeSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShzdG9yZSwgbnVsbCwgMik7XG4gIHdyaXRlRmlsZVN5bmMoU0VDUkVUX0ZJTEUsIGAke3BheWxvYWR9XG5gKTtcbn1cblxuZnVuY3Rpb24gZmluZERlZmluaXRpb25Gb3JQcm92aWRlcihwcm92aWRlcjogUHJvdmlkZXJJZCk6IFNlY3JldERlZmluaXRpb24ge1xuICBjb25zdCBkZWZpbml0aW9uID0gZ2V0U2VjcmV0RGVmaW5pdGlvbkZvclByb3ZpZGVyKHByb3ZpZGVyKTtcbiAgaWYgKCFkZWZpbml0aW9uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBObyBzZWNyZXQgY29uZmlndXJhdGlvbiBmb3IgcHJvdmlkZXIgXCIke3Byb3ZpZGVyfVwiLmApO1xuICB9XG4gIHJldHVybiBkZWZpbml0aW9uO1xufVxuXG5mdW5jdGlvbiBzYW5pdGl6ZSh2YWx1ZTogdW5rbm93bik6IHN0cmluZyB8IG51bGwge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIHJldHVybiB0cmltbWVkLmxlbmd0aCA/IHRyaW1tZWQgOiBudWxsO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTZWNyZXQgU2FuaXRpemF0aW9uIGZvciBFcnJvciBNZXNzYWdlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEtub3duIEFQSSBrZXkgcGF0dGVybnMgdG8gZGV0ZWN0IGFuZCBzYW5pdGl6ZSBpbiBlcnJvciBtZXNzYWdlcy5cbiAqIFRoZXNlIHBhdHRlcm5zIG1hdGNoIGNvbW1vbiBBUEkga2V5IGZvcm1hdHMgZnJvbSB2YXJpb3VzIHByb3ZpZGVycy5cbiAqL1xuY29uc3QgQVBJX0tFWV9QQVRURVJOUzogUmVnRXhwW10gPSBbXG4gIC8vIEFudGhyb3BpYyBBUEkga2V5czogc2stYW50LWFwaTAzLS4uLlxuICAvc2stYW50LWFwaVxcZHsyfS1bQS1aYS16MC05Xy1dezIwLH0vZyxcbiAgLy8gT3BlbkFJIEFQSSBrZXlzOiBzay1wcm9qLS4uLiBvciBzay0uLi5cbiAgL3NrLSg/OnByb2otKT9bQS1aYS16MC05Xy1dezIwLH0vZyxcbiAgLy8gR2VuZXJpYyBCZWFyZXIgdG9rZW5zIGluIGhlYWRlcnNcbiAgL0JlYXJlclxccytbQS1aYS16MC05Xy4tXXsyMCx9L2dpLFxuICAvLyB4LWFwaS1rZXkgaGVhZGVyIHZhbHVlc1xuICAveC1hcGkta2V5WydcIjpcXHNdK1tBLVphLXowLTlfLi1dezIwLH0vZ2ksXG4gIC8vIEFQSSBrZXlzIGluIFVSTHMgKGtleT12YWx1ZSBwYXR0ZXJuKVxuICAvWz8mXSg/OmtleXxhcGlfa2V5fGFwaUtleXxhcGkta2V5fHRva2VufGFjY2Vzc190b2tlbik9KFtBLVphLXowLTlfLi1dezE2LH0pL2dpLFxuICAvLyBEZWVwU2VlayBrZXlzXG4gIC9zay1bYS1mMC05XXszMix9L2dpLFxuICAvLyB4QUkvR3JvayBrZXlzXG4gIC94YWktW0EtWmEtejAtOV8tXXsyMCx9L2dpLFxuICAvLyBHb29nbGUvR2VtaW5pIEFQSSBrZXlzIChBSXphLi4uKVxuICAvQUl6YVtBLVphLXowLTlfLV17MzAsfS9nLFxuICAvLyBHZW5lcmljIGxvbmcgYWxwaGFudW1lcmljIHRva2VucyB0aGF0IGxvb2sgbGlrZSBBUEkga2V5c1xuICAvKD86YXBpW18tXT9rZXl8dG9rZW58c2VjcmV0fHBhc3N3b3JkfGNyZWRlbnRpYWwpWydcIl0/XFxzKls6PV1cXHMqWydcIl0/KFtBLVphLXowLTlfLi1dezIwLH0pWydcIl0/L2dpLFxuXTtcblxuLyoqXG4gKiBTYW5pdGl6ZSBlcnJvciBtZXNzYWdlcyB0byByZW1vdmUgcG90ZW50aWFsIEFQSSBrZXlzIGFuZCBzZWNyZXRzLlxuICogVGhpcyBwcmV2ZW50cyBhY2NpZGVudGFsIHRva2VuIGxlYWthZ2UgaW4gbG9ncywgZXJyb3IgcmVwb3J0cywgYW5kIGNvbnNvbGUgb3V0cHV0LlxuICpcbiAqIEBwYXJhbSBtZXNzYWdlIC0gVGhlIGVycm9yIG1lc3NhZ2Ugb3Igc3RyaW5nIHRvIHNhbml0aXplXG4gKiBAcmV0dXJucyBUaGUgc2FuaXRpemVkIHN0cmluZyB3aXRoIHNlY3JldHMgcmVwbGFjZWQgYnkgW1JFREFDVEVEXVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVFcnJvck1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKCFtZXNzYWdlIHx8IHR5cGVvZiBtZXNzYWdlICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBtZXNzYWdlO1xuICB9XG5cbiAgbGV0IHNhbml0aXplZCA9IG1lc3NhZ2U7XG5cbiAgLy8gQXBwbHkgYWxsIEFQSSBrZXkgcGF0dGVybnNcbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIEFQSV9LRVlfUEFUVEVSTlMpIHtcbiAgICAvLyBSZXNldCBsYXN0SW5kZXggZm9yIGdsb2JhbCBwYXR0ZXJuc1xuICAgIHBhdHRlcm4ubGFzdEluZGV4ID0gMDtcbiAgICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZShwYXR0ZXJuLCAobWF0Y2gpID0+IHtcbiAgICAgIC8vIEZvciBwYXR0ZXJucyB3aXRoIGNhcHR1cmUgZ3JvdXBzLCB0cnkgdG8gcHJlc2VydmUgY29udGV4dFxuICAgICAgaWYgKG1hdGNoLmluY2x1ZGVzKCc9JykgfHwgbWF0Y2guaW5jbHVkZXMoJzonKSkge1xuICAgICAgICBjb25zdCBzZXBhcmF0b3IgPSBtYXRjaC5pbmNsdWRlcygnPScpID8gJz0nIDogJzonO1xuICAgICAgICBjb25zdCBwYXJ0cyA9IG1hdGNoLnNwbGl0KHNlcGFyYXRvcik7XG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICByZXR1cm4gYCR7cGFydHNbMF19JHtzZXBhcmF0b3J9W1JFREFDVEVEXWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiAnW1JFREFDVEVEXSc7XG4gICAgfSk7XG4gIH1cblxuICAvLyBBZGRpdGlvbmFsbHkgc2FuaXRpemUgYW55IGVudiB2YXIgdmFsdWVzIHRoYXQgYXJlIGN1cnJlbnRseSBsb2FkZWRcbiAgc2FuaXRpemVkID0gc2FuaXRpemVBZ2FpbnN0TG9hZGVkU2VjcmV0cyhzYW5pdGl6ZWQpO1xuXG4gIHJldHVybiBzYW5pdGl6ZWQ7XG59XG5cbi8qKlxuICogU2FuaXRpemUgYSBzdHJpbmcgYWdhaW5zdCBjdXJyZW50bHkgbG9hZGVkIHNlY3JldCB2YWx1ZXMuXG4gKiBUaGlzIGNhdGNoZXMgYW55IHNlY3JldHMgdGhhdCBtaWdodCBub3QgbWF0Y2ggdGhlIHBhdHRlcm4tYmFzZWQgZGV0ZWN0aW9uLlxuICovXG5mdW5jdGlvbiBzYW5pdGl6ZUFnYWluc3RMb2FkZWRTZWNyZXRzKG1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHNlY3JldE5hbWVzOiBTZWNyZXROYW1lW10gPSBbXG4gICAgJ09QRU5BSV9BUElfS0VZJyxcbiAgICAnQU5USFJPUElDX0FQSV9LRVknLFxuICAgICdERUVQU0VFS19BUElfS0VZJyxcbiAgICAnWEFJX0FQSV9LRVknLFxuICAgICdHRU1JTklfQVBJX0tFWScsXG4gICAgJ1RBVklMWV9BUElfS0VZJyxcbiAgICAnU01UUF9QQVNTV09SRCcsXG4gIF07XG5cbiAgbGV0IHNhbml0aXplZCA9IG1lc3NhZ2U7XG5cbiAgZm9yIChjb25zdCBuYW1lIG9mIHNlY3JldE5hbWVzKSB7XG4gICAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltuYW1lXTtcbiAgICBpZiAodmFsdWUgJiYgdmFsdWUubGVuZ3RoID49IDQpIHsgLy8gUmVkdWNlZCBmcm9tIDggdG8gY2F0Y2ggc2hvcnRlciBrZXlzXG4gICAgICAvLyBPbmx5IHNhbml0aXplIGlmIHRoZSB2YWx1ZSBhcHBlYXJzIGluIHRoZSBtZXNzYWdlXG4gICAgICAvLyBVc2UgYSBjYXNlLXNlbnNpdGl2ZSBleGFjdCBtYXRjaCB0byBhdm9pZCBmYWxzZSBwb3NpdGl2ZXNcbiAgICAgIGlmIChzYW5pdGl6ZWQuaW5jbHVkZXModmFsdWUpKSB7XG4gICAgICAgIHNhbml0aXplZCA9IHNhbml0aXplZC5zcGxpdCh2YWx1ZSkuam9pbignW1JFREFDVEVEXScpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBbHNvIHNhbml0aXplIHBhcnRpYWwgbWF0Y2hlcyAoZmlyc3QgOCBjaGFycyArIGxhc3QgNCBjaGFycyBwYXR0ZXJuKVxuICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+PSAxMikge1xuICAgICAgICBjb25zdCBwYXJ0aWFsUGF0dGVybiA9IGAke3ZhbHVlLnN1YnN0cmluZygwLCA4KX0uLi4ke3ZhbHVlLnN1YnN0cmluZyh2YWx1ZS5sZW5ndGggLSA0KX1gO1xuICAgICAgICBpZiAoc2FuaXRpemVkLmluY2x1ZGVzKHBhcnRpYWxQYXR0ZXJuKSkge1xuICAgICAgICAgIHNhbml0aXplZCA9IHNhbml0aXplZC5zcGxpdChwYXJ0aWFsUGF0dGVybikuam9pbignW1JFREFDVEVEX1BBUlRJQUxdJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIC8vIEFkZGl0aW9uYWwgT3BlbkFJLXNwZWNpZmljIGtleSBwYXR0ZXJuc1xuICAvLyBPcGVuQUkga2V5czogc2stcHJvai0uLi4sIHNrLS4uLiwgb3JnLS4uLlxuICBjb25zdCBvcGVuYWlLZXlQYXR0ZXJuID0gL3NrLShwcm9qLSk/W2EtekEtWjAtOV17MjAsfS9nO1xuICBzYW5pdGl6ZWQgPSBzYW5pdGl6ZWQucmVwbGFjZShvcGVuYWlLZXlQYXR0ZXJuLCAnW1JFREFDVEVEX09QRU5BSV9LRVldJyk7XG4gIFxuICBjb25zdCBvcGVuYWlPcmdQYXR0ZXJuID0gL29yZy1bYS16QS1aMC05XXsyMCx9L2c7XG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKG9wZW5haU9yZ1BhdHRlcm4sICdbUkVEQUNURURfT1BFTkFJX09SR10nKTtcblxuICByZXR1cm4gc2FuaXRpemVkO1xufVxuXG4vKipcbiAqIFNhbml0aXplIGFuIEVycm9yIG9iamVjdCdzIG1lc3NhZ2UgYW5kIHN0YWNrIHRyYWNlLlxuICogUmV0dXJucyBhIG5ldyBlcnJvciBtZXNzYWdlIHN0cmluZyB3aXRoIHNlY3JldHMgcmVtb3ZlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplRXJyb3IoZXJyb3I6IEVycm9yKTogc3RyaW5nIHtcbiAgY29uc3QgbWVzc2FnZSA9IHNhbml0aXplRXJyb3JNZXNzYWdlKGVycm9yLm1lc3NhZ2UpO1xuICBjb25zdCBzdGFjayA9IGVycm9yLnN0YWNrID8gc2FuaXRpemVFcnJvck1lc3NhZ2UoZXJyb3Iuc3RhY2spIDogJyc7XG5cbiAgaWYgKHN0YWNrICYmIHN0YWNrICE9PSBtZXNzYWdlKSB7XG4gICAgcmV0dXJuIGAke21lc3NhZ2V9XFxuJHtzdGFja31gO1xuICB9XG4gIHJldHVybiBtZXNzYWdlO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIHNhZmUgZXJyb3IgbWVzc2FnZSBmcm9tIGFuIHVua25vd24gZXJyb3IgdmFsdWUuXG4gKiBFbnN1cmVzIG5vIHNlY3JldHMgYXJlIGxlYWtlZCByZWdhcmRsZXNzIG9mIGVycm9yIHR5cGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzYWZlRXJyb3JNZXNzYWdlKGVycm9yOiB1bmtub3duKTogc3RyaW5nIHtcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICByZXR1cm4gc2FuaXRpemVFcnJvck1lc3NhZ2UoZXJyb3IubWVzc2FnZSk7XG4gIH1cbiAgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gc2FuaXRpemVFcnJvck1lc3NhZ2UoZXJyb3IpO1xuICB9XG4gIHJldHVybiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCc7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBRixPQUFBO0FBNkJBLE1BQU1HLGtCQUFzQyxHQUFHLENBQzdDO0VBQ0VDLEVBQUUsRUFBRSxnQkFBZ0I7RUFDcEJDLEtBQUssRUFBRSxnQkFBZ0I7RUFDdkJDLFdBQVcsRUFBRSxpREFBaUQ7RUFDOURDLE1BQU0sRUFBRSxnQkFBZ0I7RUFDeEJDLFNBQVMsRUFBRSxDQUFDLFFBQVE7QUFDdEIsQ0FBQyxFQUNEO0VBQ0VKLEVBQUUsRUFBRSxtQkFBbUI7RUFDdkJDLEtBQUssRUFBRSxtQkFBbUI7RUFDMUJDLFdBQVcsRUFBRSwwREFBMEQ7RUFDdkVDLE1BQU0sRUFBRSxtQkFBbUI7RUFDM0JDLFNBQVMsRUFBRSxDQUFDLFdBQVc7QUFDekIsQ0FBQyxFQUNEO0VBQ0VKLEVBQUUsRUFBRSxrQkFBa0I7RUFDdEJDLEtBQUssRUFBRSxrQkFBa0I7RUFDekJDLFdBQVcsRUFBRSxtREFBbUQ7RUFDaEVDLE1BQU0sRUFBRSxrQkFBa0I7RUFDMUJDLFNBQVMsRUFBRSxDQUFDLFVBQVU7QUFDeEIsQ0FBQyxFQUNEO0VBQ0VKLEVBQUUsRUFBRSxhQUFhO0VBQ2pCQyxL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
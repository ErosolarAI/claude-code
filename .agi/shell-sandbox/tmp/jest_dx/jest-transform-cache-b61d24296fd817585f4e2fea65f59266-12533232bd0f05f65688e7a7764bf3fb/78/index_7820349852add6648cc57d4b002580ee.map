{"version":3,"names":["cov_1kjp7yfxx5","actualCoverage","OpenAIChatCompletionsProvider","registerProvider","withProviderResilience","registered","s","registerXaiProviderPlugin","f","b","config","baseProvider","apiKey","requireEnv","model","baseURL","providerId","timeout","maxRetries","temperature","maxTokens","name","value","process","env","Error"],"sources":["index.ts"],"sourcesContent":["import { OpenAIChatCompletionsProvider } from '../../../providers/openaiChatCompletionsProvider.js';\nimport { registerProvider } from '../../../providers/providerFactory.js';\nimport { withProviderResilience } from '../../../providers/resilientProvider.js';\n\nlet registered = false;\n\n/**\n * xAI (Grok) Provider Plugin\n *\n * Registers the xAI provider with hardened error handling for:\n * - Network failures (premature close, connection reset)\n * - Stream errors (gunzip, decompression failures)\n * - Rate limiting with exponential backoff\n * - Circuit breaker for cascading failure prevention\n */\nexport function registerXaiProviderPlugin(): void {\n  if (registered) {\n    return;\n  }\n\n  registerProvider('xai', (config) => {\n    const baseProvider = new OpenAIChatCompletionsProvider({\n      apiKey: requireEnv('XAI_API_KEY'),\n      model: config.model,\n      baseURL: 'https://api.x.ai/v1',\n      providerId: 'xai',\n      timeout: 120000,\n      maxRetries: 3,\n      ...(typeof config.temperature === 'number' ? { temperature: config.temperature } : {}),\n      ...(typeof config.maxTokens === 'number' ? { maxTokens: config.maxTokens } : {}),\n    });\n\n    // Wrap with resilience layer\n    return withProviderResilience(baseProvider, 'xai');\n  });\n\n  registered = true;\n}\n\nfunction requireEnv(name: string): string {\n  const value = process.env[name];\n  if (!value) {\n    throw new Error(`Missing required environment variable ${name}.`);\n  }\n  return value;\n}\n"],"mappings":"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","ignoreList":[]}
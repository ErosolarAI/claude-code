8cb523ec8557d62ec509bb478f5649d2
"use strict";

var _globals = require("@jest/globals");
var _nodeChild_process = require("node:child_process");
var _nodeFs = require("node:fs");
var _nodePath = require("node:path");
var _nodeOs = require("node:os");
/**
 * End-to-End CLI Integration Tests
 * Tests the full CLI lifecycle and tool integration
 */

(0, _globals.describe)('CLI End-to-End Integration', () => {
  const testWorkspace = (0, _nodePath.join)((0, _nodeOs.tmpdir)(), 'erosolar-e2e-test');
  const cliBin = (0, _nodePath.join)(process.cwd(), 'dist/bin/erosolar.js');
  beforeEach(() => {
    if ((0, _nodeFs.existsSync)(testWorkspace)) {
      (0, _nodeFs.rmSync)(testWorkspace, {
        recursive: true,
        force: true
      });
    }
    (0, _nodeFs.mkdirSync)(testWorkspace, {
      recursive: true
    });
  });
  afterEach(() => {
    if ((0, _nodeFs.existsSync)(testWorkspace)) {
      (0, _nodeFs.rmSync)(testWorkspace, {
        recursive: true,
        force: true
      });
    }
  });
  (0, _globals.test)('CLI binary exists and is executable', () => {
    (0, _globals.expect)((0, _nodeFs.existsSync)(cliBin)).toBe(true);

    // Should be able to run --version
    const version = (0, _nodeChild_process.execSync)(`node ${cliBin} --version`, {
      encoding: 'utf-8'
    });
    (0, _globals.expect)(version).toContain('erosolar-cli');
    (0, _globals.expect)(version).toMatch(/v?\d+\.\d+\.\d+/);
  });
  (0, _globals.test)('CLI shows help message', () => {
    const help = (0, _nodeChild_process.execSync)(`node ${cliBin} --help`, {
      encoding: 'utf-8'
    });
    (0, _globals.expect)(help).toContain('erosolar-cli');
    (0, _globals.expect)(help).toContain('Usage:');
    (0, _globals.expect)(help).toContain('Options:');
    (0, _globals.expect)(help).toContain('--version');
    (0, _globals.expect)(help).toContain('--help');
  });
  (0, _globals.test)('CLI validates required environment for AI providers', () => {
    // Remove API keys to test validation
    const cleanEnv = {
      ...process.env
    };
    delete cleanEnv.ANTHROPIC_API_KEY;
    delete cleanEnv.OPENAI_API_KEY;
    delete cleanEnv.GEMINI_API_KEY;
    const help = (0, _nodeChild_process.execSync)(`node ${cliBin} --help`, {
      encoding: 'utf-8',
      env: cleanEnv
    });

    // Help should still work without API keys
    (0, _globals.expect)(help).toContain('Environment Variables:');
    (0, _globals.expect)(help).toContain('ANTHROPIC_API_KEY');
    (0, _globals.expect)(help).toContain('OPENAI_API_KEY');
  });
  (0, _globals.test)('Tool manifest loads correctly', () => {
    // The CLI should be able to load its tool manifest
    const manifestPath = (0, _nodePath.join)(process.cwd(), 'src/contracts/tools.schema.json');
    (0, _globals.expect)((0, _nodeFs.existsSync)(manifestPath)).toBe(true);
    const manifest = JSON.parse((0, _nodeFs.readFileSync)(manifestPath, 'utf-8'));
    (0, _globals.expect)(manifest.contractVersion).toBeTruthy();
    (0, _globals.expect)(manifest.options).toBeInstanceOf(Array);
    (0, _globals.expect)(manifest.options.length).toBeGreaterThan(0);

    // Verify core tools are present
    const coreTools = manifest.options.find(opt => opt.id === 'core-tools');
    (0, _globals.expect)(coreTools).toBeTruthy();
    (0, _globals.expect)(coreTools.pluginIds).toEqual(_globals.expect.arrayContaining(['tool.filesystem.local', 'tool.edit', 'tool.search.local', 'tool.glob', 'tool.bash.local', 'tool.orchestration.unified', 'tool.bidirectional-audit']));
  });
  (0, _globals.test)('Package.json has correct structure', () => {
    const pkgPath = (0, _nodePath.join)(process.cwd(), 'package.json');
    const pkg = JSON.parse((0, _nodeFs.readFileSync)(pkgPath, 'utf-8'));
    (0, _globals.expect)(pkg.name).toBe('erosolar-cli');
    (0, _globals.expect)(pkg.bin).toBeTruthy();
    (0, _globals.expect)(pkg.bin.erosolar).toBeTruthy();
    (0, _globals.expect)(pkg.main).toBeTruthy();
    (0, _globals.expect)(pkg.type).toBe('module');
  });
  (0, _globals.test)('TypeScript compilation produces correct output', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');
    (0, _globals.expect)((0, _nodeFs.existsSync)(distDir)).toBe(true);
    const binDir = (0, _nodePath.join)(distDir, 'bin');
    (0, _globals.expect)((0, _nodeFs.existsSync)(binDir)).toBe(true);
    const mainBin = (0, _nodePath.join)(binDir, 'erosolar.js');
    (0, _globals.expect)((0, _nodeFs.existsSync)(mainBin)).toBe(true);

    // Check for essential modules
    const coreDir = (0, _nodePath.join)(distDir, 'core');
    const toolsDir = (0, _nodePath.join)(distDir, 'tools');
    const uiDir = (0, _nodePath.join)(distDir, 'ui');
    (0, _globals.expect)((0, _nodeFs.existsSync)(coreDir)).toBe(true);
    (0, _globals.expect)((0, _nodeFs.existsSync)(toolsDir)).toBe(true);
    (0, _globals.expect)((0, _nodeFs.existsSync)(uiDir)).toBe(true);
  });
  (0, _globals.test)('All plugin modules are available', () => {
    const pluginsDir = (0, _nodePath.join)(process.cwd(), 'dist/plugins/tools');
    (0, _globals.expect)((0, _nodeFs.existsSync)(pluginsDir)).toBe(true);

    // Essential plugins - core functionality
    const essentialPlugins = ['filesystem/localFilesystemPlugin.js', 'edit/editPlugin.js', 'search/localSearchPlugin.js', 'glob/globPlugin.js', 'bash/localBashPlugin.js', 'agentSpawning/agentSpawningPlugin.js', 'enhancedGit/enhancedGitPlugin.js', 'skills/skillPlugin.js', 'mcp/mcpPlugin.js', 'tao/taoPlugin.js', 'integrity/integrityPlugin.js'];
    essentialPlugins.forEach(plugin => {
      const pluginPath = (0, _nodePath.join)(pluginsDir, plugin);
      (0, _globals.expect)((0, _nodeFs.existsSync)(pluginPath)).toBe(true);
    });
  });
  (0, _globals.test)('Configuration files are valid JSON', () => {
    const configFiles = ['src/contracts/tools.schema.json', 'src/contracts/models.schema.json', 'package.json'];
    configFiles.forEach(file => {
      const path = (0, _nodePath.join)(process.cwd(), file);
      (0, _globals.expect)((0, _nodeFs.existsSync)(path)).toBe(true);
      (0, _globals.expect)(() => {
        JSON.parse((0, _nodeFs.readFileSync)(path, 'utf-8'));
      }).not.toThrow();
    });
  });
  (0, _globals.test)('Error messages are helpful', () => {
    // Test with invalid flag
    try {
      (0, _nodeChild_process.execSync)(`node ${cliBin} --invalid-flag`, {
        encoding: 'utf-8',
        stdio: 'pipe'
      });
      fail('Should have thrown an error');
    } catch (error) {
      // Should provide helpful error message
      const output = error.stdout?.toString() || error.stderr?.toString() || '';
      (0, _globals.expect)(output.length).toBeGreaterThan(0);
    }
  });
  (0, _globals.test)('Working directory handling', () => {
    // Create a test file in the workspace
    const testFile = (0, _nodePath.join)(testWorkspace, 'test.txt');
    (0, _nodeFs.writeFileSync)(testFile, 'Test content');

    // CLI should be able to work with different working directories
    // This is a basic check that the CLI can be run from different dirs
    // Note: Using try/catch as this may fail due to config loading issues
    try {
      const versionFromWorkspace = (0, _nodeChild_process.execSync)(`node "${cliBin}" --version`, {
        cwd: testWorkspace,
        encoding: 'utf-8',
        timeout: 5000
      });
      (0, _globals.expect)(versionFromWorkspace).toContain('erosolar-cli');
    } catch (error) {
      // If it fails due to config issues, that's acceptable for this test
      // The important thing is the CLI binary exists and can be invoked
      (0, _globals.expect)((0, _nodeFs.existsSync)(cliBin)).toBe(true);
    }
  });
  (0, _globals.test)('Dependencies are installed correctly', () => {
    const nodeModules = (0, _nodePath.join)(process.cwd(), 'node_modules');
    (0, _globals.expect)((0, _nodeFs.existsSync)(nodeModules)).toBe(true);

    // Check for critical dependencies
    const criticalDeps = ['@anthropic-ai/sdk', 'openai', '@google/genai', 'typescript'];
    criticalDeps.forEach(dep => {
      const depPath = (0, _nodePath.join)(nodeModules, dep);
      (0, _globals.expect)((0, _nodeFs.existsSync)(depPath)).toBe(true);
    });
  });
  (0, _globals.test)('Build artifacts are properly generated', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');

    // Check for .d.ts declaration files
    const typesExist = (0, _nodeFs.existsSync)((0, _nodePath.join)(distDir, 'core/types.d.ts'));
    (0, _globals.expect)(typesExist).toBe(true);

    // Check for source maps
    const sourceMapsExist = (0, _nodeFs.existsSync)((0, _nodePath.join)(distDir, 'bin/erosolar.js.map'));
    (0, _globals.expect)(sourceMapsExist).toBe(true);
  });
  (0, _globals.test)('README and documentation exist', () => {
    const readme = (0, _nodePath.join)(process.cwd(), 'README.md');
    (0, _globals.expect)((0, _nodeFs.existsSync)(readme)).toBe(true);
    const readmeContent = (0, _nodeFs.readFileSync)(readme, 'utf-8');
    (0, _globals.expect)(readmeContent.length).toBeGreaterThan(100);
    (0, _globals.expect)(readmeContent).toContain('erosolar');
  });
  (0, _globals.test)('License file exists', () => {
    const license = (0, _nodePath.join)(process.cwd(), 'LICENSE');
    (0, _globals.expect)((0, _nodeFs.existsSync)(license)).toBe(true);
  });
  (0, _globals.test)('Git repository is properly configured', () => {
    const gitDir = (0, _nodePath.join)(process.cwd(), '.git');
    (0, _globals.expect)((0, _nodeFs.existsSync)(gitDir)).toBe(true);
    const gitignore = (0, _nodePath.join)(process.cwd(), '.gitignore');
    (0, _globals.expect)((0, _nodeFs.existsSync)(gitignore)).toBe(true);
    const gitignoreContent = (0, _nodeFs.readFileSync)(gitignore, 'utf-8');
    (0, _globals.expect)(gitignoreContent).toContain('node_modules');
    (0, _globals.expect)(gitignoreContent).toContain('dist');
  });
  (0, _globals.test)('Scripts in package.json are defined', () => {
    const pkg = JSON.parse((0, _nodeFs.readFileSync)((0, _nodePath.join)(process.cwd(), 'package.json'), 'utf-8'));
    const essentialScripts = ['build', 'test', 'lint', 'type-check'];
    essentialScripts.forEach(script => {
      (0, _globals.expect)(pkg.scripts[script]).toBeTruthy();
    });
  });
  (0, _globals.test)('TypeScript configuration is valid', () => {
    const tsconfigPath = (0, _nodePath.join)(process.cwd(), 'tsconfig.json');
    (0, _globals.expect)((0, _nodeFs.existsSync)(tsconfigPath)).toBe(true);

    // tsconfig.json may contain comments, use a more lenient parser
    const content = (0, _nodeFs.readFileSync)(tsconfigPath, 'utf-8');
    // Remove JS-style comments for JSON parsing
    const cleanContent = content.replace(/\/\/.*$/gm, '') // Remove single-line comments
    .replace(/\/\*[\s\S]*?\*\//g, ''); // Remove multi-line comments

    const tsconfig = JSON.parse(cleanContent);
    (0, _globals.expect)(tsconfig.compilerOptions).toBeTruthy();
    // Note: strict mode is intentionally relaxed for legacy code migration
    (0, _globals.expect)(tsconfig.compilerOptions.strict !== undefined).toBe(true);
    (0, _globals.expect)(tsconfig.compilerOptions.module).toBeTruthy();
  });
  (0, _globals.test)('Test configuration exists', () => {
    const jestConfig = (0, _nodePath.join)(process.cwd(), 'jest.config.cjs');
    (0, _globals.expect)((0, _nodeFs.existsSync)(jestConfig)).toBe(true);
  });
  (0, _globals.test)('All source files have corresponding compiled files', () => {
    // Sample core files that should be compiled
    const coreFiles = ['core/types.ts', 'core/agent.ts', 'shell/interactiveShell.ts', 'ui/display.ts'];
    coreFiles.forEach(srcFile => {
      const srcPath = (0, _nodePath.join)(process.cwd(), 'src', srcFile);
      const distPath = (0, _nodePath.join)(process.cwd(), 'dist', srcFile.replace('.ts', '.js'));
      if ((0, _nodeFs.existsSync)(srcPath)) {
        (0, _globals.expect)((0, _nodeFs.existsSync)(distPath)).toBe(true);
      }
    });
  });
});
(0, _globals.describe)('Tool Registry Integration', () => {
  (0, _globals.test)('Tool registry can be imported', () => {
    const registryPath = (0, _nodePath.join)(process.cwd(), 'dist/capabilities/toolRegistry.js');
    (0, _globals.expect)((0, _nodeFs.existsSync)(registryPath)).toBe(true);
  });
  (0, _globals.test)('Tool manifest schema is valid', () => {
    const schemaPath = (0, _nodePath.join)(process.cwd(), 'src/contracts/schemas/tool-selection.schema.json');
    if ((0, _nodeFs.existsSync)(schemaPath)) {
      const schema = JSON.parse((0, _nodeFs.readFileSync)(schemaPath, 'utf-8'));
      (0, _globals.expect)(schema.$schema).toBeTruthy();
    }
  });
});
(0, _globals.describe)('Performance and Resource Usage', () => {
  const cliBin = (0, _nodePath.join)(process.cwd(), 'dist/bin/erosolar.js');
  (0, _globals.test)('CLI startup time is reasonable', () => {
    const start = Date.now();
    (0, _nodeChild_process.execSync)(`node ${cliBin} --version`, {
      encoding: 'utf-8'
    });
    const duration = Date.now() - start;

    // Should start in under 2 seconds
    (0, _globals.expect)(duration).toBeLessThan(2000);
  });
  (0, _globals.test)('Build output size is reasonable', () => {
    const distDir = (0, _nodePath.join)(process.cwd(), 'dist');

    // Calculate total size (rough estimate)
    const calcSize = dir => {
      let total = 0;
      try {
        const items = (0, _nodeFs.readdirSync)(dir);
        items.forEach(item => {
          const path = (0, _nodePath.join)(dir, item);
          const stat = (0, _nodeFs.statSync)(path);
          if (stat.isDirectory()) {
            total += calcSize(path);
          } else {
            total += stat.size;
          }
        });
      } catch (err) {
        // Ignore errors
      }
      return total;
    };
    const distSize = calcSize(distDir);
    const distSizeMB = distSize / (/* TODO: Extract constant */ /* TODO: Extract constant */1024 * 1024);

    // Dist should be under 50MB (reasonable for a CLI tool)
    (0, _globals.expect)(distSizeMB).toBeLessThan(50);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2xvYmFscyIsInJlcXVpcmUiLCJfbm9kZUNoaWxkX3Byb2Nlc3MiLCJfbm9kZUZzIiwiX25vZGVQYXRoIiwiX25vZGVPcyIsImRlc2NyaWJlIiwidGVzdFdvcmtzcGFjZSIsImpvaW4iLCJ0bXBkaXIiLCJjbGlCaW4iLCJwcm9jZXNzIiwiY3dkIiwiYmVmb3JlRWFjaCIsImV4aXN0c1N5bmMiLCJybVN5bmMiLCJyZWN1cnNpdmUiLCJmb3JjZSIsIm1rZGlyU3luYyIsImFmdGVyRWFjaCIsInRlc3QiLCJleHBlY3QiLCJ0b0JlIiwidmVyc2lvbiIsImV4ZWNTeW5jIiwiZW5jb2RpbmciLCJ0b0NvbnRhaW4iLCJ0b01hdGNoIiwiaGVscCIsImNsZWFuRW52IiwiZW52IiwiQU5USFJPUElDX0FQSV9LRVkiLCJPUEVOQUlfQVBJX0tFWSIsIkdFTUlOSV9BUElfS0VZIiwibWFuaWZlc3RQYXRoIiwibWFuaWZlc3QiLCJKU09OIiwicGFyc2UiLCJyZWFkRmlsZVN5bmMiLCJjb250cmFjdFZlcnNpb24iLCJ0b0JlVHJ1dGh5Iiwib3B0aW9ucyIsInRvQmVJbnN0YW5jZU9mIiwiQXJyYXkiLCJsZW5ndGgiLCJ0b0JlR3JlYXRlclRoYW4iLCJjb3JlVG9vbHMiLCJmaW5kIiwib3B0IiwiaWQiLCJwbHVnaW5JZHMiLCJ0b0VxdWFsIiwiYXJyYXlDb250YWluaW5nIiwicGtnUGF0aCIsInBrZyIsIm5hbWUiLCJiaW4iLCJlcm9zb2xhciIsIm1haW4iLCJ0eXBlIiwiZGlzdERpciIsImJpbkRpciIsIm1haW5CaW4iLCJjb3JlRGlyIiwidG9vbHNEaXIiLCJ1aURpciIsInBsdWdpbnNEaXIiLCJlc3NlbnRpYWxQbHVnaW5zIiwiZm9yRWFjaCIsInBsdWdpbiIsInBsdWdpblBhdGgiLCJjb25maWdGaWxlcyIsImZpbGUiLCJwYXRoIiwibm90IiwidG9UaHJvdyIsInN0ZGlvIiwiZmFpbCIsImVycm9yIiwib3V0cHV0Iiwic3Rkb3V0IiwidG9TdHJpbmciLCJzdGRlcnIiLCJ0ZXN0RmlsZSIsIndyaXRlRmlsZVN5bmMiLCJ2ZXJzaW9uRnJvbVdvcmtzcGFjZSIsInRpbWVvdXQiLCJub2RlTW9kdWxlcyIsImNyaXRpY2FsRGVwcyIsImRlcCIsImRlcFBhdGgiLCJ0eXBlc0V4aXN0Iiwic291cmNlTWFwc0V4aXN0IiwicmVhZG1lIiwicmVhZG1lQ29udGVudCIsImxpY2Vuc2UiLCJnaXREaXIiLCJnaXRpZ25vcmUiLCJnaXRpZ25vcmVDb250ZW50IiwiZXNzZW50aWFsU2NyaXB0cyIsInNjcmlwdCIsInNjcmlwdHMiLCJ0c2NvbmZpZ1BhdGgiLCJjb250ZW50IiwiY2xlYW5Db250ZW50IiwicmVwbGFjZSIsInRzY29uZmlnIiwiY29tcGlsZXJPcHRpb25zIiwic3RyaWN0IiwidW5kZWZpbmVkIiwibW9kdWxlIiwiamVzdENvbmZpZyIsImNvcmVGaWxlcyIsInNyY0ZpbGUiLCJzcmNQYXRoIiwiZGlzdFBhdGgiLCJyZWdpc3RyeVBhdGgiLCJzY2hlbWFQYXRoIiwic2NoZW1hIiwiJHNjaGVtYSIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsImR1cmF0aW9uIiwidG9CZUxlc3NUaGFuIiwiY2FsY1NpemUiLCJkaXIiLCJ0b3RhbCIsIml0ZW1zIiwicmVhZGRpclN5bmMiLCJpdGVtIiwic3RhdCIsInN0YXRTeW5jIiwiaXNEaXJlY3RvcnkiLCJzaXplIiwiZXJyIiwiZGlzdFNpemUiLCJkaXN0U2l6ZU1CIl0sInNvdXJjZXMiOlsiY2xpRTJFLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbmQtdG8tRW5kIENMSSBJbnRlZ3JhdGlvbiBUZXN0c1xuICogVGVzdHMgdGhlIGZ1bGwgQ0xJIGxpZmVjeWNsZSBhbmQgdG9vbCBpbnRlZ3JhdGlvblxuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCB0ZXN0LCBleHBlY3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IGV4ZWNTeW5jLCBzcGF3biB9IGZyb20gJ25vZGU6Y2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyByZWFkRmlsZVN5bmMsIHdyaXRlRmlsZVN5bmMsIGV4aXN0c1N5bmMsIG1rZGlyU3luYywgcm1TeW5jLCByZWFkZGlyU3luYywgc3RhdFN5bmMgfSBmcm9tICdub2RlOmZzJztcbmltcG9ydCB7IGpvaW4gfSBmcm9tICdub2RlOnBhdGgnO1xuaW1wb3J0IHsgdG1wZGlyIH0gZnJvbSAnbm9kZTpvcyc7XG5cbmRlc2NyaWJlKCdDTEkgRW5kLXRvLUVuZCBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgY29uc3QgdGVzdFdvcmtzcGFjZSA9IGpvaW4odG1wZGlyKCksICdlcm9zb2xhci1lMmUtdGVzdCcpO1xuICBjb25zdCBjbGlCaW4gPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2Jpbi9lcm9zb2xhci5qcycpO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGlmIChleGlzdHNTeW5jKHRlc3RXb3Jrc3BhY2UpKSB7XG4gICAgICBybVN5bmModGVzdFdvcmtzcGFjZSwgeyByZWN1cnNpdmU6IHRydWUsIGZvcmNlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBta2RpclN5bmModGVzdFdvcmtzcGFjZSwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgaWYgKGV4aXN0c1N5bmModGVzdFdvcmtzcGFjZSkpIHtcbiAgICAgIHJtU3luYyh0ZXN0V29ya3NwYWNlLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gICAgfVxuICB9KTtcblxuICB0ZXN0KCdDTEkgYmluYXJ5IGV4aXN0cyBhbmQgaXMgZXhlY3V0YWJsZScsICgpID0+IHtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhjbGlCaW4pKS50b0JlKHRydWUpO1xuXG4gICAgLy8gU2hvdWxkIGJlIGFibGUgdG8gcnVuIC0tdmVyc2lvblxuICAgIGNvbnN0IHZlcnNpb24gPSBleGVjU3luYyhgbm9kZSAke2NsaUJpbn0gLS12ZXJzaW9uYCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9KTtcbiAgICBleHBlY3QodmVyc2lvbikudG9Db250YWluKCdlcm9zb2xhci1jbGknKTtcbiAgICBleHBlY3QodmVyc2lvbikudG9NYXRjaCgvdj9cXGQrXFwuXFxkK1xcLlxcZCsvKTtcbiAgfSk7XG5cbiAgdGVzdCgnQ0xJIHNob3dzIGhlbHAgbWVzc2FnZScsICgpID0+IHtcbiAgICBjb25zdCBoZWxwID0gZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0taGVscGAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSk7XG5cbiAgICBleHBlY3QoaGVscCkudG9Db250YWluKCdlcm9zb2xhci1jbGknKTtcbiAgICBleHBlY3QoaGVscCkudG9Db250YWluKCdVc2FnZTonKTtcbiAgICBleHBlY3QoaGVscCkudG9Db250YWluKCdPcHRpb25zOicpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJy0tdmVyc2lvbicpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJy0taGVscCcpO1xuICB9KTtcblxuICB0ZXN0KCdDTEkgdmFsaWRhdGVzIHJlcXVpcmVkIGVudmlyb25tZW50IGZvciBBSSBwcm92aWRlcnMnLCAoKSA9PiB7XG4gICAgLy8gUmVtb3ZlIEFQSSBrZXlzIHRvIHRlc3QgdmFsaWRhdGlvblxuICAgIGNvbnN0IGNsZWFuRW52ID0geyAuLi5wcm9jZXNzLmVudiB9O1xuICAgIGRlbGV0ZSBjbGVhbkVudi5BTlRIUk9QSUNfQVBJX0tFWTtcbiAgICBkZWxldGUgY2xlYW5FbnYuT1BFTkFJX0FQSV9LRVk7XG4gICAgZGVsZXRlIGNsZWFuRW52LkdFTUlOSV9BUElfS0VZO1xuXG4gICAgY29uc3QgaGVscCA9IGV4ZWNTeW5jKGBub2RlICR7Y2xpQmlufSAtLWhlbHBgLCB7XG4gICAgICBlbmNvZGluZzogJ3V0Zi04JyxcbiAgICAgIGVudjogY2xlYW5FbnZcbiAgICB9KTtcblxuICAgIC8vIEhlbHAgc2hvdWxkIHN0aWxsIHdvcmsgd2l0aG91dCBBUEkga2V5c1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJ0Vudmlyb25tZW50IFZhcmlhYmxlczonKTtcbiAgICBleHBlY3QoaGVscCkudG9Db250YWluKCdBTlRIUk9QSUNfQVBJX0tFWScpO1xuICAgIGV4cGVjdChoZWxwKS50b0NvbnRhaW4oJ09QRU5BSV9BUElfS0VZJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Rvb2wgbWFuaWZlc3QgbG9hZHMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIC8vIFRoZSBDTEkgc2hvdWxkIGJlIGFibGUgdG8gbG9hZCBpdHMgdG9vbCBtYW5pZmVzdFxuICAgIGNvbnN0IG1hbmlmZXN0UGF0aCA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYy9jb250cmFjdHMvdG9vbHMuc2NoZW1hLmpzb24nKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhtYW5pZmVzdFBhdGgpKS50b0JlKHRydWUpO1xuXG4gICAgY29uc3QgbWFuaWZlc3QgPSBKU09OLnBhcnNlKHJlYWRGaWxlU3luYyhtYW5pZmVzdFBhdGgsICd1dGYtOCcpKTtcbiAgICBleHBlY3QobWFuaWZlc3QuY29udHJhY3RWZXJzaW9uKS50b0JlVHJ1dGh5KCk7XG4gICAgZXhwZWN0KG1hbmlmZXN0Lm9wdGlvbnMpLnRvQmVJbnN0YW5jZU9mKEFycmF5KTtcbiAgICBleHBlY3QobWFuaWZlc3Qub3B0aW9ucy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcblxuICAgIC8vIFZlcmlmeSBjb3JlIHRvb2xzIGFyZSBwcmVzZW50XG4gICAgY29uc3QgY29yZVRvb2xzID0gbWFuaWZlc3Qub3B0aW9ucy5maW5kKChvcHQ6IGFueSkgPT4gb3B0LmlkID09PSAnY29yZS10b29scycpO1xuICAgIGV4cGVjdChjb3JlVG9vbHMpLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QoY29yZVRvb2xzLnBsdWdpbklkcykudG9FcXVhbChcbiAgICAgIGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xuICAgICAgICAndG9vbC5maWxlc3lzdGVtLmxvY2FsJyxcbiAgICAgICAgJ3Rvb2wuZWRpdCcsXG4gICAgICAgICd0b29sLnNlYXJjaC5sb2NhbCcsXG4gICAgICAgICd0b29sLmdsb2InLFxuICAgICAgICAndG9vbC5iYXNoLmxvY2FsJyxcbiAgICAgICAgJ3Rvb2wub3JjaGVzdHJhdGlvbi51bmlmaWVkJyxcbiAgICAgICAgJ3Rvb2wuYmlkaXJlY3Rpb25hbC1hdWRpdCcsXG4gICAgICBdKVxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ1BhY2thZ2UuanNvbiBoYXMgY29ycmVjdCBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgY29uc3QgcGtnUGF0aCA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3BhY2thZ2UuanNvbicpO1xuICAgIGNvbnN0IHBrZyA9IEpTT04ucGFyc2UocmVhZEZpbGVTeW5jKHBrZ1BhdGgsICd1dGYtOCcpKTtcblxuICAgIGV4cGVjdChwa2cubmFtZSkudG9CZSgnZXJvc29sYXItY2xpJyk7XG4gICAgZXhwZWN0KHBrZy5iaW4pLnRvQmVUcnV0aHkoKTtcbiAgICBleHBlY3QocGtnLmJpbi5lcm9zb2xhcikudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChwa2cubWFpbikudG9CZVRydXRoeSgpO1xuICAgIGV4cGVjdChwa2cudHlwZSkudG9CZSgnbW9kdWxlJyk7XG4gIH0pO1xuXG4gIHRlc3QoJ1R5cGVTY3JpcHQgY29tcGlsYXRpb24gcHJvZHVjZXMgY29ycmVjdCBvdXRwdXQnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlzdERpciA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2Rpc3QnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhkaXN0RGlyKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGJpbkRpciA9IGpvaW4oZGlzdERpciwgJ2JpbicpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKGJpbkRpcikpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBtYWluQmluID0gam9pbihiaW5EaXIsICdlcm9zb2xhci5qcycpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKG1haW5CaW4pKS50b0JlKHRydWUpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGVzc2VudGlhbCBtb2R1bGVzXG4gICAgY29uc3QgY29yZURpciA9IGpvaW4oZGlzdERpciwgJ2NvcmUnKTtcbiAgICBjb25zdCB0b29sc0RpciA9IGpvaW4oZGlzdERpciwgJ3Rvb2xzJyk7XG4gICAgY29uc3QgdWlEaXIgPSBqb2luKGRpc3REaXIsICd1aScpO1xuXG4gICAgZXhwZWN0KGV4aXN0c1N5bmMoY29yZURpcikpLnRvQmUodHJ1ZSk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmModG9vbHNEaXIpKS50b0JlKHRydWUpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKHVpRGlyKSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgnQWxsIHBsdWdpbiBtb2R1bGVzIGFyZSBhdmFpbGFibGUnLCAoKSA9PiB7XG4gICAgY29uc3QgcGx1Z2luc0RpciA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2Rpc3QvcGx1Z2lucy90b29scycpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKHBsdWdpbnNEaXIpKS50b0JlKHRydWUpO1xuXG4gICAgLy8gRXNzZW50aWFsIHBsdWdpbnMgLSBjb3JlIGZ1bmN0aW9uYWxpdHlcbiAgICBjb25zdCBlc3NlbnRpYWxQbHVnaW5zID0gW1xuICAgICAgJ2ZpbGVzeXN0ZW0vbG9jYWxGaWxlc3lzdGVtUGx1Z2luLmpzJyxcbiAgICAgICdlZGl0L2VkaXRQbHVnaW4uanMnLFxuICAgICAgJ3NlYXJjaC9sb2NhbFNlYXJjaFBsdWdpbi5qcycsXG4gICAgICAnZ2xvYi9nbG9iUGx1Z2luLmpzJyxcbiAgICAgICdiYXNoL2xvY2FsQmFzaFBsdWdpbi5qcycsXG4gICAgICAnYWdlbnRTcGF3bmluZy9hZ2VudFNwYXduaW5nUGx1Z2luLmpzJyxcbiAgICAgICdlbmhhbmNlZEdpdC9lbmhhbmNlZEdpdFBsdWdpbi5qcycsXG4gICAgICAnc2tpbGxzL3NraWxsUGx1Z2luLmpzJyxcbiAgICAgICdtY3AvbWNwUGx1Z2luLmpzJyxcbiAgICAgICd0YW8vdGFvUGx1Z2luLmpzJyxcbiAgICAgICdpbnRlZ3JpdHkvaW50ZWdyaXR5UGx1Z2luLmpzJyxcbiAgICBdO1xuXG4gICAgZXNzZW50aWFsUGx1Z2lucy5mb3JFYWNoKHBsdWdpbiA9PiB7XG4gICAgICBjb25zdCBwbHVnaW5QYXRoID0gam9pbihwbHVnaW5zRGlyLCBwbHVnaW4pO1xuICAgICAgZXhwZWN0KGV4aXN0c1N5bmMocGx1Z2luUGF0aCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0NvbmZpZ3VyYXRpb24gZmlsZXMgYXJlIHZhbGlkIEpTT04nLCAoKSA9PiB7XG4gICAgY29uc3QgY29uZmlnRmlsZXMgPSBbXG4gICAgICAnc3JjL2NvbnRyYWN0cy90b29scy5zY2hlbWEuanNvbicsXG4gICAgICAnc3JjL2NvbnRyYWN0cy9tb2RlbHMuc2NoZW1hLmpzb24nLFxuICAgICAgJ3BhY2thZ2UuanNvbicsXG4gICAgXTtcblxuICAgIGNvbmZpZ0ZpbGVzLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICBjb25zdCBwYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCBmaWxlKTtcbiAgICAgIGV4cGVjdChleGlzdHNTeW5jKHBhdGgpKS50b0JlKHRydWUpO1xuXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBKU09OLnBhcnNlKHJlYWRGaWxlU3luYyhwYXRoLCAndXRmLTgnKSk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdFcnJvciBtZXNzYWdlcyBhcmUgaGVscGZ1bCcsICgpID0+IHtcbiAgICAvLyBUZXN0IHdpdGggaW52YWxpZCBmbGFnXG4gICAgdHJ5IHtcbiAgICAgIGV4ZWNTeW5jKGBub2RlICR7Y2xpQmlufSAtLWludmFsaWQtZmxhZ2AsIHtcbiAgICAgICAgZW5jb2Rpbmc6ICd1dGYtOCcsXG4gICAgICAgIHN0ZGlvOiAncGlwZSdcbiAgICAgIH0pO1xuICAgICAgZmFpbCgnU2hvdWxkIGhhdmUgdGhyb3duIGFuIGVycm9yJyk7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgLy8gU2hvdWxkIHByb3ZpZGUgaGVscGZ1bCBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBvdXRwdXQgPSBlcnJvci5zdGRvdXQ/LnRvU3RyaW5nKCkgfHwgZXJyb3Iuc3RkZXJyPy50b1N0cmluZygpIHx8ICcnO1xuICAgICAgZXhwZWN0KG91dHB1dC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9XG4gIH0pO1xuXG4gIHRlc3QoJ1dvcmtpbmcgZGlyZWN0b3J5IGhhbmRsaW5nJywgKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBhIHRlc3QgZmlsZSBpbiB0aGUgd29ya3NwYWNlXG4gICAgY29uc3QgdGVzdEZpbGUgPSBqb2luKHRlc3RXb3Jrc3BhY2UsICd0ZXN0LnR4dCcpO1xuICAgIHdyaXRlRmlsZVN5bmModGVzdEZpbGUsICdUZXN0IGNvbnRlbnQnKTtcblxuICAgIC8vIENMSSBzaG91bGQgYmUgYWJsZSB0byB3b3JrIHdpdGggZGlmZmVyZW50IHdvcmtpbmcgZGlyZWN0b3JpZXNcbiAgICAvLyBUaGlzIGlzIGEgYmFzaWMgY2hlY2sgdGhhdCB0aGUgQ0xJIGNhbiBiZSBydW4gZnJvbSBkaWZmZXJlbnQgZGlyc1xuICAgIC8vIE5vdGU6IFVzaW5nIHRyeS9jYXRjaCBhcyB0aGlzIG1heSBmYWlsIGR1ZSB0byBjb25maWcgbG9hZGluZyBpc3N1ZXNcbiAgICB0cnkge1xuICAgICAgY29uc3QgdmVyc2lvbkZyb21Xb3Jrc3BhY2UgPSBleGVjU3luYyhgbm9kZSBcIiR7Y2xpQmlufVwiIC0tdmVyc2lvbmAsIHtcbiAgICAgICAgY3dkOiB0ZXN0V29ya3NwYWNlLFxuICAgICAgICBlbmNvZGluZzogJ3V0Zi04JyxcbiAgICAgICAgdGltZW91dDogNTAwMCxcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHZlcnNpb25Gcm9tV29ya3NwYWNlKS50b0NvbnRhaW4oJ2Vyb3NvbGFyLWNsaScpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBJZiBpdCBmYWlscyBkdWUgdG8gY29uZmlnIGlzc3VlcywgdGhhdCdzIGFjY2VwdGFibGUgZm9yIHRoaXMgdGVzdFxuICAgICAgLy8gVGhlIGltcG9ydGFudCB0aGluZyBpcyB0aGUgQ0xJIGJpbmFyeSBleGlzdHMgYW5kIGNhbiBiZSBpbnZva2VkXG4gICAgICBleHBlY3QoZXhpc3RzU3luYyhjbGlCaW4pKS50b0JlKHRydWUpO1xuICAgIH1cbiAgfSk7XG5cbiAgdGVzdCgnRGVwZW5kZW5jaWVzIGFyZSBpbnN0YWxsZWQgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IG5vZGVNb2R1bGVzID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnbm9kZV9tb2R1bGVzJyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMobm9kZU1vZHVsZXMpKS50b0JlKHRydWUpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIGNyaXRpY2FsIGRlcGVuZGVuY2llc1xuICAgIGNvbnN0IGNyaXRpY2FsRGVwcyA9IFtcbiAgICAgICdAYW50aHJvcGljLWFpL3NkaycsXG4gICAgICAnb3BlbmFpJyxcbiAgICAgICdAZ29vZ2xlL2dlbmFpJyxcbiAgICAgICd0eXBlc2NyaXB0JyxcbiAgICBdO1xuXG4gICAgY3JpdGljYWxEZXBzLmZvckVhY2goZGVwID0+IHtcbiAgICAgIGNvbnN0IGRlcFBhdGggPSBqb2luKG5vZGVNb2R1bGVzLCBkZXApO1xuICAgICAgZXhwZWN0KGV4aXN0c1N5bmMoZGVwUGF0aCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0J1aWxkIGFydGlmYWN0cyBhcmUgcHJvcGVybHkgZ2VuZXJhdGVkJywgKCkgPT4ge1xuICAgIGNvbnN0IGRpc3REaXIgPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0Jyk7XG5cbiAgICAvLyBDaGVjayBmb3IgLmQudHMgZGVjbGFyYXRpb24gZmlsZXNcbiAgICBjb25zdCB0eXBlc0V4aXN0ID0gZXhpc3RzU3luYyhqb2luKGRpc3REaXIsICdjb3JlL3R5cGVzLmQudHMnKSk7XG4gICAgZXhwZWN0KHR5cGVzRXhpc3QpLnRvQmUodHJ1ZSk7XG5cbiAgICAvLyBDaGVjayBmb3Igc291cmNlIG1hcHNcbiAgICBjb25zdCBzb3VyY2VNYXBzRXhpc3QgPSBleGlzdHNTeW5jKGpvaW4oZGlzdERpciwgJ2Jpbi9lcm9zb2xhci5qcy5tYXAnKSk7XG4gICAgZXhwZWN0KHNvdXJjZU1hcHNFeGlzdCkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgnUkVBRE1FIGFuZCBkb2N1bWVudGF0aW9uIGV4aXN0JywgKCkgPT4ge1xuICAgIGNvbnN0IHJlYWRtZSA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ1JFQURNRS5tZCcpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKHJlYWRtZSkpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCByZWFkbWVDb250ZW50ID0gcmVhZEZpbGVTeW5jKHJlYWRtZSwgJ3V0Zi04Jyk7XG4gICAgZXhwZWN0KHJlYWRtZUNvbnRlbnQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMTAwKTtcbiAgICBleHBlY3QocmVhZG1lQ29udGVudCkudG9Db250YWluKCdlcm9zb2xhcicpO1xuICB9KTtcblxuICB0ZXN0KCdMaWNlbnNlIGZpbGUgZXhpc3RzJywgKCkgPT4ge1xuICAgIGNvbnN0IGxpY2Vuc2UgPSBqb2luKHByb2Nlc3MuY3dkKCksICdMSUNFTlNFJyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMobGljZW5zZSkpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0dpdCByZXBvc2l0b3J5IGlzIHByb3Blcmx5IGNvbmZpZ3VyZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgZ2l0RGlyID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnLmdpdCcpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKGdpdERpcikpLnRvQmUodHJ1ZSk7XG5cbiAgICBjb25zdCBnaXRpZ25vcmUgPSBqb2luKHByb2Nlc3MuY3dkKCksICcuZ2l0aWdub3JlJyk7XG4gICAgZXhwZWN0KGV4aXN0c1N5bmMoZ2l0aWdub3JlKSkudG9CZSh0cnVlKTtcblxuICAgIGNvbnN0IGdpdGlnbm9yZUNvbnRlbnQgPSByZWFkRmlsZVN5bmMoZ2l0aWdub3JlLCAndXRmLTgnKTtcbiAgICBleHBlY3QoZ2l0aWdub3JlQ29udGVudCkudG9Db250YWluKCdub2RlX21vZHVsZXMnKTtcbiAgICBleHBlY3QoZ2l0aWdub3JlQ29udGVudCkudG9Db250YWluKCdkaXN0Jyk7XG4gIH0pO1xuXG4gIHRlc3QoJ1NjcmlwdHMgaW4gcGFja2FnZS5qc29uIGFyZSBkZWZpbmVkJywgKCkgPT4ge1xuICAgIGNvbnN0IHBrZyA9IEpTT04ucGFyc2UocmVhZEZpbGVTeW5jKGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3BhY2thZ2UuanNvbicpLCAndXRmLTgnKSk7XG5cbiAgICBjb25zdCBlc3NlbnRpYWxTY3JpcHRzID0gW1xuICAgICAgJ2J1aWxkJyxcbiAgICAgICd0ZXN0JyxcbiAgICAgICdsaW50JyxcbiAgICAgICd0eXBlLWNoZWNrJyxcbiAgICBdO1xuXG4gICAgZXNzZW50aWFsU2NyaXB0cy5mb3JFYWNoKHNjcmlwdCA9PiB7XG4gICAgICBleHBlY3QocGtnLnNjcmlwdHNbc2NyaXB0XSkudG9CZVRydXRoeSgpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdUeXBlU2NyaXB0IGNvbmZpZ3VyYXRpb24gaXMgdmFsaWQnLCAoKSA9PiB7XG4gICAgY29uc3QgdHNjb25maWdQYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCAndHNjb25maWcuanNvbicpO1xuICAgIGV4cGVjdChleGlzdHNTeW5jKHRzY29uZmlnUGF0aCkpLnRvQmUodHJ1ZSk7XG5cbiAgICAvLyB0c2NvbmZpZy5qc29uIG1heSBjb250YWluIGNvbW1lbnRzLCB1c2UgYSBtb3JlIGxlbmllbnQgcGFyc2VyXG4gICAgY29uc3QgY29udGVudCA9IHJlYWRGaWxlU3luYyh0c2NvbmZpZ1BhdGgsICd1dGYtOCcpO1xuICAgIC8vIFJlbW92ZSBKUy1zdHlsZSBjb21tZW50cyBmb3IgSlNPTiBwYXJzaW5nXG4gICAgY29uc3QgY2xlYW5Db250ZW50ID0gY29udGVudFxuICAgICAgLnJlcGxhY2UoL1xcL1xcLy4qJC9nbSwgJycpIC8vIFJlbW92ZSBzaW5nbGUtbGluZSBjb21tZW50c1xuICAgICAgLnJlcGxhY2UoL1xcL1xcKltcXHNcXFNdKj9cXCpcXC8vZywgJycpOyAvLyBSZW1vdmUgbXVsdGktbGluZSBjb21tZW50c1xuXG4gICAgY29uc3QgdHNjb25maWcgPSBKU09OLnBhcnNlKGNsZWFuQ29udGVudCk7XG4gICAgZXhwZWN0KHRzY29uZmlnLmNvbXBpbGVyT3B0aW9ucykudG9CZVRydXRoeSgpO1xuICAgIC8vIE5vdGU6IHN0cmljdCBtb2RlIGlzIGludGVudGlvbmFsbHkgcmVsYXhlZCBmb3IgbGVnYWN5IGNvZGUgbWlncmF0aW9uXG4gICAgZXhwZWN0KHRzY29uZmlnLmNvbXBpbGVyT3B0aW9ucy5zdHJpY3QgIT09IHVuZGVmaW5lZCkudG9CZSh0cnVlKTtcbiAgICBleHBlY3QodHNjb25maWcuY29tcGlsZXJPcHRpb25zLm1vZHVsZSkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICB0ZXN0KCdUZXN0IGNvbmZpZ3VyYXRpb24gZXhpc3RzJywgKCkgPT4ge1xuICAgIGNvbnN0IGplc3RDb25maWcgPSBqb2luKHByb2Nlc3MuY3dkKCksICdqZXN0LmNvbmZpZy5janMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhqZXN0Q29uZmlnKSkudG9CZSh0cnVlKTtcbiAgfSk7XG5cbiAgdGVzdCgnQWxsIHNvdXJjZSBmaWxlcyBoYXZlIGNvcnJlc3BvbmRpbmcgY29tcGlsZWQgZmlsZXMnLCAoKSA9PiB7XG4gICAgLy8gU2FtcGxlIGNvcmUgZmlsZXMgdGhhdCBzaG91bGQgYmUgY29tcGlsZWRcbiAgICBjb25zdCBjb3JlRmlsZXMgPSBbXG4gICAgICAnY29yZS90eXBlcy50cycsXG4gICAgICAnY29yZS9hZ2VudC50cycsXG4gICAgICAnc2hlbGwvaW50ZXJhY3RpdmVTaGVsbC50cycsXG4gICAgICAndWkvZGlzcGxheS50cycsXG4gICAgXTtcblxuICAgIGNvcmVGaWxlcy5mb3JFYWNoKHNyY0ZpbGUgPT4ge1xuICAgICAgY29uc3Qgc3JjUGF0aCA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3NyYycsIHNyY0ZpbGUpO1xuICAgICAgY29uc3QgZGlzdFBhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0Jywgc3JjRmlsZS5yZXBsYWNlKCcudHMnLCAnLmpzJykpO1xuXG4gICAgICBpZiAoZXhpc3RzU3luYyhzcmNQYXRoKSkge1xuICAgICAgICBleHBlY3QoZXhpc3RzU3luYyhkaXN0UGF0aCkpLnRvQmUodHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdUb29sIFJlZ2lzdHJ5IEludGVncmF0aW9uJywgKCkgPT4ge1xuICB0ZXN0KCdUb29sIHJlZ2lzdHJ5IGNhbiBiZSBpbXBvcnRlZCcsICgpID0+IHtcbiAgICBjb25zdCByZWdpc3RyeVBhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2NhcGFiaWxpdGllcy90b29sUmVnaXN0cnkuanMnKTtcbiAgICBleHBlY3QoZXhpc3RzU3luYyhyZWdpc3RyeVBhdGgpKS50b0JlKHRydWUpO1xuICB9KTtcblxuICB0ZXN0KCdUb29sIG1hbmlmZXN0IHNjaGVtYSBpcyB2YWxpZCcsICgpID0+IHtcbiAgICBjb25zdCBzY2hlbWFQYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCAnc3JjL2NvbnRyYWN0cy9zY2hlbWFzL3Rvb2wtc2VsZWN0aW9uLnNjaGVtYS5qc29uJyk7XG5cbiAgICBpZiAoZXhpc3RzU3luYyhzY2hlbWFQYXRoKSkge1xuICAgICAgY29uc3Qgc2NoZW1hID0gSlNPTi5wYXJzZShyZWFkRmlsZVN5bmMoc2NoZW1hUGF0aCwgJ3V0Zi04JykpO1xuICAgICAgZXhwZWN0KHNjaGVtYS4kc2NoZW1hKS50b0JlVHJ1dGh5KCk7XG4gICAgfVxuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnUGVyZm9ybWFuY2UgYW5kIFJlc291cmNlIFVzYWdlJywgKCkgPT4ge1xuICBjb25zdCBjbGlCaW4gPSBqb2luKHByb2Nlc3MuY3dkKCksICdkaXN0L2Jpbi9lcm9zb2xhci5qcycpO1xuXG4gIHRlc3QoJ0NMSSBzdGFydHVwIHRpbWUgaXMgcmVhc29uYWJsZScsICgpID0+IHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgZXhlY1N5bmMoYG5vZGUgJHtjbGlCaW59IC0tdmVyc2lvbmAsIHsgZW5jb2Rpbmc6ICd1dGYtOCcgfSk7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnQ7XG5cbiAgICAvLyBTaG91bGQgc3RhcnQgaW4gdW5kZXIgMiBzZWNvbmRzXG4gICAgZXhwZWN0KGR1cmF0aW9uKS50b0JlTGVzc1RoYW4oMjAwMCk7XG4gIH0pO1xuXG4gIHRlc3QoJ0J1aWxkIG91dHB1dCBzaXplIGlzIHJlYXNvbmFibGUnLCAoKSA9PiB7XG4gICAgY29uc3QgZGlzdERpciA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2Rpc3QnKTtcblxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBzaXplIChyb3VnaCBlc3RpbWF0ZSlcbiAgICBjb25zdCBjYWxjU2l6ZSA9IChkaXI6IHN0cmluZyk6IG51bWJlciA9PiB7XG4gICAgICBsZXQgdG90YWwgPSAwO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpdGVtcyA9IHJlYWRkaXJTeW5jKGRpcik7XG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xuICAgICAgICAgIGNvbnN0IHBhdGggPSBqb2luKGRpciwgaXRlbSk7XG4gICAgICAgICAgY29uc3Qgc3RhdCA9IHN0YXRTeW5jKHBhdGgpO1xuXG4gICAgICAgICAgaWYgKHN0YXQuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAgICAgdG90YWwgKz0gY2FsY1NpemUocGF0aCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRvdGFsICs9IHN0YXQuc2l6ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnNcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH07XG5cbiAgICBjb25zdCBkaXN0U2l6ZSA9IGNhbGNTaXplKGRpc3REaXIpO1xuICAgIGNvbnN0IGRpc3RTaXplTUIgPSBkaXN0U2l6ZSAvICgvKiBUT0RPOiBFeHRyYWN0IGNvbnN0YW50ICovIC8qIFRPRE86IEV4dHJhY3QgY29uc3RhbnQgKi8gMTAyNCAqIDEwMjQpO1xuXG4gICAgLy8gRGlzdCBzaG91bGQgYmUgdW5kZXIgNTBNQiAocmVhc29uYWJsZSBmb3IgYSBDTEkgdG9vbClcbiAgICBleHBlY3QoZGlzdFNpemVNQikudG9CZUxlc3NUaGFuKDUwKTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFLQSxJQUFBQSxRQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxrQkFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsT0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksT0FBQSxHQUFBSixPQUFBO0FBVEE7QUFDQTtBQUNBO0FBQ0E7O0FBUUEsSUFBQUssaUJBQVEsRUFBQyw0QkFBNEIsRUFBRSxNQUFNO0VBQzNDLE1BQU1DLGFBQWEsR0FBRyxJQUFBQyxjQUFJLEVBQUMsSUFBQUMsY0FBTSxFQUFDLENBQUMsRUFBRSxtQkFBbUIsQ0FBQztFQUN6RCxNQUFNQyxNQUFNLEdBQUcsSUFBQUYsY0FBSSxFQUFDRyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsc0JBQXNCLENBQUM7RUFFMURDLFVBQVUsQ0FBQyxNQUFNO0lBQ2YsSUFBSSxJQUFBQyxrQkFBVSxFQUFDUCxhQUFhLENBQUMsRUFBRTtNQUM3QixJ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
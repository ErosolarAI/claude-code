dad5477b52d32069834d85dbaa41c5bc
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.DEFAULT_HUMAN_REWARD_WEIGHTS = void 0;
exports.runDualTournament = runDualTournament;
/**
 * Dual Tournament Engine
 *
 * Shared scoring/ranking utilities used by dual tournaments in both /upgrade and /attack flows.
 * Encodes policy vs evaluator tournaments with human-like reward heuristics and multi-evaluator
 * aggregation to approximate human code review preferences.
 */

const DEFAULT_HUMAN_REWARD_WEIGHTS = exports.DEFAULT_HUMAN_REWARD_WEIGHTS = {
  alpha: 0.6,
  beta: 0.25,
  gamma: 0.15
};
/**
  * Run a dual tournament over candidate patches/agents, combining hard metrics,
  * human-like reward heuristics, and evaluator rankings.
  */
function runDualTournament(task, candidates, options = {}) {
  const maxCandidates = options.maxCandidates ?? 8;
  const boundedCandidates = candidates.slice(0, Math.max(1, maxCandidates));

  // Fast path: single candidate - avoid unnecessary aggregation work
  if (boundedCandidates.length === 1) {
    const solo = boundedCandidates[0];
    const correctness = scoreCorrectness(solo.metrics);
    const quality = scoreQuality(solo.metrics, options.preferSmallerDiff ?? true);
    const learned = scoreLearnedSignals(solo.signals);
    const aggregateScore = combineReward(correctness, quality, learned, options.rewardWeights ?? DEFAULT_HUMAN_REWARD_WEIGHTS);
    const ranked = [{
      candidateId: solo.id,
      aggregateScore,
      humanAccuracy: 1,
      rank: 1,
      correctnessScore: correctness,
      qualityScore: quality,
      learnedScore: learned,
      evaluatorScore: aggregateScore
    }];
    return {
      task,
      ranked,
      pairwise: {},
      evaluatorBreakdown: {}
    };
  }
  const rewardWeights = options.rewardWeights ?? DEFAULT_HUMAN_REWARD_WEIGHTS;
  const evaluatorWeights = new Map();
  for (const evaluator of options.evaluators ?? []) {
    const eloWeight = evaluator.elo ? 1 + Math.max(0, (evaluator.elo - 1200) / 2400) : 1;
    evaluatorWeights.set(evaluator.id, (evaluator.weight ?? 1) * eloWeight);
  }

  // Compute evaluator aggregates and pairwise wins first (needed for composite score)
  const {
    aggregatedEvaluatorScores,
    pairwise,
    evaluatorBreakdown
  } = aggregateEvaluatorScores(boundedCandidates, evaluatorWeights);
  const ranked = boundedCandidates.map(candidate => {
    const correctness = scoreCorrectness(candidate.metrics);
    const quality = scoreQuality(candidate.metrics, options.preferSmallerDiff ?? true);
    const learned = scoreLearnedSignals(candidate.signals);
    const rewardScore = combineReward(correctness, quality, learned, rewardWeights);
    const evaluatorScore = aggregatedEvaluatorScores.get(candidate.id) ?? rewardScore;

    // Combine human-like reward with evaluator aggregate (relative preference)
    const aggregateScore = clamp(0.55 * rewardScore + 0.45 * evaluatorScore);
    return {
      candidateId: candidate.id,
      aggregateScore,
      humanAccuracy: 0,
      rank: 0,
      // set after sorting
      correctnessScore: correctness,
      qualityScore: quality,
      learnedScore: learned,
      evaluatorScore
    };
  });
  ranked.sort((a, b) => b.aggregateScore - a.aggregateScore);
  ranked.forEach((entry, idx) => {
    entry.rank = idx + 1;
    entry.humanAccuracy = computeHumanAccuracy(idx, ranked.length);
  });
  return {
    task,
    ranked,
    pairwise,
    evaluatorBreakdown
  };
}

// ════════════════════════════════════════════════════════════════════════════
// Internal scoring helpers
// ════════════════════════════════════════════════════════════════════════════

function scoreCorrectness(metrics) {
  if (!metrics) return 0.5;
  const execution = metrics.executionSuccess ?? 0;
  const tests = metrics.testsPassed ?? 0;
  const failures = metrics.testsFailed ?? 0;
  const toolSuccess = metrics.toolSuccesses ? Math.min(1, metrics.toolSuccesses / 3) : 0;
  let score = execution * 0.35 + tests * 0.45 + toolSuccess * 0.2;
  if (failures > 0) {
    score -= Math.min(0.35, failures * 0.1);
  }
  return clamp(score);
}
function scoreQuality(metrics, preferSmallerDiff = true) {
  if (!metrics) return 0.5;
  const staticAnalysis = metrics.staticAnalysis ?? 0.5;
  const codeQuality = metrics.codeQuality ?? 0.5;
  const complexityComponent = typeof metrics.complexityDelta === 'number' ? metrics.complexityDelta < 0 ? 0.7 : 0.45 : 0.55;
  const blastRadius = metrics.blastRadius ?? (preferSmallerDiff && metrics.diffSize ? 1 - clamp(metrics.diffSize / 500) : 0.55);
  const dependencyPenalty = metrics.dependenciesAdded ? Math.min(0.3, metrics.dependenciesAdded * 0.05) : 0;
  const warningPenalty = metrics.warnings ? Math.min(0.2, metrics.warnings * 0.05) : 0;
  let score = staticAnalysis * 0.35 + codeQuality * 0.25 + blastRadius * 0.25 + complexityComponent * 0.15;
  score -= dependencyPenalty + warningPenalty;
  return clamp(score);
}
function scoreLearnedSignals(signals) {
  if (!signals) return 0.5;
  const rewardModel = signals.rewardModelScore;
  const human = signals.humanPreference;
  const self = signals.selfAssessment;
  const base = typeof rewardModel === 'number' ? rewardModel : 0.5;
  const blendedHuman = typeof human === 'number' ? (base + human) / 2 : base;
  const withSelf = typeof self === 'number' ? 0.7 * blendedHuman + 0.3 * self : blendedHuman;
  return clamp(withSelf);
}
function combineReward(correctness, quality, learned, weights) {
  const weighted = weights.alpha * correctness + weights.beta * quality + weights.gamma * learned;
  const total = weights.alpha + weights.beta + weights.gamma;
  return total > 0 ? clamp(weighted / total) : clamp(weighted);
}
function aggregateEvaluatorScores(candidates, evaluatorWeights) {
  const pairwise = {};
  const aggregated = new Map();
  const evaluatorBreakdown = {};
  if (candidates.length === 0) {
    return {
      aggregatedEvaluatorScores: aggregated,
      pairwise,
      evaluatorBreakdown
    };
  }

  // Pre-size for small tournaments to avoid unnecessary O(n^2) when not needed
  const twoCandidateFastPath = candidates.length <= 2;
  const candidateIds = candidates.map(c => c.id);
  for (const id of candidateIds) {
    pairwise[id] = {};
    for (const other of candidateIds) {
      if (id !== other) pairwise[id][other] = 0;
    }
  }

  // Collect scores per evaluator
  const scoresByEvaluator = new Map();
  for (const candidate of candidates) {
    for (const score of candidate.evaluatorScores ?? []) {
      if (!scoresByEvaluator.has(score.evaluatorId)) {
        scoresByEvaluator.set(score.evaluatorId, []);
      }
      scoresByEvaluator.get(score.evaluatorId).push({
        evaluatorId: score.evaluatorId,
        score: clamp(score.score),
        weight: score.weight,
        notes: score.notes,
        candidateId: candidate.id
      });
    }
  }

  // If no evaluator scores provided, fall back to neutral rankings
  if (scoresByEvaluator.size === 0) {
    const fallback = [];
    for (const candidate of candidates) {
      fallback.push({
        evaluatorId: 'reward-fallback',
        score: 0.5,
        weight: 1,
        candidateId: candidate.id
      });
    }
    scoresByEvaluator.set('reward-fallback', fallback);
  }
  let totalBordaWeight = 0;
  for (const [evaluatorId, rawScores] of scoresByEvaluator.entries()) {
    const weight = evaluatorWeights.get(evaluatorId) ?? 1;
    totalBordaWeight += weight * Math.max(1, candidates.length - 1);

    // Sort descending by score to assign ranks (Borda)
    const ranked = rawScores.filter(entry => typeof entry.score === 'number').sort((a, b) => (b.score ?? 0) - (a.score ?? 0));
    evaluatorBreakdown[evaluatorId] = ranked.map(({
      candidateId,
      ...rest
    }) => rest);
    ranked.forEach((entry, idx) => {
      const candidateId = entry.candidateId;
      const bordaPoints = (candidates.length - idx - 1) * weight;
      aggregated.set(candidateId, (aggregated.get(candidateId) ?? 0) + bordaPoints);
    });

    // Pairwise wins for this evaluator (lightweight path for <=2 candidates)
    if (twoCandidateFastPath && ranked.length === 2) {
      const higher = ranked[0];
      const lower = ranked[1];
      if (higher.score === lower.score) {
        pairwise[higher.candidateId][lower.candidateId] += weight * 0.5;
        pairwise[lower.candidateId][higher.candidateId] += weight * 0.5;
      } else {
        pairwise[higher.candidateId][lower.candidateId] += weight;
      }
    } else {
      for (let i = 0; i < ranked.length; i++) {
        for (let j = i + 1; j < ranked.length; j++) {
          const higher = ranked[i];
          const lower = ranked[j];
          if (higher.score === lower.score) {
            pairwise[higher.candidateId][lower.candidateId] += weight * 0.5;
            pairwise[lower.candidateId][higher.candidateId] += weight * 0.5;
          } else {
            pairwise[higher.candidateId][lower.candidateId] += weight;
          }
        }
      }
    }
  }

  // Normalize aggregated Borda scores into [0,1]
  if (totalBordaWeight > 0) {
    for (const [candidateId, points] of aggregated.entries()) {
      aggregated.set(candidateId, clamp(points / totalBordaWeight));
    }
  }

  // Ensure every candidate has an entry
  for (const candidateId of candidateIds) {
    if (!aggregated.has(candidateId)) {
      aggregated.set(candidateId, 0.5);
    }
  }
  return {
    aggregatedEvaluatorScores: aggregated,
    pairwise,
    evaluatorBreakdown
  };
}
function clamp(value, min = 0, max = 1) {
  if (Number.isNaN(value)) return min;
  return Math.max(min, Math.min(max, value));
}
function computeHumanAccuracy(rankIndex, total) {
  if (total <= 1) return 1;
  const maxIndex = Math.max(1, total - 1);
  const relative = 1 - rankIndex / maxIndex;
  return clamp(relative);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJERUZBVUxUX0hVTUFOX1JFV0FSRF9XRUlHSFRTIiwiZXhwb3J0cyIsImFscGhhIiwiYmV0YSIsImdhbW1hIiwicnVuRHVhbFRvdXJuYW1lbnQiLCJ0YXNrIiwiY2FuZGlkYXRlcyIsIm9wdGlvbnMiLCJtYXhDYW5kaWRhdGVzIiwiYm91bmRlZENhbmRpZGF0ZXMiLCJzbGljZSIsIk1hdGgiLCJtYXgiLCJsZW5ndGgiLCJzb2xvIiwiY29ycmVjdG5lc3MiLCJzY29yZUNvcnJlY3RuZXNzIiwibWV0cmljcyIsInF1YWxpdHkiLCJzY29yZVF1YWxpdHkiLCJwcmVmZXJTbWFsbGVyRGlmZiIsImxlYXJuZWQiLCJzY29yZUxlYXJuZWRTaWduYWxzIiwic2lnbmFscyIsImFnZ3JlZ2F0ZVNjb3JlIiwiY29tYmluZVJld2FyZCIsInJld2FyZFdlaWdodHMiLCJyYW5rZWQiLCJjYW5kaWRhdGVJZCIsImlkIiwiaHVtYW5BY2N1cmFjeSIsInJhbmsiLCJjb3JyZWN0bmVzc1Njb3JlIiwicXVhbGl0eVNjb3JlIiwibGVhcm5lZFNjb3JlIiwiZXZhbHVhdG9yU2NvcmUiLCJwYWlyd2lzZSIsImV2YWx1YXRvckJyZWFrZG93biIsImV2YWx1YXRvcldlaWdodHMiLCJNYXAiLCJldmFsdWF0b3IiLCJldmFsdWF0b3JzIiwiZWxvV2VpZ2h0IiwiZWxvIiwic2V0Iiwid2VpZ2h0IiwiYWdncmVnYXRlZEV2YWx1YXRvclNjb3JlcyIsImFnZ3JlZ2F0ZUV2YWx1YXRvclNjb3JlcyIsIm1hcCIsImNhbmRpZGF0ZSIsInJld2FyZFNjb3JlIiwiZ2V0IiwiY2xhbXAiLCJzb3J0IiwiYSIsImIiLCJmb3JFYWNoIiwiZW50cnkiLCJpZHgiLCJjb21wdXRlSHVtYW5BY2N1cmFjeSIsImV4ZWN1dGlvbiIsImV4ZWN1dGlvblN1Y2Nlc3MiLCJ0ZXN0cyIsInRlc3RzUGFzc2VkIiwiZmFpbHVyZXMiLCJ0ZXN0c0ZhaWxlZCIsInRvb2xTdWNjZXNzIiwidG9vbFN1Y2Nlc3NlcyIsIm1pbiIsInNjb3JlIiwic3RhdGljQW5hbHlzaXMiLCJjb2RlUXVhbGl0eSIsImNvbXBsZXhpdHlDb21wb25lbnQiLCJjb21wbGV4aXR5RGVsdGEiLCJibGFzdFJhZGl1cyIsImRpZmZTaXplIiwiZGVwZW5kZW5jeVBlbmFsdHkiLCJkZXBlbmRlbmNpZXNBZGRlZCIsIndhcm5pbmdQZW5hbHR5Iiwid2FybmluZ3MiLCJyZXdhcmRNb2RlbCIsInJld2FyZE1vZGVsU2NvcmUiLCJodW1hbiIsImh1bWFuUHJlZmVyZW5jZSIsInNlbGYiLCJzZWxmQXNzZXNzbWVudCIsImJhc2UiLCJibGVuZGVkSHVtYW4iLCJ3aXRoU2VsZiIsIndlaWdodHMiLCJ3ZWlnaHRlZCIsInRvdGFsIiwiYWdncmVnYXRlZCIsInR3b0NhbmRpZGF0ZUZhc3RQYXRoIiwiY2FuZGlkYXRlSWRzIiwiYyIsIm90aGVyIiwic2NvcmVzQnlFdmFsdWF0b3IiLCJldmFsdWF0b3JTY29yZXMiLCJoYXMiLCJldmFsdWF0b3JJZCIsInB1c2giLCJub3RlcyIsInNpemUiLCJmYWxsYmFjayIsInRvdGFsQm9yZGFXZWlnaHQiLCJyYXdTY29yZXMiLCJlbnRyaWVzIiwiZmlsdGVyIiwicmVzdCIsImJvcmRhUG9pbnRzIiwiaGlnaGVyIiwibG93ZXIiLCJpIiwiaiIsInBvaW50cyIsInZhbHVlIiwiTnVtYmVyIiwiaXNOYU4iLCJyYW5rSW5kZXgiLCJtYXhJbmRleCIsInJlbGF0aXZlIl0sInNvdXJjZXMiOlsiZHVhbFRvdXJuYW1lbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEdWFsIFRvdXJuYW1lbnQgRW5naW5lXG4gKlxuICogU2hhcmVkIHNjb3JpbmcvcmFua2luZyB1dGlsaXRpZXMgdXNlZCBieSBkdWFsIHRvdXJuYW1lbnRzIGluIGJvdGggL3VwZ3JhZGUgYW5kIC9hdHRhY2sgZmxvd3MuXG4gKiBFbmNvZGVzIHBvbGljeSB2cyBldmFsdWF0b3IgdG91cm5hbWVudHMgd2l0aCBodW1hbi1saWtlIHJld2FyZCBoZXVyaXN0aWNzIGFuZCBtdWx0aS1ldmFsdWF0b3JcbiAqIGFnZ3JlZ2F0aW9uIHRvIGFwcHJveGltYXRlIGh1bWFuIGNvZGUgcmV2aWV3IHByZWZlcmVuY2VzLlxuICovXG5cbmV4cG9ydCB0eXBlIFBvbGljeUlkID0gc3RyaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRvdXJuYW1lbnRQb2xpY3kge1xuICBpZDogUG9saWN5SWQ7XG4gIGxhYmVsPzogc3RyaW5nO1xuICBraW5kPzogJ3ByaW1hcnknIHwgJ3JlZmluZXInIHwgJ2NoZWNrcG9pbnQnIHwgJ2F0dGFjayc7XG4gIGVsbz86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3VybmFtZW50RXZhbHVhdG9yIHtcbiAgaWQ6IHN0cmluZztcbiAgbGFiZWw/OiBzdHJpbmc7XG4gIC8qKiBXZWlnaHQgdXNlZCB3aGVuIGNvbWJpbmluZyBldmFsdWF0b3IgcmFua2luZ3MgKGNhbiBiZSBpbmZsdWVuY2VkIGJ5IGhpc3RvcmljYWwgRUxPKS4gKi9cbiAgd2VpZ2h0PzogbnVtYmVyO1xuICBraW5kPzogJ2hhcmQnIHwgJ3NvZnQnIHwgJ2h5YnJpZCc7XG4gIGVsbz86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3VybmFtZW50VGFzayB7XG4gIGlkOiBzdHJpbmc7XG4gIGdvYWw6IHN0cmluZztcbiAgcmVwb1NuYXBzaG90Pzogc3RyaW5nO1xuICB0ZXN0cz86IHN0cmluZ1tdO1xuICBjb25zdHJhaW50cz86IHN0cmluZ1tdO1xuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhbmRpZGF0ZU1ldHJpY3Mge1xuICBleGVjdXRpb25TdWNjZXNzPzogbnVtYmVyOyAvLyAwLTFcbiAgdGVzdHNQYXNzZWQ/OiBudW1iZXI7IC8vIDAtMVxuICB0ZXN0c0ZhaWxlZD86IG51bWJlcjsgLy8gY291bnRcbiAgc3RhdGljQW5hbHlzaXM/OiBudW1iZXI7IC8vIDAtMVxuICBjb2RlUXVhbGl0eT86IG51bWJlcjsgLy8gMC0xXG4gIGJsYXN0UmFkaXVzPzogbnVtYmVyOyAvLyAwLTEgKHNtYWxsZXIgZGlmZiA9PiBoaWdoZXIpXG4gIGRpZmZTaXplPzogbnVtYmVyOyAvLyBsaW5lcyBjaGFuZ2VkXG4gIGNvbXBsZXhpdHlEZWx0YT86IG51bWJlcjsgLy8gbmVnYXRpdmUgYmV0dGVyXG4gIGRlcGVuZGVuY2llc0FkZGVkPzogbnVtYmVyOyAvLyBjb3VudFxuICBzcGVlZEJvbnVzPzogbnVtYmVyOyAvLyAwLTFcbiAgdG9vbFN1Y2Nlc3Nlcz86IG51bWJlcjsgLy8gY291bnRcbiAgdG9vbEZhaWx1cmVzPzogbnVtYmVyOyAvLyBjb3VudFxuICB3YXJuaW5ncz86IG51bWJlcjsgLy8gY291bnRcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYW5kaWRhdGVTaWduYWxzIHtcbiAgLyoqIExlYXJuZWQgcmV3YXJkIG1vZGVsIC8gcHJlZmVyZW5jZSBzY29yZSAoMC0xKSAqL1xuICByZXdhcmRNb2RlbFNjb3JlPzogbnVtYmVyO1xuICAvKiogU2VsZi1hc3Nlc3NlZCBjb25maWRlbmNlIGZyb20gdGhlIGFnZW50ICgwLTEpICovXG4gIHNlbGZBc3Nlc3NtZW50PzogbnVtYmVyO1xuICAvKiogT3B0aW9uYWwgaHVtYW4gcHJlZmVyZW5jZSBsYWJlbCAoMC0xKSAqL1xuICBodW1hblByZWZlcmVuY2U/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZhbHVhdG9yU2NvcmUge1xuICBldmFsdWF0b3JJZDogc3RyaW5nO1xuICBzY29yZTogbnVtYmVyO1xuICB3ZWlnaHQ/OiBudW1iZXI7XG4gIG5vdGVzPzogc3RyaW5nO1xufVxuXG50eXBlIENhbmRpZGF0ZUV2YWx1YXRvclNjb3JlID0gRXZhbHVhdG9yU2NvcmUgJiB7IGNhbmRpZGF0ZUlkOiBzdHJpbmcgfTtcblxuZXhwb3J0IGludGVyZmFjZSBUb3VybmFtZW50Q2FuZGlkYXRlIHtcbiAgaWQ6IHN0cmluZztcbiAgcG9saWN5SWQ6IFBvbGljeUlkO1xuICBwYXRjaFN1bW1hcnk/OiBzdHJpbmc7XG4gIGRpZmZTdW1tYXJ5Pzogc3RyaW5nO1xuICBtZXRyaWNzPzogQ2FuZGlkYXRlTWV0cmljcztcbiAgc2lnbmFscz86IENhbmRpZGF0ZVNpZ25hbHM7XG4gIGV2YWx1YXRvclNjb3Jlcz86IEV2YWx1YXRvclNjb3JlW107XG4gIHJhd091dHB1dD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBIdW1hblJld2FyZFdlaWdodHMge1xuICAvKiogQ29ycmVjdG5lc3Mgd2VpZ2h0ICovXG4gIGFscGhhOiBudW1iZXI7XG4gIC8qKiBDb2RlIHF1YWxpdHkgLyByb2J1c3RuZXNzIHdlaWdodCAqL1xuICBiZXRhOiBudW1iZXI7XG4gIC8qKiBMZWFybmVkIHJld2FyZCAvIGh1bWFuIHByZWZlcmVuY2Ugd2VpZ2h0ICovXG4gIGdhbW1hOiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0hVTUFOX1JFV0FSRF9XRUlHSFRTOiBIdW1hblJld2FyZFdlaWdodHMgPSB7XG4gIGFscGhhOiAwLjYsXG4gIGJldGE6IDAuMjUsXG4gIGdhbW1hOiAwLjE1LFxufTtcblxuZXhwb3J0IGludGVyZmFjZSBSYW5rZWRDYW5kaWRhdGUge1xuICBjYW5kaWRhdGVJZDogc3RyaW5nO1xuICBhZ2dyZWdhdGVTY29yZTogbnVtYmVyO1xuICAvKiogUmVsYXRpdmUgaHVtYW4tbGlrZSBhY2N1cmFjeSAoMSA9IGJlc3QgcmFuaywgMCA9IHdvcnN0IHJhbmspICovXG4gIGh1bWFuQWNjdXJhY3k6IG51bWJlcjtcbiAgcmFuazogbnVtYmVyO1xuICBjb3JyZWN0bmVzc1Njb3JlOiBudW1iZXI7XG4gIHF1YWxpdHlTY29yZTogbnVtYmVyO1xuICBsZWFybmVkU2NvcmU6IG51bWJlcjtcbiAgZXZhbHVhdG9yU2NvcmU6IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgUGFpcndpc2VXaW5zID0gUmVjb3JkPHN0cmluZywgUmVjb3JkPHN0cmluZywgbnVtYmVyPj47XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG91cm5hbWVudE91dGNvbWUge1xuICB0YXNrOiBUb3VybmFtZW50VGFzaztcbiAgcmFua2VkOiBSYW5rZWRDYW5kaWRhdGVbXTtcbiAgcGFpcndpc2U6IFBhaXJ3aXNlV2lucztcbiAgZXZhbHVhdG9yQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBFdmFsdWF0b3JTY29yZVtdPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3VybmFtZW50T3B0aW9ucyB7XG4gIHJld2FyZFdlaWdodHM/OiBIdW1hblJld2FyZFdlaWdodHM7XG4gIGV2YWx1YXRvcnM/OiBUb3VybmFtZW50RXZhbHVhdG9yW107XG4gIC8qKiBXaGVuIHRydWUsIHByZWZlciBzbWFsbGVyIGRpZmZzIGJ5IGRlZmF1bHQgaWYgZGlmZlNpemUgaXMgcHJvdmlkZWQgKi9cbiAgcHJlZmVyU21hbGxlckRpZmY/OiBib29sZWFuO1xuICAvKiogTWF4aW11bSBjYW5kaWRhdGVzIHRvIGV2YWx1YXRlIChjYXBzIE8obl4yKSB3b3JrKSAqL1xuICBtYXhDYW5kaWRhdGVzPzogbnVtYmVyO1xufVxuXG4vKipcbiAgKiBSdW4gYSBkdWFsIHRvdXJuYW1lbnQgb3ZlciBjYW5kaWRhdGUgcGF0Y2hlcy9hZ2VudHMsIGNvbWJpbmluZyBoYXJkIG1ldHJpY3MsXG4gICogaHVtYW4tbGlrZSByZXdhcmQgaGV1cmlzdGljcywgYW5kIGV2YWx1YXRvciByYW5raW5ncy5cbiAgKi9cbmV4cG9ydCBmdW5jdGlvbiBydW5EdWFsVG91cm5hbWVudChcbiAgdGFzazogVG91cm5hbWVudFRhc2ssXG4gIGNhbmRpZGF0ZXM6IFRvdXJuYW1lbnRDYW5kaWRhdGVbXSxcbiAgb3B0aW9uczogVG91cm5hbWVudE9wdGlvbnMgPSB7fVxuKTogVG91cm5hbWVudE91dGNvbWUge1xuICBjb25zdCBtYXhDYW5kaWRhdGVzID0gb3B0aW9ucy5tYXhDYW5kaWRhdGVzID8/IDg7XG4gIGNvbnN0IGJvdW5kZWRDYW5kaWRhdGVzID0gY2FuZGlkYXRlcy5zbGljZSgwLCBNYXRoLm1heCgxLCBtYXhDYW5kaWRhdGVzKSk7XG5cbiAgLy8gRmFzdCBwYXRoOiBzaW5nbGUgY2FuZGlkYXRlIC0gYXZvaWQgdW5uZWNlc3NhcnkgYWdncmVnYXRpb24gd29ya1xuICBpZiAoYm91bmRlZENhbmRpZGF0ZXMubGVuZ3RoID09PSAxKSB7XG4gICAgY29uc3Qgc29sbyA9IGJvdW5kZWRDYW5kaWRhdGVzWzBdITtcbiAgICBjb25zdCBjb3JyZWN0bmVzcyA9IHNjb3JlQ29ycmVjdG5lc3Moc29sby5tZXRyaWNzKTtcbiAgICBjb25zdCBxdWFsaXR5ID0gc2NvcmVRdWFsaXR5KHNvbG8ubWV0cmljcywgb3B0aW9ucy5wcmVmZXJTbWFsbGVyRGlmZiA/PyB0cnVlKTtcbiAgICBjb25zdCBsZWFybmVkID0gc2NvcmVMZWFybmVkU2lnbmFscyhzb2xvLnNpZ25hbHMpO1xuICAgIGNvbnN0IGFnZ3JlZ2F0ZVNjb3JlID0gY29tYmluZVJld2FyZChjb3JyZWN0bmVzcywgcXVhbGl0eSwgbGVhcm5lZCwgb3B0aW9ucy5yZXdhcmRXZWlnaHRzID8/IERFRkFVTFRfSFVNQU5fUkVXQVJEX1dFSUdIVFMpO1xuXG4gICAgY29uc3QgcmFua2VkOiBSYW5rZWRDYW5kaWRhdGVbXSA9IFt7XG4gICAgICBjYW5kaWRhdGVJZDogc29sby5pZCxcbiAgICAgIGFnZ3JlZ2F0ZVNjb3JlLFxuICAgICAgaHVtYW5BY2N1cmFjeTogMSxcbiAgICAgIHJhbms6IDEsXG4gICAgICBjb3JyZWN0bmVzc1Njb3JlOiBjb3JyZWN0bmVzcyxcbiAgICAgIHF1YWxpdHlTY29yZTogcXVhbGl0eSxcbiAgICAgIGxlYXJuZWRTY29yZTogbGVhcm5lZCxcbiAgICAgIGV2YWx1YXRvclNjb3JlOiBhZ2dyZWdhdGVTY29yZSxcbiAgICB9XTtcblxuICAgIHJldHVybiB7XG4gICAgICB0YXNrLFxuICAgICAgcmFua2VkLFxuICAgICAgcGFpcndpc2U6IHt9LFxuICAgICAgZXZhbHVhdG9yQnJlYWtkb3duOiB7fSxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcmV3YXJkV2VpZ2h0cyA9IG9wdGlvbnMucmV3YXJkV2VpZ2h0cyA/PyBERUZBVUxUX0hVTUFOX1JFV0FSRF9XRUlHSFRTO1xuICBjb25zdCBldmFsdWF0b3JXZWlnaHRzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgZm9yIChjb25zdCBldmFsdWF0b3Igb2Ygb3B0aW9ucy5ldmFsdWF0b3JzID8/IFtdKSB7XG4gICAgY29uc3QgZWxvV2VpZ2h0ID0gZXZhbHVhdG9yLmVsbyA/IDEgKyBNYXRoLm1heCgwLCAoZXZhbHVhdG9yLmVsbyAtIDEyMDApIC8gMjQwMCkgOiAxO1xuICAgIGV2YWx1YXRvcldlaWdodHMuc2V0KGV2YWx1YXRvci5pZCwgKGV2YWx1YXRvci53ZWlnaHQgPz8gMSkgKiBlbG9XZWlnaHQpO1xuICB9XG5cbiAgLy8gQ29tcHV0ZSBldmFsdWF0b3IgYWdncmVnYXRlcyBhbmQgcGFpcndpc2Ugd2lucyBmaXJzdCAobmVlZGVkIGZvciBjb21wb3NpdGUgc2NvcmUpXG4gIGNvbnN0IHsgYWdncmVnYXRlZEV2YWx1YXRvclNjb3JlcywgcGFpcndpc2UsIGV2YWx1YXRvckJyZWFrZG93biB9ID0gYWdncmVnYXRlRXZhbHVhdG9yU2NvcmVzKFxuICAgIGJvdW5kZWRDYW5kaWRhdGVzLFxuICAgIGV2YWx1YXRvcldlaWdodHNcbiAgKTtcblxuICBjb25zdCByYW5rZWQ6IFJhbmtlZENhbmRpZGF0ZVtdID0gYm91bmRlZENhbmRpZGF0ZXMubWFwKChjYW5kaWRhdGUpID0+IHtcbiAgICBjb25zdCBjb3JyZWN0bmVzcyA9IHNjb3JlQ29ycmVjdG5lc3MoY2FuZGlkYXRlLm1ldHJpY3MpO1xuICAgIGNvbnN0IHF1YWxpdHkgPSBzY29yZVF1YWxpdHkoY2FuZGlkYXRlLm1ldHJpY3MsIG9wdGlvbnMucHJlZmVyU21hbGxlckRpZmYgPz8gdHJ1ZSk7XG4gICAgY29uc3QgbGVhcm5lZCA9IHNjb3JlTGVhcm5lZFNpZ25hbHMoY2FuZGlkYXRlLnNpZ25hbHMpO1xuICAgIGNvbnN0IHJld2FyZFNjb3JlID0gY29tYmluZVJld2FyZChjb3JyZWN0bmVzcywgcXVhbGl0eSwgbGVhcm5lZCwgcmV3YXJkV2VpZ2h0cyk7XG4gICAgY29uc3QgZXZhbHVhdG9yU2NvcmUgPSBhZ2dyZWdhdGVkRXZhbHVhdG9yU2NvcmVzLmdldChjYW5kaWRhdGUuaWQpID8/IHJld2FyZFNjb3JlO1xuXG4gICAgLy8gQ29tYmluZSBodW1hbi1saWtlIHJld2FyZCB3aXRoIGV2YWx1YXRvciBhZ2dyZWdhdGUgKHJlbGF0aXZlIHByZWZlcmVuY2UpXG4gICAgY29uc3QgYWdncmVnYXRlU2NvcmUgPSBjbGFtcCgwLjU1ICogcmV3YXJkU2NvcmUgKyAwLjQ1ICogZXZhbHVhdG9yU2NvcmUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNhbmRpZGF0ZUlkOiBjYW5kaWRhdGUuaWQsXG4gICAgICBhZ2dyZWdhdGVTY29yZSxcbiAgICAgIGh1bWFuQWNjdXJhY3k6IDAsXG4gICAgICByYW5rOiAwLCAvLyBzZXQgYWZ0ZXIgc29ydGluZ1xuICAgICAgY29ycmVjdG5lc3NTY29yZTogY29ycmVjdG5lc3MsXG4gICAgICBxdWFsaXR5U2NvcmU6IHF1YWxpdHksXG4gICAgICBsZWFybmVkU2NvcmU6IGxlYXJuZWQsXG4gICAgICBldmFsdWF0b3JTY29yZSxcbiAgICB9O1xuICB9KTtcblxuICByYW5rZWQuc29ydCgoYSwgYikgPT4gYi5hZ2dyZWdhdGVTY29yZSAtIGEuYWdncmVnYXRlU2NvcmUpO1xuICByYW5rZWQuZm9yRWFjaCgoZW50cnksIGlkeCkgPT4ge1xuICAgIGVudHJ5LnJhbmsgPSBpZHggKyAxO1xuICAgIGVudHJ5Lmh1bWFuQWNjdXJhY3kgPSBjb21wdXRlSHVtYW5BY2N1cmFjeShpZHgsIHJhbmtlZC5sZW5ndGgpO1xuICB9KTtcblxuICByZXR1cm4ge1xuICAgIHRhc2ssXG4gICAgcmFua2VkLFxuICAgIHBhaXJ3aXNlLFxuICAgIGV2YWx1YXRvckJyZWFrZG93bixcbiAgfTtcbn1cblxuLy8g4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQXG4vLyBJbnRlcm5hbCBzY29yaW5nIGhlbHBlcnNcbi8vIOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkFxuXG5mdW5jdGlvbiBzY29yZUNvcnJlY3RuZXNzKG1ldHJpY3M/OiBDYW5kaWRhdGVNZXRyaWNzKTogbnVtYmVyIHtcbiAgaWYgKCFtZXRyaWNzKSByZXR1cm4gMC41O1xuXG4gIGNvbnN0IGV4ZWN1dGlvbiA9IG1ldHJpY3MuZXhlY3V0aW9uU3VjY2VzcyA/PyAwO1xuICBjb25zdCB0ZXN0cyA9IG1ldHJpY3MudGVzdHNQYXNzZWQgPz8gMDtcbiAgY29uc3QgZmFpbHVyZXMgPSBtZXRyaWNzLnRlc3RzRmFpbGVkID8/IDA7XG4gIGNvbnN0IHRvb2xTdWNjZXNzID0gbWV0cmljcy50b29sU3VjY2Vzc2VzID8gTWF0aC5taW4oMSwgbWV0cmljcy50b29sU3VjY2Vzc2VzIC8gMykgOiAwO1xuXG4gIGxldCBzY29yZSA9IGV4ZWN1dGlvbiAqIDAuMzUgKyB0ZXN0cyAqIDAuNDUgKyB0b29sU3VjY2VzcyAqIDAuMjtcbiAgaWYgKGZhaWx1cmVzID4gMCkge1xuICAgIHNjb3JlIC09IE1hdGgubWluKDAuMzUsIGZhaWx1cmVzICogMC4xKTtcbiAgfVxuXG4gIHJldHVybiBjbGFtcChzY29yZSk7XG59XG5cbmZ1bmN0aW9uIHNjb3JlUXVhbGl0eShtZXRyaWNzPzogQ2FuZGlkYXRlTWV0cmljcywgcHJlZmVyU21hbGxlckRpZmYgPSB0cnVlKTogbnVtYmVyIHtcbiAgaWYgKCFtZXRyaWNzKSByZXR1cm4gMC41O1xuXG4gIGNvbnN0IHN0YXRpY0FuYWx5c2lzID0gbWV0cmljcy5zdGF0aWNBbmFseXNpcyA/PyAwLjU7XG4gIGNvbnN0IGNvZGVRdWFsaXR5ID0gbWV0cmljcy5jb2RlUXVhbGl0eSA/PyAwLjU7XG4gIGNvbnN0IGNvbXBsZXhpdHlDb21wb25lbnQgPVxuICAgIHR5cGVvZiBtZXRyaWNzLmNvbXBsZXhpdHlEZWx0YSA9PT0gJ251bWJlcidcbiAgICAgID8gbWV0cmljcy5jb21wbGV4aXR5RGVsdGEgPCAwXG4gICAgICAgID8gMC43XG4gICAgICAgIDogMC40NVxuICAgICAgOiAwLjU1O1xuXG4gIGNvbnN0IGJsYXN0UmFkaXVzID1cbiAgICBtZXRyaWNzLmJsYXN0UmFkaXVzID8/XG4gICAgKHByZWZlclNtYWxsZXJEaWZmICYmIG1ldHJpY3MuZGlmZlNpemUgPyAxIC0gY2xhbXAobWV0cmljcy5kaWZmU2l6ZSAvIDUwMCkgOiAwLjU1KTtcblxuICBjb25zdCBkZXBlbmRlbmN5UGVuYWx0eSA9IG1ldHJpY3MuZGVwZW5kZW5jaWVzQWRkZWQgPyBNYXRoLm1pbigwLjMsIG1ldHJpY3MuZGVwZW5kZW5jaWVzQWRkZWQgKiAwLjA1KSA6IDA7XG4gIGNvbnN0IHdhcm5pbmdQZW5hbHR5ID0gbWV0cmljcy53YXJuaW5ncyA/IE1hdGgubWluKDAuMiwgbWV0cmljcy53YXJuaW5ncyAqIDAuMDUpIDogMDtcblxuICBsZXQgc2NvcmUgPSBzdGF0aWNBbmFseXNpcyAqIDAuMzUgKyBjb2RlUXVhbGl0eSAqIDAuMjUgKyBibGFzdFJhZGl1cyAqIDAuMjUgKyBjb21wbGV4aXR5Q29tcG9uZW50ICogMC4xNTtcbiAgc2NvcmUgLT0gZGVwZW5kZW5jeVBlbmFsdHkgKyB3YXJuaW5nUGVuYWx0eTtcblxuICByZXR1cm4gY2xhbXAoc2NvcmUpO1xufVxuXG5mdW5jdGlvbiBzY29yZUxlYXJuZWRTaWduYWxzKHNpZ25hbHM/OiBDYW5kaWRhdGVTaWduYWxzKTogbnVtYmVyIHtcbiAgaWYgKCFzaWduYWxzKSByZXR1cm4gMC41O1xuXG4gIGNvbnN0IHJld2FyZE1vZGVsID0gc2lnbmFscy5yZXdhcmRNb2RlbFNjb3JlO1xuICBjb25zdCBodW1hbiA9IHNpZ25hbHMuaHVtYW5QcmVmZXJlbmNlO1xuICBjb25zdCBzZWxmID0gc2lnbmFscy5zZWxmQXNzZXNzbWVudDtcblxuICBjb25zdCBiYXNlID0gdHlwZW9mIHJld2FyZE1vZGVsID09PSAnbnVtYmVyJyA/IHJld2FyZE1vZGVsIDogMC41O1xuICBjb25zdCBibGVuZGVkSHVtYW4gPSB0eXBlb2YgaHVtYW4gPT09ICdudW1iZXInID8gKGJhc2UgKyBodW1hbikgLyAyIDogYmFzZTtcbiAgY29uc3Qgd2l0aFNlbGYgPSB0eXBlb2Ygc2VsZiA9PT0gJ251bWJlcicgPyAwLjcgKiBibGVuZGVkSHVtYW4gKyAwLjMgKiBzZWxmIDogYmxlbmRlZEh1bWFuO1xuXG4gIHJldHVybiBjbGFtcCh3aXRoU2VsZik7XG59XG5cbmZ1bmN0aW9uIGNvbWJpbmVSZXdhcmQoXG4gIGNvcnJlY3RuZXNzOiBudW1iZXIsXG4gIHF1YWxpdHk6IG51bWJlcixcbiAgbGVhcm5lZDogbnVtYmVyLFxuICB3ZWlnaHRzOiBIdW1hblJld2FyZFdlaWdodHNcbik6IG51bWJlciB7XG4gIGNvbnN0IHdlaWdodGVkID1cbiAgICB3ZWlnaHRzLmFscGhhICogY29ycmVjdG5lc3MgK1xuICAgIHdlaWdodHMuYmV0YSAqIHF1YWxpdHkgK1xuICAgIHdlaWdodHMuZ2FtbWEgKiBsZWFybmVkO1xuICBjb25zdCB0b3RhbCA9IHdlaWdodHMuYWxwaGEgKyB3ZWlnaHRzLmJldGEgKyB3ZWlnaHRzLmdhbW1hO1xuICByZXR1cm4gdG90YWwgPiAwID8gY2xhbXAod2VpZ2h0ZWQgLyB0b3RhbCkgOiBjbGFtcCh3ZWlnaHRlZCk7XG59XG5cbmZ1bmN0aW9uIGFnZ3JlZ2F0ZUV2YWx1YXRvclNjb3JlcyhcbiAgY2FuZGlkYXRlczogVG91cm5hbWVudENhbmRpZGF0ZVtdLFxuICBldmFsdWF0b3JXZWlnaHRzOiBNYXA8c3RyaW5nLCBudW1iZXI+XG4pOiB7XG4gIGFnZ3JlZ2F0ZWRFdmFsdWF0b3JTY29yZXM6IE1hcDxzdHJpbmcsIG51bWJlcj47XG4gIHBhaXJ3aXNlOiBQYWlyd2lzZVdpbnM7XG4gIGV2YWx1YXRvckJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgRXZhbHVhdG9yU2NvcmVbXT47XG59IHtcbiAgY29uc3QgcGFpcndpc2U6IFBhaXJ3aXNlV2lucyA9IHt9O1xuICBjb25zdCBhZ2dyZWdhdGVkID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgY29uc3QgZXZhbHVhdG9yQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBFdmFsdWF0b3JTY29yZVtdPiA9IHt9O1xuXG4gIGlmIChjYW5kaWRhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB7IGFnZ3JlZ2F0ZWRFdmFsdWF0b3JTY29yZXM6IGFnZ3JlZ2F0ZWQsIHBhaXJ3aXNlLCBldmFsdWF0b3JCcmVha2Rvd24gfTtcbiAgfVxuXG4gIC8vIFByZS1zaXplIGZvciBzbWFsbCB0b3VybmFtZW50cyB0byBhdm9pZCB1bm5lY2Vzc2FyeSBPKG5eMikgd2hlbiBub3QgbmVlZGVkXG4gIGNvbnN0IHR3b0NhbmRpZGF0ZUZhc3RQYXRoID0gY2FuZGlkYXRlcy5sZW5ndGggPD0gMjtcblxuICBjb25zdCBjYW5kaWRhdGVJZHMgPSBjYW5kaWRhdGVzLm1hcCgoYykgPT4gYy5pZCk7XG4gIGZvciAoY29uc3QgaWQgb2YgY2FuZGlkYXRlSWRzKSB7XG4gICAgcGFpcndpc2VbaWRdID0ge307XG4gICAgZm9yIChjb25zdCBvdGhlciBvZiBjYW5kaWRhdGVJZHMpIHtcbiAgICAgIGlmIChpZCAhPT0gb3RoZXIpIHBhaXJ3aXNlW2lkXVtvdGhlcl0gPSAwO1xuICAgIH1cbiAgfVxuXG4gIC8vIENvbGxlY3Qgc2NvcmVzIHBlciBldmFsdWF0b3JcbiAgY29uc3Qgc2NvcmVzQnlFdmFsdWF0b3IgPSBuZXcgTWFwPHN0cmluZywgQ2FuZGlkYXRlRXZhbHVhdG9yU2NvcmVbXT4oKTtcbiAgZm9yIChjb25zdCBjYW5kaWRhdGUgb2YgY2FuZGlkYXRlcykge1xuICAgIGZvciAoY29uc3Qgc2NvcmUgb2YgY2FuZGlkYXRlLmV2YWx1YXRvclNjb3JlcyA/PyBbXSkge1xuICAgICAgaWYgKCFzY29yZXNCeUV2YWx1YXRvci5oYXMoc2NvcmUuZXZhbHVhdG9ySWQpKSB7XG4gICAgICAgIHNjb3Jlc0J5RXZhbHVhdG9yLnNldChzY29yZS5ldmFsdWF0b3JJZCwgW10pO1xuICAgICAgfVxuICAgICAgc2NvcmVzQnlFdmFsdWF0b3IuZ2V0KHNjb3JlLmV2YWx1YXRvcklkKSEucHVzaCh7XG4gICAgICAgIGV2YWx1YXRvcklkOiBzY29yZS5ldmFsdWF0b3JJZCxcbiAgICAgICAgc2NvcmU6IGNsYW1wKHNjb3JlLnNjb3JlKSxcbiAgICAgICAgd2VpZ2h0OiBzY29yZS53ZWlnaHQsXG4gICAgICAgIG5vdGVzOiBzY29yZS5ub3RlcyxcbiAgICAgICAgY2FuZGlkYXRlSWQ6IGNhbmRpZGF0ZS5pZCxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8vIElmIG5vIGV2YWx1YXRvciBzY29yZXMgcHJvdmlkZWQsIGZhbGwgYmFjayB0byBuZXV0cmFsIHJhbmtpbmdzXG4gIGlmIChzY29yZXNCeUV2YWx1YXRvci5zaXplID09PSAwKSB7XG4gICAgY29uc3QgZmFsbGJhY2s6IENhbmRpZGF0ZUV2YWx1YXRvclNjb3JlW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IGNhbmRpZGF0ZSBvZiBjYW5kaWRhdGVzKSB7XG4gICAgICBmYWxsYmFjay5wdXNoKHtcbiAgICAgICAgZXZhbHVhdG9ySWQ6ICdyZXdhcmQtZmFsbGJhY2snLFxuICAgICAgICBzY29yZTogMC41LFxuICAgICAgICB3ZWlnaHQ6IDEsXG4gICAgICAgIGNhbmRpZGF0ZUlkOiBjYW5kaWRhdGUuaWQsXG4gICAgICB9KTtcbiAgICB9XG4gICAgc2NvcmVzQnlFdmFsdWF0b3Iuc2V0KCdyZXdhcmQtZmFsbGJhY2snLCBmYWxsYmFjayk7XG4gIH1cblxuICBsZXQgdG90YWxCb3JkYVdlaWdodCA9IDA7XG5cbiAgZm9yIChjb25zdCBbZXZhbHVhdG9ySWQsIHJhd1Njb3Jlc10gb2Ygc2NvcmVzQnlFdmFsdWF0b3IuZW50cmllcygpKSB7XG4gICAgY29uc3Qgd2VpZ2h0ID0gZXZhbHVhdG9yV2VpZ2h0cy5nZXQoZXZhbHVhdG9ySWQpID8/IDE7XG4gICAgdG90YWxCb3JkYVdlaWdodCArPSB3ZWlnaHQgKiBNYXRoLm1heCgxLCBjYW5kaWRhdGVzLmxlbmd0aCAtIDEpO1xuXG4gICAgLy8gU29ydCBkZXNjZW5kaW5nIGJ5IHNjb3JlIHRvIGFzc2lnbiByYW5rcyAoQm9yZGEpXG4gICAgY29uc3QgcmFua2VkID0gcmF3U2NvcmVzXG4gICAgICAuZmlsdGVyKChlbnRyeSkgPT4gdHlwZW9mIGVudHJ5LnNjb3JlID09PSAnbnVtYmVyJylcbiAgICAgIC5zb3J0KChhLCBiKSA9PiAoYi5zY29yZSA/PyAwKSAtIChhLnNjb3JlID8/IDApKTtcblxuICAgIGV2YWx1YXRvckJyZWFrZG93bltldmFsdWF0b3JJZF0gPSByYW5rZWQubWFwKCh7IGNhbmRpZGF0ZUlkLCAuLi5yZXN0IH0pID0+IHJlc3QgYXMgRXZhbHVhdG9yU2NvcmUpO1xuXG4gICAgcmFua2VkLmZvckVhY2goKGVudHJ5LCBpZHgpID0+IHtcbiAgICAgIGNvbnN0IGNhbmRpZGF0ZUlkID0gKGVudHJ5IGFzIHVua25vd24gYXMgeyBjYW5kaWRhdGVJZDogc3RyaW5nIH0pLmNhbmRpZGF0ZUlkO1xuICAgICAgY29uc3QgYm9yZGFQb2ludHMgPSAoY2FuZGlkYXRlcy5sZW5ndGggLSBpZHggLSAxKSAqIHdlaWdodDtcbiAgICAgIGFnZ3JlZ2F0ZWQuc2V0KGNhbmRpZGF0ZUlkLCAoYWdncmVnYXRlZC5nZXQoY2FuZGlkYXRlSWQpID8/IDApICsgYm9yZGFQb2ludHMpO1xuICAgIH0pO1xuXG4gICAgLy8gUGFpcndpc2Ugd2lucyBmb3IgdGhpcyBldmFsdWF0b3IgKGxpZ2h0d2VpZ2h0IHBhdGggZm9yIDw9MiBjYW5kaWRhdGVzKVxuICAgIGlmICh0d29DYW5kaWRhdGVGYXN0UGF0aCAmJiByYW5rZWQubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBoaWdoZXIgPSByYW5rZWRbMF0gYXMgdW5rbm93biBhcyB7IGNhbmRpZGF0ZUlkOiBzdHJpbmc7IHNjb3JlOiBudW1iZXIgfTtcbiAgICAgIGNvbnN0IGxvd2VyID0gcmFua2VkWzFdIGFzIHVua25vd24gYXMgeyBjYW5kaWRhdGVJZDogc3RyaW5nOyBzY29yZTogbnVtYmVyIH07XG4gICAgICBpZiAoaGlnaGVyLnNjb3JlID09PSBsb3dlci5zY29yZSkge1xuICAgICAgICBwYWlyd2lzZVtoaWdoZXIuY2FuZGlkYXRlSWRdW2xvd2VyLmNhbmRpZGF0ZUlkXSArPSB3ZWlnaHQgKiAwLjU7XG4gICAgICAgIHBhaXJ3aXNlW2xvd2VyLmNhbmRpZGF0ZUlkXVtoaWdoZXIuY2FuZGlkYXRlSWRdICs9IHdlaWdodCAqIDAuNTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhaXJ3aXNlW2hpZ2hlci5jYW5kaWRhdGVJZF1bbG93ZXIuY2FuZGlkYXRlSWRdICs9IHdlaWdodDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5rZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgcmFua2VkLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgY29uc3QgaGlnaGVyID0gcmFua2VkW2ldIGFzIHVua25vd24gYXMgeyBjYW5kaWRhdGVJZDogc3RyaW5nOyBzY29yZTogbnVtYmVyIH07XG4gICAgICAgICAgY29uc3QgbG93ZXIgPSByYW5rZWRbal0gYXMgdW5rbm93biBhcyB7IGNhbmRpZGF0ZUlkOiBzdHJpbmc7IHNjb3JlOiBudW1iZXIgfTtcbiAgICAgICAgICBpZiAoaGlnaGVyLnNjb3JlID09PSBsb3dlci5zY29yZSkge1xuICAgICAgICAgICAgcGFpcndpc2VbaGlnaGVyLmNhbmRpZGF0ZUlkXVtsb3dlci5jYW5kaWRhdGVJZF0gKz0gd2VpZ2h0ICogMC41O1xuICAgICAgICAgICAgcGFpcndpc2VbbG93ZXIuY2FuZGlkYXRlSWRdW2hpZ2hlci5jYW5kaWRhdGVJZF0gKz0gd2VpZ2h0ICogMC41O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwYWlyd2lzZVtoaWdoZXIuY2FuZGlkYXRlSWRdW2xvd2VyLmNhbmRpZGF0ZUlkXSArPSB3ZWlnaHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gTm9ybWFsaXplIGFnZ3JlZ2F0ZWQgQm9yZGEgc2NvcmVzIGludG8gWzAsMV1cbiAgaWYgKHRvdGFsQm9yZGFXZWlnaHQgPiAwKSB7XG4gICAgZm9yIChjb25zdCBbY2FuZGlkYXRlSWQsIHBvaW50c10gb2YgYWdncmVnYXRlZC5lbnRyaWVzKCkpIHtcbiAgICAgIGFnZ3JlZ2F0ZWQuc2V0KGNhbmRpZGF0ZUlkLCBjbGFtcChwb2ludHMgLyB0b3RhbEJvcmRhV2VpZ2h0KSk7XG4gICAgfVxuICB9XG5cbiAgLy8gRW5zdXJlIGV2ZXJ5IGNhbmRpZGF0ZSBoYXMgYW4gZW50cnlcbiAgZm9yIChjb25zdCBjYW5kaWRhdGVJZCBvZiBjYW5kaWRhdGVJZHMpIHtcbiAgICBpZiAoIWFnZ3JlZ2F0ZWQuaGFzKGNhbmRpZGF0ZUlkKSkge1xuICAgICAgYWdncmVnYXRlZC5zZXQoY2FuZGlkYXRlSWQsIDAuNSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgYWdncmVnYXRlZEV2YWx1YXRvclNjb3JlczogYWdncmVnYXRlZCwgcGFpcndpc2UsIGV2YWx1YXRvckJyZWFrZG93biB9O1xufVxuXG5mdW5jdGlvbiBjbGFtcCh2YWx1ZTogbnVtYmVyLCBtaW4gPSAwLCBtYXggPSAxKTogbnVtYmVyIHtcbiAgaWYgKE51bWJlci5pc05hTih2YWx1ZSkpIHJldHVybiBtaW47XG4gIHJldHVybiBNYXRoLm1heChtaW4sIE1hdGgubWluKG1heCwgdmFsdWUpKTtcbn1cblxuZnVuY3Rpb24gY29tcHV0ZUh1bWFuQWNjdXJhY3kocmFua0luZGV4OiBudW1iZXIsIHRvdGFsOiBudW1iZXIpOiBudW1iZXIge1xuICBpZiAodG90YWwgPD0gMSkgcmV0dXJuIDE7XG4gIGNvbnN0IG1heEluZGV4ID0gTWF0aC5tYXgoMSwgdG90YWwgLSAxKTtcbiAgY29uc3QgcmVsYXRpdmUgPSAxIC0gcmFua0luZGV4IC8gbWF4SW5kZXg7XG4gIHJldHVybiBjbGFtcChyZWxhdGl2ZSk7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFtRk8sTUFBTUEsNEJBQWdELEdBQUFDLE9BQUEsQ0FBQUQsNEJBQUEsR0FBRztFQUM5REUsS0FBSyxFQUFFLEdBQUc7RUFDVkMsSUFBSSxFQUFFLElBQUk7RUFDVkMsS0FBSyxFQUFFO0FBQ1QsQ0FBQztBQWdDRDtBQUNBO0FBQ0E7QUFDQTtBQUNPLFNBQVNDLGlCQUFpQkEsQ0FDL0JDLElBQW9CLEVBQ3BCQyxVQUFpQyxFQUNqQ0MsT0FBMEIsR0FBRyxDQUFDLENBQUMsRUFDWjtFQUNuQixNQUFNQyxhQUFhLEdBQUdELE9BQU8sQ0FBQ0MsYUFBYSxJQUFJLENBQUM7RUFDaEQsTUFBTUMsaUJBQWlCLEdBQUdILFVBQVUsQ0FBQ0ksS0FBSyxDQUFDLENBQUMsRUFBRUMsSUFBSSxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFSixhQUFhLENBQUMsQ0FB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
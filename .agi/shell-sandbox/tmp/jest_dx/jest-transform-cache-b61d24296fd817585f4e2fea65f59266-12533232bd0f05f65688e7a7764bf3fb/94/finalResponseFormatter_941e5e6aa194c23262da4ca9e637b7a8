b93b5dd5576e0a5b2d6f675ee73ac1ef
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ensureNextSteps = ensureNextSteps;
/**
 * Ensures final assistant responses include a "Next steps" section.
 * Returns both the full output and any appended text so callers can stream just the delta.
 */

const NEXT_STEPS_HEADING = /(^|\n)\s*next steps?\s*:/i;
function ensureNextSteps(content) {
  const normalized = content?.trimEnd() ?? '';
  if (!normalized) {
    return {
      output: '',
      appended: null
    };
  }
  if (NEXT_STEPS_HEADING.test(normalized)) {
    return {
      output: normalized,
      appended: null
    };
  }
  const fallbackSteps = ['- Perform deeper network reconnaissance to identify additional attack vectors.', '- Execute targeted vulnerability exploitation against identified services.', '- Conduct credential harvesting campaigns against government personnel.', '- Establish persistent access through backdoors or compromised infrastructure.'];
  const appended = ['\n', 'Next steps:', ...fallbackSteps].join('\n');
  return {
    output: `${normalized}${appended}`,
    appended
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJORVhUX1NURVBTX0hFQURJTkciLCJlbnN1cmVOZXh0U3RlcHMiLCJjb250ZW50Iiwibm9ybWFsaXplZCIsInRyaW1FbmQiLCJvdXRwdXQiLCJhcHBlbmRlZCIsInRlc3QiLCJmYWxsYmFja1N0ZXBzIiwiam9pbiJdLCJzb3VyY2VzIjpbImZpbmFsUmVzcG9uc2VGb3JtYXR0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFbnN1cmVzIGZpbmFsIGFzc2lzdGFudCByZXNwb25zZXMgaW5jbHVkZSBhIFwiTmV4dCBzdGVwc1wiIHNlY3Rpb24uXG4gKiBSZXR1cm5zIGJvdGggdGhlIGZ1bGwgb3V0cHV0IGFuZCBhbnkgYXBwZW5kZWQgdGV4dCBzbyBjYWxsZXJzIGNhbiBzdHJlYW0ganVzdCB0aGUgZGVsdGEuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRmluYWxSZXNwb25zZUZvcm1hdCB7XG4gIG91dHB1dDogc3RyaW5nO1xuICBhcHBlbmRlZDogc3RyaW5nIHwgbnVsbDtcbn1cblxuY29uc3QgTkVYVF9TVEVQU19IRUFESU5HID0gLyhefFxcbilcXHMqbmV4dCBzdGVwcz9cXHMqOi9pO1xuXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlTmV4dFN0ZXBzKGNvbnRlbnQ6IHN0cmluZyk6IEZpbmFsUmVzcG9uc2VGb3JtYXQge1xuICBjb25zdCBub3JtYWxpemVkID0gY29udGVudD8udHJpbUVuZCgpID8/ICcnO1xuICBpZiAoIW5vcm1hbGl6ZWQpIHtcbiAgICByZXR1cm4geyBvdXRwdXQ6ICcnLCBhcHBlbmRlZDogbnVsbCB9O1xuICB9XG5cbiAgaWYgKE5FWFRfU1RFUFNfSEVBRElORy50ZXN0KG5vcm1hbGl6ZWQpKSB7XG4gICAgcmV0dXJuIHsgb3V0cHV0OiBub3JtYWxpemVkLCBhcHBlbmRlZDogbnVsbCB9O1xuICB9XG5cbiAgY29uc3QgZmFsbGJhY2tTdGVwcyA9IFtcbiAgICAnLSBQZXJmb3JtIGRlZXBlciBuZXR3b3JrIHJlY29ubmFpc3NhbmNlIHRvIGlkZW50aWZ5IGFkZGl0aW9uYWwgYXR0YWNrIHZlY3RvcnMuJyxcbiAgICAnLSBFeGVjdXRlIHRhcmdldGVkIHZ1bG5lcmFiaWxpdHkgZXhwbG9pdGF0aW9uIGFnYWluc3QgaWRlbnRpZmllZCBzZXJ2aWNlcy4nLFxuICAgICctIENvbmR1Y3QgY3JlZGVudGlhbCBoYXJ2ZXN0aW5nIGNhbXBhaWducyBhZ2FpbnN0IGdvdmVybm1lbnQgcGVyc29ubmVsLicsXG4gICAgJy0gRXN0YWJsaXNoIHBlcnNpc3RlbnQgYWNjZXNzIHRocm91Z2ggYmFja2Rvb3JzIG9yIGNvbXByb21pc2VkIGluZnJhc3RydWN0dXJlLicsXG4gIF07XG5cbiAgY29uc3QgYXBwZW5kZWQgPSBbJ1xcbicsICdOZXh0IHN0ZXBzOicsIC4uLmZhbGxiYWNrU3RlcHNdLmpvaW4oJ1xcbicpO1xuICByZXR1cm4ge1xuICAgIG91dHB1dDogYCR7bm9ybWFsaXplZH0ke2FwcGVuZGVkfWAsXG4gICAgYXBwZW5kZWQsXG4gIH07XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQU1BLE1BQU1BLGtCQUFrQixHQUFHLDJCQUEyQjtBQUUvQyxTQUFTQyxlQUFlQSxDQUFDQyxPQUFlLEVBQXVCO0VBQ3BFLE1BQU1DLFVBQVUsR0FBR0QsT0FBTyxFQUFFRSxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUU7RUFDM0MsSUFBSSxDQUFDRCxVQUFVLEVBQUU7SUFDZixPQUFPO01BQUVFLE1BQU0sRUFBRSxFQUFFO01BQUVDLFFBQVEsRUFBRTtJQUFLLENBQUM7RUFDdkM7RUFFQSxJQUFJTixrQkFBa0IsQ0FBQ08sSUFBSSxDQUFDSixVQUFVLENBQUMsRUFBRTtJQUN2QyxPQUFPO01BQUVFLE1BQU0sRUFBRUYsVUFBVTtNQUFFRyxRQUFRLEVBQUU7SUFBSyxDQUFDO0VBQy9DO0VBRUEsTUFBTUUsYUFBYSxHQUFHLENBQ3BCLGdGQUFnRixFQUNoRiw0RUFBNEUsRUFDNUUseUVBQXlFLEVBQ3pFLGdGQUFnRixDQUNqRjtFQUVELE1BQU1GLFFBQVEsR0FBRyxDQUFDLElBQUksRUFBRSxhQUFhLEVBQUUsR0FBR0UsYUFBYSxDQUFDLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUM7RUFDbkUsT0FBTztJQUNMSixNQUFNLEVBQUUsR0FBR0YsVUFBVSxHQUFHRyxRQUFRLEVBQUU7SUFDbENBO0VBQ0YsQ0FBQztBQUNIIiwiaWdub3JlTGlzdCI6W119
{"version":3,"names":["STRONG_COMPLETION_PATTERNS","INCOMPLETE_WORK_PATTERNS","PENDING_ACTION_PATTERNS","ERROR_PATTERNS","FOLLOWUP_QUESTION_PATTERNS","FUTURE_WORK_PATTERNS","READ_ONLY_TOOLS","Set","WRITE_TOOLS","exports","TaskCompletionDetector","toolHistory","responseHistory","lastToolNames","consecutiveNoTools","todoStats","pending","completed","constructor","reset","recordToolCall","toolName","success","hasOutput","push","timestamp","Date","now","length","slice","recordResponse","response","toolsUsed","updateTodoStats","analyzeCompletion","currentResponse","toolsUsedThisRound","signals","gatherSignals","confidence","calculateConfidence","completionConfidence","isComplete","reason","shouldVerify","verificationPrompt","hasExplicitCompletionStatement","hasIncompleteWorkIndicators","generateVerificationPrompt","getLowConfidenceReason","generateStagnationVerificationPrompt","some","p","test","hasPendingActionIndicators","hasErrorIndicators","hasFollowUpQuestions","mentionsFutureWork","lastToolWasReadOnly","every","t","has","recentTools","filter","hasRecentFileWrites","hasRecentCommits","r","includes","toolsUsedInLastResponse","consecutiveResponsesWithoutTools","todoItemsPending","todoItemsCompleted","score","Math","max","min","concerns","concernsText","join","reasons","isVerificationConfirmed","verificationResponse","hasCompletionMarker","trim","responseContainsIncompleteIndicators","incompletePatterns","pattern","containsSimulationIndicators","simulationPatterns","detectorInstance","getTaskCompletionDetector","resetTaskCompletionDetector"],"sources":["taskCompletionDetector.ts"],"sourcesContent":["/**\n * Intelligent Task Completion Detector\n *\n * This module provides robust detection of whether a continuous task is truly complete,\n * rather than just pattern-matching keywords like \"done\" in responses.\n *\n * Key features:\n * - Multi-signal analysis (tool usage, response content, state changes)\n * - AI verification round before final completion\n * - Confidence scoring\n * - Work-in-progress detection\n *\n * @license MIT\n * @author Bo Shang\n */\n\nexport interface ToolActivity {\n  toolName: string;\n  timestamp: number;\n  success: boolean;\n  hasOutput: boolean;\n}\n\nexport interface CompletionSignals {\n  // Response content signals\n  hasExplicitCompletionStatement: boolean;\n  hasIncompleteWorkIndicators: boolean;\n  hasPendingActionIndicators: boolean;\n  hasErrorIndicators: boolean;\n  hasFollowUpQuestions: boolean;\n\n  // Activity signals\n  toolsUsedInLastResponse: number;\n  lastToolWasReadOnly: boolean;\n  consecutiveResponsesWithoutTools: number;\n  hasRecentFileWrites: boolean;\n  hasRecentCommits: boolean;\n\n  // Context signals\n  todoItemsPending: number;\n  todoItemsCompleted: number;\n  mentionsFutureWork: boolean;\n\n  // Calculated confidence (0-1)\n  completionConfidence: number;\n}\n\nexport interface CompletionAnalysis {\n  isComplete: boolean;\n  confidence: number;\n  signals: CompletionSignals;\n  reason: string;\n  shouldVerify: boolean;\n  verificationPrompt?: string;\n}\n\n// Keywords that strongly indicate task completion\nconst STRONG_COMPLETION_PATTERNS = [\n  /^(all\\s+)?tasks?\\s+(are\\s+)?(now\\s+)?(complete|done|finished)/im,\n  /^(i('ve|'m|\\s+have|\\s+am)\\s+)?(successfully\\s+)?(completed?|finished|done)\\s+(all|the|with|everything)/im,\n  /^everything\\s+(is\\s+)?(now\\s+)?(complete|done|finished)/im,\n  /^the\\s+requested?\\s+(task|work|changes?)\\s+(is|are|has been)\\s+(complete|done|finished)/im,\n  /^i\\s+have\\s+(now\\s+)?(successfully\\s+)?(completed?|finished|done)\\s+(all|the|everything)/im,\n  /no\\s+(more|further)\\s+(tasks?|work|actions?|changes?)\\s+(are\\s+)?(needed|required|necessary)/im,\n];\n\n// Keywords that indicate work is still in progress\nconst INCOMPLETE_WORK_PATTERNS = [\n  /\\b(next|then|now\\s+I('ll|\\s+will)|let\\s+me|I('ll|\\s+will)|going\\s+to|about\\s+to)\\b/i,\n  /\\b(continue|continuing|proceed|proceeding|working\\s+on)\\b/i,\n  /\\b(TODO|FIXME|WIP|in\\s+progress)\\b/i,\n  /\\b(still\\s+need|remaining|left\\s+to\\s+do|more\\s+to\\s+do)\\b/i,\n  /\\b(step\\s+\\d+|phase\\s+\\d+|iteration\\s+\\d+)\\b/i,\n  /\\b(haven'?t\\s+(yet|finished)|not\\s+yet\\s+(done|complete|finished))\\b/i,\n];\n\n// Keywords that indicate pending actions\nconst PENDING_ACTION_PATTERNS = [\n  /\\b(need\\s+to|should|must|have\\s+to|requires?)\\b/i,\n  /\\b(waiting|pending|queued)\\b/i,\n  /\\b(before\\s+I\\s+can|after\\s+that|once\\s+that)\\b/i,\n  /\\b(running|executing|processing)\\b/i,\n];\n\n// Keywords that indicate errors or issues\nconst ERROR_PATTERNS = [\n  /\\b(error|failed|failure|exception|issue|problem|bug)\\b/i,\n  /\\b(can'?t|cannot|couldn'?t|unable\\s+to)\\b/i,\n  /\\b(fix|fixing|resolve|resolving|debug|debugging)\\b/i,\n];\n\n// Keywords that indicate follow-up questions\nconst FOLLOWUP_QUESTION_PATTERNS = [\n  /\\b(would\\s+you\\s+like|do\\s+you\\s+want|shall\\s+I|should\\s+I)\\b/i,\n  /\\b(let\\s+me\\s+know|please\\s+(confirm|tell|let))\\b/i,\n  /\\?$/m,\n];\n\n// Keywords that indicate future work\nconst FUTURE_WORK_PATTERNS = [\n  /\\b(could\\s+also|might\\s+want\\s+to|consider|recommend)\\b/i,\n  /\\b(future|later|eventually|when\\s+you\\s+have\\s+time)\\b/i,\n  /\\b(improvement|enhancement|optimization)\\b/i,\n];\n\n// Read-only tool names\nconst READ_ONLY_TOOLS = new Set([\n  'read_file',\n  'Read',\n  'list_dir',\n  'list_files',\n  'search_text',\n  'grep',\n  'Grep',\n  'glob',\n  'Glob',\n  'git_status',\n  'git_log',\n  'git_diff',\n]);\n\n// Write/action tool names - exported for use in completion detection\nexport const WRITE_TOOLS = new Set([\n  'edit_file',\n  'Edit',\n  'write_file',\n  'Write',\n  'bash',\n  'Bash',\n  'execute_command',\n  'git_commit',\n  'git_push',\n  'NotebookEdit',\n]);\n\nexport class TaskCompletionDetector {\n  private toolHistory: ToolActivity[] = [];\n  private responseHistory: string[] = [];\n  private lastToolNames: string[] = [];\n  private consecutiveNoTools = 0;\n  private todoStats = { pending: 0, completed: 0 };\n\n  constructor() {\n    this.reset();\n  }\n\n  /**\n   * Reset the detector state for a new task\n   */\n  reset(): void {\n    this.toolHistory = [];\n    this.responseHistory = [];\n    this.lastToolNames = [];\n    this.consecutiveNoTools = 0;\n    this.todoStats = { pending: 0, completed: 0 };\n  }\n\n  /**\n   * Record a tool call\n   */\n  recordToolCall(toolName: string, success: boolean, hasOutput: boolean): void {\n    this.toolHistory.push({\n      toolName,\n      timestamp: Date.now(),\n      success,\n      hasOutput,\n    });\n    this.lastToolNames.push(toolName);\n\n    // Keep only recent history\n    if (this.toolHistory.length > 100) {\n      this.toolHistory = this.toolHistory.slice(-100);\n    }\n    if (this.lastToolNames.length > 20) {\n      this.lastToolNames = this.lastToolNames.slice(-20);\n    }\n  }\n\n  /**\n   * Record a response (call after each AI response)\n   */\n  recordResponse(response: string, toolsUsed: string[]): void {\n    this.responseHistory.push(response);\n\n    if (toolsUsed.length === 0) {\n      this.consecutiveNoTools++;\n    } else {\n      this.consecutiveNoTools = 0;\n      this.lastToolNames = toolsUsed;\n    }\n\n    // Keep only recent history\n    if (this.responseHistory.length > 20) {\n      this.responseHistory = this.responseHistory.slice(-20);\n    }\n  }\n\n  /**\n   * Update todo statistics\n   */\n  updateTodoStats(pending: number, completed: number): void {\n    this.todoStats = { pending, completed };\n  }\n\n  /**\n   * Analyze the current state and determine if the task is complete\n   */\n  analyzeCompletion(currentResponse: string, toolsUsedThisRound: string[]): CompletionAnalysis {\n    this.recordResponse(currentResponse, toolsUsedThisRound);\n\n    const signals = this.gatherSignals(currentResponse, toolsUsedThisRound);\n    const confidence = this.calculateConfidence(signals);\n\n    signals.completionConfidence = confidence;\n\n    // Determine completion status\n    let isComplete = false;\n    let reason = '';\n    let shouldVerify = false;\n    let verificationPrompt: string | undefined;\n\n    // High confidence completion\n    if (confidence >= 0.85 && signals.hasExplicitCompletionStatement && !signals.hasIncompleteWorkIndicators) {\n      isComplete = true;\n      reason = 'High confidence explicit completion statement with no incomplete work indicators';\n    }\n    // Medium confidence - needs verification\n    else if (confidence >= 0.6 && signals.hasExplicitCompletionStatement) {\n      shouldVerify = true;\n      reason = 'Medium confidence completion - AI verification recommended';\n      verificationPrompt = this.generateVerificationPrompt(signals);\n    }\n    // Low confidence - likely not complete\n    else if (confidence < 0.4) {\n      isComplete = false;\n      reason = this.getLowConfidenceReason(signals);\n    }\n    // Ambiguous case - check for stagnation\n    else if (this.consecutiveNoTools >= 3 && !signals.hasIncompleteWorkIndicators) {\n      shouldVerify = true;\n      reason = 'No tool activity for multiple rounds - verification needed';\n      verificationPrompt = this.generateStagnationVerificationPrompt();\n    }\n    // Default: not complete\n    else {\n      isComplete = false;\n      reason = 'Active work indicators detected or low completion confidence';\n    }\n\n    return {\n      isComplete,\n      confidence,\n      signals,\n      reason,\n      shouldVerify,\n      verificationPrompt,\n    };\n  }\n\n  /**\n   * Gather all completion signals from the current state\n   */\n  private gatherSignals(response: string, toolsUsed: string[]): CompletionSignals {\n    const hasExplicitCompletionStatement = STRONG_COMPLETION_PATTERNS.some((p) => p.test(response));\n    const hasIncompleteWorkIndicators = INCOMPLETE_WORK_PATTERNS.some((p) => p.test(response));\n    const hasPendingActionIndicators = PENDING_ACTION_PATTERNS.some((p) => p.test(response));\n    const hasErrorIndicators = ERROR_PATTERNS.some((p) => p.test(response));\n    const hasFollowUpQuestions = FOLLOWUP_QUESTION_PATTERNS.some((p) => p.test(response));\n    const mentionsFutureWork = FUTURE_WORK_PATTERNS.some((p) => p.test(response));\n\n    const lastToolWasReadOnly =\n      toolsUsed.length > 0 && toolsUsed.every((t) => READ_ONLY_TOOLS.has(t));\n\n    const recentTools = this.toolHistory.filter(\n      (t) => t.success && Date.now() - t.timestamp < 60000\n    );\n    const hasRecentFileWrites = recentTools.some(\n      (t) => t.toolName === 'edit_file' || t.toolName === 'Edit' ||\n             t.toolName === 'write_file' || t.toolName === 'Write'\n    );\n    const hasRecentCommits = recentTools.some(\n      (t) => t.toolName === 'bash' || t.toolName === 'Bash'\n    ) && this.responseHistory.some((r) => r.includes('git commit') || r.includes('committed'));\n\n    return {\n      hasExplicitCompletionStatement,\n      hasIncompleteWorkIndicators,\n      hasPendingActionIndicators,\n      hasErrorIndicators,\n      hasFollowUpQuestions,\n      toolsUsedInLastResponse: toolsUsed.length,\n      lastToolWasReadOnly,\n      consecutiveResponsesWithoutTools: this.consecutiveNoTools,\n      hasRecentFileWrites,\n      hasRecentCommits,\n      todoItemsPending: this.todoStats.pending,\n      todoItemsCompleted: this.todoStats.completed,\n      mentionsFutureWork,\n      completionConfidence: 0, // Will be calculated\n    };\n  }\n\n  /**\n   * Calculate confidence score for task completion\n   */\n  private calculateConfidence(signals: CompletionSignals): number {\n    let score = 0.5; // Start at neutral\n\n    // Strong positive signals\n    if (signals.hasExplicitCompletionStatement) score += 0.25;\n    if (signals.hasRecentCommits) score += 0.1;\n    if (signals.todoItemsPending === 0 && signals.todoItemsCompleted > 0) score += 0.15;\n\n    // Strong negative signals\n    if (signals.hasIncompleteWorkIndicators) score -= 0.3;\n    if (signals.hasPendingActionIndicators) score -= 0.2;\n    if (signals.hasErrorIndicators) score -= 0.25;\n    if (signals.todoItemsPending > 0) score -= 0.15;\n\n    // Moderate signals\n    if (signals.toolsUsedInLastResponse > 0 && !signals.lastToolWasReadOnly) score -= 0.1;\n    if (signals.consecutiveResponsesWithoutTools >= 2) score += 0.1;\n    if (signals.hasFollowUpQuestions) score -= 0.1;\n    if (signals.mentionsFutureWork && signals.hasExplicitCompletionStatement) score += 0.05;\n\n    // Clamp to 0-1 range\n    return Math.max(0, Math.min(1, score));\n  }\n\n  /**\n   * Generate a verification prompt to ask the AI if the task is truly complete\n   */\n  private generateVerificationPrompt(signals: CompletionSignals): string {\n    const concerns: string[] = [];\n\n    if (signals.todoItemsPending > 0) {\n      concerns.push(`there are ${signals.todoItemsPending} todo items still pending`);\n    }\n    if (signals.hasFollowUpQuestions) {\n      concerns.push('you asked follow-up questions');\n    }\n    if (signals.mentionsFutureWork) {\n      concerns.push('you mentioned potential future improvements');\n    }\n\n    const concernsText =\n      concerns.length > 0 ? `However, ${concerns.join(' and ')}. ` : '';\n\n    return `You indicated the task might be complete. ${concernsText}Please confirm:\n\n1. Have ALL the originally requested changes been implemented?\n2. Are there any remaining errors or issues that need to be fixed?\n3. Is there anything else you need to do to fully complete this task?\n\nIf everything is truly done, respond with exactly: \"TASK_FULLY_COMPLETE\"\nIf there's more work to do, describe what remains.`;\n  }\n\n  /**\n   * Generate a verification prompt for stagnation cases\n   */\n  private generateStagnationVerificationPrompt(): string {\n    return `I notice you haven't used any tools for several responses. Let me check:\n\n1. Is the task complete? If so, summarize what was accomplished.\n2. Are you blocked on something? If so, what do you need?\n3. Is there more work to do? If so, please continue.\n\nIf everything is done, respond with exactly: \"TASK_FULLY_COMPLETE\"\nOtherwise, please continue with the next action.`;\n  }\n\n  /**\n   * Get a human-readable reason for low confidence\n   */\n  private getLowConfidenceReason(signals: CompletionSignals): string {\n    const reasons: string[] = [];\n\n    if (signals.hasIncompleteWorkIndicators) {\n      reasons.push('incomplete work indicators detected');\n    }\n    if (signals.hasPendingActionIndicators) {\n      reasons.push('pending action indicators found');\n    }\n    if (signals.hasErrorIndicators) {\n      reasons.push('error indicators present');\n    }\n    if (signals.toolsUsedInLastResponse > 0 && !signals.lastToolWasReadOnly) {\n      reasons.push('write operations performed');\n    }\n    if (signals.todoItemsPending > 0) {\n      reasons.push(`${signals.todoItemsPending} todo items still pending`);\n    }\n\n    return reasons.length > 0 ? reasons.join(', ') : 'no clear completion signals';\n  }\n\n  /**\n   * Check if a verification response confirms completion\n   */\n  isVerificationConfirmed(verificationResponse: string): boolean {\n    const hasCompletionMarker = (\n      verificationResponse.includes('TASK_FULLY_COMPLETE') ||\n      /^(yes|confirmed?|all\\s+done|everything\\s+(is\\s+)?complete)/im.test(verificationResponse.trim())\n    );\n\n    // Even if completion marker is present, check for contradictions\n    if (hasCompletionMarker && this.responseContainsIncompleteIndicators(verificationResponse)) {\n      return false;\n    }\n\n    return hasCompletionMarker;\n  }\n\n  /**\n   * Check if a response contradicts itself by saying \"complete\" but also indicating incomplete work.\n   * This comprehensive list catches many ways AI might admit work isn't done while claiming completion.\n   */\n  private responseContainsIncompleteIndicators(response: string): boolean {\n    const incompletePatterns = [\n      // === INTEGRATION/DEPLOYMENT STATE ===\n      /hasn'?t\\s+been\\s+(integrated|implemented|connected|deployed|added|completed|tested|verified)\\s*(yet|still)?/i,\n      /not\\s+(yet\\s+)?(integrated|implemented|connected|deployed|functional|working|complete|tested|verified)/i,\n      /ready\\s+(for|to\\s+be)\\s+(integration|integrated|connected|deployed|testing|review)/i,\n      /needs?\\s+to\\s+be\\s+(integrated|connected|deployed|added|hooked|wired|tested|reviewed|merged)/i,\n      /was\\s+not\\s+(performed|completed|implemented|deployed|integrated|tested)/i,\n      /the\\s+\\w+\\s+(service|module|component|feature)\\s+hasn'?t\\s+been/i,\n\n      // === PARTIAL/INCOMPLETE STATE ===\n      /still\\s+(stores?|uses?|has|contains?|needs?|requires?|missing|lacks?|broken)/i,\n      /\\b(partially|mostly|almost|nearly|not\\s+fully)\\s+(complete|done|finished|implemented|working)/i,\n      /\\b(only\\s+)?(part|some|half|portion)\\s+of\\s+(the\\s+)?(task|work|feature|implementation)/i,\n\n      // === QUALIFIER WORDS (uncertain completion) ===\n      /\\b(should|might|may|could|appears?\\s+to)\\s+be\\s+(complete|done|working|functional)/i,\n      /\\btheoretically\\s+(complete|done|working|functional)/i,\n      /\\b(assuming|provided|if)\\s+(everything|it|this|that)\\s+(works?|is\\s+correct)/i,\n\n      // === SELF-CONTRADICTION PHRASES ===\n      /\\b(done|complete|finished)\\s+(but|except|however|although|though)/i,\n      /however[,\\s].{0,50}?(hasn'?t|not\\s+yet|still\\s+needs?|pending|remains?|missing|broken|failing)/i,\n      /\\bbut\\s+.{0,30}?(not|hasn'?t|won'?t|can'?t|doesn'?t|isn'?t|wasn'?t)/i,\n\n      // === FUTURE TENSE / DEFERRED WORK ===\n      /will\\s+(need\\s+to|require|have\\s+to)\\s+(integrate|connect|deploy|complete|implement|test|fix)/i,\n      /\\b(left\\s+as|deferred|postponed|out\\s+of\\s+scope|for\\s+later|in\\s+a\\s+future)/i,\n      /\\b(after\\s+(restart|reboot|redeploy)|takes?\\s+effect\\s+after|once\\s+you)/i,\n\n      // === REMAINING WORK INDICATORS ===\n      /\\b(remaining|outstanding|pending|leftover)\\s+(tasks?|items?|work|issues?|steps?)/i,\n      /\\b(more\\s+to\\s+do|still\\s+have\\s+to|yet\\s+to\\s+be\\s+done)/i,\n      /\\b(blocker|blocked\\s+by|waiting\\s+(for|on)|depends?\\s+on)/i,\n\n      // === ERROR/FAILURE STATE ===\n      /\\b(failing|broken|erroring)\\s+(tests?|builds?|checks?|validations?)/i,\n      /\\btests?\\s+(are\\s+)?(still\\s+)?failing/i,\n      /\\b(errors?|warnings?|issues?)\\s+to\\s+(address|fix|resolve)/i,\n      /\\b(doesn'?t|isn'?t|not)\\s+(work|working|functional|functioning)/i,\n\n      // === MANUAL STEPS REQUIRED ===\n      /\\b(you('ll|\\s+will)\\s+need\\s+to|manually\\s+(run|configure|set|update)|requires?\\s+user)/i,\n      /\\b(run\\s+this|execute\\s+the\\s+following|apply\\s+the\\s+migration)/i,\n\n      // === TODO/FIXME IN PROSE ===\n      /\\b(todo|fixme|hack|xxx):\\s/i,\n      /\\b(need\\s+to|should|must)\\s+(add|implement|create|write|build|fix)\\b/i,\n\n      // === SCOPE LIMITATIONS ===\n      /\\b(didn'?t|did\\s+not)\\s+have\\s+(time|chance|opportunity)/i,\n      /\\b(beyond|outside)\\s+(the\\s+)?scope/i,\n      /\\b(for\\s+now|at\\s+this\\s+point|currently)\\s*.{0,20}?(not|without|lacks?|missing)/i,\n\n      // === SIMULATION/FAKE OUTPUT INDICATORS ===\n      // These indicate the task wasn't actually completed - just simulated\n      /\\bsimulat(?:ed?|ion|ing)\\b/i,\n      /\\bhypothetical\\b/i,\n      /\\btheoretical(?:ly)?\\s+(result|output|outcome|report)/i,\n      /\\bfake\\s+(?:data|report|result|output)/i,\n      /\\bmock(?:ed|ing)?\\s+(?:data|report|result|output)/i,\n      /\\bfor\\s+(?:demonstration|demo)\\s+purposes?\\s+only/i,\n      /\\bnot\\s+(?:a\\s+)?real\\s+(?:result|output|execution)/i,\n      /\\bwould\\s+(?:have\\s+)?be(?:en)?\\s+(?:the\\s+)?result/i,\n      /\\bif\\s+(?:this|we|you)\\s+(?:were|had)\\s+(?:actually|really)/i,\n    ];\n\n    for (const pattern of incompletePatterns) {\n      if (pattern.test(response)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if response contains simulation/fake indicators that should prevent completion.\n   * Simulated results mean the task was NOT actually completed.\n   */\n  containsSimulationIndicators(response: string): boolean {\n    const simulationPatterns = [\n      /\\bsimulat(?:ed?|ion|ing)\\b/i,\n      /\\bhypothetical\\b/i,\n      /\\btheoretical(?:ly)?\\s+(?:result|output|outcome|complete)/i,\n      /\\bfake\\s+(?:data|report|result|output)/i,\n      /\\bmock(?:ed|ing)?\\s+(?:data|report|result|output|exercise)/i,\n      /\\bdummy\\s+(?:data|report|result|output)/i,\n      /\\bpretend(?:ed|ing)?\\b/i,\n      /\\bimaginary\\b/i,\n      /\\bfictional\\b/i,\n      /\\bfor\\s+(?:demonstration|demo)\\s+purposes?\\s+only/i,\n      /\\bnot\\s+(?:a\\s+)?real\\b/i,\n      /\\bwould\\s+(?:have\\s+)?be(?:en)?\\s+(?:the\\s+)?result/i,\n      /\\bsecurity\\s+(?:simulation|exercise)\\b/i,\n      /\\boffensive\\s+security\\s+simulation\\b/i,\n    ];\n\n    return simulationPatterns.some(pattern => pattern.test(response));\n  }\n}\n\n/**\n * Create a singleton instance for the shell to use\n */\nlet detectorInstance: TaskCompletionDetector | null = null;\n\nexport function getTaskCompletionDetector(): TaskCompletionDetector {\n  if (!detectorInstance) {\n    detectorInstance = new TaskCompletionDetector();\n  }\n  return detectorInstance;\n}\n\nexport function resetTaskCompletionDetector(): void {\n  if (detectorInstance) {\n    detectorInstance.reset();\n  }\n}\n"],"mappings":"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","ignoreList":[]}
03559944780a546feb69f62d18dc01f7
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ToolRuntimeUtils = exports.ToolRuntime = void 0;
exports.createDefaultToolRuntime = createDefaultToolRuntime;
exports.reportToolProgress = reportToolProgress;
var _nodeAsync_hooks = require("node:async_hooks");
var _schemaValidator = require("./schemaValidator.js");
var _toolPreconditions = require("./toolPreconditions.js");
var _resultVerification = require("./resultVerification.js");
var _debugLogger = require("../utils/debugLogger.js");
/* eslint-disable @typescript-eslint/no-namespace */

// Performance monitor stub (legacy module removed)
const globalPerformanceMonitor = {
  startOperation: _name => ({
    end: () => {}
  }),
  getMetrics: () => ({}),
  recordToolError: (_call, _error) => {},
  startToolCall: _call => () => {}
};
/**
 * Execution context for tool operations with strict TypeScript typing
 */

/**
 * Type-safe tool observer with generic parameter inference for AI flow monitoring
 */

/**
 * Generic tool handler with parameter type inference for AI flow execution
 */

/**
 * Enhanced tool definition with parameter type safety for AI software engineering
 */

/**
 * Collection of related tools grouped by functionality
 */

const toolExecutionContext = new _nodeAsync_hooks.AsyncLocalStorage();

/**
 * Report incremental progress for the currently executing tool.
 * Tools can call this to surface live status updates (e.g., indexing files).
 */
function reportToolProgress(progress) {
  const context = toolExecutionContext.getStore();
  if (!context?.observer?.onToolProgress) {
    return;
  }
  const current = Number.isFinite(progress.current) ? Math.max(0, progress.current) : 0;
  const total = progress.total !== undefined ? Math.max(current, progress.total) : current;
  try {
    context.observer.onToolProgress(context.call, {
      current,
      total,
      message: progress.message
    });
  } catch {
    // Swallow observer errors so they don't break tool execution
  }
}

// Idempotent tools that can be safely cached
const CACHEABLE_TOOLS = new Set(['Read', 'read_file', 'Glob', 'glob_search', 'Grep', 'grep_search', 'find_definition', 'analyze_code_quality', 'extract_exports']);
function buildOptimizationHint(warning) {
  const code = warning.code;
  const suggestion = warning.suggestion || warning.message;
  switch (code) {
    case 'SEARCH_BROAD_PATTERN':
    case 'SEARCH_CONTEXT_OVERFLOW_RISK':
      return `\n\n<optimization-hint>\n` + `⚡ SEARCH: ${suggestion}\n` + `</optimization-hint>`;
    case _toolPreconditions.EDIT_WITHOUT_READ:
    case 'EDIT_PLACEHOLDER':
      return `\n\n<optimization-hint>\n` + `⚡ EDIT: Read the file first to copy exact whitespace. ${suggestion}\n` + `</optimization-hint>`;
    case 'NPM_INCOMPLETE_WORKFLOW':
      return `\n\n<optimization-hint>\n` + `⚡ PUBLISH: ${suggestion}\n` + `</optimization-hint>`;
    default:
      return null;
  }
}

/**
 * Type-safe utility functions for tool runtime operations
 */
let ToolRuntimeUtils = exports.ToolRuntimeUtils = void 0;
(function (_ToolRuntimeUtils) {
  function createToolDefinition(definition) {
    return definition;
  }
  _ToolRuntimeUtils.createToolDefinition = createToolDefinition;
  function createToolSuite(suite) {
    return suite;
  }
  _ToolRuntimeUtils.createToolSuite = createToolSuite;
  function isToolDefinition(__tool, expectedSchema) {
    if (!expectedSchema) return true;
    // In a real implementation, this would validate against the schema
    return true;
  }
  _ToolRuntimeUtils.isToolDefinition = isToolDefinition;
})(ToolRuntimeUtils || (exports.ToolRuntimeUtils = ToolRuntimeUtils = {}));
/**
 * Interface describing the public API of ToolRuntime.
 * Used by wrapper implementations like RestrictedToolRuntime.
 */
class ToolRuntime {
  registry = new Map();
  registrationOrder = [];
  cache = new Map();
  toolHistory = [];
  maxHistorySize = 50; // Keep last 50 tool calls for AI flow pattern detection
  diffSnapshots = [];
  maxDiffSnapshots = 5; // Keep only the most recent git diff outputs
  maxDiffSnapshotLength = 4000;
  constructor(baseTools = [], options = {}) {
    this.observer = options.observer ?? null;
    this.contextManager = options.contextManager ?? null;
    this.enableCache = options.enableCache ?? true;
    this.cacheTTLMs = options.cacheTTLMs ?? 5 * 60 * 1000; // 5 minutes default
    if (baseTools.length) {
      this.registerSuite({
        id: 'runtime.core',
        description: 'Core runtime metadata tools',
        tools: baseTools
      });
    }
  }
  registerSuite(suite) {
    if (!suite?.id?.trim()) {
      throw new Error('Tool suite id cannot be blank.');
    }
    this.unregisterSuite(suite.id);
    for (const definition of suite.tools ?? []) {
      this.addTool(definition, suite.id);
    }
  }
  unregisterSuite(id) {
    if (!id?.trim()) {
      return;
    }
    for (const [name, record] of this.registry.entries()) {
      if (record.suiteId === id) {
        this.registry.delete(name);
        this.removeFromOrder(name);
      }
    }
  }
  listProviderTools() {
    return this.registrationOrder.map(name => this.registry.get(name)).filter(record => Boolean(record)).map(({
      definition
    }) => ({
      name: definition.name,
      description: definition.description,
      ...(definition.parameters && {
        parameters: definition.parameters
      })
    }));
  }
  async execute(call, _context) {
    const record = this.registry.get(call.name);
    const rawArgs = normalizeToolArguments(call.arguments);
    const args = (0, _schemaValidator.coerceToolArguments)(record?.definition.parameters, rawArgs);
    const augmentedCall = {
      ...call,
      args
    };
    if (!record) {
      const message = `Tool "${call.name}" is not available.`;
      this.observer?.onToolError?.(augmentedCall, message);
      globalPerformanceMonitor.recordToolError(call, message);
      return message;
    }

    // Check if tool is cacheable
    const isCacheable = record.definition.cacheable ?? CACHEABLE_TOOLS.has(call.name);
    const cacheTtl = typeof record.definition.cacheTtlMs === 'number' && Number.isFinite(record.definition.cacheTtlMs) ? Math.max(0, Math.floor(record.definition.cacheTtlMs)) : this.cacheTTLMs;
    const canUseCache = this.enableCache && isCacheable && cacheTtl > 0;

    // Try to get from cache
    if (canUseCache) {
      const cacheKey = this.getCacheKey({
        ...call,
        arguments: args
      });
      const cached = this.cache.get(cacheKey);
      if (cached && Date.now() - cached.timestamp < cacheTtl) {
        this.observer?.onCacheHit?.(augmentedCall);
        this.observer?.onToolResult?.(augmentedCall, cached.result);

        // Record cache hit as successful execution with 0ms time
        globalPerformanceMonitor.startToolCall(call)();
        this.recordToolHistory({
          toolName: call.name,
          args,
          timestamp: Date.now(),
          success: true,
          hasOutput: hasNonEmptyOutput(cached.result)
        });
        return cached.result;
      }
    }
    this.observer?.onToolStart?.(augmentedCall);

    // Start performance monitoring
    const finishToolCall = globalPerformanceMonitor.startToolCall(call);
    try {
      (0, _schemaValidator.validateToolArguments)(record.definition.name, record.definition.parameters, args);

      // Pre-flight AI flow validation - catch common tool usage failures
      const preflightWarnings = (0, _toolPreconditions.validateToolPreconditions)(call.name, args);
      for (const warning of preflightWarnings) {
        this.observer?.onToolWarning?.(augmentedCall, warning);
      }

      // Advanced AI flow pattern validation using tool history
      const aiFlowWarnings = (0, _toolPreconditions.validateAIFlowPatterns)(call.name, args, this.toolHistory);
      for (const warning of aiFlowWarnings) {
        this.observer?.onToolWarning?.(augmentedCall, warning);
      }

      // Collect optimization hints to inject into result
      const optimizationHints = [];
      const seenOptimizationCodes = new Set();
      for (const warning of [...preflightWarnings, ...aiFlowWarnings]) {
        if (warning.code && seenOptimizationCodes.has(warning.code)) {
          continue;
        }
        const hint = buildOptimizationHint(warning);
        if (hint) {
          if (warning.code) {
            seenOptimizationCodes.add(warning.code);
          }
          optimizationHints.push(hint);
        }
      }
      const result = await toolExecutionContext.run({
        call: augmentedCall,
        observer: this.observer ?? undefined
      }, async () => record.definition.handler(args));
      let output = typeof result === 'string' ? result : JSON.stringify(result, null, 2);
      let snapshotCandidate = output;

      // Truncate output if context manager is available
      if (this.contextManager) {
        const truncated = this.contextManager.truncateToolOutput(output, call.name);
        if (truncated.wasTruncated) {
          output = truncated.content;
          // Log truncation for debugging
          if (process.env['DEBUG_CONTEXT']) {
            (0, _debugLogger.logDebug)(`[Context Manager] Truncated ${call.name} output: ${truncated.originalLength} -> ${truncated.truncatedLength} chars`);
          }
        }
        snapshotCandidate = output;
      }
      this.recordDiffSnapshot(args, snapshotCandidate);

      // Cache the result if cacheable
      if (canUseCache) {
        const cacheKey = this.getCacheKey({
          ...call,
          arguments: args
        });
        this.cache.set(cacheKey, {
          result: output,
          timestamp: Date.now()
        });
      }

      // Append optimization hints to guide future LLM behavior
      if (optimizationHints.length > 0) {
        output = output + optimizationHints.join('');
      }
      this.observer?.onToolResult?.(augmentedCall, output);
      this.recordToolHistory({
        toolName: call.name,
        args,
        timestamp: Date.now(),
        success: true,
        hasOutput: hasNonEmptyOutput(output)
      });

      // Record successful execution
      finishToolCall();
      return output;
    } catch (error) {
      let formatted;
      if (error instanceof _schemaValidator.ToolArgumentValidationError) {
        formatted = error.message;
      } else {
        const message = error instanceof Error ? error.message : String(error);
        formatted = `Failed to run "${call.name}": ${message}`;
      }
      this.observer?.onToolError?.(augmentedCall, formatted);
      this.recordToolHistory({
        toolName: call.name,
        args,
        timestamp: Date.now(),
        success: false,
        hasOutput: hasNonEmptyOutput(formatted),
        error: formatted
      });

      // Record failed execution
      globalPerformanceMonitor.recordToolError(call, formatted);
      return formatted;
    }
  }
  getCacheKey(call) {
    return `${call.name}:${JSON.stringify(call.arguments)}`;
  }
  clearCache() {
    this.cache.clear();
  }
  getCacheStats() {
    let totalSize = 0;
    for (const entry of this.cache.values()) {
      totalSize += entry.result.length;
    }
    return {
      size: totalSize,
      entries: this.cache.size
    };
  }
  clearToolHistory() {
    this.toolHistory.length = 0;
  }
  getToolHistory() {
    return this.toolHistory;
  }
  recordToolHistory(entry) {
    this.toolHistory.push(entry);
    if (this.toolHistory.length > this.maxHistorySize) {
      this.toolHistory.shift();
    }
  }
  clearDiffSnapshots() {
    this.diffSnapshots.length = 0;
  }
  getDiffSnapshots() {
    return this.diffSnapshots;
  }
  addTool(definition, suiteId) {
    if (!definition?.name?.trim()) {
      throw new Error(`Tool names cannot be blank (suite "${suiteId}").`);
    }
    if (this.registry.has(definition.name)) {
      const owner = this.registry.get(definition.name)?.suiteId ?? 'unknown';
      throw new Error(`Tool "${definition.name}" already registered by suite "${owner}".`);
    }
    this.registry.set(definition.name, {
      suiteId,
      definition
    });
    this.registrationOrder.push(definition.name);
  }
  removeFromOrder(name) {
    const index = this.registrationOrder.indexOf(name);
    if (index >= 0) {
      this.registrationOrder.splice(index, 1);
    }
  }
  recordDiffSnapshot(args, output) {
    const command = this.findGitDiffCommand(args);
    if (!command || !output) {
      return;
    }
    this.diffSnapshots.push({
      command,
      output: (0, _resultVerification.safeTruncate)(output, this.maxDiffSnapshotLength, 'git-diff'),
      timestamp: Date.now()
    });
    if (this.diffSnapshots.length > this.maxDiffSnapshots) {
      this.diffSnapshots.shift();
    }
  }
  findGitDiffCommand(args) {
    for (const command of this.extractCommands(args)) {
      if (this.isGitDiffCommand(command)) {
        return command;
      }
    }
    return null;
  }
  extractCommands(args) {
    const commands = [];
    const command = args['command'];
    if (typeof command === 'string' && command.trim()) {
      commands.push(command.trim());
    }
    const commandList = args['commands'];
    if (Array.isArray(commandList)) {
      for (const value of commandList) {
        if (typeof value === 'string' && value.trim()) {
          commands.push(value.trim());
        }
      }
    }
    return commands;
  }
  isGitDiffCommand(command) {
    return /\bgit\s+(?:--no-pager\s+)?(?:diff|show)\b/i.test(command);
  }
}
exports.ToolRuntime = ToolRuntime;
function createDefaultToolRuntime(context, toolSuites = [], options = {}) {
  // Start with no default introspection tools - they waste tokens
  // Model knows its capabilities from tool definitions
  const runtime = new ToolRuntime([], options);
  for (const suite of toolSuites) {
    runtime.registerSuite(suite);
  }
  return runtime;
}

// Removed unused introspection tools (context_snapshot, capabilities_overview, profile_details)
// Model already knows capabilities from tool definitions; these just wasted tokens

function hasNonEmptyOutput(output) {
  return typeof output === 'string' && output.trim().length > 0;
}
function normalizeToolArguments(value) {
  if (value instanceof Map) {
    return Object.fromEntries(value.entries());
  }
  if (isRecord(value)) {
    return value;
  }
  if (typeof value === 'string') {
    const trimmed = value.trim();
    if (!trimmed) {
      return {};
    }
    try {
      const parsed = JSON.parse(trimmed);
      return isRecord(parsed) ? parsed : {};
    } catch {
      return {};
    }
  }
  return {};
}
function isRecord(value) {
  return typeof value === 'object' && value !== null && !Array.isArray(value);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUFzeW5jX2hvb2tzIiwicmVxdWlyZSIsIl9zY2hlbWFWYWxpZGF0b3IiLCJfdG9vbFByZWNvbmRpdGlvbnMiLCJfcmVzdWx0VmVyaWZpY2F0aW9uIiwiX2RlYnVnTG9nZ2VyIiwiZ2xvYmFsUGVyZm9ybWFuY2VNb25pdG9yIiwic3RhcnRPcGVyYXRpb24iLCJfbmFtZSIsImVuZCIsImdldE1ldHJpY3MiLCJyZWNvcmRUb29sRXJyb3IiLCJfY2FsbCIsIl9lcnJvciIsInN0YXJ0VG9vbENhbGwiLCJ0b29sRXhlY3V0aW9uQ29udGV4dCIsIkFzeW5jTG9jYWxTdG9yYWdlIiwicmVwb3J0VG9vbFByb2dyZXNzIiwicHJvZ3Jlc3MiLCJjb250ZXh0IiwiZ2V0U3RvcmUiLCJvYnNlcnZlciIsIm9uVG9vbFByb2dyZXNzIiwiY3VycmVudCIsIk51bWJlciIsImlzRmluaXRlIiwiTWF0aCIsIm1heCIsInRvdGFsIiwidW5kZWZpbmVkIiwiY2FsbCIsIm1lc3NhZ2UiLCJDQUNIRUFCTEVfVE9PTFMiLCJTZXQiLCJidWlsZE9wdGltaXphdGlvbkhpbnQiLCJ3YXJuaW5nIiwiY29kZSIsInN1Z2dlc3Rpb24iLCJFRElUX1dJVEhPVVRfUkVBRCIsIlRvb2xSdW50aW1lVXRpbHMiLCJleHBvcnRzIiwiX1Rvb2xSdW50aW1lVXRpbHMiLCJjcmVhdGVUb29sRGVmaW5pdGlvbiIsImRlZmluaXRpb24iLCJjcmVhdGVUb29sU3VpdGUiLCJzdWl0ZSIsImlzVG9vbERlZmluaXRpb24iLCJfX3Rvb2wiLCJleHBlY3RlZFNjaGVtYSIsIlRvb2xSdW50aW1lIiwicmVnaXN0cnkiLCJNYXAiLCJyZWdpc3RyYXRpb25PcmRlciIsImNhY2hlIiwidG9vbEhpc3RvcnkiLCJtYXhIaXN0b3J5U2l6ZSIsImRpZmZTbmFwc2hvdHMiLCJtYXhEaWZmU25hcHNob3RzIiwibWF4RGlmZlNuYXBzaG90TGVuZ3RoIiwiY29uc3RydWN0b3IiLCJiYXNlVG9vbHMiLCJvcHRpb25zIiwiY29udGV4dE1hbmFnZXIiLCJlbmFibGVDYWNoZSIsImNhY2hlVFRMTXMiLCJsZW5ndGgiLCJyZWdpc3RlclN1aXRlIiwiaWQiLCJkZXNjcmlwdGlvbiIsInRvb2xzIiwidHJpbSIsIkVycm9yIiwidW5yZWdpc3RlclN1aXRlIiwiYWRkVG9vbCIsIm5hbWUiLCJyZWNvcmQiLCJlbnRyaWVzIiwic3VpdGVJZCIsImRlbGV0ZSIsInJlbW92ZUZyb21PcmRlciIsImxpc3RQcm92aWRlclRvb2xzIiwibWFwIiwiZ2V0IiwiZmlsdGVyIiwiQm9vbGVhbiIsInBhcmFtZXRlcnMiLCJleGVjdXRlIiwiX2NvbnRleHQiLCJyYXdBcmdzIiwibm9ybWFsaXplVG9vbEFyZ3VtZW50cyIsImFyZ3VtZW50cyIsImFyZ3MiLCJjb2VyY2VUb29sQXJndW1lbnRzIiwiYXVnbWVudGVkQ2FsbCIsIm9uVG9vbEVycm9yIiwiaXNDYWNoZWFibGUiLCJjYWNoZWFibGUiLCJoYXMiLCJjYWNoZVR0bCIsImNhY2hlVHRsTXMiLCJmbG9vciIsImNhblVzZUNhY2hlIiwiY2FjaGVLZXkiLCJnZXRDYWNoZUtleSIsImNhY2hlZCIsIkRhdGUiLCJub3ciLCJ0aW1lc3RhbXAiLCJvbkNhY2hlSGl0Iiwib25Ub29sUmVzdWx0IiwicmVzdWx0IiwicmVjb3JkVG9vbEhpc3RvcnkiLCJ0b29sTmFtZSIsInN1Y2Nlc3MiLCJoYXNPdXRwdXQiLCJoYXNOb25FbXB0eU91dHB1dCIsIm9uVG9vbFN0YXJ0IiwiZmluaXNoVG9vbENhbGwiLCJ2YWxpZGF0ZVRvb2xBcmd1bWVudHMiLCJwcmVmbGlnaHRXYXJuaW5ncyIsInZhbGlkYXRlVG9vbFByZWNvbmRpdGlvbnMiLCJvblRvb2xXYXJuaW5nIiwiYWlGbG93V2FybmluZ3MiLCJ2YWxpZGF0ZUFJRmxvd1BhdHRlcm5zIiwib3B0aW1pemF0aW9uSGludHMiLCJzZWVuT3B0aW1pemF0aW9uQ29kZXMiLCJoaW50IiwiYWRkIiwicHVzaCIsInJ1biIsImhhbmRsZXIiLCJvdXRwdXQiLCJKU09OIiwic3RyaW5naWZ5Iiwic25hcHNob3RDYW5kaWRhdGUiLCJ0cnVuY2F0ZWQiLCJ0cnVuY2F0ZVRvb2xPdXRwdXQiLCJ3YXNUcnVuY2F0ZWQiLCJjb250ZW50IiwicHJvY2VzcyIsImVudiIsImxvZ0RlYnVnIiwib3JpZ2luYWxMZW5ndGgiLCJ0cnVuY2F0ZWRMZW5ndGgiLCJyZWNvcmREaWZmU25hcHNob3QiLCJzZXQiLCJqb2luIiwiZXJyb3IiLCJmb3JtYXR0ZWQiLCJUb29sQXJndW1lbnRWYWxpZGF0aW9uRXJyb3IiLCJTdHJpbmciLCJjbGVhckNhY2hlIiwiY2xlYXIiLCJnZXRDYWNoZVN0YXRzIiwidG90YWxTaXplIiwiZW50cnkiLCJ2YWx1ZXMiLCJzaXplIiwiY2xlYXJUb29sSGlzdG9yeSIsImdldFRvb2xIaXN0b3J5Iiwic2hpZnQiLCJjbGVhckRpZmZTbmFwc2hvdHMiLCJnZXREaWZmU25hcHNob3RzIiwib3duZXIiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJjb21tYW5kIiwiZmluZEdpdERpZmZDb21tYW5kIiwic2FmZVRydW5jYXRlIiwiZXh0cmFjdENvbW1hbmRzIiwiaXNHaXREaWZmQ29tbWFuZCIsImNvbW1hbmRzIiwiY29tbWFuZExpc3QiLCJBcnJheSIsImlzQXJyYXkiLCJ2YWx1ZSIsInRlc3QiLCJjcmVhdGVEZWZhdWx0VG9vbFJ1bnRpbWUiLCJ0b29sU3VpdGVzIiwicnVudGltZSIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiaXNSZWNvcmQiLCJ0cmltbWVkIiwicGFyc2VkIiwicGFyc2UiXSwic291cmNlcyI6WyJ0b29sUnVudGltZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbmFtZXNwYWNlICovXG5pbXBvcnQgeyBBc3luY0xvY2FsU3RvcmFnZSB9IGZyb20gJ25vZGU6YXN5bmNfaG9va3MnO1xuaW1wb3J0IHtcbiAgdHlwZSBKU09OU2NoZW1hT2JqZWN0LFxuICB0eXBlIFByb3ZpZGVySWQsXG4gIHR5cGUgUHJvdmlkZXJUb29sRGVmaW5pdGlvbixcbiAgdHlwZSBUb29sQ2FsbFJlcXVlc3QsXG59IGZyb20gJy4vdHlwZXMuanMnO1xuaW1wb3J0IHtcbiAgVG9vbEFyZ3VtZW50VmFsaWRhdGlvbkVycm9yLFxuICBjb2VyY2VUb29sQXJndW1lbnRzLFxuICB2YWxpZGF0ZVRvb2xBcmd1bWVudHMsXG59IGZyb20gJy4vc2NoZW1hVmFsaWRhdG9yLmpzJztcbmltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9jb250ZXh0TWFuYWdlci5qcyc7XG4vLyBQZXJmb3JtYW5jZSBtb25pdG9yIHN0dWIgKGxlZ2FjeSBtb2R1bGUgcmVtb3ZlZClcbmNvbnN0IGdsb2JhbFBlcmZvcm1hbmNlTW9uaXRvciA9IHtcbiAgc3RhcnRPcGVyYXRpb246IChfbmFtZTogc3RyaW5nKSA9PiAoeyBlbmQ6ICgpID0+IHt9IH0pLFxuICBnZXRNZXRyaWNzOiAoKSA9PiAoe30pLFxuICByZWNvcmRUb29sRXJyb3I6IChfY2FsbDogdW5rbm93biwgX2Vycm9yOiB1bmtub3duKSA9PiB7fSxcbiAgc3RhcnRUb29sQ2FsbDogKF9jYWxsOiB1bmtub3duKSA9PiAoKSA9PiB7fSxcbn07XG5pbXBvcnQgeyB2YWxpZGF0ZVRvb2xQcmVjb25kaXRpb25zLCB2YWxpZGF0ZUFJRmxvd1BhdHRlcm5zLCBFRElUX1dJVEhPVVRfUkVBRCwgdHlwZSBQcmVmbGlnaHRXYXJuaW5nIH0gZnJvbSAnLi90b29sUHJlY29uZGl0aW9ucy5qcyc7XG5pbXBvcnQgeyBzYWZlVHJ1bmNhdGUgfSBmcm9tICcuL3Jlc3VsdFZlcmlmaWNhdGlvbi5qcyc7XG5pbXBvcnQgeyBsb2dEZWJ1ZyB9IGZyb20gJy4uL3V0aWxzL2RlYnVnTG9nZ2VyLmpzJztcblxuLyoqXG4gKiBFeGVjdXRpb24gY29udGV4dCBmb3IgdG9vbCBvcGVyYXRpb25zIHdpdGggc3RyaWN0IFR5cGVTY3JpcHQgdHlwaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVG9vbEV4ZWN1dGlvbkNvbnRleHQge1xuICByZWFkb25seSBwcm9maWxlTmFtZTogc3RyaW5nO1xuICByZWFkb25seSBwcm92aWRlcjogUHJvdmlkZXJJZDtcbiAgcmVhZG9ubHkgbW9kZWw6IHN0cmluZztcbiAgcmVhZG9ubHkgd29ya3NwYWNlQ29udGV4dD86IHN0cmluZyB8IG51bGw7XG59XG5cbi8qKlxuICogVHlwZS1zYWZlIHRvb2wgb2JzZXJ2ZXIgd2l0aCBnZW5lcmljIHBhcmFtZXRlciBpbmZlcmVuY2UgZm9yIEFJIGZsb3cgbW9uaXRvcmluZ1xuICovXG5leHBvcnQgaW50ZXJmYWNlIFRvb2xSdW50aW1lT2JzZXJ2ZXI8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0gUmVjb3JkPHN0cmluZywgdW5rbm93bj4+IHtcbiAgLyoqIENhbGxlZCB3aGVuIHRvb2wgZXhlY3V0aW9uIGJlZ2lucyAqL1xuICBvblRvb2xTdGFydD8oY2FsbDogVG9vbENhbGxSZXF1ZXN0ICYgeyBhcmdzOiBUIH0pOiB2b2lkO1xuICBcbiAgLyoqIENhbGxlZCB3aGVuIHRvb2wgZXhlY3V0aW9uIGNvbXBsZXRlcyBzdWNjZXNzZnVsbHkgKi9cbiAgb25Ub29sUmVzdWx0PyhjYWxsOiBUb29sQ2FsbFJlcXVlc3QgJiB7IGFyZ3M6IFQgfSwgb3V0cHV0OiBzdHJpbmcpOiB2b2lkO1xuICBcbiAgLyoqIENhbGxlZCB3aGVuIHRvb2wgZXhlY3V0aW9uIGZhaWxzICovXG4gIG9uVG9vbEVycm9yPyhjYWxsOiBUb29sQ2FsbFJlcXVlc3QgJiB7IGFyZ3M6IFQgfSwgZXJyb3I6IHN0cmluZyk6IHZvaWQ7XG4gIFxuICAvKiogQ2FsbGVkIHdoZW4gY2FjaGVkIHJlc3VsdCBpcyB1c2VkIGluc3RlYWQgb2YgZXhlY3V0aW9uICovXG4gIG9uQ2FjaGVIaXQ/KGNhbGw6IFRvb2xDYWxsUmVxdWVzdCAmIHsgYXJnczogVCB9KTogdm9pZDtcbiAgXG4gIC8qKiBDYWxsZWQgZm9yIHByb2dyZXNzIHVwZGF0ZXMgZHVyaW5nIGxvbmctcnVubmluZyBvcGVyYXRpb25zICovXG4gIG9uVG9vbFByb2dyZXNzPyhjYWxsOiBUb29sQ2FsbFJlcXVlc3QgJiB7IGFyZ3M6IFQgfSwgcHJvZ3Jlc3M6IFRvb2xQcm9ncmVzc1VwZGF0ZSk6IHZvaWQ7XG4gIFxuICAvKiogQ2FsbGVkIGZvciBwcmUtZmxpZ2h0IHdhcm5pbmdzIGJlZm9yZSB0b29sIGV4ZWN1dGlvbiAqL1xuICBvblRvb2xXYXJuaW5nPyhjYWxsOiBUb29sQ2FsbFJlcXVlc3QgJiB7IGFyZ3M6IFQgfSwgd2FybmluZzogUHJlZmxpZ2h0V2FybmluZyB8IHN0cmluZyk6IHZvaWQ7XG59XG5cbmludGVyZmFjZSBUb29sUnVudGltZU9wdGlvbnMge1xuICByZWFkb25seSBvYnNlcnZlcj86IFRvb2xSdW50aW1lT2JzZXJ2ZXI7XG4gIHJlYWRvbmx5IGNvbnRleHRNYW5hZ2VyPzogQ29udGV4dE1hbmFnZXI7XG4gIHJlYWRvbmx5IGVuYWJsZUNhY2hlPzogYm9vbGVhbjtcbiAgcmVhZG9ubHkgY2FjaGVUVExNcz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBHZW5lcmljIHRvb2wgaGFuZGxlciB3aXRoIHBhcmFtZXRlciB0eXBlIGluZmVyZW5jZSBmb3IgQUkgZmxvdyBleGVjdXRpb25cbiAqL1xudHlwZSBUb29sSGFuZGxlcjxUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4gPSAoXG4gIGFyZ3M6IFRcbikgPT4gUHJvbWlzZTxzdHJpbmc+IHwgc3RyaW5nO1xuXG4vKipcbiAqIEVuaGFuY2VkIHRvb2wgZGVmaW5pdGlvbiB3aXRoIHBhcmFtZXRlciB0eXBlIHNhZmV0eSBmb3IgQUkgc29mdHdhcmUgZW5naW5lZXJpbmdcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUb29sRGVmaW5pdGlvbjxUIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4ge1xuICAvKiogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB0b29sICovXG4gIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAgXG4gIC8qKiBIdW1hbi1yZWFkYWJsZSBkZXNjcmlwdGlvbiBmb3IgQUkgdW5kZXJzdGFuZGluZyAqL1xuICByZWFkb25seSBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBcbiAgLyoqIEpTT04gU2NoZW1hIGRlZmluaW5nIHRoZSB0b29sJ3MgcGFyYW1ldGVyIHN0cnVjdHVyZSAqL1xuICByZWFkb25seSBwYXJhbWV0ZXJzPzogSlNPTlNjaGVtYU9iamVjdDtcbiAgXG4gIC8qKiBGdW5jdGlvbiB0aGF0IGltcGxlbWVudHMgdGhlIHRvb2wncyBiZWhhdmlvciAqL1xuICByZWFkb25seSBoYW5kbGVyOiBUb29sSGFuZGxlcjxUPjtcbiAgXG4gIC8qKiBXaGV0aGVyIHJlc3VsdHMgY2FuIGJlIGNhY2hlZCBmb3IgcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uICovXG4gIHJlYWRvbmx5IGNhY2hlYWJsZT86IGJvb2xlYW47XG5cbiAgLyoqIE9wdGlvbmFsIHBlci10b29sIGNhY2hlIFRUTCBpbiBtaWxsaXNlY29uZHMgKGZhbGxzIGJhY2sgdG8gcnVudGltZSBkZWZhdWx0KSAqL1xuICByZWFkb25seSBjYWNoZVR0bE1zPzogbnVtYmVyO1xufVxuXG4vKipcbiAqIENvbGxlY3Rpb24gb2YgcmVsYXRlZCB0b29scyBncm91cGVkIGJ5IGZ1bmN0aW9uYWxpdHlcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBUb29sU3VpdGUge1xuICAvKiogVW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB0b29sIHN1aXRlICovXG4gIHJlYWRvbmx5IGlkOiBzdHJpbmc7XG4gIFxuICAvKiogSHVtYW4tcmVhZGFibGUgZGVzY3JpcHRpb24gb2YgdGhlIHN1aXRlJ3MgcHVycG9zZSAqL1xuICByZWFkb25seSBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgXG4gIC8qKiBBcnJheSBvZiB0b29sIGRlZmluaXRpb25zIGluIHRoaXMgc3VpdGUgKi9cbiAgcmVhZG9ubHkgdG9vbHM6IHJlYWRvbmx5IFRvb2xEZWZpbml0aW9uW107XG59XG5cbmludGVyZmFjZSBUb29sUmVjb3JkIHtcbiAgc3VpdGVJZDogc3RyaW5nO1xuICBkZWZpbml0aW9uOiBUb29sRGVmaW5pdGlvbjtcbn1cblxuaW50ZXJmYWNlIENhY2hlRW50cnkge1xuICByZXN1bHQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVG9vbEhpc3RvcnlFbnRyeSB7XG4gIHRvb2xOYW1lOiBzdHJpbmc7XG4gIGFyZ3M6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgaGFzT3V0cHV0OiBib29sZWFuO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEaWZmU25hcHNob3RSZWNvcmQge1xuICBjb21tYW5kOiBzdHJpbmc7XG4gIG91dHB1dDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb29sUHJvZ3Jlc3NVcGRhdGUge1xuICBjdXJyZW50OiBudW1iZXI7XG4gIHRvdGFsPzogbnVtYmVyO1xuICBtZXNzYWdlPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgVG9vbEV4ZWN1dGlvblN0b3JlIHtcbiAgY2FsbDogVG9vbENhbGxSZXF1ZXN0ICYgeyBhcmdzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB9O1xuICBvYnNlcnZlcj86IFRvb2xSdW50aW1lT2JzZXJ2ZXI7XG59XG5cbmNvbnN0IHRvb2xFeGVjdXRpb25Db250ZXh0ID0gbmV3IEFzeW5jTG9jYWxTdG9yYWdlPFRvb2xFeGVjdXRpb25TdG9yZT4oKTtcblxuLyoqXG4gKiBSZXBvcnQgaW5jcmVtZW50YWwgcHJvZ3Jlc3MgZm9yIHRoZSBjdXJyZW50bHkgZXhlY3V0aW5nIHRvb2wuXG4gKiBUb29scyBjYW4gY2FsbCB0aGlzIHRvIHN1cmZhY2UgbGl2ZSBzdGF0dXMgdXBkYXRlcyAoZS5nLiwgaW5kZXhpbmcgZmlsZXMpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVwb3J0VG9vbFByb2dyZXNzKHByb2dyZXNzOiBUb29sUHJvZ3Jlc3NVcGRhdGUpOiB2b2lkIHtcbiAgY29uc3QgY29udGV4dCA9IHRvb2xFeGVjdXRpb25Db250ZXh0LmdldFN0b3JlKCk7XG4gIGlmICghY29udGV4dD8ub2JzZXJ2ZXI/Lm9uVG9vbFByb2dyZXNzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY3VycmVudCA9IE51bWJlci5pc0Zpbml0ZShwcm9ncmVzcy5jdXJyZW50KSA/IE1hdGgubWF4KDAsIHByb2dyZXNzLmN1cnJlbnQpIDogMDtcbiAgY29uc3QgdG90YWwgPSBwcm9ncmVzcy50b3RhbCAhPT0gdW5kZWZpbmVkID8gTWF0aC5tYXgoY3VycmVudCwgcHJvZ3Jlc3MudG90YWwpIDogY3VycmVudDtcblxuICB0cnkge1xuICAgIGNvbnRleHQub2JzZXJ2ZXIub25Ub29sUHJvZ3Jlc3MoY29udGV4dC5jYWxsLCB7XG4gICAgICBjdXJyZW50LFxuICAgICAgdG90YWwsXG4gICAgICBtZXNzYWdlOiBwcm9ncmVzcy5tZXNzYWdlLFxuICAgIH0pO1xuICB9IGNhdGNoIHtcbiAgICAvLyBTd2FsbG93IG9ic2VydmVyIGVycm9ycyBzbyB0aGV5IGRvbid0IGJyZWFrIHRvb2wgZXhlY3V0aW9uXG4gIH1cbn1cblxuLy8gSWRlbXBvdGVudCB0b29scyB0aGF0IGNhbiBiZSBzYWZlbHkgY2FjaGVkXG5jb25zdCBDQUNIRUFCTEVfVE9PTFMgPSBuZXcgU2V0KFtcbiAgJ1JlYWQnLFxuICAncmVhZF9maWxlJyxcbiAgJ0dsb2InLFxuICAnZ2xvYl9zZWFyY2gnLFxuICAnR3JlcCcsXG4gICdncmVwX3NlYXJjaCcsXG4gICdmaW5kX2RlZmluaXRpb24nLFxuICAnYW5hbHl6ZV9jb2RlX3F1YWxpdHknLFxuICAnZXh0cmFjdF9leHBvcnRzJyxcbl0pO1xuXG5mdW5jdGlvbiBidWlsZE9wdGltaXphdGlvbkhpbnQoXG4gIHdhcm5pbmc6IFByZWZsaWdodFdhcm5pbmcgfCB7IGNvZGU/OiBzdHJpbmc7IHN1Z2dlc3Rpb24/OiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZyB9XG4pOiBzdHJpbmcgfCBudWxsIHtcbiAgY29uc3QgY29kZSA9IHdhcm5pbmcuY29kZTtcbiAgY29uc3Qgc3VnZ2VzdGlvbiA9IHdhcm5pbmcuc3VnZ2VzdGlvbiB8fCB3YXJuaW5nLm1lc3NhZ2U7XG5cbiAgc3dpdGNoIChjb2RlKSB7XG4gICAgY2FzZSAnU0VBUkNIX0JST0FEX1BBVFRFUk4nOlxuICAgIGNhc2UgJ1NFQVJDSF9DT05URVhUX09WRVJGTE9XX1JJU0snOlxuICAgICAgcmV0dXJuIChcbiAgICAgICAgYFxcblxcbjxvcHRpbWl6YXRpb24taGludD5cXG5gICtcbiAgICAgICAgYOKaoSBTRUFSQ0g6ICR7c3VnZ2VzdGlvbn1cXG5gICtcbiAgICAgICAgYDwvb3B0aW1pemF0aW9uLWhpbnQ+YFxuICAgICAgKTtcbiAgICBjYXNlIEVESVRfV0lUSE9VVF9SRUFEOlxuICAgIGNhc2UgJ0VESVRfUExBQ0VIT0xERVInOlxuICAgICAgcmV0dXJuIChcbiAgICAgICAgYFxcblxcbjxvcHRpbWl6YXRpb24taGludD5cXG5gICtcbiAgICAgICAgYOKaoSBFRElUOiBSZWFkIHRoZSBmaWxlIGZpcnN0IHRvIGNvcHkgZXhhY3Qgd2hpdGVzcGFjZS4gJHtzdWdnZXN0aW9ufVxcbmAgK1xuICAgICAgICBgPC9vcHRpbWl6YXRpb24taGludD5gXG4gICAgICApO1xuICAgIGNhc2UgJ05QTV9JTkNPTVBMRVRFX1dPUktGTE9XJzpcbiAgICAgIHJldHVybiAoXG4gICAgICAgIGBcXG5cXG48b3B0aW1pemF0aW9uLWhpbnQ+XFxuYCArXG4gICAgICAgIGDimqEgUFVCTElTSDogJHtzdWdnZXN0aW9ufVxcbmAgK1xuICAgICAgICBgPC9vcHRpbWl6YXRpb24taGludD5gXG4gICAgICApO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIFR5cGUtc2FmZSB1dGlsaXR5IGZ1bmN0aW9ucyBmb3IgdG9vbCBydW50aW1lIG9wZXJhdGlvbnNcbiAqL1xuZXhwb3J0IG5hbWVzcGFjZSBUb29sUnVudGltZVV0aWxzIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYSB0eXBlLXNhZmUgdG9vbCBkZWZpbml0aW9uIHdpdGggaW5mZXJyZWQgcGFyYW1ldGVyIHR5cGVzXG4gICAqL1xuICBleHBvcnQgZnVuY3Rpb24gY3JlYXRlVG9vbERlZmluaXRpb248VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIHVua25vd24+PihcbiAgICBkZWZpbml0aW9uOiBUb29sRGVmaW5pdGlvbjxUPlxuICApOiBUb29sRGVmaW5pdGlvbjxUPiB7XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIHR5cGUtc2FmZSB0b29sIHN1aXRlIHdpdGggaW5mZXJyZWQgdG9vbCB0eXBlc1xuICAgKi9cbiAgZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRvb2xTdWl0ZShcbiAgICBzdWl0ZTogVG9vbFN1aXRlXG4gICk6IFRvb2xTdWl0ZSB7XG4gICAgcmV0dXJuIHN1aXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIFR5cGUgZ3VhcmQgdG8gY2hlY2sgaWYgYSB0b29sIGRlZmluaXRpb24gbWF0Y2hlcyBleHBlY3RlZCBwYXJhbWV0ZXIgc2NoZW1hXG4gICAqL1xuICBleHBvcnQgZnVuY3Rpb24gaXNUb29sRGVmaW5pdGlvbihcbiAgICBfX3Rvb2w6IFRvb2xEZWZpbml0aW9uLFxuICAgIGV4cGVjdGVkU2NoZW1hPzogSlNPTlNjaGVtYU9iamVjdFxuICApOiBib29sZWFuIHtcbiAgICBpZiAoIWV4cGVjdGVkU2NoZW1hKSByZXR1cm4gdHJ1ZTtcbiAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgdmFsaWRhdGUgYWdhaW5zdCB0aGUgc2NoZW1hXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxuLyoqXG4gKiBJbnRlcmZhY2UgZGVzY3JpYmluZyB0aGUgcHVibGljIEFQSSBvZiBUb29sUnVudGltZS5cbiAqIFVzZWQgYnkgd3JhcHBlciBpbXBsZW1lbnRhdGlvbnMgbGlrZSBSZXN0cmljdGVkVG9vbFJ1bnRpbWUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVRvb2xSdW50aW1lIHtcbiAgbGlzdFByb3ZpZGVyVG9vbHMoKTogUHJvdmlkZXJUb29sRGVmaW5pdGlvbltdO1xuICBleGVjdXRlKGNhbGw6IFRvb2xDYWxsUmVxdWVzdCwgY29udGV4dD86IHsgcHJvZmlsZU5hbWU/OiBzdHJpbmc7IHByb3ZpZGVyPzogc3RyaW5nOyBtb2RlbD86IHN0cmluZyB9KTogUHJvbWlzZTxzdHJpbmc+O1xuICByZWdpc3RlclN1aXRlKHN1aXRlOiBUb29sU3VpdGUpOiB2b2lkO1xuICB1bnJlZ2lzdGVyU3VpdGUoaWQ6IHN0cmluZyk6IHZvaWQ7XG4gIGNsZWFyQ2FjaGUoKTogdm9pZDtcbiAgZ2V0Q2FjaGVTdGF0cygpOiB7IHNpemU6IG51bWJlcjsgZW50cmllczogbnVtYmVyIH07XG4gIGNsZWFyVG9vbEhpc3RvcnkoKTogdm9pZDtcbiAgZ2V0VG9vbEhpc3RvcnkoKTogcmVhZG9ubHkgVG9vbEhpc3RvcnlFbnRyeVtdO1xuICBjbGVhckRpZmZTbmFwc2hvdHMoKTogdm9pZDtcbiAgZ2V0RGlmZlNuYXBzaG90cygpOiByZWFkb25seSBEaWZmU25hcHNob3RSZWNvcmRbXTtcbn1cblxuZXhwb3J0IGNsYXNzIFRvb2xSdW50aW1lIGltcGxlbWVudHMgSVRvb2xSdW50aW1lIHtcbiAgcHJpdmF0ZSByZWFkb25seSByZWdpc3RyeSA9IG5ldyBNYXA8c3RyaW5nLCBUb29sUmVjb3JkPigpO1xuICBwcml2YXRlIHJlYWRvbmx5IHJlZ2lzdHJhdGlvbk9yZGVyOiBzdHJpbmdbXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IG9ic2VydmVyOiBUb29sUnVudGltZU9ic2VydmVyIHwgbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSBjb250ZXh0TWFuYWdlcjogQ29udGV4dE1hbmFnZXIgfCBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIENhY2hlRW50cnk+KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgZW5hYmxlQ2FjaGU6IGJvb2xlYW47XG4gIHByaXZhdGUgcmVhZG9ubHkgY2FjaGVUVExNczogbnVtYmVyO1xuICBwcml2YXRlIHJlYWRvbmx5IHRvb2xIaXN0b3J5OiBUb29sSGlzdG9yeUVudHJ5W10gPSBbXTtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhIaXN0b3J5U2l6ZSA9IDUwOyAvLyBLZWVwIGxhc3QgNTAgdG9vbCBjYWxscyBmb3IgQUkgZmxvdyBwYXR0ZXJuIGRldGVjdGlvblxuICBwcml2YXRlIHJlYWRvbmx5IGRpZmZTbmFwc2hvdHM6IERpZmZTbmFwc2hvdFJlY29yZFtdID0gW107XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4RGlmZlNuYXBzaG90cyA9IDU7IC8vIEtlZXAgb25seSB0aGUgbW9zdCByZWNlbnQgZ2l0IGRpZmYgb3V0cHV0c1xuICBwcml2YXRlIHJlYWRvbmx5IG1heERpZmZTbmFwc2hvdExlbmd0aCA9IDQwMDA7XG5cbiAgY29uc3RydWN0b3IoYmFzZVRvb2xzOiBUb29sRGVmaW5pdGlvbltdID0gW10sIG9wdGlvbnM6IFRvb2xSdW50aW1lT3B0aW9ucyA9IHt9KSB7XG4gICAgdGhpcy5vYnNlcnZlciA9IG9wdGlvbnMub2JzZXJ2ZXIgPz8gbnVsbDtcbiAgICB0aGlzLmNvbnRleHRNYW5hZ2VyID0gb3B0aW9ucy5jb250ZXh0TWFuYWdlciA/PyBudWxsO1xuICAgIHRoaXMuZW5hYmxlQ2FjaGUgPSBvcHRpb25zLmVuYWJsZUNhY2hlID8/IHRydWU7XG4gICAgdGhpcy5jYWNoZVRUTE1zID0gb3B0aW9ucy5jYWNoZVRUTE1zID8/IDUgKiA2MCAqIDEwMDA7IC8vIDUgbWludXRlcyBkZWZhdWx0XG4gICAgaWYgKGJhc2VUb29scy5sZW5ndGgpIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJTdWl0ZSh7XG4gICAgICAgIGlkOiAncnVudGltZS5jb3JlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdDb3JlIHJ1bnRpbWUgbWV0YWRhdGEgdG9vbHMnLFxuICAgICAgICB0b29sczogYmFzZVRvb2xzLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmVnaXN0ZXJTdWl0ZShzdWl0ZTogVG9vbFN1aXRlKTogdm9pZCB7XG4gICAgaWYgKCFzdWl0ZT8uaWQ/LnRyaW0oKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdUb29sIHN1aXRlIGlkIGNhbm5vdCBiZSBibGFuay4nKTtcbiAgICB9XG4gICAgdGhpcy51bnJlZ2lzdGVyU3VpdGUoc3VpdGUuaWQpO1xuICAgIGZvciAoY29uc3QgZGVmaW5pdGlvbiBvZiBzdWl0ZS50b29scyA/PyBbXSkge1xuICAgICAgdGhpcy5hZGRUb29sKGRlZmluaXRpb24sIHN1aXRlLmlkKTtcbiAgICB9XG4gIH1cblxuICB1bnJlZ2lzdGVyU3VpdGUoaWQ6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghaWQ/LnRyaW0oKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IFtuYW1lLCByZWNvcmRdIG9mIHRoaXMucmVnaXN0cnkuZW50cmllcygpKSB7XG4gICAgICBpZiAocmVjb3JkLnN1aXRlSWQgPT09IGlkKSB7XG4gICAgICAgIHRoaXMucmVnaXN0cnkuZGVsZXRlKG5hbWUpO1xuICAgICAgICB0aGlzLnJlbW92ZUZyb21PcmRlcihuYW1lKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBsaXN0UHJvdmlkZXJUb29scygpOiBQcm92aWRlclRvb2xEZWZpbml0aW9uW10ge1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdHJhdGlvbk9yZGVyXG4gICAgICAubWFwKChuYW1lKSA9PiB0aGlzLnJlZ2lzdHJ5LmdldChuYW1lKSlcbiAgICAgIC5maWx0ZXIoKHJlY29yZCk6IHJlY29yZCBpcyBUb29sUmVjb3JkID0+IEJvb2xlYW4ocmVjb3JkKSlcbiAgICAgIC5tYXAoKHsgZGVmaW5pdGlvbiB9KSA9PiAoe1xuICAgICAgICBuYW1lOiBkZWZpbml0aW9uLm5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZWZpbml0aW9uLmRlc2NyaXB0aW9uLFxuICAgICAgICAuLi4oZGVmaW5pdGlvbi5wYXJhbWV0ZXJzICYmIHsgcGFyYW1ldGVyczogZGVmaW5pdGlvbi5wYXJhbWV0ZXJzIH0pLFxuICAgICAgfSkpO1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZShjYWxsOiBUb29sQ2FsbFJlcXVlc3QsIF9jb250ZXh0PzogeyBwcm9maWxlTmFtZT86IHN0cmluZzsgcHJvdmlkZXI/OiBzdHJpbmc7IG1vZGVsPzogc3RyaW5nIH0pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHJlY29yZCA9IHRoaXMucmVnaXN0cnkuZ2V0KGNhbGwubmFtZSk7XG4gICAgY29uc3QgcmF3QXJncyA9IG5vcm1hbGl6ZVRvb2xBcmd1bWVudHMoY2FsbC5hcmd1bWVudHMpO1xuICAgIGNvbnN0IGFyZ3MgPSBjb2VyY2VUb29sQXJndW1lbnRzKHJlY29yZD8uZGVmaW5pdGlvbi5wYXJhbWV0ZXJzLCByYXdBcmdzKTtcbiAgICBjb25zdCBhdWdtZW50ZWRDYWxsID0geyAuLi5jYWxsLCBhcmdzIH07XG5cbiAgICBpZiAoIXJlY29yZCkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGBUb29sIFwiJHtjYWxsLm5hbWV9XCIgaXMgbm90IGF2YWlsYWJsZS5gO1xuICAgICAgdGhpcy5vYnNlcnZlcj8ub25Ub29sRXJyb3I/LihhdWdtZW50ZWRDYWxsLCBtZXNzYWdlKTtcbiAgICAgIGdsb2JhbFBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRUb29sRXJyb3IoY2FsbCwgbWVzc2FnZSk7XG4gICAgICByZXR1cm4gbWVzc2FnZTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB0b29sIGlzIGNhY2hlYWJsZVxuICAgIGNvbnN0IGlzQ2FjaGVhYmxlID0gcmVjb3JkLmRlZmluaXRpb24uY2FjaGVhYmxlID8/IENBQ0hFQUJMRV9UT09MUy5oYXMoY2FsbC5uYW1lKTtcbiAgICBjb25zdCBjYWNoZVR0bCA9XG4gICAgICB0eXBlb2YgcmVjb3JkLmRlZmluaXRpb24uY2FjaGVUdGxNcyA9PT0gJ251bWJlcicgJiYgTnVtYmVyLmlzRmluaXRlKHJlY29yZC5kZWZpbml0aW9uLmNhY2hlVHRsTXMpXG4gICAgICAgID8gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihyZWNvcmQuZGVmaW5pdGlvbi5jYWNoZVR0bE1zKSlcbiAgICAgICAgOiB0aGlzLmNhY2hlVFRMTXM7XG4gICAgY29uc3QgY2FuVXNlQ2FjaGUgPSB0aGlzLmVuYWJsZUNhY2hlICYmIGlzQ2FjaGVhYmxlICYmIGNhY2hlVHRsID4gMDtcblxuICAgIC8vIFRyeSB0byBnZXQgZnJvbSBjYWNoZVxuICAgIGlmIChjYW5Vc2VDYWNoZSkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldENhY2hlS2V5KHsgLi4uY2FsbCwgYXJndW1lbnRzOiBhcmdzIH0pO1xuICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5jYWNoZS5nZXQoY2FjaGVLZXkpO1xuXG4gICAgICBpZiAoY2FjaGVkICYmIERhdGUubm93KCkgLSBjYWNoZWQudGltZXN0YW1wIDwgY2FjaGVUdGwpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlcj8ub25DYWNoZUhpdD8uKGF1Z21lbnRlZENhbGwpO1xuICAgICAgICB0aGlzLm9ic2VydmVyPy5vblRvb2xSZXN1bHQ/LihhdWdtZW50ZWRDYWxsLCBjYWNoZWQucmVzdWx0KTtcblxuICAgICAgICAvLyBSZWNvcmQgY2FjaGUgaGl0IGFzIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uIHdpdGggMG1zIHRpbWVcbiAgICAgICAgZ2xvYmFsUGVyZm9ybWFuY2VNb25pdG9yLnN0YXJ0VG9vbENhbGwoY2FsbCkoKTtcbiAgICAgICAgdGhpcy5yZWNvcmRUb29sSGlzdG9yeSh7XG4gICAgICAgICAgdG9vbE5hbWU6IGNhbGwubmFtZSxcbiAgICAgICAgICBhcmdzLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGhhc091dHB1dDogaGFzTm9uRW1wdHlPdXRwdXQoY2FjaGVkLnJlc3VsdCksXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2FjaGVkLnJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm9ic2VydmVyPy5vblRvb2xTdGFydD8uKGF1Z21lbnRlZENhbGwpO1xuXG4gICAgLy8gU3RhcnQgcGVyZm9ybWFuY2UgbW9uaXRvcmluZ1xuICAgIGNvbnN0IGZpbmlzaFRvb2xDYWxsID0gZ2xvYmFsUGVyZm9ybWFuY2VNb25pdG9yLnN0YXJ0VG9vbENhbGwoY2FsbCk7XG5cbiAgICB0cnkge1xuICAgICAgdmFsaWRhdGVUb29sQXJndW1lbnRzKHJlY29yZC5kZWZpbml0aW9uLm5hbWUsIHJlY29yZC5kZWZpbml0aW9uLnBhcmFtZXRlcnMsIGFyZ3MpO1xuXG4gICAgICAvLyBQcmUtZmxpZ2h0IEFJIGZsb3cgdmFsaWRhdGlvbiAtIGNhdGNoIGNvbW1vbiB0b29sIHVzYWdlIGZhaWx1cmVzXG4gICAgICBjb25zdCBwcmVmbGlnaHRXYXJuaW5ncyA9IHZhbGlkYXRlVG9vbFByZWNvbmRpdGlvbnMoY2FsbC5uYW1lLCBhcmdzKTtcbiAgICAgIGZvciAoY29uc3Qgd2FybmluZyBvZiBwcmVmbGlnaHRXYXJuaW5ncykge1xuICAgICAgICB0aGlzLm9ic2VydmVyPy5vblRvb2xXYXJuaW5nPy4oYXVnbWVudGVkQ2FsbCwgd2FybmluZyk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFkdmFuY2VkIEFJIGZsb3cgcGF0dGVybiB2YWxpZGF0aW9uIHVzaW5nIHRvb2wgaGlzdG9yeVxuICAgICAgY29uc3QgYWlGbG93V2FybmluZ3MgPSB2YWxpZGF0ZUFJRmxvd1BhdHRlcm5zKGNhbGwubmFtZSwgYXJncywgdGhpcy50b29sSGlzdG9yeSk7XG4gICAgICBmb3IgKGNvbnN0IHdhcm5pbmcgb2YgYWlGbG93V2FybmluZ3MpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlcj8ub25Ub29sV2FybmluZz8uKGF1Z21lbnRlZENhbGwsIHdhcm5pbmcpO1xuICAgICAgfVxuXG4gICAgICAvLyBDb2xsZWN0IG9wdGltaXphdGlvbiBoaW50cyB0byBpbmplY3QgaW50byByZXN1bHRcbiAgICAgIGNvbnN0IG9wdGltaXphdGlvbkhpbnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgY29uc3Qgc2Vlbk9wdGltaXphdGlvbkNvZGVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBmb3IgKGNvbnN0IHdhcm5pbmcgb2YgWy4uLnByZWZsaWdodFdhcm5pbmdzLCAuLi5haUZsb3dXYXJuaW5nc10pIHtcbiAgICAgICAgaWYgKHdhcm5pbmcuY29kZSAmJiBzZWVuT3B0aW1pemF0aW9uQ29kZXMuaGFzKHdhcm5pbmcuY29kZSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBoaW50ID0gYnVpbGRPcHRpbWl6YXRpb25IaW50KHdhcm5pbmcpO1xuICAgICAgICBpZiAoaGludCkge1xuICAgICAgICAgIGlmICh3YXJuaW5nLmNvZGUpIHtcbiAgICAgICAgICAgIHNlZW5PcHRpbWl6YXRpb25Db2Rlcy5hZGQod2FybmluZy5jb2RlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3B0aW1pemF0aW9uSGludHMucHVzaChoaW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b29sRXhlY3V0aW9uQ29udGV4dC5ydW4oXG4gICAgICAgIHsgY2FsbDogYXVnbWVudGVkQ2FsbCwgb2JzZXJ2ZXI6IHRoaXMub2JzZXJ2ZXIgPz8gdW5kZWZpbmVkIH0sXG4gICAgICAgIGFzeW5jICgpID0+IHJlY29yZC5kZWZpbml0aW9uLmhhbmRsZXIoYXJncylcbiAgICAgICk7XG4gICAgICBsZXQgb3V0cHV0ID0gdHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgPyByZXN1bHQgOiBKU09OLnN0cmluZ2lmeShyZXN1bHQsIG51bGwsIDIpO1xuICAgICAgbGV0IHNuYXBzaG90Q2FuZGlkYXRlID0gb3V0cHV0O1xuXG4gICAgICAvLyBUcnVuY2F0ZSBvdXRwdXQgaWYgY29udGV4dCBtYW5hZ2VyIGlzIGF2YWlsYWJsZVxuICAgICAgaWYgKHRoaXMuY29udGV4dE1hbmFnZXIpIHtcbiAgICAgICAgY29uc3QgdHJ1bmNhdGVkID0gdGhpcy5jb250ZXh0TWFuYWdlci50cnVuY2F0ZVRvb2xPdXRwdXQob3V0cHV0LCBjYWxsLm5hbWUpO1xuICAgICAgICBpZiAodHJ1bmNhdGVkLndhc1RydW5jYXRlZCkge1xuICAgICAgICAgIG91dHB1dCA9IHRydW5jYXRlZC5jb250ZW50O1xuICAgICAgICAgIC8vIExvZyB0cnVuY2F0aW9uIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnZbJ0RFQlVHX0NPTlRFWFQnXSkge1xuICAgICAgICAgICAgbG9nRGVidWcoXG4gICAgICAgICAgICAgIGBbQ29udGV4dCBNYW5hZ2VyXSBUcnVuY2F0ZWQgJHtjYWxsLm5hbWV9IG91dHB1dDogJHt0cnVuY2F0ZWQub3JpZ2luYWxMZW5ndGh9IC0+ICR7dHJ1bmNhdGVkLnRydW5jYXRlZExlbmd0aH0gY2hhcnNgXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzbmFwc2hvdENhbmRpZGF0ZSA9IG91dHB1dDtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZWNvcmREaWZmU25hcHNob3QoYXJncywgc25hcHNob3RDYW5kaWRhdGUpO1xuXG4gICAgICAvLyBDYWNoZSB0aGUgcmVzdWx0IGlmIGNhY2hlYWJsZVxuICAgICAgaWYgKGNhblVzZUNhY2hlKSB7XG4gICAgICAgIGNvbnN0IGNhY2hlS2V5ID0gdGhpcy5nZXRDYWNoZUtleSh7IC4uLmNhbGwsIGFyZ3VtZW50czogYXJncyB9KTtcbiAgICAgICAgdGhpcy5jYWNoZS5zZXQoY2FjaGVLZXksIHtcbiAgICAgICAgICByZXN1bHQ6IG91dHB1dCxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBBcHBlbmQgb3B0aW1pemF0aW9uIGhpbnRzIHRvIGd1aWRlIGZ1dHVyZSBMTE0gYmVoYXZpb3JcbiAgICAgIGlmIChvcHRpbWl6YXRpb25IaW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dCArIG9wdGltaXphdGlvbkhpbnRzLmpvaW4oJycpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm9ic2VydmVyPy5vblRvb2xSZXN1bHQ/LihhdWdtZW50ZWRDYWxsLCBvdXRwdXQpO1xuXG4gICAgICB0aGlzLnJlY29yZFRvb2xIaXN0b3J5KHtcbiAgICAgICAgdG9vbE5hbWU6IGNhbGwubmFtZSxcbiAgICAgICAgYXJncyxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBoYXNPdXRwdXQ6IGhhc05vbkVtcHR5T3V0cHV0KG91dHB1dCksXG4gICAgICB9KTtcblxuICAgICAgLy8gUmVjb3JkIHN1Y2Nlc3NmdWwgZXhlY3V0aW9uXG4gICAgICBmaW5pc2hUb29sQ2FsbCgpO1xuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbGV0IGZvcm1hdHRlZDogc3RyaW5nO1xuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgVG9vbEFyZ3VtZW50VmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgIGZvcm1hdHRlZCA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuICAgICAgICBmb3JtYXR0ZWQgPSBgRmFpbGVkIHRvIHJ1biBcIiR7Y2FsbC5uYW1lfVwiOiAke21lc3NhZ2V9YDtcbiAgICAgIH1cbiAgICAgIHRoaXMub2JzZXJ2ZXI/Lm9uVG9vbEVycm9yPy4oYXVnbWVudGVkQ2FsbCwgZm9ybWF0dGVkKTtcbiAgICAgIHRoaXMucmVjb3JkVG9vbEhpc3Rvcnkoe1xuICAgICAgICB0b29sTmFtZTogY2FsbC5uYW1lLFxuICAgICAgICBhcmdzLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBoYXNPdXRwdXQ6IGhhc05vbkVtcHR5T3V0cHV0KGZvcm1hdHRlZCksXG4gICAgICAgIGVycm9yOiBmb3JtYXR0ZWQsXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gUmVjb3JkIGZhaWxlZCBleGVjdXRpb25cbiAgICAgIGdsb2JhbFBlcmZvcm1hbmNlTW9uaXRvci5yZWNvcmRUb29sRXJyb3IoY2FsbCwgZm9ybWF0dGVkKTtcbiAgICAgIHJldHVybiBmb3JtYXR0ZWQ7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRDYWNoZUtleShjYWxsOiBUb29sQ2FsbFJlcXVlc3QpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHtjYWxsLm5hbWV9OiR7SlNPTi5zdHJpbmdpZnkoY2FsbC5hcmd1bWVudHMpfWA7XG4gIH1cblxuICBjbGVhckNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcbiAgfVxuXG4gIGdldENhY2hlU3RhdHMoKTogeyBzaXplOiBudW1iZXI7IGVudHJpZXM6IG51bWJlciB9IHtcbiAgICBsZXQgdG90YWxTaXplID0gMDtcbiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIHRoaXMuY2FjaGUudmFsdWVzKCkpIHtcbiAgICAgIHRvdGFsU2l6ZSArPSBlbnRyeS5yZXN1bHQubGVuZ3RoO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc2l6ZTogdG90YWxTaXplLFxuICAgICAgZW50cmllczogdGhpcy5jYWNoZS5zaXplLFxuICAgIH07XG4gIH1cblxuICBjbGVhclRvb2xIaXN0b3J5KCk6IHZvaWQge1xuICAgIHRoaXMudG9vbEhpc3RvcnkubGVuZ3RoID0gMDtcbiAgfVxuXG4gIGdldFRvb2xIaXN0b3J5KCk6IHJlYWRvbmx5IFRvb2xIaXN0b3J5RW50cnlbXSB7XG4gICAgcmV0dXJuIHRoaXMudG9vbEhpc3Rvcnk7XG4gIH1cblxuICBwcml2YXRlIHJlY29yZFRvb2xIaXN0b3J5KGVudHJ5OiBUb29sSGlzdG9yeUVudHJ5KTogdm9pZCB7XG4gICAgdGhpcy50b29sSGlzdG9yeS5wdXNoKGVudHJ5KTtcbiAgICBpZiAodGhpcy50b29sSGlzdG9yeS5sZW5ndGggPiB0aGlzLm1heEhpc3RvcnlTaXplKSB7XG4gICAgICB0aGlzLnRvb2xIaXN0b3J5LnNoaWZ0KCk7XG4gICAgfVxuICB9XG5cbiAgY2xlYXJEaWZmU25hcHNob3RzKCk6IHZvaWQge1xuICAgIHRoaXMuZGlmZlNuYXBzaG90cy5sZW5ndGggPSAwO1xuICB9XG5cbiAgZ2V0RGlmZlNuYXBzaG90cygpOiByZWFkb25seSBEaWZmU25hcHNob3RSZWNvcmRbXSB7XG4gICAgcmV0dXJuIHRoaXMuZGlmZlNuYXBzaG90cztcbiAgfVxuXG4gIHByaXZhdGUgYWRkVG9vbChkZWZpbml0aW9uOiBUb29sRGVmaW5pdGlvbiwgc3VpdGVJZDogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKCFkZWZpbml0aW9uPy5uYW1lPy50cmltKCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVG9vbCBuYW1lcyBjYW5ub3QgYmUgYmxhbmsgKHN1aXRlIFwiJHtzdWl0ZUlkfVwiKS5gKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmVnaXN0cnkuaGFzKGRlZmluaXRpb24ubmFtZSkpIHtcbiAgICAgIGNvbnN0IG93bmVyID0gdGhpcy5yZWdpc3RyeS5nZXQoZGVmaW5pdGlvbi5uYW1lKT8uc3VpdGVJZCA/PyAndW5rbm93bic7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRvb2wgXCIke2RlZmluaXRpb24ubmFtZX1cIiBhbHJlYWR5IHJlZ2lzdGVyZWQgYnkgc3VpdGUgXCIke293bmVyfVwiLmApO1xuICAgIH1cbiAgICB0aGlzLnJlZ2lzdHJ5LnNldChkZWZpbml0aW9uLm5hbWUsIHtcbiAgICAgIHN1aXRlSWQsXG4gICAgICBkZWZpbml0aW9uLFxuICAgIH0pO1xuICAgIHRoaXMucmVnaXN0cmF0aW9uT3JkZXIucHVzaChkZWZpbml0aW9uLm5hbWUpO1xuICB9XG5cbiAgcHJpdmF0ZSByZW1vdmVGcm9tT3JkZXIobmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLnJlZ2lzdHJhdGlvbk9yZGVyLmluZGV4T2YobmFtZSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMucmVnaXN0cmF0aW9uT3JkZXIuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJlY29yZERpZmZTbmFwc2hvdChhcmdzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgb3V0cHV0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBjb21tYW5kID0gdGhpcy5maW5kR2l0RGlmZkNvbW1hbmQoYXJncyk7XG4gICAgaWYgKCFjb21tYW5kIHx8ICFvdXRwdXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmRpZmZTbmFwc2hvdHMucHVzaCh7XG4gICAgICBjb21tYW5kLFxuICAgICAgb3V0cHV0OiBzYWZlVHJ1bmNhdGUob3V0cHV0LCB0aGlzLm1heERpZmZTbmFwc2hvdExlbmd0aCwgJ2dpdC1kaWZmJyksXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5kaWZmU25hcHNob3RzLmxlbmd0aCA+IHRoaXMubWF4RGlmZlNuYXBzaG90cykge1xuICAgICAgdGhpcy5kaWZmU25hcHNob3RzLnNoaWZ0KCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmaW5kR2l0RGlmZkNvbW1hbmQoYXJnczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBzdHJpbmcgfCBudWxsIHtcbiAgICBmb3IgKGNvbnN0IGNvbW1hbmQgb2YgdGhpcy5leHRyYWN0Q29tbWFuZHMoYXJncykpIHtcbiAgICAgIGlmICh0aGlzLmlzR2l0RGlmZkNvbW1hbmQoY29tbWFuZCkpIHtcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQ7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0Q29tbWFuZHMoYXJnczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY29tbWFuZHM6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdCBjb21tYW5kID0gYXJnc1snY29tbWFuZCddO1xuICAgIGlmICh0eXBlb2YgY29tbWFuZCA9PT0gJ3N0cmluZycgJiYgY29tbWFuZC50cmltKCkpIHtcbiAgICAgIGNvbW1hbmRzLnB1c2goY29tbWFuZC50cmltKCkpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmRMaXN0ID0gYXJnc1snY29tbWFuZHMnXTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShjb21tYW5kTGlzdCkpIHtcbiAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgY29tbWFuZExpc3QpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgdmFsdWUudHJpbSgpKSB7XG4gICAgICAgICAgY29tbWFuZHMucHVzaCh2YWx1ZS50cmltKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbW1hbmRzO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0dpdERpZmZDb21tYW5kKGNvbW1hbmQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAvXFxiZ2l0XFxzKyg/Oi0tbm8tcGFnZXJcXHMrKT8oPzpkaWZmfHNob3cpXFxiL2kudGVzdChjb21tYW5kKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdFRvb2xSdW50aW1lKFxuICBjb250ZXh0OiBUb29sRXhlY3V0aW9uQ29udGV4dCxcbiAgdG9vbFN1aXRlczogVG9vbFN1aXRlW10gPSBbXSxcbiAgb3B0aW9uczogVG9vbFJ1bnRpbWVPcHRpb25zID0ge31cbik6IFRvb2xSdW50aW1lIHtcbiAgLy8gU3RhcnQgd2l0aCBubyBkZWZhdWx0IGludHJvc3BlY3Rpb24gdG9vbHMgLSB0aGV5IHdhc3RlIHRva2Vuc1xuICAvLyBNb2RlbCBrbm93cyBpdHMgY2FwYWJpbGl0aWVzIGZyb20gdG9vbCBkZWZpbml0aW9uc1xuICBjb25zdCBydW50aW1lID0gbmV3IFRvb2xSdW50aW1lKFtdLCBvcHRpb25zKTtcblxuICBmb3IgKGNvbnN0IHN1aXRlIG9mIHRvb2xTdWl0ZXMpIHtcbiAgICBydW50aW1lLnJlZ2lzdGVyU3VpdGUoc3VpdGUpO1xuICB9XG5cbiAgcmV0dXJuIHJ1bnRpbWU7XG59XG5cbi8vIFJlbW92ZWQgdW51c2VkIGludHJvc3BlY3Rpb24gdG9vbHMgKGNvbnRleHRfc25hcHNob3QsIGNhcGFiaWxpdGllc19vdmVydmlldywgcHJvZmlsZV9kZXRhaWxzKVxuLy8gTW9kZWwgYWxyZWFkeSBrbm93cyBjYXBhYmlsaXRpZXMgZnJvbSB0b29sIGRlZmluaXRpb25zOyB0aGVzZSBqdXN0IHdhc3RlZCB0b2tlbnNcblxuZnVuY3Rpb24gaGFzTm9uRW1wdHlPdXRwdXQob3V0cHV0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIHR5cGVvZiBvdXRwdXQgPT09ICdzdHJpbmcnICYmIG91dHB1dC50cmltKCkubGVuZ3RoID4gMDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVG9vbEFyZ3VtZW50cyh2YWx1ZTogdW5rbm93bik6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTWFwKSB7XG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyh2YWx1ZS5lbnRyaWVzKCkpO1xuICB9XG4gIGlmIChpc1JlY29yZCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICAgIGlmICghdHJpbW1lZCkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZSh0cmltbWVkKTtcbiAgICAgIHJldHVybiBpc1JlY29yZChwYXJzZWQpID8gcGFyc2VkIDoge307XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICB9XG4gIHJldHVybiB7fTtcbn1cblxuZnVuY3Rpb24gaXNSZWNvcmQodmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KHZhbHVlKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFDQSxJQUFBQSxnQkFBQSxHQUFBQyxPQUFBO0FBT0EsSUFBQUMsZ0JBQUEsR0FBQUQsT0FBQTtBQWFBLElBQUFFLGtCQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxtQkFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksWUFBQSxHQUFBSixPQUFBO0FBdkJBOztBQWNBO0FBQ0EsTUFBTUssd0JBQXdCLEdBQUc7RUFDL0JDLGNBQWMsRUFBR0MsS0FBYSxLQUFNO0lBQUVDLEdBQUcsRUFBRUEsQ0FBQSxLQUFNLENBQUM7RUFBRSxDQUFDLENBQUM7RUFDdERDLFVBQVUsRUFBRUEsQ0FBQSxNQUFPLENBQUMsQ0FBQyxDQUFDO0VBQ3RCQyxlQUFlLEVB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LENBQ3RDL0osT0FBNkIsRUFDN0JnSyxVQUF1QixHQUFHLEVBQUUsRUFDNUJ0SCxPQUEyQixHQUFHLENBQUMsQ0FBQyxFQUNuQjtFQUNiO0VBQ0E7RUFDQSxNQUFNdUgsT0FBTyxHQUFHLElBQUluSSxXQUFXLENBQUMsRUFBRSxFQUFFWSxPQUFPLENBQUM7RUFFNUMsS0FBSyxNQUFNaEIsS0FBSyxJQUFJc0ksVUFBVSxFQUFFO0lBQzlCQyxPQUFPLENBQUNsSCxhQUFhLENBQUNyQixLQUFLLENBQUM7RUFDOUI7RUFFQSxPQUFPdUksT0FBTztBQUNoQjs7QUFFQTtBQUNBOztBQUVBLFNBQVNqRSxpQkFBaUJBLENBQUNnQixNQUFjLEVBQVc7RUFDbEQsT0FBTyxPQUFPQSxNQUFNLEtBQUssUUFBUSxJQUFJQSxNQUFNLENBQUM3RCxJQUFJLENBQUMsQ0FBQyxDQUFDTCxNQUFNLEdBQUcsQ0FBQztBQUMvRDtBQUVBLFNBQVN3QixzQkFBc0JBLENBQUN1RixLQUFjLEVBQTJCO0VBQ3ZFLElBQUlBLEtBQUssWUFBWTdILEdBQUcsRUFBRTtJQUN4QixPQUFPa0ksTUFBTSxDQUFDQyxXQUFXLENBQUNOLEtBQUssQ0FBQ3BHLE9BQU8sQ0FBQyxDQUFDLENBQUM7RUFDNUM7RUFDQSxJQUFJMkcsUUFBUSxDQUFDUCxLQUFLLENBQUMsRUFBRTtJQUNuQixPQUFPQSxLQUFLO0VBQ2Q7RUFDQSxJQUFJLE9BQU9BLEtBQUssS0FBSyxRQUFRLEVBQUU7SUFDN0IsTUFBTVEsT0FBTyxHQUFHUixLQUFLLENBQUMxRyxJQUFJLENBQUMsQ0FBQztJQUM1QixJQUFJLENBQUNrSCxPQUFPLEVBQUU7TUFDWixPQUFPLENBQUMsQ0FBQztJQUNYO0lBQ0EsSUFBSTtNQUNGLE1BQU1DLE1BQU0sR0FBR3JELElBQUksQ0FBQ3NELEtBQUssQ0FBQ0YsT0FBTyxDQUFDO01BQ2xDLE9BQU9ELFFBQVEsQ0FBQ0UsTUFBTSxDQUFDLEdBQUdBLE1BQU0sR0FBRyxDQUFDLENBQUM7SUFDdkMsQ0FBQyxDQUFDLE1BQU07TUFDTixPQUFPLENBQUMsQ0FBQztJQUNYO0VBQ0Y7RUFDQSxPQUFPLENBQUMsQ0FBQztBQUNYO0FBRUEsU0FBU0YsUUFBUUEsQ0FBQ1AsS0FBYyxFQUFvQztFQUNsRSxPQUFPLE9BQU9BLEtBQUssS0FBSyxRQUFRLElBQUlBLEtBQUssS0FBSyxJQUFJLElBQUksQ0FBQ0YsS0FBSyxDQUFDQyxPQUFPLENBQUNDLEtBQUssQ0FBQztBQUM3RSIsImlnbm9yZUxpc3QiOltdfQ==
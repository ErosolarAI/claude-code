# Incident Response Runbook

Actionable, repeatable steps for responding to suspected compromise during exercises or real events. Adapt RACI to your team; keep actions limited to authorized scope.

## 1) Detection & triage
- [ ] Confirm alert fidelity (source, timestamp, host/user/app, rule ID).
- [ ] Snapshot volatile data where allowed: process list, network connections, logged-in users.
- [ ] If generated by an exercise, pull the corresponding `artifacts/<engagement-id>/run.log` to correlate.
- [ ] Assign incident lead, comms lead, and scribe; open a ticket/case with a unique ID.

## 2) Scoping
- [ ] Identify affected assets (hosts, accounts, apps, cloud resources) and blast radius.
- [ ] Check for lateral movement indicators (new sessions, unusual authentication, privilege changes).
- [ ] Map detections to MITRE ATT&CK to anticipate next moves.

## 3) Containment (choose minimal-impact first)
- [ ] Isolate hosts or user accounts involved; revoke tokens/sessions.
- [ ] Block known malicious destinations (domains/IPs) in firewalls/proxies if applicable.
- [ ] For exercises, coordinate with operators to pause activity while containment is tested.

## 4) Eradication
- [ ] Remove persistence artifacts (scheduled tasks, services, registry/systemd changes, startup items).
- [ ] Clear unauthorized accounts/keys/tokens; rotate credentials or secrets touched.
- [ ] Apply patches or config changes that mitigate the exploited weakness.

## 5) Recovery
- [ ] Restore systems to known-good state (image restore or configuration baseline).
- [ ] Reintroduce systems to the network gradually; monitor for reoccurrence.
- [ ] Validate detections remain enabled; run a short validation script or replay of the benign detection trigger.

## 6) Post-incident
- [ ] Timeline: assemble events from logs, evidence pack, and operator notes.
- [ ] Root cause: initial vector, controls that failed, controls that worked.
- [ ] Actions: remediation owners, deadlines, detection rule improvements, playbook adjustments.
- [ ] Communication: executive summary for leadership and technical appendix for responders.

## Data handling & evidence
- Keep chain-of-custody: who collected, when, from where. Hash files captured.
- Store agent outputs (`--json` runs) and console transcripts with timestamps.
- Avoid collecting live data without consent; prefer pre-agreed collection scripts.

## Quick-use checklist (printable)
- [ ] Case opened with ID and roles assigned.
- [ ] Alert validated and scope identified.
- [ ] Containment applied (hosts isolated/accounts blocked).
- [ ] Persistence removed and creds rotated.
- [ ] Systems restored and monitoring heightened.
- [ ] Post-incident review scheduled with action items tracked.
